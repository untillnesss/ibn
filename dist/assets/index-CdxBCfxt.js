const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AboutView-BIAqk6Xq.js","assets/AboutView-CSIvawM9.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Zu(i){const e=Object.create(null);for(const t of i.split(","))e[t]=1;return t=>t in e}const Je={},Pr=[],Mn=()=>{},Wy=()=>!1,pl=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),eh=i=>i.startsWith("onUpdate:"),Bt=Object.assign,th=(i,e)=>{const t=i.indexOf(e);t>-1&&i.splice(t,1)},Gy=Object.prototype.hasOwnProperty,We=(i,e)=>Gy.call(i,e),Te=Array.isArray,Vs=i=>gl(i)==="[object Map]",Ky=i=>gl(i)==="[object Set]",Ce=i=>typeof i=="function",xt=i=>typeof i=="string",ar=i=>typeof i=="symbol",ct=i=>i!==null&&typeof i=="object",M1=i=>(ct(i)||Ce(i))&&Ce(i.then)&&Ce(i.catch),Yy=Object.prototype.toString,gl=i=>Yy.call(i),Xy=i=>gl(i).slice(8,-1),Qy=i=>gl(i)==="[object Object]",nh=i=>xt(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,Fs=Zu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ml=i=>{const e=Object.create(null);return t=>e[t]||(e[t]=i(t))},Jy=/-(\w)/g,Ai=ml(i=>i.replace(Jy,(e,t)=>t?t.toUpperCase():"")),Zy=/\B([A-Z])/g,lr=ml(i=>i.replace(Zy,"-$1").toLowerCase()),O1=ml(i=>i.charAt(0).toUpperCase()+i.slice(1)),hc=ml(i=>i?`on${O1(i)}`:""),vi=(i,e)=>!Object.is(i,e),dc=(i,...e)=>{for(let t=0;t<i.length;t++)i[t](...e)},D1=(i,e,t,n=!1)=>{Object.defineProperty(i,e,{configurable:!0,enumerable:!1,writable:n,value:t})},ev=i=>{const e=parseFloat(i);return isNaN(e)?i:e};let Tf;const _l=()=>Tf||(Tf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ih(i){if(Te(i)){const e={};for(let t=0;t<i.length;t++){const n=i[t],r=xt(n)?rv(n):ih(n);if(r)for(const s in r)e[s]=r[s]}return e}else if(xt(i)||ct(i))return i}const tv=/;(?![^(]*\))/g,nv=/:([^]+)/,iv=/\/\*[^]*?\*\//g;function rv(i){const e={};return i.replace(iv,"").split(tv).forEach(t=>{if(t){const n=t.split(nv);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function rh(i){let e="";if(xt(i))e=i;else if(Te(i))for(let t=0;t<i.length;t++){const n=rh(i[t]);n&&(e+=n+" ")}else if(ct(i))for(const t in i)i[t]&&(e+=t+" ");return e.trim()}const sv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ov=Zu(sv);function U1(i){return!!i||i===""}/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ht;class V1{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ht,!e&&Ht&&(this.index=(Ht.scopes||(Ht.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Ht;try{return Ht=this,e()}finally{Ht=t}}}on(){Ht=this}off(){Ht=this.parent}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function F1(i){return new V1(i)}function B1(){return Ht}function av(i,e=!1){Ht&&Ht.cleanups.push(i)}let Ze;const fc=new WeakSet;class $1{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ht&&Ht.active&&Ht.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,fc.has(this)&&(fc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||H1(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,kf(this),j1(this);const e=Ze,t=_n;Ze=this,_n=!0;try{return this.fn()}finally{q1(this),Ze=e,_n=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)ah(e);this.deps=this.depsTail=void 0,kf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?fc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Kc(this)&&this.run()}get dirty(){return Kc(this)}}let z1=0,Bs,$s;function H1(i,e=!1){if(i.flags|=8,e){i.next=$s,$s=i;return}i.next=Bs,Bs=i}function sh(){z1++}function oh(){if(--z1>0)return;if($s){let e=$s;for($s=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let i;for(;Bs;){let e=Bs;for(Bs=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){i||(i=n)}e=t}}if(i)throw i}function j1(i){for(let e=i.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function q1(i){let e,t=i.depsTail,n=t;for(;n;){const r=n.prevDep;n.version===-1?(n===t&&(t=r),ah(n),lv(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=r}i.deps=e,i.depsTail=t}function Kc(i){for(let e=i.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(W1(e.dep.computed)||e.dep.version!==e.version))return!0;return!!i._dirty}function W1(i){if(i.flags&4&&!(i.flags&16)||(i.flags&=-17,i.globalVersion===ro))return;i.globalVersion=ro;const e=i.dep;if(i.flags|=2,e.version>0&&!i.isSSR&&i.deps&&!Kc(i)){i.flags&=-3;return}const t=Ze,n=_n;Ze=i,_n=!0;try{j1(i);const r=i.fn(i._value);(e.version===0||vi(r,i._value))&&(i._value=r,e.version++)}catch(r){throw e.version++,r}finally{Ze=t,_n=n,q1(i),i.flags&=-3}}function ah(i,e=!1){const{dep:t,prevSub:n,nextSub:r}=i;if(n&&(n.nextSub=r,i.prevSub=void 0),r&&(r.prevSub=n,i.nextSub=void 0),t.subs===i&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)ah(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function lv(i){const{prevDep:e,nextDep:t}=i;e&&(e.nextDep=t,i.prevDep=void 0),t&&(t.prevDep=e,i.nextDep=void 0)}let _n=!0;const G1=[];function Oi(){G1.push(_n),_n=!1}function Di(){const i=G1.pop();_n=i===void 0?!0:i}function kf(i){const{cleanup:e}=i;if(i.cleanup=void 0,e){const t=Ze;Ze=void 0;try{e()}finally{Ze=t}}}let ro=0;class cv{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class lh{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Ze||!_n||Ze===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Ze)t=this.activeLink=new cv(Ze,this),Ze.deps?(t.prevDep=Ze.depsTail,Ze.depsTail.nextDep=t,Ze.depsTail=t):Ze.deps=Ze.depsTail=t,K1(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=Ze.depsTail,t.nextDep=void 0,Ze.depsTail.nextDep=t,Ze.depsTail=t,Ze.deps===t&&(Ze.deps=n)}return t}trigger(e){this.version++,ro++,this.notify(e)}notify(e){sh();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{oh()}}}function K1(i){if(i.dep.sc++,i.sub.flags&4){const e=i.dep.computed;if(e&&!i.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)K1(n)}const t=i.dep.subs;t!==i&&(i.prevSub=t,t&&(t.nextSub=i)),i.dep.subs=i}}const Ca=new WeakMap,Qi=Symbol(""),Yc=Symbol(""),so=Symbol("");function Lt(i,e,t){if(_n&&Ze){let n=Ca.get(i);n||Ca.set(i,n=new Map);let r=n.get(t);r||(n.set(t,r=new lh),r.map=n,r.key=t),r.track()}}function Xn(i,e,t,n,r,s){const o=Ca.get(i);if(!o){ro++;return}const a=l=>{l&&l.trigger()};if(sh(),e==="clear")o.forEach(a);else{const l=Te(i),c=l&&nh(t);if(l&&t==="length"){const u=Number(n);o.forEach((h,d)=>{(d==="length"||d===so||!ar(d)&&d>=u)&&a(h)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(so)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Qi)),Vs(i)&&a(o.get(Yc)));break;case"delete":l||(a(o.get(Qi)),Vs(i)&&a(o.get(Yc)));break;case"set":Vs(i)&&a(o.get(Qi));break}}oh()}function uv(i,e){const t=Ca.get(i);return t&&t.get(e)}function br(i){const e=$e(i);return e===i?e:(Lt(e,"iterate",so),yn(i)?e:e.map(jt))}function ch(i){return Lt(i=$e(i),"iterate",so),i}const hv={__proto__:null,[Symbol.iterator](){return pc(this,Symbol.iterator,jt)},concat(...i){return br(this).concat(...i.map(e=>Te(e)?br(e):e))},entries(){return pc(this,"entries",i=>(i[1]=jt(i[1]),i))},every(i,e){return qn(this,"every",i,e,void 0,arguments)},filter(i,e){return qn(this,"filter",i,e,t=>t.map(jt),arguments)},find(i,e){return qn(this,"find",i,e,jt,arguments)},findIndex(i,e){return qn(this,"findIndex",i,e,void 0,arguments)},findLast(i,e){return qn(this,"findLast",i,e,jt,arguments)},findLastIndex(i,e){return qn(this,"findLastIndex",i,e,void 0,arguments)},forEach(i,e){return qn(this,"forEach",i,e,void 0,arguments)},includes(...i){return gc(this,"includes",i)},indexOf(...i){return gc(this,"indexOf",i)},join(i){return br(this).join(i)},lastIndexOf(...i){return gc(this,"lastIndexOf",i)},map(i,e){return qn(this,"map",i,e,void 0,arguments)},pop(){return xs(this,"pop")},push(...i){return xs(this,"push",i)},reduce(i,...e){return Rf(this,"reduce",i,e)},reduceRight(i,...e){return Rf(this,"reduceRight",i,e)},shift(){return xs(this,"shift")},some(i,e){return qn(this,"some",i,e,void 0,arguments)},splice(...i){return xs(this,"splice",i)},toReversed(){return br(this).toReversed()},toSorted(i){return br(this).toSorted(i)},toSpliced(...i){return br(this).toSpliced(...i)},unshift(...i){return xs(this,"unshift",i)},values(){return pc(this,"values",jt)}};function pc(i,e,t){const n=ch(i),r=n[e]();return n!==i&&!yn(i)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=t(s.value)),s}),r}const dv=Array.prototype;function qn(i,e,t,n,r,s){const o=ch(i),a=o!==i&&!yn(i),l=o[e];if(l!==dv[e]){const h=l.apply(i,s);return a?jt(h):h}let c=t;o!==i&&(a?c=function(h,d){return t.call(this,jt(h),d,i)}:t.length>2&&(c=function(h,d){return t.call(this,h,d,i)}));const u=l.call(o,c,n);return a&&r?r(u):u}function Rf(i,e,t,n){const r=ch(i);let s=t;return r!==i&&(yn(i)?t.length>3&&(s=function(o,a,l){return t.call(this,o,a,l,i)}):s=function(o,a,l){return t.call(this,o,jt(a),l,i)}),r[e](s,...n)}function gc(i,e,t){const n=$e(i);Lt(n,"iterate",so);const r=n[e](...t);return(r===-1||r===!1)&&dh(t[0])?(t[0]=$e(t[0]),n[e](...t)):r}function xs(i,e,t=[]){Oi(),sh();const n=$e(i)[e].apply(i,t);return oh(),Di(),n}const fv=Zu("__proto__,__v_isRef,__isVue"),Y1=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(ar));function pv(i){ar(i)||(i=String(i));const e=$e(this);return Lt(e,"has",i),e.hasOwnProperty(i)}class X1{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const r=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!r;if(t==="__v_isReadonly")return r;if(t==="__v_isShallow")return s;if(t==="__v_raw")return n===(r?s?Iv:em:s?Z1:J1).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=Te(e);if(!r){let l;if(o&&(l=hv[t]))return l;if(t==="hasOwnProperty")return pv}const a=Reflect.get(e,t,_t(e)?e:n);return(ar(t)?Y1.has(t):fv(t))||(r||Lt(e,"get",t),s)?a:_t(a)?o&&nh(t)?a:a.value:ct(a)?r?nm(a):yl(a):a}}class Q1 extends X1{constructor(e=!1){super(!1,e)}set(e,t,n,r){let s=e[t];if(!this._isShallow){const l=er(s);if(!yn(n)&&!er(n)&&(s=$e(s),n=$e(n)),!Te(e)&&_t(s)&&!_t(n))return l?!1:(s.value=n,!0)}const o=Te(e)&&nh(t)?Number(t)<e.length:We(e,t),a=Reflect.set(e,t,n,_t(e)?e:r);return e===$e(r)&&(o?vi(n,s)&&Xn(e,"set",t,n):Xn(e,"add",t,n)),a}deleteProperty(e,t){const n=We(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&n&&Xn(e,"delete",t,void 0),r}has(e,t){const n=Reflect.has(e,t);return(!ar(t)||!Y1.has(t))&&Lt(e,"has",t),n}ownKeys(e){return Lt(e,"iterate",Te(e)?"length":Qi),Reflect.ownKeys(e)}}class gv extends X1{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const mv=new Q1,_v=new gv,yv=new Q1(!0);const Xc=i=>i,ta=i=>Reflect.getPrototypeOf(i);function vv(i,e,t){return function(...n){const r=this.__v_raw,s=$e(r),o=Vs(s),a=i==="entries"||i===Symbol.iterator&&o,l=i==="keys"&&o,c=r[i](...n),u=t?Xc:e?Qc:jt;return!e&&Lt(s,"iterate",l?Yc:Qi),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function na(i){return function(...e){return i==="delete"?!1:i==="clear"?void 0:this}}function bv(i,e){const t={get(r){const s=this.__v_raw,o=$e(s),a=$e(r);i||(vi(r,a)&&Lt(o,"get",r),Lt(o,"get",a));const{has:l}=ta(o),c=e?Xc:i?Qc:jt;if(l.call(o,r))return c(s.get(r));if(l.call(o,a))return c(s.get(a));s!==o&&s.get(r)},get size(){const r=this.__v_raw;return!i&&Lt($e(r),"iterate",Qi),Reflect.get(r,"size",r)},has(r){const s=this.__v_raw,o=$e(s),a=$e(r);return i||(vi(r,a)&&Lt(o,"has",r),Lt(o,"has",a)),r===a?s.has(r):s.has(r)||s.has(a)},forEach(r,s){const o=this,a=o.__v_raw,l=$e(a),c=e?Xc:i?Qc:jt;return!i&&Lt(l,"iterate",Qi),a.forEach((u,h)=>r.call(s,c(u),c(h),o))}};return Bt(t,i?{add:na("add"),set:na("set"),delete:na("delete"),clear:na("clear")}:{add(r){!e&&!yn(r)&&!er(r)&&(r=$e(r));const s=$e(this);return ta(s).has.call(s,r)||(s.add(r),Xn(s,"add",r,r)),this},set(r,s){!e&&!yn(s)&&!er(s)&&(s=$e(s));const o=$e(this),{has:a,get:l}=ta(o);let c=a.call(o,r);c||(r=$e(r),c=a.call(o,r));const u=l.call(o,r);return o.set(r,s),c?vi(s,u)&&Xn(o,"set",r,s):Xn(o,"add",r,s),this},delete(r){const s=$e(this),{has:o,get:a}=ta(s);let l=o.call(s,r);l||(r=$e(r),l=o.call(s,r)),a&&a.call(s,r);const c=s.delete(r);return l&&Xn(s,"delete",r,void 0),c},clear(){const r=$e(this),s=r.size!==0,o=r.clear();return s&&Xn(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=vv(r,i,e)}),t}function uh(i,e){const t=bv(i,e);return(n,r,s)=>r==="__v_isReactive"?!i:r==="__v_isReadonly"?i:r==="__v_raw"?n:Reflect.get(We(t,r)&&r in n?t:n,r,s)}const wv={get:uh(!1,!1)},Ev={get:uh(!1,!0)},xv={get:uh(!0,!1)};const J1=new WeakMap,Z1=new WeakMap,em=new WeakMap,Iv=new WeakMap;function Sv(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Av(i){return i.__v_skip||!Object.isExtensible(i)?0:Sv(Xy(i))}function yl(i){return er(i)?i:hh(i,!1,mv,wv,J1)}function tm(i){return hh(i,!1,yv,Ev,Z1)}function nm(i){return hh(i,!0,_v,xv,em)}function hh(i,e,t,n,r){if(!ct(i)||i.__v_raw&&!(e&&i.__v_isReactive))return i;const s=r.get(i);if(s)return s;const o=Av(i);if(o===0)return i;const a=new Proxy(i,o===2?n:t);return r.set(i,a),a}function zs(i){return er(i)?zs(i.__v_raw):!!(i&&i.__v_isReactive)}function er(i){return!!(i&&i.__v_isReadonly)}function yn(i){return!!(i&&i.__v_isShallow)}function dh(i){return i?!!i.__v_raw:!1}function $e(i){const e=i&&i.__v_raw;return e?$e(e):i}function Cv(i){return!We(i,"__v_skip")&&Object.isExtensible(i)&&D1(i,"__v_skip",!0),i}const jt=i=>ct(i)?yl(i):i,Qc=i=>ct(i)?nm(i):i;function _t(i){return i?i.__v_isRef===!0:!1}function Ji(i){return im(i,!1)}function fh(i){return im(i,!0)}function im(i,e){return _t(i)?i:new Tv(i,e)}class Tv{constructor(e,t){this.dep=new lh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:$e(e),this._value=t?e:jt(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this.__v_isShallow||yn(e)||er(e);e=n?e:$e(e),vi(e,t)&&(this._rawValue=e,this._value=n?e:jt(e),this.dep.trigger())}}function Zi(i){return _t(i)?i.value:i}function Kn(i){return Ce(i)?i():Zi(i)}const kv={get:(i,e,t)=>e==="__v_raw"?i:Zi(Reflect.get(i,e,t)),set:(i,e,t,n)=>{const r=i[e];return _t(r)&&!_t(t)?(r.value=t,!0):Reflect.set(i,e,t,n)}};function rm(i){return zs(i)?i:new Proxy(i,kv)}class Rv{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return uv($e(this._object),this._key)}}class Nv{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Pv(i,e,t){return _t(i)?i:Ce(i)?new Nv(i):ct(i)&&arguments.length>1?Lv(i,e,t):Ji(i)}function Lv(i,e,t){const n=i[e];return _t(n)?n:new Rv(i,e,t)}class Mv{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new lh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ro-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Ze!==this)return H1(this,!0),!0}get value(){const e=this.dep.track();return W1(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Ov(i,e,t=!1){let n,r;return Ce(i)?n=i:(n=i.get,r=i.set),new Mv(n,r,t)}const ia={},Ta=new WeakMap;let qi;function Dv(i,e=!1,t=qi){if(t){let n=Ta.get(t);n||Ta.set(t,n=[]),n.push(i)}}function Uv(i,e,t=Je){const{immediate:n,deep:r,once:s,scheduler:o,augmentJob:a,call:l}=t,c=A=>r?A:yn(A)||r===!1||r===0?_i(A,1):_i(A);let u,h,d,p,g=!1,_=!1;if(_t(i)?(h=()=>i.value,g=yn(i)):zs(i)?(h=()=>c(i),g=!0):Te(i)?(_=!0,g=i.some(A=>zs(A)||yn(A)),h=()=>i.map(A=>{if(_t(A))return A.value;if(zs(A))return c(A);if(Ce(A))return l?l(A,2):A()})):Ce(i)?e?h=l?()=>l(i,2):i:h=()=>{if(d){Oi();try{d()}finally{Di()}}const A=qi;qi=u;try{return l?l(i,3,[p]):i(p)}finally{qi=A}}:h=Mn,e&&r){const A=h,E=r===!0?1/0:r;h=()=>_i(A(),E)}const v=B1(),C=()=>{u.stop(),v&&v.active&&th(v.effects,u)};if(s&&e){const A=e;e=(...E)=>{A(...E),C()}}let T=_?new Array(i.length).fill(ia):ia;const y=A=>{if(!(!(u.flags&1)||!u.dirty&&!A))if(e){const E=u.run();if(r||g||(_?E.some((x,w)=>vi(x,T[w])):vi(E,T))){d&&d();const x=qi;qi=u;try{const w=[E,T===ia?void 0:_&&T[0]===ia?[]:T,p];l?l(e,3,w):e(...w),T=E}finally{qi=x}}}else u.run()};return a&&a(y),u=new $1(h),u.scheduler=o?()=>o(y,!1):y,p=A=>Dv(A,!1,u),d=u.onStop=()=>{const A=Ta.get(u);if(A){if(l)l(A,4);else for(const E of A)E();Ta.delete(u)}},e?n?y(!0):T=u.run():o?o(y.bind(null,!0),!0):u.run(),C.pause=u.pause.bind(u),C.resume=u.resume.bind(u),C.stop=C,C}function _i(i,e=1/0,t){if(e<=0||!ct(i)||i.__v_skip||(t=t||new Set,t.has(i)))return i;if(t.add(i),e--,_t(i))_i(i.value,e,t);else if(Te(i))for(let n=0;n<i.length;n++)_i(i[n],e,t);else if(Ky(i)||Vs(i))i.forEach(n=>{_i(n,e,t)});else if(Qy(i)){for(const n in i)_i(i[n],e,t);for(const n of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,n)&&_i(i[n],e,t)}return i}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Io(i,e,t,n){try{return n?i(...n):i()}catch(r){vl(r,e,t)}}function Un(i,e,t,n){if(Ce(i)){const r=Io(i,e,t,n);return r&&M1(r)&&r.catch(s=>{vl(s,e,t)}),r}if(Te(i)){const r=[];for(let s=0;s<i.length;s++)r.push(Un(i[s],e,t,n));return r}}function vl(i,e,t,n=!0){const r=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Je;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const u=a.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](i,l,c)===!1)return}a=a.parent}if(s){Oi(),Io(s,null,10,[i,l,c]),Di();return}}Vv(i,t,r,n,o)}function Vv(i,e,t,n=!0,r=!1){if(r)throw i;console.error(i)}const qt=[];let Tn=-1;const Lr=[];let pi=null,Ir=0;const sm=Promise.resolve();let ka=null;function om(i){const e=ka||sm;return i?e.then(this?i.bind(this):i):e}function Fv(i){let e=Tn+1,t=qt.length;for(;e<t;){const n=e+t>>>1,r=qt[n],s=oo(r);s<i||s===i&&r.flags&2?e=n+1:t=n}return e}function ph(i){if(!(i.flags&1)){const e=oo(i),t=qt[qt.length-1];!t||!(i.flags&2)&&e>=oo(t)?qt.push(i):qt.splice(Fv(e),0,i),i.flags|=1,am()}}function am(){ka||(ka=sm.then(cm))}function Bv(i){Te(i)?Lr.push(...i):pi&&i.id===-1?pi.splice(Ir+1,0,i):i.flags&1||(Lr.push(i),i.flags|=1),am()}function Nf(i,e,t=Tn+1){for(;t<qt.length;t++){const n=qt[t];if(n&&n.flags&2){if(i&&n.id!==i.uid)continue;qt.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function lm(i){if(Lr.length){const e=[...new Set(Lr)].sort((t,n)=>oo(t)-oo(n));if(Lr.length=0,pi){pi.push(...e);return}for(pi=e,Ir=0;Ir<pi.length;Ir++){const t=pi[Ir];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}pi=null,Ir=0}}const oo=i=>i.id==null?i.flags&2?-1:1/0:i.id;function cm(i){try{for(Tn=0;Tn<qt.length;Tn++){const e=qt[Tn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Io(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Tn<qt.length;Tn++){const e=qt[Tn];e&&(e.flags&=-2)}Tn=-1,qt.length=0,lm(),ka=null,(qt.length||Lr.length)&&cm()}}let Wt=null,um=null;function Ra(i){const e=Wt;return Wt=i,um=i&&i.type.__scopeId||null,e}function Nt(i,e=Wt,t){if(!e||i._n)return i;const n=(...r)=>{n._d&&Bf(-1);const s=Ra(e);let o;try{o=i(...r)}finally{Ra(s),n._d&&Bf(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Hi(i,e,t,n){const r=i.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[n];l&&(Oi(),Un(l,t,8,[i.el,a,i,e]),Di())}}const $v=Symbol("_vte"),zv=i=>i.__isTeleport;function gh(i,e){i.shapeFlag&6&&i.component?(i.transition=e,gh(i.component.subTree,e)):i.shapeFlag&128?(i.ssContent.transition=e.clone(i.ssContent),i.ssFallback.transition=e.clone(i.ssFallback)):i.transition=e}/*! #__NO_SIDE_EFFECTS__ */function hm(i,e){return Ce(i)?Bt({name:i.name},e,{setup:i}):i}function dm(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}function Hv(i){const e=vh(),t=fh(null);if(e){const r=e.refs===Je?e.refs={}:e.refs;Object.defineProperty(r,i,{enumerable:!0,get:()=>t.value,set:s=>t.value=s})}return t}function Na(i,e,t,n,r=!1){if(Te(i)){i.forEach((g,_)=>Na(g,e&&(Te(e)?e[_]:e),t,n,r));return}if(Mr(n)&&!r){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Na(i,e,t,n.component.subTree);return}const s=n.shapeFlag&4?bh(n.component):n.el,o=r?null:s,{i:a,r:l}=i,c=e&&e.r,u=a.refs===Je?a.refs={}:a.refs,h=a.setupState,d=$e(h),p=h===Je?()=>!1:g=>We(d,g);if(c!=null&&c!==l&&(xt(c)?(u[c]=null,p(c)&&(h[c]=null)):_t(c)&&(c.value=null)),Ce(l))Io(l,a,12,[o,u]);else{const g=xt(l),_=_t(l);if(g||_){const v=()=>{if(i.f){const C=g?p(l)?h[l]:u[l]:l.value;r?Te(C)&&th(C,s):Te(C)?C.includes(s)||C.push(s):g?(u[l]=[s],p(l)&&(h[l]=u[l])):(l.value=[s],i.k&&(u[i.k]=l.value))}else g?(u[l]=o,p(l)&&(h[l]=o)):_&&(l.value=o,i.k&&(u[i.k]=o))};o?(v.id=-1,en(v,t)):v()}}}_l().requestIdleCallback;_l().cancelIdleCallback;const Mr=i=>!!i.type.__asyncLoader,fm=i=>i.type.__isKeepAlive;function jv(i,e){pm(i,"a",e)}function qv(i,e){pm(i,"da",e)}function pm(i,e,t=Ut){const n=i.__wdc||(i.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return i()});if(bl(e,n,t),t){let r=t.parent;for(;r&&r.parent;)fm(r.parent.vnode)&&Wv(n,e,t,r),r=r.parent}}function Wv(i,e,t,n){const r=bl(e,i,n,!0);mh(()=>{th(n[e],r)},t)}function bl(i,e,t=Ut,n=!1){if(t){const r=t[i]||(t[i]=[]),s=e.__weh||(e.__weh=(...o)=>{Oi();const a=So(t),l=Un(e,t,i,o);return a(),Di(),l});return n?r.unshift(s):r.push(s),s}}const ri=i=>(e,t=Ut)=>{(!co||i==="sp")&&bl(i,(...n)=>e(...n),t)},Gv=ri("bm"),gm=ri("m"),Kv=ri("bu"),Yv=ri("u"),Xv=ri("bum"),mh=ri("um"),mm=ri("sp"),Qv=ri("rtg"),Jv=ri("rtc");function Zv(i,e=Ut){bl("ec",i,e)}const e3=Symbol.for("v-ndc");function mc(i,e,t={},n,r){if(Wt.ce||Wt.parent&&Mr(Wt.parent)&&Wt.parent.ce)return e!=="default"&&(t.name=e),cn(),nu(tn,null,[at("slot",t,n)],64);let s=i[e];s&&s._c&&(s._d=!1),cn();const o=s&&_m(s(t)),a=t.key||o&&o.key,l=nu(tn,{key:(a&&!ar(a)?a:`_${e}`)+""},o||[],o&&i._===1?64:-2);return s&&s._c&&(s._d=!0),l}function _m(i){return i.some(e=>lo(e)?!(e.type===$r||e.type===tn&&!_m(e.children)):!0)?i:null}const Jc=i=>i?Vm(i)?bh(i):Jc(i.parent):null,Hs=Bt(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>Jc(i.parent),$root:i=>Jc(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>vm(i),$forceUpdate:i=>i.f||(i.f=()=>{ph(i.update)}),$nextTick:i=>i.n||(i.n=om.bind(i.proxy)),$watch:i=>w3.bind(i)}),_c=(i,e)=>i!==Je&&!i.__isScriptSetup&&We(i,e),t3={get({_:i},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:n,data:r,props:s,accessCache:o,type:a,appContext:l}=i;let c;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return n[e];case 2:return r[e];case 4:return t[e];case 3:return s[e]}else{if(_c(n,e))return o[e]=1,n[e];if(r!==Je&&We(r,e))return o[e]=2,r[e];if((c=i.propsOptions[0])&&We(c,e))return o[e]=3,s[e];if(t!==Je&&We(t,e))return o[e]=4,t[e];Zc&&(o[e]=0)}}const u=Hs[e];let h,d;if(u)return e==="$attrs"&&Lt(i.attrs,"get",""),u(i);if((h=a.__cssModules)&&(h=h[e]))return h;if(t!==Je&&We(t,e))return o[e]=4,t[e];if(d=l.config.globalProperties,We(d,e))return d[e]},set({_:i},e,t){const{data:n,setupState:r,ctx:s}=i;return _c(r,e)?(r[e]=t,!0):n!==Je&&We(n,e)?(n[e]=t,!0):We(i.props,e)||e[0]==="$"&&e.slice(1)in i?!1:(s[e]=t,!0)},has({_:{data:i,setupState:e,accessCache:t,ctx:n,appContext:r,propsOptions:s}},o){let a;return!!t[o]||i!==Je&&We(i,o)||_c(e,o)||(a=s[0])&&We(a,o)||We(n,o)||We(Hs,o)||We(r.config.globalProperties,o)},defineProperty(i,e,t){return t.get!=null?i._.accessCache[e]=0:We(t,"value")&&this.set(i,e,t.value,null),Reflect.defineProperty(i,e,t)}};function Pf(i){return Te(i)?i.reduce((e,t)=>(e[t]=null,e),{}):i}let Zc=!0;function n3(i){const e=vm(i),t=i.proxy,n=i.ctx;Zc=!1,e.beforeCreate&&Lf(e.beforeCreate,i,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:p,updated:g,activated:_,deactivated:v,beforeDestroy:C,beforeUnmount:T,destroyed:y,unmounted:A,render:E,renderTracked:x,renderTriggered:w,errorCaptured:S,serverPrefetch:I,expose:k,inheritAttrs:P,components:O,directives:R,filters:K}=e;if(c&&i3(c,n,null),o)for(const se in o){const Y=o[se];Ce(Y)&&(n[se]=Y.bind(t))}if(r){const se=r.call(t,t);ct(se)&&(i.data=yl(se))}if(Zc=!0,s)for(const se in s){const Y=s[se],Q=Ce(Y)?Y.bind(t,t):Ce(Y.get)?Y.get.bind(t,t):Mn,re=!Ce(Y)&&Ce(Y.set)?Y.set.bind(t):Mn,ve=fn({get:Q,set:re});Object.defineProperty(n,se,{enumerable:!0,configurable:!0,get:()=>ve.value,set:ae=>ve.value=ae})}if(a)for(const se in a)ym(a[se],n,t,se);if(l){const se=Ce(l)?l.call(t):l;Reflect.ownKeys(se).forEach(Y=>{ma(Y,se[Y])})}u&&Lf(u,i,"c");function pe(se,Y){Te(Y)?Y.forEach(Q=>se(Q.bind(t))):Y&&se(Y.bind(t))}if(pe(Gv,h),pe(gm,d),pe(Kv,p),pe(Yv,g),pe(jv,_),pe(qv,v),pe(Zv,S),pe(Jv,x),pe(Qv,w),pe(Xv,T),pe(mh,A),pe(mm,I),Te(k))if(k.length){const se=i.exposed||(i.exposed={});k.forEach(Y=>{Object.defineProperty(se,Y,{get:()=>t[Y],set:Q=>t[Y]=Q})})}else i.exposed||(i.exposed={});E&&i.render===Mn&&(i.render=E),P!=null&&(i.inheritAttrs=P),O&&(i.components=O),R&&(i.directives=R),I&&dm(i)}function i3(i,e,t=Mn){Te(i)&&(i=eu(i));for(const n in i){const r=i[n];let s;ct(r)?"default"in r?s=vn(r.from||n,r.default,!0):s=vn(r.from||n):s=vn(r),_t(s)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[n]=s}}function Lf(i,e,t){Un(Te(i)?i.map(n=>n.bind(e.proxy)):i.bind(e.proxy),e,t)}function ym(i,e,t,n){let r=n.includes(".")?Lm(t,n):()=>t[n];if(xt(i)){const s=e[i];Ce(s)&&js(r,s)}else if(Ce(i))js(r,i.bind(t));else if(ct(i))if(Te(i))i.forEach(s=>ym(s,e,t,n));else{const s=Ce(i.handler)?i.handler.bind(t):e[i.handler];Ce(s)&&js(r,s,i)}}function vm(i){const e=i.type,{mixins:t,extends:n}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=i.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!t&&!n?l=e:(l={},r.length&&r.forEach(c=>Pa(l,c,o,!0)),Pa(l,e,o)),ct(e)&&s.set(e,l),l}function Pa(i,e,t,n=!1){const{mixins:r,extends:s}=e;s&&Pa(i,s,t,!0),r&&r.forEach(o=>Pa(i,o,t,!0));for(const o in e)if(!(n&&o==="expose")){const a=r3[o]||t&&t[o];i[o]=a?a(i[o],e[o]):e[o]}return i}const r3={data:Mf,props:Of,emits:Of,methods:Ps,computed:Ps,beforeCreate:zt,created:zt,beforeMount:zt,mounted:zt,beforeUpdate:zt,updated:zt,beforeDestroy:zt,beforeUnmount:zt,destroyed:zt,unmounted:zt,activated:zt,deactivated:zt,errorCaptured:zt,serverPrefetch:zt,components:Ps,directives:Ps,watch:o3,provide:Mf,inject:s3};function Mf(i,e){return e?i?function(){return Bt(Ce(i)?i.call(this,this):i,Ce(e)?e.call(this,this):e)}:e:i}function s3(i,e){return Ps(eu(i),eu(e))}function eu(i){if(Te(i)){const e={};for(let t=0;t<i.length;t++)e[i[t]]=i[t];return e}return i}function zt(i,e){return i?[...new Set([].concat(i,e))]:e}function Ps(i,e){return i?Bt(Object.create(null),i,e):e}function Of(i,e){return i?Te(i)&&Te(e)?[...new Set([...i,...e])]:Bt(Object.create(null),Pf(i),Pf(e??{})):e}function o3(i,e){if(!i)return e;if(!e)return i;const t=Bt(Object.create(null),i);for(const n in e)t[n]=zt(i[n],e[n]);return t}function bm(){return{app:null,config:{isNativeTag:Wy,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let a3=0;function l3(i,e){return function(n,r=null){Ce(n)||(n=Bt({},n)),r!=null&&!ct(r)&&(r=null);const s=bm(),o=new WeakSet,a=[];let l=!1;const c=s.app={_uid:a3++,_component:n,_props:r,_container:null,_context:s,_instance:null,version:$3,get config(){return s.config},set config(u){},use(u,...h){return o.has(u)||(u&&Ce(u.install)?(o.add(u),u.install(c,...h)):Ce(u)&&(o.add(u),u(c,...h))),c},mixin(u){return s.mixins.includes(u)||s.mixins.push(u),c},component(u,h){return h?(s.components[u]=h,c):s.components[u]},directive(u,h){return h?(s.directives[u]=h,c):s.directives[u]},mount(u,h,d){if(!l){const p=c._ceVNode||at(n,r);return p.appContext=s,d===!0?d="svg":d===!1&&(d=void 0),i(p,u,d),l=!0,c._container=u,u.__vue_app__=c,bh(p.component)}},onUnmount(u){a.push(u)},unmount(){l&&(Un(a,c._instance,16),i(null,c._container),delete c._container.__vue_app__)},provide(u,h){return s.provides[u]=h,c},runWithContext(u){const h=Or;Or=c;try{return u()}finally{Or=h}}};return c}}let Or=null;function ma(i,e){if(Ut){let t=Ut.provides;const n=Ut.parent&&Ut.parent.provides;n===t&&(t=Ut.provides=Object.create(n)),t[i]=e}}function vn(i,e,t=!1){const n=Ut||Wt;if(n||Or){const r=Or?Or._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(r&&i in r)return r[i];if(arguments.length>1)return t&&Ce(e)?e.call(n&&n.proxy):e}}const wm={},Em=()=>Object.create(wm),xm=i=>Object.getPrototypeOf(i)===wm;function c3(i,e,t,n=!1){const r={},s=Em();i.propsDefaults=Object.create(null),Im(i,e,r,s);for(const o in i.propsOptions[0])o in r||(r[o]=void 0);t?i.props=n?r:tm(r):i.type.props?i.props=r:i.props=s,i.attrs=s}function u3(i,e,t,n){const{props:r,attrs:s,vnode:{patchFlag:o}}=i,a=$e(r),[l]=i.propsOptions;let c=!1;if((n||o>0)&&!(o&16)){if(o&8){const u=i.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(wl(i.emitsOptions,d))continue;const p=e[d];if(l)if(We(s,d))p!==s[d]&&(s[d]=p,c=!0);else{const g=Ai(d);r[g]=tu(l,a,g,p,i,!1)}else p!==s[d]&&(s[d]=p,c=!0)}}}else{Im(i,e,r,s)&&(c=!0);let u;for(const h in a)(!e||!We(e,h)&&((u=lr(h))===h||!We(e,u)))&&(l?t&&(t[h]!==void 0||t[u]!==void 0)&&(r[h]=tu(l,a,h,void 0,i,!0)):delete r[h]);if(s!==a)for(const h in s)(!e||!We(e,h))&&(delete s[h],c=!0)}c&&Xn(i.attrs,"set","")}function Im(i,e,t,n){const[r,s]=i.propsOptions;let o=!1,a;if(e)for(let l in e){if(Fs(l))continue;const c=e[l];let u;r&&We(r,u=Ai(l))?!s||!s.includes(u)?t[u]=c:(a||(a={}))[u]=c:wl(i.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,o=!0)}if(s){const l=$e(t),c=a||Je;for(let u=0;u<s.length;u++){const h=s[u];t[h]=tu(r,l,h,c[h],i,!We(c,h))}}return o}function tu(i,e,t,n,r,s){const o=i[t];if(o!=null){const a=We(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Ce(l)){const{propsDefaults:c}=r;if(t in c)n=c[t];else{const u=So(r);n=c[t]=l.call(null,e),u()}}else n=l;r.ce&&r.ce._setProp(t,n)}o[0]&&(s&&!a?n=!1:o[1]&&(n===""||n===lr(t))&&(n=!0))}return n}const h3=new WeakMap;function Sm(i,e,t=!1){const n=t?h3:e.propsCache,r=n.get(i);if(r)return r;const s=i.props,o={},a=[];let l=!1;if(!Ce(i)){const u=h=>{l=!0;const[d,p]=Sm(h,e,!0);Bt(o,d),p&&a.push(...p)};!t&&e.mixins.length&&e.mixins.forEach(u),i.extends&&u(i.extends),i.mixins&&i.mixins.forEach(u)}if(!s&&!l)return ct(i)&&n.set(i,Pr),Pr;if(Te(s))for(let u=0;u<s.length;u++){const h=Ai(s[u]);Df(h)&&(o[h]=Je)}else if(s)for(const u in s){const h=Ai(u);if(Df(h)){const d=s[u],p=o[h]=Te(d)||Ce(d)?{type:d}:Bt({},d),g=p.type;let _=!1,v=!0;if(Te(g))for(let C=0;C<g.length;++C){const T=g[C],y=Ce(T)&&T.name;if(y==="Boolean"){_=!0;break}else y==="String"&&(v=!1)}else _=Ce(g)&&g.name==="Boolean";p[0]=_,p[1]=v,(_||We(p,"default"))&&a.push(h)}}const c=[o,a];return ct(i)&&n.set(i,c),c}function Df(i){return i[0]!=="$"&&!Fs(i)}const Am=i=>i[0]==="_"||i==="$stable",_h=i=>Te(i)?i.map(Rn):[Rn(i)],d3=(i,e,t)=>{if(e._n)return e;const n=Nt((...r)=>_h(e(...r)),t);return n._c=!1,n},Cm=(i,e,t)=>{const n=i._ctx;for(const r in i){if(Am(r))continue;const s=i[r];if(Ce(s))e[r]=d3(r,s,n);else if(s!=null){const o=_h(s);e[r]=()=>o}}},Tm=(i,e)=>{const t=_h(e);i.slots.default=()=>t},km=(i,e,t)=>{for(const n in e)(t||n!=="_")&&(i[n]=e[n])},f3=(i,e,t)=>{const n=i.slots=Em();if(i.vnode.shapeFlag&32){const r=e._;r?(km(n,e,t),t&&D1(n,"_",r,!0)):Cm(e,n)}else e&&Tm(i,e)},p3=(i,e,t)=>{const{vnode:n,slots:r}=i;let s=!0,o=Je;if(n.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:km(r,e,t):(s=!e.$stable,Cm(e,r)),o=e}else e&&(Tm(i,e),o={default:1});if(s)for(const a in r)!Am(a)&&o[a]==null&&delete r[a]},en=T3;function g3(i){return m3(i)}function m3(i,e){const t=_l();t.__VUE__=!0;const{insert:n,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:p=Mn,insertStaticContent:g}=i,_=(L,M,D,B=null,H=null,z=null,te=void 0,ee=null,X=!!M.dynamicChildren)=>{if(L===M)return;L&&!Is(L,M)&&(B=U(L),ae(L,H,z,!0),L=null),M.patchFlag===-2&&(X=!1,M.dynamicChildren=null);const{type:$,ref:ce,shapeFlag:G}=M;switch($){case El:v(L,M,D,B);break;case $r:C(L,M,D,B);break;case vc:L==null&&T(M,D,B,te);break;case tn:O(L,M,D,B,H,z,te,ee,X);break;default:G&1?E(L,M,D,B,H,z,te,ee,X):G&6?R(L,M,D,B,H,z,te,ee,X):(G&64||G&128)&&$.process(L,M,D,B,H,z,te,ee,X,le)}ce!=null&&H&&Na(ce,L&&L.ref,z,M||L,!M)},v=(L,M,D,B)=>{if(L==null)n(M.el=a(M.children),D,B);else{const H=M.el=L.el;M.children!==L.children&&c(H,M.children)}},C=(L,M,D,B)=>{L==null?n(M.el=l(M.children||""),D,B):M.el=L.el},T=(L,M,D,B)=>{[L.el,L.anchor]=g(L.children,M,D,B,L.el,L.anchor)},y=({el:L,anchor:M},D,B)=>{let H;for(;L&&L!==M;)H=d(L),n(L,D,B),L=H;n(M,D,B)},A=({el:L,anchor:M})=>{let D;for(;L&&L!==M;)D=d(L),r(L),L=D;r(M)},E=(L,M,D,B,H,z,te,ee,X)=>{M.type==="svg"?te="svg":M.type==="math"&&(te="mathml"),L==null?x(M,D,B,H,z,te,ee,X):I(L,M,H,z,te,ee,X)},x=(L,M,D,B,H,z,te,ee)=>{let X,$;const{props:ce,shapeFlag:G,transition:he,dirs:ge}=L;if(X=L.el=o(L.type,z,ce&&ce.is,ce),G&8?u(X,L.children):G&16&&S(L.children,X,null,B,H,yc(L,z),te,ee),ge&&Hi(L,null,B,"created"),w(X,L,L.scopeId,te,B),ce){for(const we in ce)we!=="value"&&!Fs(we)&&s(X,we,null,ce[we],z,B);"value"in ce&&s(X,"value",null,ce.value,z),($=ce.onVnodeBeforeMount)&&Cn($,B,L)}ge&&Hi(L,null,B,"beforeMount");const me=_3(H,he);me&&he.beforeEnter(X),n(X,M,D),(($=ce&&ce.onVnodeMounted)||me||ge)&&en(()=>{$&&Cn($,B,L),me&&he.enter(X),ge&&Hi(L,null,B,"mounted")},H)},w=(L,M,D,B,H)=>{if(D&&p(L,D),B)for(let z=0;z<B.length;z++)p(L,B[z]);if(H){let z=H.subTree;if(M===z||Om(z.type)&&(z.ssContent===M||z.ssFallback===M)){const te=H.vnode;w(L,te,te.scopeId,te.slotScopeIds,H.parent)}}},S=(L,M,D,B,H,z,te,ee,X=0)=>{for(let $=X;$<L.length;$++){const ce=L[$]=ee?gi(L[$]):Rn(L[$]);_(null,ce,M,D,B,H,z,te,ee)}},I=(L,M,D,B,H,z,te)=>{const ee=M.el=L.el;let{patchFlag:X,dynamicChildren:$,dirs:ce}=M;X|=L.patchFlag&16;const G=L.props||Je,he=M.props||Je;let ge;if(D&&ji(D,!1),(ge=he.onVnodeBeforeUpdate)&&Cn(ge,D,M,L),ce&&Hi(M,L,D,"beforeUpdate"),D&&ji(D,!0),(G.innerHTML&&he.innerHTML==null||G.textContent&&he.textContent==null)&&u(ee,""),$?k(L.dynamicChildren,$,ee,D,B,yc(M,H),z):te||Y(L,M,ee,null,D,B,yc(M,H),z,!1),X>0){if(X&16)P(ee,G,he,D,H);else if(X&2&&G.class!==he.class&&s(ee,"class",null,he.class,H),X&4&&s(ee,"style",G.style,he.style,H),X&8){const me=M.dynamicProps;for(let we=0;we<me.length;we++){const ye=me[we],Oe=G[ye],Ye=he[ye];(Ye!==Oe||ye==="value")&&s(ee,ye,Oe,Ye,H,D)}}X&1&&L.children!==M.children&&u(ee,M.children)}else!te&&$==null&&P(ee,G,he,D,H);((ge=he.onVnodeUpdated)||ce)&&en(()=>{ge&&Cn(ge,D,M,L),ce&&Hi(M,L,D,"updated")},B)},k=(L,M,D,B,H,z,te)=>{for(let ee=0;ee<M.length;ee++){const X=L[ee],$=M[ee],ce=X.el&&(X.type===tn||!Is(X,$)||X.shapeFlag&70)?h(X.el):D;_(X,$,ce,null,B,H,z,te,!0)}},P=(L,M,D,B,H)=>{if(M!==D){if(M!==Je)for(const z in M)!Fs(z)&&!(z in D)&&s(L,z,M[z],null,H,B);for(const z in D){if(Fs(z))continue;const te=D[z],ee=M[z];te!==ee&&z!=="value"&&s(L,z,ee,te,H,B)}"value"in D&&s(L,"value",M.value,D.value,H)}},O=(L,M,D,B,H,z,te,ee,X)=>{const $=M.el=L?L.el:a(""),ce=M.anchor=L?L.anchor:a("");let{patchFlag:G,dynamicChildren:he,slotScopeIds:ge}=M;ge&&(ee=ee?ee.concat(ge):ge),L==null?(n($,D,B),n(ce,D,B),S(M.children||[],D,ce,H,z,te,ee,X)):G>0&&G&64&&he&&L.dynamicChildren?(k(L.dynamicChildren,he,D,H,z,te,ee),(M.key!=null||H&&M===H.subTree)&&Rm(L,M,!0)):Y(L,M,D,ce,H,z,te,ee,X)},R=(L,M,D,B,H,z,te,ee,X)=>{M.slotScopeIds=ee,L==null?M.shapeFlag&512?H.ctx.activate(M,D,B,te,X):K(M,D,B,H,z,te,X):ie(L,M,X)},K=(L,M,D,B,H,z,te)=>{const ee=L.component=O3(L,B,H);if(fm(L)&&(ee.ctx.renderer=le),D3(ee,!1,te),ee.asyncDep){if(H&&H.registerDep(ee,pe,te),!L.el){const X=ee.subTree=at($r);C(null,X,M,D)}}else pe(ee,L,M,D,H,z,te)},ie=(L,M,D)=>{const B=M.component=L.component;if(A3(L,M,D))if(B.asyncDep&&!B.asyncResolved){se(B,M,D);return}else B.next=M,B.update();else M.el=L.el,B.vnode=M},pe=(L,M,D,B,H,z,te)=>{const ee=()=>{if(L.isMounted){let{next:G,bu:he,u:ge,parent:me,vnode:we}=L;{const ot=Nm(L);if(ot){G&&(G.el=we.el,se(L,G,te)),ot.asyncDep.then(()=>{L.isUnmounted||ee()});return}}let ye=G,Oe;ji(L,!1),G?(G.el=we.el,se(L,G,te)):G=we,he&&dc(he),(Oe=G.props&&G.props.onVnodeBeforeUpdate)&&Cn(Oe,me,G,we),ji(L,!0);const Ye=Vf(L),De=L.subTree;L.subTree=Ye,_(De,Ye,h(De.el),U(De),L,H,z),G.el=Ye.el,ye===null&&C3(L,Ye.el),ge&&en(ge,H),(Oe=G.props&&G.props.onVnodeUpdated)&&en(()=>Cn(Oe,me,G,we),H)}else{let G;const{el:he,props:ge}=M,{bm:me,m:we,parent:ye,root:Oe,type:Ye}=L,De=Mr(M);ji(L,!1),me&&dc(me),!De&&(G=ge&&ge.onVnodeBeforeMount)&&Cn(G,ye,M),ji(L,!0);{Oe.ce&&Oe.ce._injectChildStyle(Ye);const ot=L.subTree=Vf(L);_(null,ot,D,B,L,H,z),M.el=ot.el}if(we&&en(we,H),!De&&(G=ge&&ge.onVnodeMounted)){const ot=M;en(()=>Cn(G,ye,ot),H)}(M.shapeFlag&256||ye&&Mr(ye.vnode)&&ye.vnode.shapeFlag&256)&&L.a&&en(L.a,H),L.isMounted=!0,M=D=B=null}};L.scope.on();const X=L.effect=new $1(ee);L.scope.off();const $=L.update=X.run.bind(X),ce=L.job=X.runIfDirty.bind(X);ce.i=L,ce.id=L.uid,X.scheduler=()=>ph(ce),ji(L,!0),$()},se=(L,M,D)=>{M.component=L;const B=L.vnode.props;L.vnode=M,L.next=null,u3(L,M.props,B,D),p3(L,M.children,D),Oi(),Nf(L),Di()},Y=(L,M,D,B,H,z,te,ee,X=!1)=>{const $=L&&L.children,ce=L?L.shapeFlag:0,G=M.children,{patchFlag:he,shapeFlag:ge}=M;if(he>0){if(he&128){re($,G,D,B,H,z,te,ee,X);return}else if(he&256){Q($,G,D,B,H,z,te,ee,X);return}}ge&8?(ce&16&&be($,H,z),G!==$&&u(D,G)):ce&16?ge&16?re($,G,D,B,H,z,te,ee,X):be($,H,z,!0):(ce&8&&u(D,""),ge&16&&S(G,D,B,H,z,te,ee,X))},Q=(L,M,D,B,H,z,te,ee,X)=>{L=L||Pr,M=M||Pr;const $=L.length,ce=M.length,G=Math.min($,ce);let he;for(he=0;he<G;he++){const ge=M[he]=X?gi(M[he]):Rn(M[he]);_(L[he],ge,D,null,H,z,te,ee,X)}$>ce?be(L,H,z,!0,!1,G):S(M,D,B,H,z,te,ee,X,G)},re=(L,M,D,B,H,z,te,ee,X)=>{let $=0;const ce=M.length;let G=L.length-1,he=ce-1;for(;$<=G&&$<=he;){const ge=L[$],me=M[$]=X?gi(M[$]):Rn(M[$]);if(Is(ge,me))_(ge,me,D,null,H,z,te,ee,X);else break;$++}for(;$<=G&&$<=he;){const ge=L[G],me=M[he]=X?gi(M[he]):Rn(M[he]);if(Is(ge,me))_(ge,me,D,null,H,z,te,ee,X);else break;G--,he--}if($>G){if($<=he){const ge=he+1,me=ge<ce?M[ge].el:B;for(;$<=he;)_(null,M[$]=X?gi(M[$]):Rn(M[$]),D,me,H,z,te,ee,X),$++}}else if($>he)for(;$<=G;)ae(L[$],H,z,!0),$++;else{const ge=$,me=$,we=new Map;for($=me;$<=he;$++){const et=M[$]=X?gi(M[$]):Rn(M[$]);et.key!=null&&we.set(et.key,$)}let ye,Oe=0;const Ye=he-me+1;let De=!1,ot=0;const xe=new Array(Ye);for($=0;$<Ye;$++)xe[$]=0;for($=ge;$<=G;$++){const et=L[$];if(Oe>=Ye){ae(et,H,z,!0);continue}let gt;if(et.key!=null)gt=we.get(et.key);else for(ye=me;ye<=he;ye++)if(xe[ye-me]===0&&Is(et,M[ye])){gt=ye;break}gt===void 0?ae(et,H,z,!0):(xe[gt-me]=$+1,gt>=ot?ot=gt:De=!0,_(et,M[gt],D,null,H,z,te,ee,X),Oe++)}const Kt=De?y3(xe):Pr;for(ye=Kt.length-1,$=Ye-1;$>=0;$--){const et=me+$,gt=M[et],Jt=et+1<ce?M[et+1].el:B;xe[$]===0?_(null,gt,D,Jt,H,z,te,ee,X):De&&(ye<0||$!==Kt[ye]?ve(gt,D,Jt,2):ye--)}}},ve=(L,M,D,B,H=null)=>{const{el:z,type:te,transition:ee,children:X,shapeFlag:$}=L;if($&6){ve(L.component.subTree,M,D,B);return}if($&128){L.suspense.move(M,D,B);return}if($&64){te.move(L,M,D,le);return}if(te===tn){n(z,M,D);for(let G=0;G<X.length;G++)ve(X[G],M,D,B);n(L.anchor,M,D);return}if(te===vc){y(L,M,D);return}if(B!==2&&$&1&&ee)if(B===0)ee.beforeEnter(z),n(z,M,D),en(()=>ee.enter(z),H);else{const{leave:G,delayLeave:he,afterLeave:ge}=ee,me=()=>n(z,M,D),we=()=>{G(z,()=>{me(),ge&&ge()})};he?he(z,me,we):we()}else n(z,M,D)},ae=(L,M,D,B=!1,H=!1)=>{const{type:z,props:te,ref:ee,children:X,dynamicChildren:$,shapeFlag:ce,patchFlag:G,dirs:he,cacheIndex:ge}=L;if(G===-2&&(H=!1),ee!=null&&Na(ee,null,D,L,!0),ge!=null&&(M.renderCache[ge]=void 0),ce&256){M.ctx.deactivate(L);return}const me=ce&1&&he,we=!Mr(L);let ye;if(we&&(ye=te&&te.onVnodeBeforeUnmount)&&Cn(ye,M,L),ce&6)W(L.component,D,B);else{if(ce&128){L.suspense.unmount(D,B);return}me&&Hi(L,null,M,"beforeUnmount"),ce&64?L.type.remove(L,M,D,le,B):$&&!$.hasOnce&&(z!==tn||G>0&&G&64)?be($,M,D,!1,!0):(z===tn&&G&384||!H&&ce&16)&&be(X,M,D),B&&fe(L)}(we&&(ye=te&&te.onVnodeUnmounted)||me)&&en(()=>{ye&&Cn(ye,M,L),me&&Hi(L,null,M,"unmounted")},D)},fe=L=>{const{type:M,el:D,anchor:B,transition:H}=L;if(M===tn){Me(D,B);return}if(M===vc){A(L);return}const z=()=>{r(D),H&&!H.persisted&&H.afterLeave&&H.afterLeave()};if(L.shapeFlag&1&&H&&!H.persisted){const{leave:te,delayLeave:ee}=H,X=()=>te(D,z);ee?ee(L.el,z,X):X()}else z()},Me=(L,M)=>{let D;for(;L!==M;)D=d(L),r(L),L=D;r(M)},W=(L,M,D)=>{const{bum:B,scope:H,job:z,subTree:te,um:ee,m:X,a:$}=L;Uf(X),Uf($),B&&dc(B),H.stop(),z&&(z.flags|=8,ae(te,L,M,D)),ee&&en(ee,M),en(()=>{L.isUnmounted=!0},M),M&&M.pendingBranch&&!M.isUnmounted&&L.asyncDep&&!L.asyncResolved&&L.suspenseId===M.pendingId&&(M.deps--,M.deps===0&&M.resolve())},be=(L,M,D,B=!1,H=!1,z=0)=>{for(let te=z;te<L.length;te++)ae(L[te],M,D,B,H)},U=L=>{if(L.shapeFlag&6)return U(L.component.subTree);if(L.shapeFlag&128)return L.suspense.next();const M=d(L.anchor||L.el),D=M&&M[$v];return D?d(D):M};let Z=!1;const J=(L,M,D)=>{L==null?M._vnode&&ae(M._vnode,null,null,!0):_(M._vnode||null,L,M,null,null,null,D),M._vnode=L,Z||(Z=!0,Nf(),lm(),Z=!1)},le={p:_,um:ae,m:ve,r:fe,mt:K,mc:S,pc:Y,pbc:k,n:U,o:i};return{render:J,hydrate:void 0,createApp:l3(J)}}function yc({type:i,props:e},t){return t==="svg"&&i==="foreignObject"||t==="mathml"&&i==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function ji({effect:i,job:e},t){t?(i.flags|=32,e.flags|=4):(i.flags&=-33,e.flags&=-5)}function _3(i,e){return(!i||i&&!i.pendingBranch)&&e&&!e.persisted}function Rm(i,e,t=!1){const n=i.children,r=e.children;if(Te(n)&&Te(r))for(let s=0;s<n.length;s++){const o=n[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=gi(r[s]),a.el=o.el),!t&&a.patchFlag!==-2&&Rm(o,a)),a.type===El&&(a.el=o.el)}}function y3(i){const e=i.slice(),t=[0];let n,r,s,o,a;const l=i.length;for(n=0;n<l;n++){const c=i[n];if(c!==0){if(r=t[t.length-1],i[r]<c){e[n]=r,t.push(n);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,i[t[a]]<c?s=a+1:o=a;c<i[t[s]]&&(s>0&&(e[n]=t[s-1]),t[s]=n)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function Nm(i){const e=i.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Nm(e)}function Uf(i){if(i)for(let e=0;e<i.length;e++)i[e].flags|=8}const v3=Symbol.for("v-scx"),b3=()=>vn(v3);function js(i,e,t){return Pm(i,e,t)}function Pm(i,e,t=Je){const{immediate:n,deep:r,flush:s,once:o}=t,a=Bt({},t),l=e&&n||!e&&s!=="post";let c;if(co){if(s==="sync"){const p=b3();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=Mn,p.resume=Mn,p.pause=Mn,p}}const u=Ut;a.call=(p,g,_)=>Un(p,u,g,_);let h=!1;s==="post"?a.scheduler=p=>{en(p,u&&u.suspense)}:s!=="sync"&&(h=!0,a.scheduler=(p,g)=>{g?p():ph(p)}),a.augmentJob=p=>{e&&(p.flags|=4),h&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const d=Uv(i,e,a);return co&&(c?c.push(d):l&&d()),d}function w3(i,e,t){const n=this.proxy,r=xt(i)?i.includes(".")?Lm(n,i):()=>n[i]:i.bind(n,n);let s;Ce(e)?s=e:(s=e.handler,t=e);const o=So(this),a=Pm(r,s.bind(n),t);return o(),a}function Lm(i,e){const t=e.split(".");return()=>{let n=i;for(let r=0;r<t.length&&n;r++)n=n[t[r]];return n}}const E3=(i,e)=>e==="modelValue"||e==="model-value"?i.modelModifiers:i[`${e}Modifiers`]||i[`${Ai(e)}Modifiers`]||i[`${lr(e)}Modifiers`];function x3(i,e,...t){if(i.isUnmounted)return;const n=i.vnode.props||Je;let r=t;const s=e.startsWith("update:"),o=s&&E3(n,e.slice(7));o&&(o.trim&&(r=t.map(u=>xt(u)?u.trim():u)),o.number&&(r=t.map(ev)));let a,l=n[a=hc(e)]||n[a=hc(Ai(e))];!l&&s&&(l=n[a=hc(lr(e))]),l&&Un(l,i,6,r);const c=n[a+"Once"];if(c){if(!i.emitted)i.emitted={};else if(i.emitted[a])return;i.emitted[a]=!0,Un(c,i,6,r)}}function Mm(i,e,t=!1){const n=e.emitsCache,r=n.get(i);if(r!==void 0)return r;const s=i.emits;let o={},a=!1;if(!Ce(i)){const l=c=>{const u=Mm(c,e,!0);u&&(a=!0,Bt(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),i.extends&&l(i.extends),i.mixins&&i.mixins.forEach(l)}return!s&&!a?(ct(i)&&n.set(i,null),null):(Te(s)?s.forEach(l=>o[l]=null):Bt(o,s),ct(i)&&n.set(i,o),o)}function wl(i,e){return!i||!pl(e)?!1:(e=e.slice(2).replace(/Once$/,""),We(i,e[0].toLowerCase()+e.slice(1))||We(i,lr(e))||We(i,e))}function Vf(i){const{type:e,vnode:t,proxy:n,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:h,data:d,setupState:p,ctx:g,inheritAttrs:_}=i,v=Ra(i);let C,T;try{if(t.shapeFlag&4){const A=r||n,E=A;C=Rn(c.call(E,A,u,h,p,d,g)),T=a}else{const A=e;C=Rn(A.length>1?A(h,{attrs:a,slots:o,emit:l}):A(h,null)),T=e.props?a:I3(a)}}catch(A){qs.length=0,vl(A,i,1),C=at($r)}let y=C;if(T&&_!==!1){const A=Object.keys(T),{shapeFlag:E}=y;A.length&&E&7&&(s&&A.some(eh)&&(T=S3(T,s)),y=zr(y,T,!1,!0))}return t.dirs&&(y=zr(y,null,!1,!0),y.dirs=y.dirs?y.dirs.concat(t.dirs):t.dirs),t.transition&&gh(y,t.transition),C=y,Ra(v),C}const I3=i=>{let e;for(const t in i)(t==="class"||t==="style"||pl(t))&&((e||(e={}))[t]=i[t]);return e},S3=(i,e)=>{const t={};for(const n in i)(!eh(n)||!(n.slice(9)in e))&&(t[n]=i[n]);return t};function A3(i,e,t){const{props:n,children:r,component:s}=i,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?Ff(n,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==n[d]&&!wl(c,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?Ff(n,o,c):!0:!!o;return!1}function Ff(i,e,t){const n=Object.keys(e);if(n.length!==Object.keys(i).length)return!0;for(let r=0;r<n.length;r++){const s=n[r];if(e[s]!==i[s]&&!wl(t,s))return!0}return!1}function C3({vnode:i,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===i&&(n.el=i.el),n===i)(i=e.vnode).el=t,e=e.parent;else break}}const Om=i=>i.__isSuspense;function T3(i,e){e&&e.pendingBranch?Te(i)?e.effects.push(...i):e.effects.push(i):Bv(i)}const tn=Symbol.for("v-fgt"),El=Symbol.for("v-txt"),$r=Symbol.for("v-cmt"),vc=Symbol.for("v-stc"),qs=[];let nn=null;function cn(i=!1){qs.push(nn=i?null:[])}function k3(){qs.pop(),nn=qs[qs.length-1]||null}let ao=1;function Bf(i,e=!1){ao+=i,i<0&&nn&&e&&(nn.hasOnce=!0)}function Dm(i){return i.dynamicChildren=ao>0?nn||Pr:null,k3(),ao>0&&nn&&nn.push(i),i}function si(i,e,t,n,r,s){return Dm(je(i,e,t,n,r,s,!0))}function nu(i,e,t,n,r){return Dm(at(i,e,t,n,r,!0))}function lo(i){return i?i.__v_isVNode===!0:!1}function Is(i,e){return i.type===e.type&&i.key===e.key}const Um=({key:i})=>i??null,_a=({ref:i,ref_key:e,ref_for:t})=>(typeof i=="number"&&(i=""+i),i!=null?xt(i)||_t(i)||Ce(i)?{i:Wt,r:i,k:e,f:!!t}:i:null);function je(i,e=null,t=null,n=0,r=null,s=i===tn?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:i,props:e,key:e&&Um(e),ref:e&&_a(e),scopeId:um,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Wt};return a?(yh(l,t),s&128&&i.normalize(l)):t&&(l.shapeFlag|=xt(t)?8:16),ao>0&&!o&&nn&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&nn.push(l),l}const at=R3;function R3(i,e=null,t=null,n=0,r=null,s=!1){if((!i||i===e3)&&(i=$r),lo(i)){const a=zr(i,e,!0);return t&&yh(a,t),ao>0&&!s&&nn&&(a.shapeFlag&6?nn[nn.indexOf(i)]=a:nn.push(a)),a.patchFlag=-2,a}if(B3(i)&&(i=i.__vccOpts),e){e=N3(e);let{class:a,style:l}=e;a&&!xt(a)&&(e.class=rh(a)),ct(l)&&(dh(l)&&!Te(l)&&(l=Bt({},l)),e.style=ih(l))}const o=xt(i)?1:Om(i)?128:zv(i)?64:ct(i)?4:Ce(i)?2:0;return je(i,e,t,n,r,o,s,!0)}function N3(i){return i?dh(i)||xm(i)?Bt({},i):i:null}function zr(i,e,t=!1,n=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:l}=i,c=e?P3(r||{},e):r,u={__v_isVNode:!0,__v_skip:!0,type:i.type,props:c,key:c&&Um(c),ref:e&&e.ref?t&&s?Te(s)?s.concat(_a(e)):[s,_a(e)]:_a(e):s,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:a,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:e&&i.type!==tn?o===-1?16:o|16:o,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:l,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&zr(i.ssContent),ssFallback:i.ssFallback&&zr(i.ssFallback),el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return l&&n&&gh(u,l.clone(u)),u}function He(i=" ",e=0){return at(El,null,i,e)}function Rn(i){return i==null||typeof i=="boolean"?at($r):Te(i)?at(tn,null,i.slice()):lo(i)?gi(i):at(El,null,String(i))}function gi(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:zr(i)}function yh(i,e){let t=0;const{shapeFlag:n}=i;if(e==null)e=null;else if(Te(e))t=16;else if(typeof e=="object")if(n&65){const r=e.default;r&&(r._c&&(r._d=!1),yh(i,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!xm(e)?e._ctx=Wt:r===3&&Wt&&(Wt.slots._===1?e._=1:(e._=2,i.patchFlag|=1024))}else Ce(e)?(e={default:e,_ctx:Wt},t=32):(e=String(e),n&64?(t=16,e=[He(e)]):t=8);i.children=e,i.shapeFlag|=t}function P3(...i){const e={};for(let t=0;t<i.length;t++){const n=i[t];for(const r in n)if(r==="class")e.class!==n.class&&(e.class=rh([e.class,n.class]));else if(r==="style")e.style=ih([e.style,n.style]);else if(pl(r)){const s=e[r],o=n[r];o&&s!==o&&!(Te(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=n[r])}return e}function Cn(i,e,t,n=null){Un(i,e,7,[t,n])}const L3=bm();let M3=0;function O3(i,e,t){const n=i.type,r=(e?e.appContext:i.appContext)||L3,s={uid:M3++,vnode:i,type:n,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new V1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Sm(n,r),emitsOptions:Mm(n,r),emit:null,emitted:null,propsDefaults:Je,inheritAttrs:n.inheritAttrs,ctx:Je,data:Je,props:Je,attrs:Je,slots:Je,refs:Je,setupState:Je,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=x3.bind(null,s),i.ce&&i.ce(s),s}let Ut=null;const vh=()=>Ut||Wt;let La,iu;{const i=_l(),e=(t,n)=>{let r;return(r=i[t])||(r=i[t]=[]),r.push(n),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};La=e("__VUE_INSTANCE_SETTERS__",t=>Ut=t),iu=e("__VUE_SSR_SETTERS__",t=>co=t)}const So=i=>{const e=Ut;return La(i),i.scope.on(),()=>{i.scope.off(),La(e)}},$f=()=>{Ut&&Ut.scope.off(),La(null)};function Vm(i){return i.vnode.shapeFlag&4}let co=!1;function D3(i,e=!1,t=!1){e&&iu(e);const{props:n,children:r}=i.vnode,s=Vm(i);c3(i,n,s,e),f3(i,r,t);const o=s?U3(i,e):void 0;return e&&iu(!1),o}function U3(i,e){const t=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,t3);const{setup:n}=t;if(n){Oi();const r=i.setupContext=n.length>1?F3(i):null,s=So(i),o=Io(n,i,0,[i.props,r]),a=M1(o);if(Di(),s(),(a||i.sp)&&!Mr(i)&&dm(i),a){if(o.then($f,$f),e)return o.then(l=>{zf(i,l)}).catch(l=>{vl(l,i,0)});i.asyncDep=o}else zf(i,o)}else Fm(i)}function zf(i,e,t){Ce(e)?i.type.__ssrInlineRender?i.ssrRender=e:i.render=e:ct(e)&&(i.setupState=rm(e)),Fm(i)}function Fm(i,e,t){const n=i.type;i.render||(i.render=n.render||Mn);{const r=So(i);Oi();try{n3(i)}finally{Di(),r()}}}const V3={get(i,e){return Lt(i,"get",""),i[e]}};function F3(i){const e=t=>{i.exposed=t||{}};return{attrs:new Proxy(i.attrs,V3),slots:i.slots,emit:i.emit,expose:e}}function bh(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(rm(Cv(i.exposed)),{get(e,t){if(t in e)return e[t];if(t in Hs)return Hs[t](i)},has(e,t){return t in e||t in Hs}})):i.proxy}function B3(i){return Ce(i)&&"__vccOpts"in i}const fn=(i,e)=>Ov(i,e,co);function Bm(i,e,t){const n=arguments.length;return n===2?ct(e)&&!Te(e)?lo(e)?at(i,null,[e]):at(i,e):at(i,null,e):(n>3?t=Array.prototype.slice.call(arguments,2):n===3&&lo(t)&&(t=[t]),at(i,e,t))}const $3="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ru;const Hf=typeof window<"u"&&window.trustedTypes;if(Hf)try{ru=Hf.createPolicy("vue",{createHTML:i=>i})}catch{}const $m=ru?i=>ru.createHTML(i):i=>i,z3="http://www.w3.org/2000/svg",H3="http://www.w3.org/1998/Math/MathML",Yn=typeof document<"u"?document:null,jf=Yn&&Yn.createElement("template"),j3={insert:(i,e,t)=>{e.insertBefore(i,t||null)},remove:i=>{const e=i.parentNode;e&&e.removeChild(i)},createElement:(i,e,t,n)=>{const r=e==="svg"?Yn.createElementNS(z3,i):e==="mathml"?Yn.createElementNS(H3,i):t?Yn.createElement(i,{is:t}):Yn.createElement(i);return i==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:i=>Yn.createTextNode(i),createComment:i=>Yn.createComment(i),setText:(i,e)=>{i.nodeValue=e},setElementText:(i,e)=>{i.textContent=e},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Yn.querySelector(i),setScopeId(i,e){i.setAttribute(e,"")},insertStaticContent(i,e,t,n,r,s){const o=t?t.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===s||!(r=r.nextSibling)););else{jf.innerHTML=$m(n==="svg"?`<svg>${i}</svg>`:n==="mathml"?`<math>${i}</math>`:i);const a=jf.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},q3=Symbol("_vtc");function W3(i,e,t){const n=i[q3];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?i.removeAttribute("class"):t?i.setAttribute("class",e):i.className=e}const qf=Symbol("_vod"),G3=Symbol("_vsh"),K3=Symbol(""),Y3=/(^|;)\s*display\s*:/;function X3(i,e,t){const n=i.style,r=xt(t);let s=!1;if(t&&!r){if(e)if(xt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&ya(n,a,"")}else for(const o in e)t[o]==null&&ya(n,o,"");for(const o in t)o==="display"&&(s=!0),ya(n,o,t[o])}else if(r){if(e!==t){const o=n[K3];o&&(t+=";"+o),n.cssText=t,s=Y3.test(t)}}else e&&i.removeAttribute("style");qf in i&&(i[qf]=s?n.display:"",i[G3]&&(n.display="none"))}const Wf=/\s*!important$/;function ya(i,e,t){if(Te(t))t.forEach(n=>ya(i,e,n));else if(t==null&&(t=""),e.startsWith("--"))i.setProperty(e,t);else{const n=Q3(i,e);Wf.test(t)?i.setProperty(lr(n),t.replace(Wf,""),"important"):i[n]=t}}const Gf=["Webkit","Moz","ms"],bc={};function Q3(i,e){const t=bc[e];if(t)return t;let n=Ai(e);if(n!=="filter"&&n in i)return bc[e]=n;n=O1(n);for(let r=0;r<Gf.length;r++){const s=Gf[r]+n;if(s in i)return bc[e]=s}return e}const Kf="http://www.w3.org/1999/xlink";function Yf(i,e,t,n,r,s=ov(e)){n&&e.startsWith("xlink:")?t==null?i.removeAttributeNS(Kf,e.slice(6,e.length)):i.setAttributeNS(Kf,e,t):t==null||s&&!U1(t)?i.removeAttribute(e):i.setAttribute(e,s?"":ar(t)?String(t):t)}function Xf(i,e,t,n,r){if(e==="innerHTML"||e==="textContent"){t!=null&&(i[e]=e==="innerHTML"?$m(t):t);return}const s=i.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?i.getAttribute("value")||"":i.value,l=t==null?i.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in i))&&(i.value=l),t==null&&i.removeAttribute(e),i._value=t;return}let o=!1;if(t===""||t==null){const a=typeof i[e];a==="boolean"?t=U1(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{i[e]=t}catch{}o&&i.removeAttribute(r||e)}function J3(i,e,t,n){i.addEventListener(e,t,n)}function Z3(i,e,t,n){i.removeEventListener(e,t,n)}const Qf=Symbol("_vei");function e5(i,e,t,n,r=null){const s=i[Qf]||(i[Qf]={}),o=s[e];if(n&&o)o.value=n;else{const[a,l]=t5(e);if(n){const c=s[e]=r5(n,r);J3(i,a,c,l)}else o&&(Z3(i,a,o,l),s[e]=void 0)}}const Jf=/(?:Once|Passive|Capture)$/;function t5(i){let e;if(Jf.test(i)){e={};let n;for(;n=i.match(Jf);)i=i.slice(0,i.length-n[0].length),e[n[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):lr(i.slice(2)),e]}let wc=0;const n5=Promise.resolve(),i5=()=>wc||(n5.then(()=>wc=0),wc=Date.now());function r5(i,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;Un(s5(n,t.value),e,5,[n])};return t.value=i,t.attached=i5(),t}function s5(i,e){if(Te(e)){const t=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{t.call(i),i._stopped=!0},e.map(n=>r=>!r._stopped&&n&&n(r))}else return e}const Zf=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,o5=(i,e,t,n,r,s)=>{const o=r==="svg";e==="class"?W3(i,n,o):e==="style"?X3(i,t,n):pl(e)?eh(e)||e5(i,e,t,n,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):a5(i,e,n,o))?(Xf(i,e,n),!i.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Yf(i,e,n,o,s,e!=="value")):i._isVueCE&&(/[A-Z]/.test(e)||!xt(n))?Xf(i,Ai(e),n,s,e):(e==="true-value"?i._trueValue=n:e==="false-value"&&(i._falseValue=n),Yf(i,e,n,o))};function a5(i,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in i&&Zf(e)&&Ce(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&i.tagName==="INPUT"||e==="type"&&i.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=i.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Zf(e)&&xt(t)?!1:e in i}const l5=Bt({patchProp:o5},j3);let ep;function c5(){return ep||(ep=g3(l5))}const u5=(...i)=>{const e=c5().createApp(...i),{mount:t}=e;return e.mount=n=>{const r=d5(n);if(!r)return;const s=e._component;!Ce(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=t(r,!1,h5(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function h5(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function d5(i){return xt(i)?document.querySelector(i):i}function f5(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Ec={exports:{}},tp;function p5(){return tp||(tp=1,function(i){var e=function(t,n){var r=this;if((typeof t=="string"||t instanceof String)&&(t=document.querySelector(t)),this.element=t,this.config=e.mergeDeep(e._defaultConfig(n),n),this._layoutConfigs={base:{orientation:this.config.orientation,levelSeparation:this.config.levelSeparation,mixedHierarchyNodesSeparation:this.config.mixedHierarchyNodesSeparation,assistantSeparation:this.config.assistantSeparation,subtreeSeparation:this.config.subtreeSeparation,siblingSeparation:this.config.siblingSeparation,layout:this.config.layout,columns:this.config.columns,collapse:this.config.collapse,partnerNodeSeparation:this.config.partnerNodeSeparation}},this.config.tags)for(var s in this.config.tags){var o=this.config.tags[s];o.subTreeConfig!=null&&(this._layoutConfigs[s]={orientation:o.subTreeConfig.orientation!=null?o.subTreeConfig.orientation:this.config.orientation,levelSeparation:o.subTreeConfig.levelSeparation!=null?o.subTreeConfig.levelSeparation:this.config.levelSeparation,mixedHierarchyNodesSeparation:o.subTreeConfig.mixedHierarchyNodesSeparation!=null?o.subTreeConfig.mixedHierarchyNodesSeparation:this.config.mixedHierarchyNodesSeparation,assistantSeparation:o.subTreeConfig.assistantSeparation!=null?o.subTreeConfig.assistantSeparation:this.config.assistantSeparation,subtreeSeparation:o.subTreeConfig.subtreeSeparation!=null?o.subTreeConfig.subtreeSeparation:this.config.subtreeSeparation,siblingSeparation:o.subTreeConfig.siblingSeparation!=null?o.subTreeConfig.siblingSeparation:this.config.siblingSeparation,layout:o.subTreeConfig.layout!=null?o.subTreeConfig.layout:this.config.layout,columns:o.subTreeConfig.columns!=null?o.subTreeConfig.columns:this.config.columns,collapse:o.subTreeConfig.collapse!=null?o.subTreeConfig.collapse:this.config.collapse,partnerNodeSeparation:o.subTreeConfig.partnerNodeSeparation!=null?o.subTreeConfig.partnerNodeSeparation:this.config.partnerNodeSeparation})}this._event_id=e._guid(),e._validateConfig(this.config)&&(this._vScroll={},this.config.ui||(this.ui=e.ui),this.config.editUI?this.editUI=this.config.editUI:this.editUI=new e.editUI,this.editUI.init(this),this.config.filterUI?this.filterUI=this.config.filterUI:this.filterUI=new e.filterUI,this.filterUI.init(this),this.manager=new e.manager(this),this.config.searchUI?this.searchUI=this.config.searchUI:this.searchUI=new e.searchUI,this.config.nodeMenuUI?this.nodeMenuUI=this.config.nodeMenuUI:this.nodeMenuUI=new e.menuUI,this.nodeMenuUI.init(this,this.config.nodeMenu),this.config.nodeCircleMenuUI?this.nodeCircleMenuUI=this.config.nodeCircleMenuUI:this.nodeCircleMenuUI=new e.circleMenuUI,this.nodeCircleMenuUI.init(this,this.config.nodeCircleMenu),this.config.nodeContextMenuUI?this.nodeContextMenuUI=this.config.nodeContextMenuUI:this.nodeContextMenuUI=new e.menuUI,this.nodeContextMenuUI.init(this,this.config.nodeContextMenu),this.config.toolbarUI?this.toolbarUI=this.config.toolbarUI:this.toolbarUI=new e.toolbarUI,this.config.notifierUI?this.notifierUI=this.config.notifierUI:this.notifierUI=new e.notifierUI,this.notifierUI.init(this),this.config.menuUI?this.menuUI=this.config.menuUI:this.menuUI=new e.menuUI,this.menuUI.init(this,this.config.menu),this.config.xScrollUI||(this.xScrollUI=new e.xScrollUI(this.element,this.config,function(){return{boundary:r.response.boundary,scale:r.getScale(),viewBox:r.getViewBox(),padding:r.config.padding}},function(a){r.setViewBox(a)},function(){r._draw(!0,e.action.xScroll)})),this.config.yScrollUI||(this.yScrollUI=new e.yScrollUI(this.element,this.config,function(){return{boundary:r.response.boundary,scale:r.getScale(),viewBox:r.getViewBox(),padding:r.config.padding}},function(a){r.setViewBox(a)},function(){r._draw(!0,e.action.xScroll)})),this.config.undoRedoUI?this.undoRedoUI=this.config.undoRedoUI:this.undoRedoUI=new e.undoRedoUI,this.element.classList.add("bft-"+this.config.mode),this._gragStartedId=null,this._timeout=null,this._touch=null,this._initialized=!1,this._loaded=!1,this._moveInterval=null,this._movePosition=null,this.response=null,this.nodes=null,this.isVisible=null,e._intersectionObserver(this.element,function(a){r.isVisible=a,e.events.publish("visibility-change",[r])!==!1&&e.LAZY_LOADING&&r.isVisible&&(r._loaded?r._draw(!1,e.action.update):(r._setInitialSizeIfNotSet(),r._draw(!1,e.action.init)))}))};e._defaultConfig=function(t){return{interactive:!0,mode:"light",lazyLoading:!0,enableDragDrop:!1,enableSearch:!0,enableTouch:!1,enablePan:!0,keyNavigation:!1,miniMap:!1,nodeMenu:null,nodeCircleMenu:null,nodeContextMenu:null,menu:null,toolbar:!1,sticky:!0,nodeMouseClick:e.action.details,nodeMouseDbClick:e.none,mouseScrool:e.action.zoom,showXScroll:e.none,showYScroll:e.none,template:"ana",tags:{},min:!1,nodeBinding:{},linkBinding:{},searchFields:null,searchDisplayField:null,searchFieldsWeight:null,searchFieldsAbbreviation:null,nodes:[],clinks:[],slinks:[],backdrops:[],groupDottedLines:[],dottedLines:[],undoRedoStorageName:null,levelSeparation:60,siblingSeparation:20,subtreeSeparation:40,backdropSeparation:15,mixedHierarchyNodesSeparation:15,assistantSeparation:100,minPartnerSeparation:50,partnerChildrenSplitSeparation:20,partnerNodeSeparation:15,columns:10,padding:30,orientation:e.orientation.top,layout:e.layout.normal,layoutGridColumns:"dynamic",scaleInitial:1,movable:null,scaleMin:.1,scaleMax:5,orderBy:null,editUI:null,filterUI:null,searchUI:null,xScrollUI:null,yScrollUI:null,nodeMenuUI:null,nodeCircleMenuUI:null,nodeContextMenuUI:null,toolbarUI:null,notifierUI:null,menuUI:null,undoRedoUI:null,exportUrl:"https://balkan.app/export",collapse:{},expand:{},align:e.CENTER,UI:null,anim:{func:e.anim.outPow,duration:200},zoom:{speed:120,smooth:12},roots:null,state:null,editForm:{readOnly:!1,titleBinding:"name",photoBinding:"img",addMore:"Add more fields",addMoreBtn:"Add",addMoreFieldName:"Field name",saveAndCloseBtn:"Save and close",cancelBtn:"Cancel",generateElementsFromFields:!0,focusBinding:null,buttons:{edit:{icon:e.icon.edit(24,24,"#fff"),text:"Edit",hideIfEditMode:!0,hideIfDetailsMode:!1},share:{icon:e.icon.share(24,24,"#fff"),text:"Share"},pdf:{icon:e.icon.pdf(24,24,"#fff"),text:"Save as PDF"},remove:{icon:e.icon.remove(24,24,"#fff"),text:"Remove",hideIfDetailsMode:!0}},elements:[]}}},e.prototype.load=function(t,n){var r=this;return this.config.nodes=t,this._draw(!1,e.action.init,void 0,function(){r.filterUI.update(),n&&n()}),this},e.prototype.loadXML=function(t,n){var r=e._xml2json(t);return this.load(r,n)},e.prototype.getXML=function(){return e._json2xml(this.config.nodes)},e.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e.prototype.removeListener=function(t,n){return e.events.remove(t,n,this._event_id)},e.prototype.draw=function(t,n,r){t==null&&(t=e.action.update),this._draw(!1,t,n,r)},e.prototype._draw=function(t,n,r,s){var o=this;if(!e.LAZY_LOADING||this.isVisible)if(e.LAZY_LOADING||this._initialized||(this._setInitialSizeIfNotSet(),this.width()!=0&&this.height()!=0)){this._hideBeforeAnimationCompleted=!1;var a=n==e.action.init?null:this.getViewBox();this.manager.read(t,this.width(),this.height(),a,n,r,function(l){if(!o.notifierUI.show(l.notif)){n!=e.action.exporting&&(o.nodes=l.nodes,o.visibleNodeIds=l.visibleNodeIds,o.roots=l.roots),o.editUI.fields=l.allFields;var c={defs:""};e.events.publish("renderdefs",[o,c]);var u=o.ui.defs(c.defs),h=o.getScale(l.viewBox);u+=o.ui.pointer(o.config,n,h);var d=o.getViewBox(),p=l.viewBox;c={content:u,res:l},e.events.publish("prerender",[o,c]),u=c.content;var g=[];if(e.RENDER_LINKS_BEFORE_NODES)for(var _=0;_<l.visibleNodeIds.length;_++){var v=l.nodes[l.visibleNodeIds[_]];e.getRootOf(v).stParent?g.push(v.id):u+=o.ui.link(v,o,h,l.bordersByRootIdAndLevel,l.nodes,n)}for(_=0;_<l.visibleNodeIds.length;_++){v=l.nodes[l.visibleNodeIds[_]];var C=o._get(v.id);e.RENDER_LINKS_BEFORE_NODES&&g.includes(v.id)&&(u+=o.ui.link(v,o,h,l.bordersByRootIdAndLevel,l.nodes,n)),u+=o.ui.node(v,C,l.animations,o.config,void 0,void 0,void 0,n,h,o)}for(_=0;_<l.visibleNodeIds.length;_++)v=l.nodes[l.visibleNodeIds[_]],e.RENDER_LINKS_BEFORE_NODES||(u+=o.ui.link(v,o,h,l.bordersByRootIdAndLevel,l.nodes,n)),u+=o.ui.expandCollapseBtn(o,v,o._layoutConfigs,n,h);if(c={content:u,res:l},e.events.publish("render",[o,c]),u=c.content,l=c.res,u+=o.ui.lonely(o.config),n!==e.action.exporting){if(n!==e.action.centernode&&n!==e.action.insert&&n!==e.action.expand&&n!==e.action.collapse&&n!==e.action.update||(p=d),n===e.action.init&&d!=null&&(p=d),o.response=l,I=o.ui.svg(o.width(),o.height(),p,o.config,u),o._initialized){var T=o.getSvg(),y=T.parentNode;y.removeChild(T),y.insertAdjacentHTML("afterbegin",I),o._attachEventHandlers(),o.xScrollUI.addListener(o.getSvg()),o.yScrollUI.addListener(o.getSvg()),o.xScrollUI.setPosition(),o.yScrollUI.setPosition()}else o.element.innerHTML=o.ui.css()+I+o.ui.menuButton(o.config),o._attachInitEventHandlers(),o._attachEventHandlers(),o.xScrollUI.create(o.width(),o.config.padding),o.xScrollUI.setPosition(),o.xScrollUI.addListener(o.getSvg()),o.yScrollUI.create(o.height(),o.config.padding),o.yScrollUI.setPosition(),o.yScrollUI.addListener(o.getSvg()),o.config.enableSearch&&o.searchUI.init(o),o.toolbarUI.init(o,o.config.toolbar),o.undoRedoUI.init(o);var A=!1,E=o.response.animations;if(E[0].length>0){for(o._hideBeforeAnimation(E[0].length),_=0;_<E[0].length;_++)E[0][_]=o.getNodeElement(E[0][_]);e.animate(E[0],E[1],E[2],o.config.anim.duration,o.config.anim.func,function(){A||(s&&s(),e.events.publish("redraw",[o]),o._showAfterAnimation(),A=!0)})}n===e.action.centerNode?e.animate(o.getSvg(),{viewbox:d},{viewbox:o.response.viewBox},o.config.anim.duration,o.config.anim.func,function(){o.ripple(r.options.rippleId),A||(s&&s(),e.events.publish("redraw",[o]),o._showAfterAnimation(),A=!0)},function(){o.xScrollUI.setPosition(),o.yScrollUI.setPosition()}):!d||!o.response||d[0]==o.response.viewBox[0]&&d[1]==o.response.viewBox[1]&&d[2]==o.response.viewBox[2]&&d[3]==o.response.viewBox[3]||n!==e.action.insert&&n!==e.action.expand&&n!==e.action.collapse&&n!==e.action.update&&n!==e.action.init?E[0].length==0&&(A||(s&&s(),e.events.publish("redraw",[o]),A=!0)):e.animate(o.getSvg(),{viewbox:d},{viewbox:o.response.viewBox},2*o.config.anim.duration,o.config.anim.func,function(){o.xScrollUI.setPosition(),o.yScrollUI.setPosition(),A||(s&&s(),e.events.publish("redraw",[o]),A=!0)}),o._initialized||(o._initialized=!0,o.filterUI.update(),e.events.publish("init",[o])),!o._loaded&&l&&l.nodes&&Object.keys(l.nodes).length&&(o._loaded=!0)}else{var x=l.boundary,w=x.maxX-x.minX,S=x.maxY-x.minY,I=o.ui.svg(w,S,[x.minX,x.minY,w,S],o.config,u,h);s(I,l)}}},function(l){e.events.publish("ready",[o,l])})}else console.error("Cannot load the family with size 0! If you are using the FamilyTree within tabs set FamilyTree.LAZY_LOADING to true! ")},e.prototype._setInitialSizeIfNotSet=function(){this.element.style.overflow="hidden",this.element.style.position="relative",this.element.offsetHeight==0&&(this.element.style.height="100%",this.element.offsetHeight==0&&(this.element.style.height="700px")),this.element.offsetWidth==0&&(this.element.style.width="100%",this.element.offsetWidth==0&&(this.element.style.width="700px"))},e.prototype.width=function(){return this.element.offsetWidth},e.prototype.height=function(){return this.element.offsetHeight},e.prototype.getViewBox=function(){var t=this.getSvg();return e._getViewBox(t)},e.prototype.setViewBox=function(t){this.getSvg().setAttribute("viewBox",t.toString())},e.prototype.getScale=function(t){return t||(t=this.getViewBox()),e.getScale(t,this.width(),this.height(),this.config.scaleInitial,this.config.scaleMax,this.config.scaleMin)},e.prototype.setScale=function(t){t>this.config.scaleMax&&(t=this.config.scaleMax),t<this.config.scaleMin&&(t=this.config.scaleMin);var n=this.getViewBox().slice(0),r=this.width(),s=this.height(),o=r/n[2],a=s/n[3],l=o>a?a:o,c=n,u=n[2],h=n[3];return n[2]=n[2]/(t/l),n[3]=n[3]/(t/l),n[0]=c[0]-(n[2]-u)/2,n[1]=c[1]-(n[3]-h)/2,this.setViewBox(n),e.events.publish("redraw",[this]),t},e.prototype.ripple=function(t,n,r){var s=this.getNode(t);if(s!=null){var o=this.getNodeElement(t);if(o!=null){var a=this.getScale(),l=s.w/2,c=s.h/2;if(n!==void 0&&r!==void 0){var u=o.getBoundingClientRect();l=n/a-u.left/a,c=r/a-u.top/a}var h=s.w,d=s.h,p=h-l>l?h-l:l,g=d-c>c?d-c:c,_=p>g?p:g,v=document.createElementNS("http://www.w3.org/2000/svg","g"),C=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),T=document.createElementNS("http://www.w3.org/2000/svg","rect"),y=document.createElementNS("http://www.w3.org/2000/svg","circle"),A=e.randomId();C.setAttribute("id",A);var E={ripple:e.t(s.templateName,s.min,this.getScale()).ripple,node:s};e.events.publish("ripple",[this,E]),T.setAttribute("x",E.ripple.rect?E.ripple.rect.x:0),T.setAttribute("y",E.ripple.rect?E.ripple.rect.y:0),T.setAttribute("width",E.ripple.rect?E.ripple.rect.width:s.w),T.setAttribute("height",E.ripple.rect?E.ripple.rect.height:s.h),T.setAttribute("rx",E.ripple.radius),T.setAttribute("ry",E.ripple.radius),y.setAttribute("clip-path","url(#"+A+")"),y.setAttribute("cx",l),y.setAttribute("cy",c),y.setAttribute("r",0),y.setAttribute("fill",E.ripple.color),y.setAttribute("class","bft-ripple"),C.appendChild(T),v.appendChild(C),v.appendChild(y),o.appendChild(v),e.animate(y,{r:0,opacity:1},{r:_,opacity:0},500,e.anim.outPow,function(){o.removeChild(v)})}}},e.prototype.center=function(t,n,r){var s,o,a=t,l=!0,c=!0;n&&n.parentState!=null&&(s=n.parentState),n&&n.childrenState!=null&&(o=n.childrenState),n&&n.rippleId!=null&&(a=n.rippleId),n&&n.vertical!=null&&(l=n.vertical),n&&n.horizontal!=null&&(c=n.horizontal);var u={parentState:s,childrenState:o,rippleId:a,vertical:l,horizontal:c};this._draw(!1,e.action.centerNode,{id:t,options:u},r)},e.prototype.fit=function(t){this.config.scaleInitial=e.match.boundary,this._draw(!0,e.action.init,{method:"fit"},t)},e.prototype.toggleFullScreen=function(){var t=document.querySelector("["+e.attr.tlbr+"r='fullScreen']");document.fullscreenElement==this.element||document.webkitFullscreenElement==this.element||document.mozFullScreenElement==this.element||document.msFullscreenElement==this.element?(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),t&&(t.innerHTML=e.toolbarUI.openFullScreenIcon)):(this.element.requestFullscreen?this.element.requestFullscreen():this.element.mozRequestFullScreen?this.element.mozRequestFullScreen():this.element.webkitRequestFullscreen?this.element.webkitRequestFullscreen():this.element.msRequestFullscreen&&this.element.msRequestFullscreen(),t&&(t.innerHTML=e.toolbarUI.closeFullScreenIcon))},e.prototype.getNode=function(t){return this.nodes[t]},e.prototype.setLayout=function(t,n){n||(n="base"),this._layoutConfigs[n].layout=t,n=="base"&&(this.config.layout=t),this._draw(!1,e.action.update)},e.prototype.setOrientation=function(t,n,r){var s=this;n||(n="base"),this._layoutConfigs[n].orientation=t,n=="base"&&(this.config.orientation=t),this._draw(!1,e.action.update,void 0,function(){e._moveToBoundaryArea(s.getSvg(),s.getViewBox(),s.response.boundary,function(){s._draw(!0,e.action.pan),r&&r()})})},e.prototype.search=function(t,n,r){return e.isNEU(n)&&(n=this.searchUI._searchFields),e.isNEU(r)&&(r=n),e._search.search(this.config.nodes,t,n,r,this.config.searchDisplayField,this.config.searchFieldsWeight,this.searchUI._searchFieldsAbbreviation)},e.prototype._hideBeforeAnimation=function(t){if(this._hideBeforeAnimationCompleted!=1&&!(t&&t<e.ANIM_THRESHOLD)){var n=this.element.getElementsByTagName("text");if(n.length>e.TEXT_THRESHOLD)for(var r=0;r<n.length;r++)n[r].style.display="none";var s=this.element.getElementsByTagName("image");if(s.length>e.IMAGES_THRESHOLD)for(r=0;r<s.length;r++)s[r].style.display="none";var o=this.element.querySelectorAll("["+e.attr.link_id+"]");if(o.length>e.LINKS_THRESHOLD)for(r=0;r<o.length;r++)o[r].style.display="none";var a=this.element.querySelectorAll("["+e.attr.control_expcoll_id+"]");if(a.length>e.BUTTONS_THRESHOLD)for(r=0;r<a.length;r++)a[r].style.display="none";var l=this.element.querySelectorAll("["+e.attr.control_up_id+"]");if(l.length>e.BUTTONS_THRESHOLD)for(r=0;r<l.length;r++)l[r].style.display="none";this._hideBeforeAnimationCompleted=!0}},e.prototype._showAfterAnimation=function(){for(var t=this.element.getElementsByTagName("text"),n=0;n<t.length;n++)t[n].style.display="";var r=this.element.getElementsByTagName("image");for(n=0;n<r.length;n++)r[n].style.display="";var s=this.element.querySelectorAll("["+e.attr.link_id+"]");for(n=0;n<s.length;n++)s[n].style.display="";var o=this.element.querySelectorAll("["+e.attr.control_expcoll_id+"]");for(n=0;n<o.length;n++)o[n].style.display="";var a=this.element.querySelectorAll("["+e.attr.control_up_id+"]");for(n=0;n<a.length;n++)a[n].style.display="";this._hideBeforeAnimationCompleted=!1},e.prototype.isChild=function(t,n){for(var r=this.getNode(n);r;){if(r.id==t)return!0;r=r.parent?r.parent:r.stParent}return!1},e.prototype.getCollapsedIds=function(t){for(var n=[],r=0;r<t.childrenIds.length;r++){var s=this.getNode(t.childrenIds[r]);s.collapsed==1&&n.push(s.id)}return n},e.prototype.stateToUrl=function(){if(this.manager.state){var t={};return t.exp=this.manager.state.exp.join("*"),t.min=this.manager.state.min.join("*"),t.adjustify=this.manager.state.adjustify.x+"*"+this.manager.state.adjustify.y,t.scale=this.manager.state.scale,t.y=this.manager.state.x,t.x=this.manager.state.y,new URLSearchParams(t).toString()}return""},e.prototype.generateId=function(){for(;;){var t="_"+("0000"+(Math.random()*Math.pow(36,4)|0).toString(36)).slice(-4);if(this.nodes==null||!this.nodes.hasOwnProperty(t))return t}},e.prototype.moveNodesToVisibleArea=function(t,n){for(var r=this,s=this.getSvg(),o=this.getViewBox(),a=null,l=null,c=null,u=null,h=0;h<t.length;h++){var d=this.nodes[t[h]];(a===null||a<d.x+d.w)&&(a=d.x+d.w),(l===null||l<d.y+d.h)&&(l=d.y+d.h),(c===null||c>d.x)&&(c=d.x),(u===null||u>d.y)&&(u=d.y)}var p=this.width(),g=this.height(),_=p/(A=a-c+2*this.config.padding),v=g/(E=l-u+2*this.config.padding),C=_>v?v:_,T=Math.ceil(p/C),y=Math.ceil(g/C),A=0,E=0;if(T-2*this.config.padding>=a-c)A=(a+c)/2-T/2;else switch(A=firstRoot.x-T/2+e.manager._getNodeWidth(firstRoot,this.config)/2,this.config.orientation){case e.orientation.right:case e.orientation.right_top:(A=-(T/2-(c-a)/2))<this.config.padding-T&&(A=this.config.padding-T);break;case e.orientation.left:case e.orientation.bottom_left:case e.orientation.top_left:case e.orientation.left_top:(A=-(T/2-(a-c)/2))>-this.config.padding&&(A=-this.config.padding)}if(y-2*this.config.padding>=l-u)E=(l+u)/2-y/2;else switch((E=-(y/2-(l-u)/2))>-this.config.padding&&(E=-this.config.padding),this.config.orientation){case e.orientation.bottom:case e.orientation.bottom_left:(E=-(y/2-(u-l)/2))<this.config.padding-y&&(E=this.config.padding-y);break;case e.orientation.left:case e.orientation.right:E=firstRoot.y-y/2+e.manager._getNodeWidth(firstRoot,this.config)/2}var x=[A,E,T,y];o[0]!==x[0]||o[1]!==x[1]?e.animate(s,{viewBox:o},{viewBox:x},this.config.anim.duration,this.config.anim.func,function(){r.draw(e.action.update,void 0,n)}):n&&n()},e.prototype._nodeHasHiddenParent=function(t){return!t.parent&&!e.isNEU(t.pid)&&this.getNode(t.pid)},e.prototype.destroy=function(){this._removeEvent(window,"resize"),e.events.removeForEventId(this._event_id),this.element.innerHTML=null},e.__defaultConfig=e._defaultConfig,e._defaultConfig=function(t){var n=e.__defaultConfig();return n.nodeTreeMenu=null,n.template="tommy",n.mode="light",n.minPartnerSeparation=30,n.partnerChildrenSplitSeparation=10,n.siblingSeparation=35,n.tags["children-group"]={template:"cgroup",subTreeConfig:{siblingSeparation:7,columns:1}},t&&t.template?(n.tags.male={template:t.template+"_male"},n.tags.female={template:t.template+"_female"}):(n.tags.male={template:n.template+"_male"},n.tags.female={template:n.template+"_female"}),n},e.prototype.load=function(t,n){var r=this;return this.config.nodes=t,this.config.roots=null,this._draw(!1,e.action.init,void 0,function(){r.filterUI.update(),n&&n()}),this},e.prototype.getRecentRootsByNodeId=function(t){this.recentRoots||(this.recentRoots=[]);var n=this.recentRoots,r=this.getNode(t);return r?(r.rids.sort(function(s,o){var a=n.indexOf(s),l=n.indexOf(o);return a==-1?1e3:l==-1?-1e3:a-l}),r.rids):[]},e.prototype._nodeHasHiddenParent=function(t){return!(t.parent||e.isNEU(t.pid)||!this.getNode(t.pid))||!(!t.isPartner||e.isNEU(t.mid)||!this.getNode(t.mid))||!(!t.isPartner||e.isNEU(t.fid)||!this.getNode(t.fid))||!!(t.isPartner&&t.pids.length>1)},e.prototype._center=e.prototype.center,e.prototype.center=function(t,n,r){var s=this.getRecentRootsByNodeId(t);Array.isArray(this.config.roots)||(roots=[]),e._changeRootOption(this.config.roots,s,this.manager.rootList),this._center(t,n,r)},e.localStorage={},e.localStorage.getItem=function(t){var n=localStorage.getItem("to_date");if(n){if((n=new Date(n))<new Date){for(var r=0,s=localStorage.length;r<s;++r){var o=localStorage.key(r);o&&o.startsWith&&o.startsWith('{"n"')&&localStorage.removeItem(o)}localStorage.removeItem("to_date")}}else(n=new Date).setDate(n.getDate()+5),n=n.toISOString(),localStorage.setItem("to_date",n);return localStorage.getItem(t)},e.localStorage.setItem=function(t,n){try{localStorage.setItem(t,n)}catch(r){r.code==r.QUOTA_EXCEEDED_ERR?(console.warn("Local storage quota exceeded"),localStorage.clear()):(console.error("Local storage error code:"+r.code),console.error(r))}},e.prototype.canUpdateLink=function(t,n){if(n==null||n==null||t==null||t==null||t==n)return!1;var r=this.getNode(n),s=this.getNode(t);return!(r&&s&&(r.isPartner||r.hasPartners&&s.isAssistant||r.hasAssistants&&s.isPartner))&&!this.isChild(t,n)},e.prototype._canUpdateLink=e.prototype.canUpdateLink,e.prototype.updateNode=function(t,n,r){var s=this,o=this.get(t.id);if(r===!0&&e.events.publish("update",[this,o,t])===!1)return!1;this.update(t),e.events.publish("updated",[this]),this.filterUI.update();var a=this.getNode(t.id),l=a.pid;l==null&&(l=a.stpid),this._draw(!1,e.action.update,{id:l},function(){s.ripple(t.id),n&&n()})},e.prototype.update=function(t){for(var n=0;n<this.config.nodes.length;n++)if(this.config.nodes[n].id==t.id){this._putInUndoStack(),this.clearRedo(),this.config.nodes[n]=t;break}return this},e.prototype.removeNode=function(t,n,r){var s=this;if(!this.canRemove(t))return!1;var o=this._getNewPidsAndStpidsForIds(t);return r===!0&&e.events.publish("remove",[this,t,o])===!1?!1:(this.remove(t),e.events.publish("updated",[this]),this.filterUI.update(),this._draw(!1,e.action.update,null,function(){s.config.sticky&&e._moveToBoundaryArea(s.getSvg(),s.getViewBox(),s.response.boundary),n&&n()}),!0)},e.prototype.remove=function(t){var n=this.get(t);if(n){this._putInUndoStack(),this.clearRedo();for(var r=this.config.nodes.length-1;r>=0;r--)this.config.nodes[r].pid!=t&&this.config.nodes[r].stpid!=t||(this.config.nodes[r].pid=n.pid,this.config.nodes[r].stpid=n.stpid),this.config.nodes[r].id==t&&this.config.nodes.splice(r,1)}return this},e.prototype._getNewPidsAndStpidsForIds=function(t){var n=this.get(t),r={},s={};if(n)for(var o=this.config.nodes.length-1;o>=0;o--)this.config.nodes[o].pid==t?r[this.config.nodes[o].id]=n.pid:this.config.nodes[o].stpid==t&&(s[this.config.nodes[o].id]=n.stpid);return{newPidsForIds:r,newStpidsForIds:s}},e.prototype.addNode=function(t,n,r){var s=this;if(r===!0&&e.events.publish("add",[this,t])===!1)return!1;this.add(t),e.events.publish("updated",[this]),this.filterUI.update(),s._draw(!1,e.action.insert,{id:t.pid,insertedNodeId:t.id},function(){s.ripple(t.id),n&&n()})},e.prototype.add=function(t){if(t.id==null&&console.error("Call addNode without id"),this._putInUndoStack(),this.clearRedo(),this.config.movable&&!e.isNEU(t.pid)){var n=this._get(t.pid);n&&(n.movex!=null&&(t.movex=n.movex),n.movey!=null&&(t.movey=n.movey))}return this.config.nodes.push(t),this},e.prototype.replaceIds=function(t,n){this._replaceIds(t),this._draw(!1,e.action.update,void 0,n)},e.prototype._replaceIds=function(t){for(var n=function(u){for(var h=0;h<u.length;h++){var d=u[h];for(var p in t){var g=t[p];d.from==p&&(d.from=g),d.to==p&&(d.to=g)}}},r=0;r<this.config.nodes.length;r++){var s=this.config.nodes[r];for(var o in t){var a=t[o];s.id==o&&(s.id=a),s.pid==o&&(s.pid=a),s.stpid==o&&(s.stpid=a),s.ppid==o&&(s.ppid=a)}}if(Array.isArray(this.config.roots))for(r=0;r<this.config.roots.length;r++)e.isNEU(t[this.config.roots[r]])||(this.config.roots[r]=t[this.config.roots[r]]);if(this.nodes)for(var l in this.nodes)e.isNEU(t[l])||(a=t[l],(c=this.nodes[l]).id=a,this.nodes[a]=c);if(this.manager.oldNodes)for(var l in this.manager.oldNodes)e.isNEU(t[l])||(a=t[l],(c=this.manager.oldNodes[l]).id=a,this.manager.oldNodes[a]=c);if(this.roots){for(var l in this.roots)if(!e.isNEU(t[l])){var c;a=t[l],(c=this.roots[l]).id=a,this.roots[a]=c}}n(this.config.clinks),n(this.config.slinks),n(this.config.groupDottedLines),n(this.config.dottedLines)},e.prototype._get=function(t){var n=this.__get(t);if(n)return n;if((this.config.groupDottedLines.length||this.config.dottedLines.length)&&!e.isNEU(t)&&typeof t=="string"&&(t.indexOf("balkan_group_dotted_")!=-1||t.indexOf("balkan_dotted_")!=-1)){var r=(t=(t=t.replace("balkan_group_dotted_","")).replace("balkan_dotted_","")).indexOf("_balkan_id_");if(t=t.substring(r+11),n=this.__get(t))return n}return null},e.prototype.__get=function(t){for(var n=0;n<this.config.nodes.length;n++)if(this.config.nodes[n].id==t)return this.config.nodes[n];return null},e.prototype.get=function(t){var n=this._get(t);return n==null?null:JSON.parse(JSON.stringify(n))},e.prototype.canRemove=function(t){var n=this.getNode(t);return!!n&&!n.hasPartners&&!n.hasAssistants},e.prototype.addChildNode=function(t,n,r){this.hideTreeMenu(!1);var s=this;if(!t||e.isNEU(t.mid)&&e.isNEU(t.fid))console.error("addSonNode invalid data");else{e.isNEU(t.id)&&(t.id=this.generateId());var o={addNodesData:[t],updateNodesData:[],removeNodeId:null};if(r===!0&&e.events.publish("update",[this,o])===!1)return!1;s._fireUpdate_addUpdateRemove(o,r);var a="";e.isNEU(o.addNodesData[0].pid)?e.isNEU(o.addNodesData[0].mid)?e.isNEU(o.addNodesData[0].fid)||(a=o.addNodesData[0].fid):a=o.addNodesData[0].mid:a=o.addNodesData[0].pid,s._draw(!1,e.action.insert,{id:a,insertedNodeId:o.addNodesData[0].id},function(){s.ripple(o.addNodesData[0].id),n&&n(),r===!0&&e.events.publish("updated",[s,o]),s.filterUI.update()})}},e.prototype.addChildAndPartnerNodes=function(t,n,r,s,o){this.hideTreeMenu(!1);var a=this;if(!n||e.isNEU(n.mid)&&e.isNEU(n.fid))console.error("addChildAndPartnerNodes invalid childData");else if(r){e.isNEU(n.id)&&(n.id=this.generateId()),e.isNEU(r.id)&&(r.id=this.generateId()),n.mid=="_ft_partner"?n.mid=r.id:n.fid=="_ft_partner"&&(n.fid=r.id);var l=[],c=null;Array.isArray(r.pids)&&(r.pids.length!=1&&console.error("addChildAndPartnerNodes partnerData.pids has to have one partner"),c=this.get(r.pids[0]),Array.isArray(c.pids)||(c.pids=[]),c.pids.push(r.id),l.push(c));var u={addNodesData:[n,r],updateNodesData:l,removeNodeId:null};if(o===!0&&e.events.publish("update",[this,u])===!1)return!1;a._fireUpdate_addUpdateRemove(u,o);var h=a.getRecentRootsByNodeId(t);e._changeRootOption(a.config.roots,h,a.manager.rootList);var d="";c?d=c.id:e.isNEU(n.pid)?e.isNEU(n.mid)?e.isNEU(n.fid)||(d=n.fid):d=n.mid:d=n.pid,a._draw(!1,e.action.update,{id:d},function(){a.ripple(n.id),a.ripple(r.id),s&&s(),o===!0&&e.events.publish("updated",[a,u]),a.filterUI.update()}),o===!0&&e.events.publish("updating",[a,u])}else console.error("addChildAndPartnerNodes invalid data")},e.prototype.addPartnerAndParentNodes=function(t,n,r,s,o){this.hideTreeMenu(!1);var a=this;if(!e.isNEU(n)&&n.length)if(r){e.isNEU(r.id)&&(r.id=this.generateId());for(var l=[],c=0;c<n.length;c++){var u=this.get(n[c]);if(!e.isNEU(u.mid)&&!e.isNEU(u.fid))return void console.error("father id (fid) or mather id (mid) has to be null or undefined");e.isNEU(u.mid)?u.mid=r.id:e.isNEU(u.mid)||(u.fid=r.id),l.push(u)}var h=null;Array.isArray(r.pids)&&(r.pids.length!=1&&console.error("addChildAndPartnerNodes partnerData.pids has to have one partner"),h=this.get(r.pids[0]),Array.isArray(h.pids)||(h.pids=[]),h.pids.push(r.id),l.push(h));var d={addNodesData:[r],updateNodesData:l,removeNodeId:null};if(o===!0&&e.events.publish("update",[this,d])===!1)return!1;a._fireUpdate_addUpdateRemove(d,o);var p=a.getRecentRootsByNodeId(t);e._changeRootOption(a.config.roots,p,a.manager.rootList);var g="";h&&(g=h.id),a._draw(!1,e.action.update,{id:g},function(){a.ripple(r.id),s&&s(),o===!0&&e.events.publish("updated",[a,d]),a.filterUI.update()}),o===!0&&e.events.publish("updating",[a,d])}else console.error("addPartnerAndParentNodes invalid data");else console.error("addPartnerAndParentNodes invalid data")},e.prototype.addPartnerNode=function(t,n,r){this.hideTreeMenu(!1);var s=this;if(t&&Array.isArray(t.pids)&&t.pids.length==1){e.isNEU(t.id)&&(t.id=this.generateId());var o=this.get(t.pids[0]);Array.isArray(o.pids)||(o.pids=[]),o.pids.push(t.id);var a={removeNodeId:null,updateNodesData:[o],addNodesData:[t]};if(r===!0&&e.events.publish("update",[this,a])===!1)return!1;s._fireUpdate_addUpdateRemove(a,r);var l=s.getRecentRootsByNodeId(a.updateNodesData[0].id);e._changeRootOption(s.config.roots,l,s.manager.rootList);var c=a.updateNodesData[0].id;s._draw(!1,e.action.insert,{id:c,insertedNodeId:a.addNodesData[0].id},function(){s.ripple(a.addNodesData[0].id),n&&n(),r===!0&&e.events.publish("updated",[s,a]),s.filterUI.update()}),r===!0&&e.events.publish("updating",[s,a])}else console.error("addPartnerNode invalid data")},e.prototype.addParentNode=function(t,n,r,s,o){this.hideTreeMenu(!1);var a=this;if(r)if(["mid","fid"].has(n))if(e.isNEU(t))console.error("addParentNode invalid childId");else{e.isNEU(r.id)&&(r.id=this.generateId());var l=[],c=this.get(t);c[n]=r.id,l.push(c);var u=null;Array.isArray(r.pids)&&(r.pids.length!=1&&console.error("addParentNode: data has to have one partner"),u=this.get(r.pids[0]),Array.isArray(u.pids)||(u.pids=[]),u.pids.push(r.id),l.push(u));var h={removeNodeId:null,updateNodesData:l,addNodesData:[r]};if(o===!0&&e.events.publish("update",[this,h])===!1)return!1;a._fireUpdate_addUpdateRemove(h,o);var d=t;a.config.roots=[h.addNodesData[0].id],a._draw(!1,e.action.insert,{id:d,insertedNodeId:h.addNodesData[0].id},function(){a.ripple(h.addNodesData[0].id),s&&s(),o===!0&&e.events.publish("updated",[a,h]),a.filterUI.update()}),o===!0&&e.events.publish("updating",[a,h])}else console.error("addParentNode invalid type");else console.error("addParentNode invalid data")},e.prototype.canRemove=function(t){var n=this.getNode(t);if(!n)return!1;var r=this.getNode(n.mid),s=this.getNode(n.fid),o=n.ftChildrenIds.length>0,a=!1,l=n.pids.length>0,c=n.pids.length>1;if(n.pids.length==1){var u=this.getNode(n.pids[0]);a=n.ftChildrenIds.compare(u.ftChildrenIds)}return!(!r&&!s||o||l)||!(r||s||o||c||!l||a)||!(r||s||!o||!a)||!(r||s||!o||a)||!(r||s||o||!a)},e.prototype.removeNode=function(t,n,r){var s=this;if(this.canRemove(t)){var o=this.getNode(t),a=[];if(Array.isArray(o.pids))for(var l=0;l<o.pids.length;l++){var c=this.get(o.pids[l]);c&&(h=c.pids.indexOf(o.id))!=-1&&(c.pids.splice(h,1),a.push(c))}if(Array.isArray(o.ftChildrenIds))for(l=0;l<o.ftChildrenIds.length;l++){var u=this.get(o.ftChildrenIds[l]);u&&(u.mid==o.id?(u.mid=void 0,a.push(u)):u.fid==o.id&&(u.fid=void 0,a.push(u)))}var h,d={removeNodeId:t,updateNodesData:a,addNodesData:[]};if(r===!0&&e.events.publish("update",[this,d])===!1)return!1;s._fireUpdate_addUpdateRemove(d,r),(h=s.config.roots.indexOf(t))!=-1&&s.config.roots.splice(h,1),s._draw(!1,e.action.update,null,function(){s.config.sticky&&e._moveToBoundaryArea(s.getSvg(),s.getViewBox(),s.response.boundary),n&&n(),r===!0&&e.events.publish("updated",[s,d]),s.filterUI.update()}),r===!0&&e.events.publish("updating",[s,d])}},e.prototype.updateNode=function(t,n,r){var s=this,o=this.getNode(t.id);t.pids||(t.pids=[]);var a=[];a.push(t);for(var l=0;l<o.pids.length;l++)if(!t.pids.has(o.pids[l])&&(u=this._get(o.pids[l]))&&u.pids){var c=u.pids.indexOf(t.id);c!=-1&&(u.pids.splice(c,1),a.push(t)),o.pids.splice(l,1),a.push(u)}for(l=0;l<t.pids.length;l++){var u;(!o.pids||!o.pids.has(t.pids[l]))&&((u=this._get(t.pids[l])).pids||(u.pids=[]),u.pids.push(t.pids[l]),a.push(u))}var h={removeNodeId:null,updateNodesData:a,addNodesData:[]};if(r===!0&&e.events.publish("update",[this,h])===!1)return!1;s._fireUpdate_addUpdateRemove(h,r),s._draw(!1,e.action.update,null,function(){s.config.sticky&&e._moveToBoundaryArea(s.getSvg(),s.getViewBox(),s.response.boundary),n&&n(),r===!0&&e.events.publish("updated",[s,h]),s.filterUI.update()})},e.prototype._fireUpdate_addUpdateRemove=function(t,n){for(var r=0;r<t.addNodesData.length;r++)this.add(t.addNodesData[r]);for(r=0;r<t.updateNodesData.length;r++)this.update(t.updateNodesData[r]);e.isNEU(t.removeNodeId)||this.remove(t.removeNodeId),n===!0&&e.events.publish("updating",[this,t])},e.prototype.__replaceIds=e.prototype._replaceIds,e.prototype._replaceIds=function(t){this.__replaceIds(t);for(var n=0;n<this.config.nodes.length;n++){var r=this.config.nodes[n];for(var s in t){var o=t[s];if(r.fid==s&&(r.fid=o),r.mid==s&&(r.mid=o),Array.isArray(r.pids))for(var a=0;a<r.pids.length;a++)r.pids[a]==s&&(r.pids[a]=o)}}},e===void 0&&(e={}),e._ajax=function(t,n,r,s,o){s==null&&(s="arraybuffer");var a=new XMLHttpRequest;a.onload=function(l){a.readyState==4&&this.status===200&&(l.target==null?o(this.response):o(l.target.response))},a.onerror=function(l){o({error:l})},a.open(n,t),a.responseType=s,a.setRequestHeader("Content-Type","application/json"),r==null?a.send():a.send(r)},e===void 0&&(e={}),e.animate=function(t,n,r,s,o,a,l){var c,u=10,h=1,d=s/u+1;return document.getElementsByTagName("g"),Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]),c=setInterval(function(){for(var p=0;p<t.length;p++)for(var g in r[p]){var _=e._arrayContains(["top","left","right","bottom","width","height"],g.toLowerCase())?"px":"";switch(g.toLowerCase()){case"d":var v=o((h*u-u)/s)*(r[p][g][0]-n[p][g][0])+n[p][g][0],C=o((h*u-u)/s)*(r[p][g][1]-n[p][g][1])+n[p][g][1];t[p].setAttribute("d",t[p].getAttribute("d")+" L"+v+" "+C);break;case"r":var T=o((h*u-u)/s)*(r[p][g]-n[p][g])+n[p][g];t[p].setAttribute("r",T);break;case"x1":T=o((h*u-u)/s)*(r[p][g]-n[p][g])+n[p][g],t[p].setAttribute("x1",T);break;case"x2":T=o((h*u-u)/s)*(r[p][g]-n[p][g])+n[p][g],t[p].setAttribute("x2",T);break;case"y1":T=o((h*u-u)/s)*(r[p][g]-n[p][g])+n[p][g],t[p].setAttribute("y1",T);break;case"y2":T=o((h*u-u)/s)*(r[p][g]-n[p][g])+n[p][g],t[p].setAttribute("y2",T);break;case"rotate3d":if(r[p][g]){var y=n[p][g],A=r[p][g],E=[0,0,0,0];for(var x in y)E[x]=o((h*u-u)/s)*(A[x]-y[x])+y[x];t[p].style.transform="rotate3d("+E.toString()+"deg)"}break;case"transform":if(r[p][g]){y=n[p][g],A=r[p][g],E=[0,0,0,0,0,0];for(var x in y)E[x]=o((h*u-u)/s)*(A[x]-y[x])+y[x];t[p].hasAttribute("transform")?t[p].setAttribute("transform","matrix("+E.toString()+")"):t[p].style.transform="matrix("+E.toString()+")"}break;case"viewbox":if(r[p][g]){y=n[p][g],A=r[p][g],E=[0,0,0,0];for(var x in y)E[x]=o((h*u-u)/s)*(A[x]-y[x])+y[x];t[p].setAttribute("viewBox",E.toString())}break;case"margin":if(r[p][g]){y=n[p][g],A=r[p][g],E=[0,0,0,0];for(var x in y)E[x]=o((h*u-u)/s)*(A[x]-y[x])+y[x];var w="";for(x=0;x<E.length;x++)w+=parseInt(E[x])+"px ";t[p]&&t[p].style&&(t[p].style[g]=w)}break;case"scrolly":T=o((h*u-u)/s)*(r[p][g]-n[p][g])+n[p][g],t[p].scrollTo(0,T);break;default:T=o((h*u-u)/s)*(r[p][g]-n[p][g])+n[p][g],t[p]&&t[p].style&&(t[p].style[g]=T+_)}}l&&l(),(h+=1)>d+1&&(clearInterval(c),a&&a(t))},u)},e.anim={},e.anim.inPow=function(t){return t<0?0:t>1?1:Math.pow(t,2)},e.anim.outPow=function(t){return t<0?0:t>1?1:-1*(Math.pow(t-1,2)+-1)},e.anim.inOutPow=function(t){return t<0?0:t>1?1:(t*=2)<1?e.anim.inPow(t,2)/2:-.5*(Math.pow(t-2,2)+-2)},e.anim.inSin=function(t){return t<0?0:t>1?1:1-Math.cos(t*(Math.PI/2))},e.anim.outSin=function(t){return t<0?0:t>1?1:Math.sin(t*(Math.PI/2))},e.anim.inOutSin=function(t){return t<0?0:t>1?1:-.5*(Math.cos(Math.PI*t)-1)},e.anim.inExp=function(t){return t<0?0:t>1?1:Math.pow(2,10*(t-1))},e.anim.outExp=function(t){return t<0?0:t>1?1:1-Math.pow(2,-10*t)},e.anim.inOutExp=function(t){return t<0?0:t>1?1:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,10*(-2*t+1)))},e.anim.inCirc=function(t){return t<0?0:t>1?1:-(Math.sqrt(1-t*t)-1)},e.anim.outCirc=function(t){return t<0?0:t>1?1:Math.sqrt(1-(t-1)*(t-1))},e.anim.inOutCirc=function(t){return t<0?0:t>1?1:t<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(2*t-2)*(2*t-2))+1)},e.anim.rebound=function(t){return t<0?0:t>1?1:t<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-1.5/2.75)*(t-1.5/2.75)+.75):t<2.5/2.75?1-(7.5625*(t-2.25/2.75)*(t-2.25/2.75)+.9375):1-(7.5625*(t-2.625/2.75)*(t-2.625/2.75)+.984375)},e.anim.inBack=function(t){return t<0?0:t>1?1:t*t*(2.70158*t-1.70158)},e.anim.outBack=function(t){return t<0?0:t>1?1:(t-1)*(t-1)*(2.70158*(t-1)+1.70158)+1},e.anim.inOutBack=function(t){return t<0?0:t>1?1:t<.5?4*t*t*(7.1898*t-2.5949)*.5:.5*((2*t-2)*(2*t-2)*(3.5949*(2*t-2)+2.5949)+2)},e.anim.impulse=function(t){var n=2*t;return n*Math.exp(1-n)},e.anim.expPulse=function(t){return Math.exp(-2*Math.pow(t,2))},e===void 0&&(e={}),e.prototype._attachInitEventHandlers=function(t){this._addEvent(window,"resize",this._resizeHandler)},e.prototype._attachEventHandlers=function(t){if(this.config.interactive){t=this.getSvg(),this.config.enableTouch||e.isMobile()?(this._addEvent(t,"touchstart",this._globalMouseDownHandler),this._addEvent(t,"touchend",this._globalClickHandler)):(this._addEvent(t,"mousedown",this._globalMouseDownHandler),this._addEvent(t,"click",this._globalClickHandler),this._addEvent(t,"contextmenu",this._globalContextHandler),this._addEvent(t,"dblclick",this._globalDbClickHandler),this.config.mouseScrool!=e.action.none&&this._addEvent(t,"wheel",this._mouseScrollHandler));var n=this.getMenuButton();n&&this._addEvent(n,"click",this._menuClickHandler)}},e.prototype._addEvent=function(t,n,r,s){var o,a;s||(s=""),t.getListenerList||(t.getListenerList={}),t.getListenerList[n+s]||(o=this,a=r,r=function(){if(a)return a.apply(o,[this,arguments[0]])},t.addEventListener?n=="mousewheel"?t.addEventListener(n,l,{passive:!1}):t.addEventListener(n,l,!1):t.attachEvent("on"+n,function(){var c=r.call(t,window.event);return c===!1&&(window.event.returnValue=!1,window.event.cancelBubble=!0),c}),t.getListenerList[n+s]=l);function l(c){var u=r.apply(this,arguments);return u===!1&&(c.stopPropagation(),c.preventDefault()),u}},e.prototype._removeEvent=function(t,n){if(t.getListenerList[n]){var r=t.getListenerList[n];t.removeEventListener(n,r,!1),delete t.getListenerList[n]}},e===void 0&&(e={}),e.VERSION="8.14.55",e.orientation={},e.orientation.top=0,e.orientation.bottom=1,e.orientation.right=2,e.orientation.left=3,e.orientation.top_left=4,e.orientation.bottom_left=5,e.orientation.right_top=6,e.orientation.left_top=7,e.align={},e.align.center=e.CENTER=8,e.align.orientation=e.ORIENTATION=9,e.attr={},e.attr.l="data-l",e.attr.id="data-id",e.attr.sl="data-sl",e.attr.lbl="data-lbl",e.attr.val="data-val",e.attr.tlbr="data-tlbr",e.attr.item="data-item",e.attr.layout="data-layout",e.attr.node_id="data-n-id",e.attr.link_id="data-l-id",e.attr.field_name="data-f-name",e.attr.c_link_to="data-c-l-to",e.attr.c_link_from="data-c-l-from",e.attr.s_link_to="data-s-l-to",e.attr.s_link_from="data-s-l-from",e.attr.control_add="data-ctrl-add",e.attr.control_expcoll_id="data-ctrl-ec-id",e.attr.control_up_id="data-ctrl-up-id",e.attr.control_export_menu="data-ctrl-menu",e.attr.control_node_menu_id="data-ctrl-n-menu-id",e.attr.control_node_circle_menu_id="data-ctrl-n-c-menu-id",e.attr.control_node_circle_menu_name="data-ctrl-n-c-menu-name",e.attr.control_node_circle_menu_wrraper_id="data-ctrl-n-c-menu-wrapper-id",e.attr.width="data-width",e.attr.text_overflow="data-text-overflow",e.ID="id",e.PID="pid",e.STPID="stpid",e.TAGS="tags",e.NODES="nodes",e.ELASTIC="elastic",e.ASSISTANT="Assistant",e.action={},e.action.expand=0,e.action.collapse=1,e.action.maximize=101,e.action.minimize=102,e.action.expandCollapse=501,e.action.edit=1,e.action.zoom=2,e.action.ctrlZoom=22,e.action.scroll=41,e.action.xScroll=3,e.action.yScroll=4,e.action.none=5,e.action.init=6,e.action.update=7,e.action.move=70,e.action.pan=8,e.action.centerNode=9,e.action.resize=10,e.action.insert=11,e.action.insertfirst=12,e.action.details=13,e.action.exporting=14,e.none=400001,e.scroll={},e.scroll.visible=!0,e.scroll.smooth=12,e.scroll.speed=120,e.scroll.safari={smooth:12,speed:250},e.match={},e.match.height=100001,e.match.width=100002,e.match.boundary=100003,e.movable={},e.movable.node="node",e.movable.tree="tree",e.movable.detachTree="detachTree",e.layout={},e.layout.normal=e.normal=0,e.layout.mixed=e.mixed=1,e.layout.tree=e.tree=2,e.layout.treeLeftOffset=e.treeLeftOffset=3,e.layout.treeRightOffset=e.treeRightOffset=4,e.layout.treeLeft=5,e.layout.treeRight=6,e.layout.grid=-1,e.nodeOpenTag="<g "+e.attr.node_id+'="{id}" style="opacity: {opacity}" transform="matrix(1,0,0,1,{x},{y})" class="{class}" '+e.attr.sl+'="{sl}" '+e.attr.l+"={level} {lcn}>",e.linkOpenTag="<g "+e.attr.link_id+'="[{id}][{child-id}]" class="{class}">',e.expcollOpenTag="<g "+e.attr.control_expcoll_id+'="{id}" transform="matrix(1,0,0,1,{x},{y})"  style="cursor:pointer;">',e.upOpenTag="<g "+e.attr.control_up_id+'="{id}" transform="matrix(1,0,0,1,{x},{y})" style="cursor:pointer;">',e.linkFieldsOpenTag='<g transform="matrix(1,0,0,1,{x},{y}) rotate({rotate})">',e.grCloseTag="</g>",e.A5w=420,e.A5h=595,e.A4w=595,e.A4h=842,e.A3w=842,e.A3h=1191,e.A2w=1191,e.A2h=1684,e.A1w=1684,e.A1h=2384,e.Letterw=612,e.Letterh=791,e.Legalw=612,e.Legalh=1009,e.COLLAPSE_PARENT_NEIGHBORS=1,e.COLLAPSE_SUB_CHILDRENS=2,e.COLLAPSE_PARENT_SUB_CHILDREN_EXCEPT_CLICKED=3,e.TEXT_THRESHOLD=400,e.IMAGES_THRESHOLD=100,e.LINKS_THRESHOLD=200,e.BUTTONS_THRESHOLD=70,e.ANIM_THRESHOLD=50,e.IT_IS_LONELY_HERE='<g transform="translate(-100, 0)" style="cursor:pointer;"  '+e.attr.control_add+'="control-add"><text fill="#039be5">{link}</text></g>',e.RES={},e.IT_IS_LONELY_HERE_LINK=e.RES.IT_IS_LONELY_HERE_LINK="It's lonely here, add your first node",e.FIRE_DRAG_NOT_CLICK_IF_MOVE=3,e.STRING_TAGS=!1,e.MAX_NODES_MESS="The trial has expired or 200 nodes limit was reached! <br /><a style='color: #039BE5;' target='_blank' href='https://balkan.app/FamilyTreeJS/Docs/Evaluation'>See more</a>",e.OFFLINE_MESS="The evaluation version requires internet connection! <br /><a style='color: #039BE5;' target='_blank' href='https://balkan.app/FamilyTreeJS/Docs/Evaluation'>See more</a>",e.SEARCH_PLACEHOLDER="Search... type ? to get help.",e.SEARCH_HELP_SYMBOL="?",e.SEARCH_CLOSE_RESULT_ON_ESCAPE_OR_CLICKOUTSIDE=!1,e.SEARCH_RESULT_LIMIT=10,e.IMPORT_MESSAGE="Choose the columns (fields) in your data file that contain the required information.",e.FIXED_POSITION_ON_CLICK=!1,e.RENDER_LINKS_BEFORE_NODES=!1,e.RENDER_CLINKS_BEFORE_NODES=!1,e.MIXED_LAYOUT_ALL_NODES=!0,e.MIXED_LAYOUT_FOR_NODES_WITH_COLLAPSED_CHILDREN=!1,e.MIXED_LAYOUT_IF_NUMBER_OF_CHILDREN_IS_MORE_THEN=1,e.LINK_ROUNDED_CORNERS=5,e.MOVE_STEP=5,e.CLINK_CURVE=1,e.MAX_DEPTH=200,e.SCALE_FACTOR=1.44,e.LAZY_LOADING_FACTOR=500,e.HIDE_EDIT_FORM_ON_PAN=!0,e.LAZY_LOADING=!0,e.ARRAY_FIELDS=["tags"],e.CSV_DELIMITER=",",e.EDITFORM_CLOSE_BTN='<svg data-edit-from-close class="bft-edit-form-close"><path style="fill:#ffffff;" d="M21.205,5.007c-0.429-0.444-1.143-0.444-1.587,0c-0.429,0.429-0.429,1.143,0,1.571l8.047,8.047H1.111 C0.492,14.626,0,15.118,0,15.737c0,0.619,0.492,1.127,1.111,1.127h26.554l-8.047,8.032c-0.429,0.444-0.429,1.159,0,1.587 c0.444,0.444,1.159,0.444,1.587,0l9.952-9.952c0.444-0.429,0.444-1.143,0-1.571L21.205,5.007z"></path></svg>',e.ESCAPE_HTML=!1,e.VERTICAL_CHILDREN_ASSISTANT=!1,e.EXPORT_PAGES_CUT_NODES=!1,e.RESET_MOVABLE_ONEXPANDCOLLAPSE=!1,e.FILTER_ALPHABETICALLY=!0,e.SERVER_PREFIX=".azurewebsites.net/api/OrgChartJS",e.FUNC_URL_NAME="func-url-orgfamilyjs",e.MINIMUM_SYMBOLS_IN_SEARCH_INPUT=1,i.exports=e,e.SERVER_PREFIX=".azurewebsites.net/api/FamilyTreeJS",e.FUNC_URL_NAME="func-url-familytreejs",e.OC_VERSION=e.VERSION,e.VERSION="1.09.45",e.RENDER_LINKS_BEFORE_NODES=!0,e.ARRAY_FIELDS=["tags","pids"],e._intersects=function(t,n,r){var s=t.x-r.siblingSeparation/4,o=t.y,a=t.x+t.w+r.siblingSeparation/4,l=t.y;switch(r.orientation){case e.orientation.right:case e.orientation.right_top:case e.orientation.left:case e.orientation.left_top:s=t.x,o=t.y-r.siblingSeparation/4,a=t.x,l=t.y+t.h+r.siblingSeparation/4}var c,u,h,d=n.p,p=n.q,g=n.r,_=n.s;return(c=(a-s)*(_-p)-(g-d)*(l-o))!==0&&(u=((o-l)*(g-s)+(a-s)*(_-o))/c,0<(h=((_-p)*(g-s)+(d-g)*(_-o))/c)&&h<1&&0<u&&u<1)},e._addPoint=function(t,n,r,s,o){switch(r.orientation){case e.orientation.top:case e.orientation.top_left:return e._addPointTop(t,n,r,s,o);case e.orientation.bottom:case e.orientation.bottom_left:return e._addPointBottom(t,n,r,s,o);case e.orientation.left:case e.orientation.left_top:return e._addPointLeft(t,n,r,s,o);case e.orientation.right:case e.orientation.right_top:return e._addPointRight(t,n,r,s,o)}},e._addPointTop=function(t,n,r,s,o){var a,l,c;return o=="left"?a=t.leftNeighbor?t.x+(t.leftNeighbor.x+t.leftNeighbor.w-t.x)/2:t.x-r.siblingSeparation/2:o=="right"&&(a=t.rightNeighbor?t.x+t.w+(t.rightNeighbor.x-(t.x+t.w))/2:t.x+t.w+r.siblingSeparation/2),n.push([a,n[n.length-1][1]]),n.push([a,t.y-r.levelSeparation/3]),l=n[n.length-1][1],c=a,s.p=a,s.q=l,s.r=c,s},e._addPointBottom=function(t,n,r,s,o){var a,l,c;return o=="left"?a=t.leftNeighbor?t.x+(t.leftNeighbor.x+t.leftNeighbor.w-t.x)/2:t.x-r.siblingSeparation/2:o=="right"&&(a=t.rightNeighbor?t.x+t.w+(t.rightNeighbor.x-(t.x+t.w))/2:t.x+t.w+r.siblingSeparation/2),n.push([a,n[n.length-1][1]]),n.push([a,t.y+t.h+r.levelSeparation/3]),l=n[n.length-1][1],c=a,s.p=a,s.q=l,s.r=c,s},e._addPointLeft=function(t,n,r,s,o){var a,l=n[n.length-1][0];o=="bottom"?a=t.rightNeighbor?t.y+t.h+(t.rightNeighbor.y-(t.y+t.h))/2:t.y+t.h+r.siblingSeparation/2:o=="top"&&(a=t.leftNeighbor?t.y+(t.leftNeighbor.y+t.leftNeighbor.h-t.y)/2:t.y-r.siblingSeparation/2),n.push([n[n.length-1][0],a]),n.push([t.x-r.levelSeparation/3,a]),l=n[n.length-1][0];var c=a;return s.p=l,s.q=a,s.s=c,s},e._addPointRight=function(t,n,r,s,o){var a,l=n[n.length-1][0];o=="bottom"?a=t.rightNeighbor?t.y+t.h+(t.rightNeighbor.y-(t.y+t.h))/2:t.y+t.h+r.siblingSeparation/2:o=="top"&&(a=t.leftNeighbor?t.y+(t.leftNeighbor.y+t.leftNeighbor.h-t.y)/2:t.y-r.siblingSeparation/2),n.push([n[n.length-1][0],a]),n.push([t.x+t.w+r.levelSeparation/3,a]),l=n[n.length-1][0];var c=a;return s.p=l,s.q=a,s.s=c,s},e.editUI=function(){},e.editUI.prototype.init=function(t){this.obj=t,this.fields=null,this._event_id=e._guid()},e.editUI.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e.editUI.prototype.show=function(t,n,r){if(this.hide(),e.events.publish("show",[this,t])===!1)return!1;var s=this,o=this.content(t,n,r);this.obj.element.appendChild(o.element),e.input.init(this.obj.element),r?n||this._focusElement(o.focusId):this.interval=e.animate(o.element,{right:-20,opacity:0},{right:0,opacity:1},300,e.anim.outSin,function(){n||s._focusElement(o.focusId)}),this.obj.element.querySelector("[data-edit-from-close]").addEventListener("click",function(c){c.preventDefault(),e.events.publish("cancel",[s,{id:t}])!==!1&&s.hide()}),this.obj.element.querySelector("[data-edit-from-cancel]").addEventListener("click",function(c){c.preventDefault(),e.events.publish("cancel",[s,{id:t}])!==!1&&s.hide()}),this.obj.element.querySelector("[data-edit-from-save]").addEventListener("click",function(c){c.preventDefault();var u=e.input.validateAndGetData(o.element);if(u!==!1){var h=s.obj.get(t),d={data:e.mergeDeep(h,u)};if(e.events.publish("save",[s,d])===!1)return;s.obj.updateNode(d.data,null,!0),s.hide()}});for(var a=this.obj.element.querySelectorAll("[data-input-btn]"),l=0;l<a.length;l++)a[l].addEventListener("click",function(c){c.preventDefault(),e.events.publish("element-btn-click",[s,{input:this.parentNode.querySelector("input"),nodeId:t,event:c}])});this.obj.element.querySelector("[data-add-more-fields-btn]").addEventListener("click",function(c){c.stopPropagation(),c.preventDefault();var u=this,h=e.elements.textbox({},{type:"textbox",label:s.obj.config.editForm.addMoreFieldName,btn:s.obj.config.editForm.addMoreBtn},"280px");u.parentNode.insertAdjacentHTML("beforebegin",h.html),u.style.display="none",e.input.init(u.parentNode.previousSibling);var d=document.getElementById(h.id);d.focus(),d.nextElementSibling.addEventListener("click",function(p){p.stopPropagation(),p.preventDefault();var g=d.value,_=s.obj.element.querySelector('[data-binding="'+e._escapeDoubleQuotes(d.value)+'"]');if(e.isNEU(g)||_)d.focus();else{var v=e.elements.textbox({},{type:"textbox",label:g,binding:g},"280px");d.parentNode.parentNode.parentNode.removeChild(d.parentNode.parentNode),u.parentNode.insertAdjacentHTML("beforebegin",v.html),u.style.display="",e.input.init(u.parentNode.previousSibling),document.getElementById(v.id).focus()}})}),this.obj.element.querySelector("[data-bft-edit-from-btns]").addEventListener("click",function(c){for(var u=c.target;u&&u.hasAttribute&&!u.hasAttribute("data-edit-from-btn");)u=u.parentNode;if(u&&u.hasAttribute){var h=u.getAttribute("data-edit-from-btn"),d={button:s.obj.config.editForm.buttons[h],name:h,nodeId:t,event:c};if(e.events.publish("button-click",[s,d])===!1)return!1;switch(h){case"edit":s.obj.editUI.show(t,!1,!0);break;case"pdf":s.obj.exportPDFProfile({id:t,filename:o.title}),s.hide();break;case"png":s.obj.exportPNGProfile({id:t,filename:o.title}),s.hide();break;case"share":s.obj.shareProfile(t);break;case"remove":s.obj.removeNode(t,null,!0),s.hide()}}})},e.editUI.prototype._focusElement=function(t){var n=null;e.isNEU(this.obj.config.editForm.focusBinding)?e.isNEU(t)||(n=document.getElementById(t)):n=this.obj.element.querySelector('[data-binding="'+this.obj.config.editForm.focusBinding+'"]'),n&&(n.value&&n.value.length&&n.setSelectionRange(n.value.length,n.value.length),n.focus())},e.editUI.prototype.setAvatar=function(t){var n=this.obj.element.querySelector("#bft-avatar");e.isNEU(t)?n.innerHTML=e.icon.user(150,150,"#8C8C8C",0,0):n.innerHTML=`<img style="width: 100%;height:100%;object-fit:cover;border-radius: 50%;" src="${t}"></img>`},e.editUI.prototype.content=function(t,n,r,s,o){var a,l=this.obj.config.editForm.readOnly,c=JSON.parse(JSON.stringify(this.obj.config.editForm.elements)),u=this.obj.config.editForm.addMore,h=this.obj.config.editForm.saveAndCloseBtn,d=this.obj.config.editForm.cancelBtn,p=this.obj.config.editForm.buttons,g=this.obj.config.editForm.titleBinding,_=this.obj.config.editForm.photoBinding,v=this.obj.getNode(t),C=this.obj._get(t),T=e.t(v.templateName,v.min,this.obj.getScale()),y=C[g],A=C[_];if(this.obj.config.editForm.generateElementsFromFields)for(var E=0;E<this.fields.length;E++){var x=this.fields[E];if(x!="tags"){for(var w=!1,S=0;S<c.length;S++){if(Array.isArray(c[S])){for(var I=0;I<c[S].length;I++)if(x==c[S][I].binding){w=!0;break}}else if(x==c[S].binding){w=!0;break}if(w)break}w||c.push({type:"textbox",label:x,binding:x})}}e.isNEU(y)&&(y=""),A=e.isNEU(A)?e.icon.user(150,150,"#8C8C8C",0,0):`<img style="width: 100%;height:100%;border-radius: 50%;object-fit:cover;" src="${A}"></img>`;var k=!n,P=n?"display:none;":"",O=n||!u?"display:none;":"",R=T.editFormHeaderColor?`style="background-color:${T.editFormHeaderColor};"`:"",K=document.createElement("form");if(K.setAttribute("data-bft-edit-form",""),K.classList.add("bft-edit-form"),K.classList.add(this.obj.config.mode),K.classList.add(v.templateName.replaceAll(" ","")),K.classList.add(e.ui._defsIds[v.templateName]),Array.isArray(v.tags)&&v.tags.length)for(E=0;E<v.tags.length;E++)K.classList.add(v.tags[E].replaceAll(" ",""));K.style.display="flex",K.style.opacity=r?1:0,K.style.right=r?0:"-20px",s&&(K.style.width=s);var ie=[],pe=o?"":e.EDITFORM_CLOSE_BTN;return K.innerHTML=`<div>
                        <div class="bft-edit-form-header" ${R}>
                            ${pe}
                            ${e.editUI.renderHeaderContent(y,A,v,C)}
                        </div>
                        <div data-bft-edit-from-btns class="bft-edit-form-instruments">
                        ${function(){if(o)return"";var se="";for(var Y in p){var Q=p[Y];e.isNEU(Q)||k&&Q.hideIfEditMode||n&&Q.hideIfDetailsMode||l&&Q.text=="Edit"||(se+=`<div data-edit-from-btn='${Y}' class="bft-img-button" ${R} title="${Q.text}">${Q.icon}</div>`)}return se}()}    
                        </div>
                    </div>
                    <div class="bft-edit-form-fields">
                        <div class="bft-edit-form-fields-inner">
                            <div class="bft-form-fieldset">
                                ${function(){for(var se="",Y=0;Y<c.length;Y++){var Q=c[Y];if(Array.isArray(Q)){se+='<div class="bft-form-field-100 bft-form-fieldset">';for(var re=0;re<Q.length;re++){var ve=Q[re],ae=e.elements[ve.type](C,ve,"unset",n);!e.isNEU(ae.id)&&e.isNEU(a)&&e.isNEU(ae.value)&&(a=ae.id),e.isNEU(ae.value)||ie.push(`${ve.label}: ${ae.value}`),se+=ae.html}se+="</div>"}else ae=e.elements[Q.type](C,Q,"280px",n),!e.isNEU(ae.id)&&e.isNEU(a)&&e.isNEU(ae.value)&&(a=ae.id),e.isNEU(ae.value)||ie.push(`${Q.label}: ${ae.value}`),se+=ae.html}return se}()}

                                <div class="bft-form-field" style="min-width: 280px; text-align:center; ${O}">
                                    <a data-add-more-fields-btn href="#" class="bft-link">${u}</a>
                                </div>
                            </div>        
                        </div>
                    </div>
                    <div class="bft-form-fieldset" style="padding: 14px 10px; ${P}">
                        <div class="bft-form-field" style="min-width: initial;">
                            <button data-edit-from-cancel type="button" class="bft-button transparent">${d}</button>
                        </div>
                        <div class="bft-form-field" style="min-width: initial;">
                            <button type="submit" data-edit-from-save type="button" class="bft-button">${h}</button>
                        </div>
                    </div>`,{element:K,focusId:a,title:y,shareText:ie.join(`
`)}},e.editUI.prototype.hide=function(){if(e.events.publish("hide",[this])===!1)return!1;e.isNEU(this.interval)&&(clearInterval(this.interval),this.interval=null);var t=this.obj.element.querySelector("[data-bft-edit-form]");t&&t.parentNode&&t.parentNode.removeChild(t)},e.editUI.renderHeaderContent=function(t,n,r,s){return`<h1 class="bft-edit-form-title">${e._escapeGreaterLessSign(t)}</h1>
                <div id="bft-avatar" class="bft-edit-form-avatar">${n}</div>`},e.prototype.getSvg=function(){var t=this.element.getElementsByTagName("svg");return t&&t.length?t[0]:null},e.prototype.getPointerElement=function(){return this.element.querySelector("g[data-pointer]")},e.prototype.getNodeElement=function(t){return this.element.querySelector("["+e.attr.node_id+"='"+t+"']")},e.prototype.getMenuButton=function(){return this.element.querySelector("["+e.attr.control_export_menu+"]")},e.menuUI=function(){},e.menuUI.prototype.init=function(t,n){this.obj=t,this.wrapper=null,this.menu=n,this._event_id=e._guid()},e.menuUI.prototype.showStickIn=function(t,n,r,s){this._show(t,null,n,r,s)},e.menuUI.prototype.show=function(t,n,r,s,o){this._show(t,n,r,s,o)},e.menuUI.prototype._show=function(t,n,r,s,o){var a=this;this.hide();var l="";o||(o=this.menu);var c={firstNodeId:r,secondNodeId:s,menu:o};if(e.events.publish("show",[this,c])===!1)return!1;for(var u in o=c.menu){var h=o[u].icon,d=o[u].text;h===void 0&&(h=e.icon[u]?e.icon[u](24,24,"#7A7A7A"):""),typeof d=="function"&&(d=d()),typeof h=="function"&&(h=h()),l+="<div "+e.attr.item+'="'+u+'">'+h+"<span>&nbsp;&nbsp;"+d+"</span></div>"}if(l!=""){if(this.wrapper=document.createElement("div"),this.wrapper.className="bft-family-menu",this.wrapper.style.left="-99999px",this.wrapper.style.top="-99999px",this.wrapper.innerHTML=l,this.obj.element.appendChild(this.wrapper),n==null){var p=e._menuPosition(t,this.wrapper,this.obj.getSvg());t=p.x,n=p.y}var g=t+45;this.wrapper.style.left=g+"px",this.wrapper.style.top=n+"px",this.wrapper.style.left=g-this.wrapper.offsetWidth+"px";var _=t-this.wrapper.offsetWidth;e.animate(this.wrapper,{opacity:0,left:g-this.wrapper.offsetWidth},{opacity:1,left:_},300,e.anim.inOutPow);for(var v=this.wrapper.getElementsByTagName("div"),C=0;C<v.length;C++)(u=v[C]).addEventListener("click",function(T){var y,A=this.getAttribute(e.attr.item);if(o[A].onClick===void 0)if(A==="add"){var E={id:a.obj.generateId(),pid:r};a.obj.addNode(E,null,!0)}else if(A==="edit"){var x=a.obj.getNode(r);a.obj.editUI.show(x.id)}else A==="details"?(x=a.obj.getNode(r),a.obj.editUI.show(x.id,!0)):A==="remove"?a.obj.removeNode(r,null,!0):A==="svg"?a.obj.exportSVG({filename:"FamilyTree.svg",expandChildren:!1,nodeId:r}):A==="pdf"?a.obj.exportPDF({filename:"FamilyTree.pdf",expandChildren:!1,nodeId:r}):A==="png"?a.obj.exportPNG({filename:"FamilyTree.png",expandChildren:!1,nodeId:r}):A==="csv"?a.obj.exportCSV({nodeId:r}):A==="xml"?a.obj.exportXML({nodeId:r}):A==="json"&&a.obj.exportJSON({nodeId:r});else y=o[A].onClick.call(a.obj,r,s);y!=0&&a.hide()})}},e.menuUI.prototype.isVisible=function(){return this.wrapper!=null},e.menuUI.prototype.hide=function(){this.wrapper!=null&&(this.obj.element.removeChild(this.wrapper),this.wrapper=null)},e.menuUI.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e.circleMenuUI=function(){},e.circleMenuUI.prototype.init=function(t,n){this.obj=t,this.menu=n,this._menu=null,this._buttonsInterval=[],this._linesInterval=[],this._event_id=e._guid()},e.circleMenuUI.prototype.show=function(t,n){this._show(t,n)},e.circleMenuUI.prototype._show=function(t,n){var r=this,s=this.obj.getNode(t),o=e.t(s.templateName,s.min,this.obj.getScale());if(!e.isNEU(o.nodeCircleMenuButton)){var a=this.obj.getSvg(),l=this.obj.element.querySelector("["+e.attr.control_node_circle_menu_id+'="'+t+'"]'),c=this.obj.getNodeElement(t),u=e._getTransform(l),h=e._getTransform(c),d=u[4]+h[4],p=u[5]+h[5],g=l.querySelectorAll("line"),_=this.obj.element.querySelector("["+e.attr.control_node_circle_menu_wrraper_id+"]");if(e.isNEU(_)||_.getAttribute(e.attr.control_node_circle_menu_wrraper_id)!=t){this.hide(),n||(n=this.menu);var v={nodeId:t,menu:n},C=e.events.publish("show",[this,v]);if(this._menu=n,C===!1)return!1;for(var T=0,y=Object.keys(v.menu).length,A=2*o.nodeCircleMenuButton.radius+4,E=2*Math.PI*A,x=E/y-(2*o.nodeCircleMenuButton.radius+2);x<0;)A+=8,x=(E=2*Math.PI*A)/y-(2*o.nodeCircleMenuButton.radius+2);for(var w in(_=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute(e.attr.control_node_circle_menu_wrraper_id,t),_.setAttribute("transform","matrix(1,0,0,1,"+d+","+p+")"),a.appendChild(_),v.menu){var S=v.menu[w].icon,I=v.menu[w].color,k=v.menu[w].text;typeof S=="function"&&(S=S()),typeof I=="function"&&(I=I()),typeof k=="function"&&(k=k());var P=document.createElementNS("http://www.w3.org/2000/svg","g");P.setAttribute("transform","matrix(1,0,0,1,0,0)"),P.setAttribute(e.attr.control_node_circle_menu_name,w),P.style.cursor="pointer";var O=document.createElementNS("http://www.w3.org/2000/svg","title");e.isNEU(k)||(O.innerHTML=k);var R=document.createElementNS("http://www.w3.org/2000/svg","circle");R.setAttribute("cx",0),R.setAttribute("cy",0),R.setAttribute("r",o.nodeCircleMenuButton.radius),R.setAttribute("fill",I),R.setAttribute("stroke-width","1"),R.setAttribute("stroke",o.nodeCircleMenuButton.stroke),P.appendChild(R),P.appendChild(O),P.innerHTML+=S,_.appendChild(P);var K=P.getElementsByTagName("svg")[0];if(K.setAttribute("pointer-events","none"),K){var ie=parseInt(K.getAttribute("width")),pe=parseInt(K.getAttribute("height"));K.setAttribute("x",-ie/2),K.setAttribute("y",-pe/2)}var se=T*Math.PI/(y/2);T++;var Y=Math.cos(se)*A,Q=Math.sin(se)*A;this._buttonsInterval.push(e.animate(P,{transform:[1,0,0,1,0,0]},{transform:[1,0,0,1,Y,Q]},250,e.anim.outBack,function(re){var ve=re[0].getAttribute(e.attr.control_node_circle_menu_name),ae=re[0].parentNode.getAttribute(e.attr.control_node_circle_menu_wrraper_id);re[0].addEventListener("mouseenter",function(fe){e.events.publish("mouseenter",[r,{from:ae,menuItem:v.menu[ve],menuItemName:ve,event:fe}])}),re[0].addEventListener("mouseout",function(fe){e.events.publish("mouseout",[r,{from:ae,menuItem:v.menu[ve],menuItemName:ve,event:fe}])})}))}this._linesInterval.push(e.animate(g[0],{x1:-o.nodeCircleMenuButton.radius/2,y1:-6,x2:o.nodeCircleMenuButton.radius/2,y2:-6},{x1:-7,y1:-7,x2:7,y2:7},500,e.anim.inOutSin)),this._linesInterval.push(e.animate(g[1],{x1:-o.nodeCircleMenuButton.radius/2,y1:0,x2:o.nodeCircleMenuButton.radius/2,y2:0},{x1:0,y1:0,x2:0,y2:0},500,e.anim.inOutSin)),this._linesInterval.push(e.animate(g[2],{x1:-o.nodeCircleMenuButton.radius/2,y1:6,x2:o.nodeCircleMenuButton.radius/2,y2:6},{x1:-7,y1:7,x2:7,y2:-7},500,e.anim.inOutSin))}else this.hide()}},e.circleMenuUI.prototype.hide=function(){for(var t=this._buttonsInterval.length-1;t>=0;t--)clearInterval(this._buttonsInterval[t]),this._buttonsInterval.splice(t,1);for(this._buttonsInterval=[],t=this._linesInterval.length-1;t>=0;t--)clearInterval(this._linesInterval[t]),this._linesInterval.splice(t,1);this._linesInterval=[];var n=this.obj.element.querySelector("["+e.attr.control_node_circle_menu_wrraper_id+"]");if(n!=null){var r=n.getAttribute(e.attr.control_node_circle_menu_wrraper_id),s=this.obj.getNode(r),o=e.t(s.templateName,s.min,this.obj.getScale()),a=this.obj.element.querySelector("["+e.attr.control_node_circle_menu_id+'="'+r+'"]').querySelectorAll("line");a[0].setAttribute("x1",-o.nodeCircleMenuButton.radius/2),a[0].setAttribute("x2",o.nodeCircleMenuButton.radius/2),a[0].setAttribute("y1",-6),a[0].setAttribute("y2",-6),a[1].setAttribute("x1",-o.nodeCircleMenuButton.radius/2),a[1].setAttribute("x2",o.nodeCircleMenuButton.radius/2),a[1].setAttribute("y1",0),a[1].setAttribute("y2",0),a[2].setAttribute("x1",-o.nodeCircleMenuButton.radius/2),a[2].setAttribute("x2",o.nodeCircleMenuButton.radius/2),a[2].setAttribute("y1",6),a[2].setAttribute("y2",6),n.parentElement.removeChild(n),n=null}},e.circleMenuUI.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e===void 0&&(e={}),e.idb={version:1,dbName:"BALKAN",tableName:"familytree-js",keyPath:"id"},e.idb.db=null,e.idb._open=function(t){if(e._browser().msie)t&&t(!1);else if((navigator.userAgent.toLowerCase().indexOf("safari")>0||navigator.userAgent.toLowerCase().indexOf("firefox")>0)&&window.location!==window.parent.location)t&&t(!1);else{if(!window.indexedDB)return console.error("Your browser doesn't support a stable version of IndexedDB."),void(t&&t(!1));if(e.idb.db==null){var n=indexedDB.open(e.idb.dbName,e.idb.version);n.onerror=function(r){console.error("Cannot open database!"),t&&t(!1)},n.onsuccess=function(r){e.idb.db=r.target.result,t&&t(!0)},n.onupgradeneeded=function(r){var s=r.target.result;s.objectStoreNames.contains(e.idb.tableName)&&s.deleteObjectStore(e.idb.tableName),s.createObjectStore(e.idb.tableName,{keyPath:e.idb.keyPath})}}else t&&t(!0)}},e.idb.read=function(t,n){e.idb._open(function(r){if(r){var s=e.idb.db.transaction([e.idb.tableName]).objectStore(e.idb.tableName).get(t);s.onerror=function(o){console.error("Unable to retrieve data from database!"),n&&n(!1)},s.onsuccess=function(o){s.result?n&&n(!0,s.result):n&&n(null)}}else n&&n(!1)})},e.idb.write=function(t,n){e.idb.read(t.id,function(r){if(r==null){var s=e.idb.db.transaction([e.idb.tableName],"readwrite").objectStore(e.idb.tableName).add(t);s.onerror=function(o){console.error("Unable to add data to database!"),n&&n(!1)},s.onsuccess=function(o){n&&n(!0)}}else n&&n(r)})},e.idb.put=function(t,n){e.idb._open(function(r){if(r){var s=e.idb.db.transaction([e.idb.tableName],"readwrite").objectStore(e.idb.tableName).put(t);s.onerror=function(o){console.error("Unable to put data to database!"),n&&n(!1)},s.onsuccess=function(o){n&&n(!0)}}else n&&n(!1)})},e.idb.delete=function(t,n){e.idb._open(function(r){if(r){var s=e.idb.db.transaction([e.idb.tableName],"readwrite").objectStore(e.idb.tableName).delete(t);s.onerror=function(o){console.error("Unable to retrieve data from database!"),n&&n(!1)},s.onsuccess=function(o){s.error?n&&n(!1):n&&n(!0)}}else n&&n(!1)})},e.toolbarUI=function(){},e.toolbarUI.expandAllIcon='<svg style="margin-bottom:7px;box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#757575" /></marker><line x1="11" y1="11" x2="6" y2="6" stroke="#757575" stroke-width="2" marker-end="url(#arrow)" /><line x1="21" y1="11" x2="26" y2="6" stroke="#757575" stroke-width="2" marker-end="url(#arrow)" /><line x1="21" y1="21" x2="26" y2="26" stroke="#757575" stroke-width="2" marker-end="url(#arrow)" /><line x1="11" y1="21" x2="6" y2="26" stroke="#757575" stroke-width="2" marker-end="url(#arrow)" /><rect x="12" y="12" width="8" height="8" fill="#757575"></rect></svg>',e.toolbarUI.fitIcon='<svg  style="margin-bottom:7px;box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><path stroke-width="3" fill="none" stroke="#757575" d="M4,11 L4,4 L11,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,11 L28,4 L21,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,21 L28,28 L21,28"></path><path stroke-width="3" fill="none" stroke="#757575" d="M4,21 L4,28 L11,28"></path><circle cx="16" cy="16" r="5" fill="#757575"></circle></svg>',e.toolbarUI.openFullScreenIcon='<svg  style="margin-bottom:7px;box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><path stroke-width="3" fill="none" stroke="#757575" d="M4,11 L4,4 L11,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,11 L28,4 L21,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,21 L28,28 L21,28"></path><path stroke-width="3" fill="none" stroke="#757575" d="M4,21 L4,28 L11,28"></path><line x1="5" y1="5" x2="27" y2="27" stroke-width="3" stroke="#757575"></line><line x1="5" y1="27" x2="27" y2="5" stroke-width="3" stroke="#757575"></line></svg>',e.toolbarUI.closeFullScreenIcon='<svg  style="margin-bottom:7px;box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><path stroke-width="3" fill="none" stroke="#757575" d="M4,11 L4,4 L11,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,11 L28,4 L21,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,21 L28,28 L21,28"></path><path stroke-width="3" fill="none" stroke="#757575" d="M4,21 L4,28 L11,28"></path><rect x="11" y="11" width="10" height="10" stroke-width="3" fill="none" stroke="#757575" ></rect></svg>',e.toolbarUI.zoomInIcon='<svg style="box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border-left: 1px solid #cacaca; border-right: 1px solid #cacaca; border-top: 1px solid #cacaca; background-color: #f9f9f9;display: block; cursor: pointer;" width="32px" height="32px" ><g><rect fill="#f9f9f9" x="0" y="0" width="32" height="32" ></rect><line x1="8" y1="16" x2="24" y2="16" stroke-width="3" stroke="#757575"></line><line x1="16" y1="8" x2="16" y2="24" stroke-width="3" stroke="#757575"></line></g><line x1="4" y1="32" x2="28" y2="32" stroke-width="1" stroke="#cacaca"></line></svg>',e.toolbarUI.zoomOutIcon='<svg style="box-shadow: 0px 1px 4px rgba(0,0,0,0.3); margin-bottom:7px; border-left: 1px solid #cacaca; border-right: 1px solid #cacaca; border-bottom: 1px solid #cacaca; background-color: #f9f9f9;display: block; cursor: pointer;" width="32px" height="32px" ><g><rect fill="#f9f9f9" x="0" y="0" width="32" height="32" ></rect><line x1="8" y1="16" x2="24" y2="16" stroke-width="3" stroke="#757575"></line></g></svg>',e.toolbarUI.layoutIcon="<svg "+e.attr.tlbr+'="layout" style="box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><path stroke-width="3" fill="none" stroke="#757575" d="M8,24 L16,14 L24,24"></path><path stroke-width="3" fill="none" stroke="#757575" d="M8,16 L16,8 L24,16"></path></svg>',e.toolbarUI.prototype.init=function(t,n){if(n){this.obj=t,this.toolbar=n,this._visible=!1,this.div=document.createElement("div"),this.div.classList.add("bft-toolbar-container"),Object.assign(this.div.style,{position:"absolute",padding:"3px",right:this.obj.config.padding-10+"px",bottom:this.obj.config.padding-10+"px"}),n.expandAll&&(this.div.innerHTML+="<div "+e.attr.tlbr+'="expand">'+e.toolbarUI.expandAllIcon+"</div>"),n.fit&&(this.div.innerHTML+="<div "+e.attr.tlbr+'="fit">'+e.toolbarUI.fitIcon+"</div>"),n.zoom&&(this.div.innerHTML+="<div "+e.attr.tlbr+'="plus">'+e.toolbarUI.zoomInIcon+"</div>",this.div.innerHTML+="<div "+e.attr.tlbr+'="minus">'+e.toolbarUI.zoomOutIcon+"</div>"),n.layout&&(this.div.innerHTML+="<div "+e.attr.tlbr+'="layout">'+e.toolbarUI.layoutIcon+"</div>",this.layouts=document.createElement("div"),this.layouts.classList.add("bft-toolbar-layout"),this.layouts.innerHTML=`<svg data-layout="normal" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="7" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="63" y="41" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="35" stroke-width="1"></line><line stroke="#000000" x1="32" x2="88" y1="35" y2="35" stroke-width="1"></line><line stroke="#000000" x1="32" x2="32" y1="35" y2="41" stroke-width="1"></line><line stroke="#000000" x1="88" x2="88" y1="35" y2="41" stroke-width="1"></line></svg>
            <svg data-layout="treeRightOffset" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="40" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="40" y="73" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="35" stroke-width="1"></line><line stroke="#000000" x1="60" x2="35" y1="35" y2="35" stroke-width="1"></line><line stroke="#000000" x1="35" x2="35" y1="35" y2="86" stroke-width="1"></line><line stroke="#000000" x1="35" x2="40" y1="86" y2="86" stroke-width="1"></line><line stroke="#000000" x1="35" x2="40" y1="54" y2="54" stroke-width="1"></line></svg>
            <svg data-layout="treeLeftOffset" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="30" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="30" y="73" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="35" stroke-width="1"></line><line stroke="#000000" x1="60" x2="85" y1="35" y2="35" stroke-width="1"></line><line stroke="#000000" x1="85" x2="85" y1="35" y2="86" stroke-width="1"></line><line stroke="#000000" x1="80" x2="85" y1="86" y2="86" stroke-width="1"></line><line stroke="#000000" x1="80" x2="85" y1="54" y2="54" stroke-width="1"></line></svg>
            <svg data-layout="mixed" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="35" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="35" y="73" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="41" stroke-width="1"></line><line stroke="#000000" x1="60" x2="60" y1="68" y2="73" stroke-width="1"></line></svg>
            <svg data-layout="tree" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="7" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="35" y="73" width="50" height="27"></rect><rect fill="#F57C00" x="63" y="41" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="73" stroke-width="1"></line><line stroke="#000000" x1="57" x2="63" y1="54" y2="54" stroke-width="1"></line></svg>
            <svg data-layout="grid" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="7" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="7" y="73" width="50" height="27"></rect><rect fill="#F57C00" x="63" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="63" y="73" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="71" stroke-width="1"></line><line stroke="#000000" x1="32" x2="88" y1="39" y2="39" stroke-width="1"></line><line stroke="#000000" x1="32" x2="88" y1="71" y2="71" stroke-width="1"></line><line stroke="#000000" x1="32" x2="32" y1="71" y2="73" stroke-width="1"></line><line stroke="#000000" x1="88" x2="88" y1="71" y2="73" stroke-width="1"></line><line stroke="#000000" x1="32" x2="32" y1="39" y2="41" stroke-width="1"></line><line stroke="#000000" x1="88" x2="88" y1="39" y2="41" stroke-width="1"></line></svg>`,this.obj.element.appendChild(this.layouts)),n.fullScreen&&(this.div.innerHTML+="<div "+e.attr.tlbr+'="fullScreen">'+e.toolbarUI.openFullScreenIcon+"</div>"),this.obj.element.appendChild(this.div),this.layoutBtn=this.div.querySelector("["+e.attr.tlbr+'="layout"]');var r=this.div.querySelector("["+e.attr.tlbr+'="plus"]'),s=this.div.querySelector("["+e.attr.tlbr+'="minus"]'),o=this.div.querySelector("["+e.attr.tlbr+'="fit"]'),a=this.div.querySelector("["+e.attr.tlbr+'="fullScreen"]'),l=this.div.querySelector("["+e.attr.tlbr+'="expand"]'),c=this;r&&r.addEventListener("click",function(){c.obj.zoom(!0,null,!0)}),s&&s.addEventListener("click",function(){c.obj.zoom(!1,null,!0)}),o&&o.addEventListener("click",function(){c.obj.fit()}),a&&a.addEventListener("click",function(){c.obj.toggleFullScreen()}),l&&l.addEventListener("click",function(){c.obj.expand(null,"all")}),this.layoutBtn&&this.layoutBtn.addEventListener("click",function(){c._visible?c.hideLayout():c.showLayout()}),this.layouts&&this.layouts.addEventListener("click",function(u){for(var h=u.target;h;){if(h.hasAttribute&&h.hasAttribute(e.attr.layout)){h=h.getAttribute(e.attr.layout),c.obj.setLayout(e.layout[h]);break}h=h.parentNode}})}},e.toolbarUI.prototype.showLayout=function(){this._visible=!0,this.layoutBtn.style.transform="rotate(180deg) translateX(0px) translateY(0px)",e.animate(this.div,{bottom:this.obj.config.padding-10},{bottom:this.obj.config.padding+135},this.obj.config.anim.duration,this.obj.config.anim.func),e.animate(this.layouts,{bottom:-145},{bottom:0},this.obj.config.anim.duration,this.obj.config.anim.func)},e.toolbarUI.prototype.hideLayout=function(){this._visible=!1,this.layoutBtn.style.transform="rotate(0deg) translateX(0px) translateY(0px)",e.animate(this.div,{bottom:this.obj.config.padding+135},{bottom:this.obj.config.padding-10},this.obj.config.anim.duration,this.obj.config.anim.func),e.animate(this.layouts,{bottom:0},{bottom:-145},this.obj.config.anim.duration,this.obj.config.anim.func)},e.notifierUI=function(){},e.notifierUI.prototype.init=function(t){this.obj=t},e.notifierUI.prototype.show=function(t,n){if(t==null)return!1;t==1&&(t=e.MAX_NODES_MESS,n="#FFCA28"),t==2&&(t=e.OFFLINE_MESS,n="#FFCA28");var r=document.createElement("div");r.innerHTML=t,Object.assign(r.style,{position:"absolute","background-color":n,color:"#ffffff",padding:"15px","border-radius":"40px",opacity:0,overflow:"hidden","white-space":"nowrap","text-align":"center"}),this.obj.element.appendChild(r);var s=this.obj.width()/2-r.offsetWidth/2,o=this.obj.height()/2-r.offsetHeight/2;r.style.left=s+"px",r.style.top=o+"px";var a=r.offsetWidth;return r.style.width="20px",e.animate(r,{opacity:0,width:10},{opacity:1,width:a},this.obj.config.anim.duration,this.obj.config.anim.func),!0},e===void 0&&(e={}),e._validateConfig=function(t){return!!t||(console.error("config is not defined"),!1)},e._arrayContains=function(t,n){if(t&&Array.isArray(t)){for(var r=t.length;r--;)if(t[r]===n)return!0}return!1},e._interceptions=function(t,n){if(!t)return[];if(!n)return[];var r=[];if(Array.isArray(t)&&Array.isArray(n))for(var s in t)for(var o in n)t[s]==n[o]&&r.push(t[s]);else if(Array.isArray(t)&&!Array.isArray(n))for(var s in t)for(var o in n)t[s]==o&&r.push(t[s]);else if(!Array.isArray(t)&&Array.isArray(n))for(var s in t)for(var o in n)s==n[o]&&r.push(n[o]);return r},e._getTags=function(t){return t.tags&&!Array.isArray(t.tags)?t.tags.split(","):t.tags&&Array.isArray(t.tags)?t.tags:[]},e._centerPointInPercent=function(t,n,r){var s=t.getBoundingClientRect(),o=n-s.left,a=r-s.top;return[o/(s.width/100),a/(s.height/100)]},e._trim=function(t){return t.replace(/^\s+|\s+$/g,"")},e._getTransform=function(t){var n=t.getAttribute("transform");return n=n.replace("matrix","").replace("(","").replace(")",""),e._browser().msie&&(n=n.replace(/ /g,",")),n="["+(n=e._trim(n))+"]",n=JSON.parse(n)},e.getScale=function(t,n,r,s,o,a,l,c){var u=1;if(t||s!==e.match.boundary)if(t||s!==e.match.width)if(t||s!==e.match.height)if(t){var h,d;u=(h=n/t[2])>(d=r/t[3])?d:h}else u=s;else u=r/c;else u=n/l;else u=(h=n/l)>(d=r/c)?d:h;return u&&u>o&&(u=o),u&&u<a&&(u=a),u},e.isObject=function(t){return t&&typeof t=="object"&&!Array.isArray(t)&&t!==null},e.fileUploadDialog=function(t){var n=document.createElement("INPUT");n.setAttribute("type","file"),n.style.display="none",n.onchange=function(){var r=this.files[0];t(r)},document.body.appendChild(n),n.click()},e.mergeDeep=function(t,n){if(e.isObject(t)&&e.isObject(n))for(var r in n)e.isObject(n[r])?(t[r]||Object.assign(t,{[r]:{}}),e.mergeDeep(t[r],n[r])):Object.assign(t,{[r]:n[r]});return t},e._lblIsImg=function(t,n){return!(!t.nodeBinding||typeof n!="string"||n.indexOf("img")==-1||!t.nodeBinding[n])},e._getFistImgField=function(t){if(t.nodeBinding){for(var n in t.nodeBinding)if(n.indexOf("img")!=-1)return t.nodeBinding[n]}return!1},e._fieldIsImg=function(t,n){if(t.nodeBinding){for(var r in t.nodeBinding)if(t.nodeBinding[r]==n)return e._lblIsImg(t,r)}return!1},e._guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e.htmlRipple=function(t){var n=document.createElement("style");n.type="text/css",n.innerHTML=" .bft-ripple-container {position: absolute; top: 0; right: 0; bottom: 0; left: 0; } .bft-ripple-container span {transform: scale(0);border-radius:100%;position:absolute;opacity:0.75;background-color:#fff;animation: bft-ripple 1000ms; }@-moz-keyframes bft-ripple {to {opacity: 0;transform: scale(2);}}@-webkit-keyframes bft-ripple {to {opacity: 0;transform: scale(2);}}@-o-keyframes bft-ripple {to {opacity: 0;transform: scale(2);}}@keyframes bft-ripple {to {opacity: 0;transform: scale(2);}}",document.head.appendChild(n);var r,s,o,a=document.createElement("div");a.className="bft-ripple-container",t.addEventListener("mousedown",function(l){var c,u,h,d,p;return u=document.createElement("span"),h=this.offsetWidth,c=this.getBoundingClientRect(),p=l.pageX-c.left-h/2,d="top:"+(l.pageY-c.top-h/2)+"px; left: "+p+"px; height: "+h+"px; width: "+h+"px;",t.rippleContainer.appendChild(u),u.setAttribute("style",d)}),t.addEventListener("mouseup",(r=function(){for(;this.rippleContainer.firstChild;)this.rippleContainer.removeChild(this.rippleContainer.firstChild)},s=2e3,o=void 0,function(){var l,c;return c=this,l=arguments,clearTimeout(o),o=setTimeout(function(){return r.apply(c,l)},s)})),t.rippleContainer=a,t.appendChild(a)},e._moveToBoundaryArea=function(t,n,r,s){var o=n.slice(0);n[0]<r.left&&n[0]<r.right&&(o[0]=r.left>r.right?r.right:r.left),n[0]>r.right&&n[0]>r.left&&(o[0]=r.left>r.right?r.left:r.right),n[1]<r.top&&n[1]<r.bottom&&(o[1]=r.top>r.bottom?r.bottom:r.top),n[1]>r.bottom&&n[1]>r.top&&(o[1]=r.top>r.bottom?r.top:r.bottom),n[0]!==o[0]||n[1]!==o[1]?e.animate(t,{viewBox:n},{viewBox:o},300,e.anim.outPow,function(){s&&s()}):s&&s()},e.randomId=function(){return"_"+("0000"+(Math.random()*Math.pow(36,4)|0).toString(36)).slice(-4)},e._getClientXY=function(t){return t.type.indexOf("touch")==-1?{x:t.clientX,y:t.clientY}:t.changedTouches.length?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:void 0},e._getClientTouchesXY=function(t,n){return t.type.indexOf("touch")!=-1?t.touches.length<n+1?{x:null,y:null}:{x:t.touches[n].clientX,y:t.touches[n].clientY}:{x:t.clientX,y:t.clientY}},e._getOffset=function(t,n){t&&(n.x+=t.offsetLeft,n.y+=t.offsetTop,e._getOffset(t.offsetParent,n))},e._getTopLeft=function(t){var n={x:0,y:0};return e._getOffset(t,n),n},e._getOffsetXY=function(t,n){if(n.type.indexOf("touch")==-1)return{x:n.offsetX,y:n.offsetY};if(n.touches.length){var r=e._getTopLeft(t);return{x:n.touches[0].pageX-r.x,y:n.touches[0].pageY-r.y}}if(n.changedTouches.length)return r=e._getTopLeft(t),isNaN(r.x)||isNaN(r.y)?{x:n.changedTouches[0].pageX,y:n.changedTouches[0].pageY}:{x:n.changedTouches[0].pageX-r.x,y:n.changedTouches[0].pageY-r.y}},e._pinchMiddlePointInPercent=function(t,n,r,s){var o=e._getTopLeft(t),a=s.touches[0].pageX-o.x,l=s.touches[0].pageY-o.y,c=s.touches[1].pageX-o.x,u=s.touches[1].pageY-o.y;return[((a-c)/2+c)/(n/100),((l-u)/2+u)/(r/100)]},e._browser=function(){var t=!!window.opr&&!!window.opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,n=typeof InstallTrigger<"u",r=/constructor/i.test(window.HTMLElement)||(!window.safari||window.safari!==void 0&&safari.pushNotification).toString()==="[object SafariRemoteNotification]",s=!!document.documentMode,o=!s&&!!window.StyleMedia,a=!(!window.chrome||!window.chrome.webstore&&!window.chrome.runtime);return{opera:t,firefox:n,safari:r,msie:s,edge:o,chrome:a,blink:(a||t)&&!!window.CSS}},e._menuPosition=function(t,n,r){var s=t.getBoundingClientRect(),o=r.getBoundingClientRect(),a=n.getBoundingClientRect(),l=s.left-o.left,c=s.top-o.top;return s.top+a.height>o.top+o.height&&(c-=a.height),s.left-a.width<o.left&&(l+=a.width),{x:l,y:c}},e._getTemplate=function(t,n,r){if(Array.isArray(t))for(var s=0;s<t.length;s++){var o=n[t[s]];if(o&&o.template)return o.template}return r},e._getMin=function(t,n){if(t.tags&&t.tags.length&&n.tags)for(var r=0;r<t.tags.length;r++){var s=n.tags[t.tags[r]];if(s&&s.min===!0)return!0}return n.min},e._getSubLevels=function(t,n){if(t&&t.length)for(var r=0;r<t.length;r++){var s=n[t[r]];if(s&&s.subLevels)return s.subLevels}return 0},e._isHTML=function(t){var n=new DOMParser().parseFromString(t,"text/html");return Array.from(n.body.childNodes).some(r=>r.nodeType===1)},e._getTestDiv=function(){var t=document.getElementById("orgfamily_js_test_div");return t||((t=document.createElement("div")).id="orgfamily_js_test_div",t.style.position="fixed",t.style.top="-10000px",t.style.left="-10000px",document.body.appendChild(t)),t},e._getLabelSize=function(t){var n=e._getTestDiv();return n.innerHTML="<svg>"+t+"</svg>",n.querySelector("text").getBoundingClientRect()},e.wrapText=function(t,n){var r=n.toLowerCase();if(r.indexOf("<text")==-1||r.indexOf(e.attr.width)==-1||r.indexOf("foreignobject")!=-1||n.indexOf(e.attr.width)==-1||e.ESCAPE_HTML&&typeof str=="string"&&e._isHTML(t))return e._escapeHtml(t);if(!e.ESCAPE_HTML&&e._isHTML(t))return t;var s=e._getTestDiv();n=n.replaceAll("{cw}",0),s.innerHTML="<svg>"+n+"</svg>";var o,a,l=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("text")[0],c=parseFloat(l.getAttribute("x")),u=parseFloat(l.getAttribute("y")),h=l.getAttribute("text-anchor"),d=l.getAttribute(e.attr.width),p=l.getAttribute(e.attr.text_overflow),g="http://www.w3.org/2000/svg",_=s.getElementsByTagName("svg")[0].getElementsByTagName("text")[0];p||(p="ellipsis");var v=p.split("-");if(v.length>1&&(o=parseInt(p.split("-")[1]),v.length>2&&v[2]=="ellipsis"&&(a=!0)),!d)return e._escapeHtml(t);if(d=parseFloat(d),c||(c=0),u||(u=0),c||(h="start"),p=="ellipsis"){_.removeChild(_.firstChild),_.textContent=t;for(var C=_.getComputedTextLength(),T=2;C>d;)_.textContent=t.substring(0,t.length-T),_.textContent+="...",C=_.getComputedTextLength(),T++;return T>2?`<title>${e._escapeHtml(t)}</title>${_.textContent}`:e._escapeHtml(t)}if(p.indexOf("multiline")!=-1){var y=t.split(" "),A=_.getBBox().height;_.textContent="";var E=document.createElementNS(g,"tspan"),x=document.createTextNode(y[0]);E.setAttributeNS(null,"x",c),E.setAttributeNS(null,"y",u),E.setAttributeNS(null,"text-anchor",h),E.appendChild(x),_.appendChild(E),T=1;for(var w=1,S=!1,I=1;I<y.length;I++){var k=E.firstChild.data.length;if(E.firstChild.data+=" "+y[I],E.getComputedTextLength()>d){if(E.firstChild.data=E.firstChild.data.slice(0,k),w++,o&&w>o){if(a&&_.children.length==o){var P=_.children[o-1].textContent;_.children[o-1].textContent=P.substring(0,P.length-3)+"...",S=!0}break}(E=document.createElementNS(g,"tspan")).setAttributeNS(null,"x",c),E.setAttributeNS(null,"y",u+A*T),E.setAttributeNS(null,"text-anchor",h),x=document.createTextNode(y[I]),E.appendChild(x),_.appendChild(E),T++}}var O="";if(_.innerHTML!=null)O=_.innerHTML,_.innerHTML="";else{var R="";for(I=_.childNodes.length-1;I>=0;I--)R=XMLSerializer().serializeToString(_.childNodes[I])+R,_.removeChild(_.childNodes[I]);O=R}return S?`<title>${e._escapeHtml(t)}</title>${O}`:O}},e._downloadFile=function(t,n,r,s,o){var a=new Blob([n],{type:t});if(s==1){var l=URL.createObjectURL(a);window.open(l,"_blank").focus()}else if(navigator.msSaveBlob)navigator.msSaveBlob(a,r);else{var c=document.createElement("a");if(c.download!==void 0){l=URL.createObjectURL(a),c.setAttribute("href",l);var u=r;u.toLowerCase().endsWith(o.toLowerCase())||(u=u+"."+o),c.setAttribute("download",u),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}}},e._getPosition=function(t,n,r,s){var o={x:n.x,y:n.y};if(r!=null&&(o.x=r),s!=null&&(o.y=r),t&&t.length==3){var a=t[0].indexOf(n.id);a!=-1&&t[1][a].transform!=null&&(r==null&&(o.x=t[1][a].transform[4]),s==null&&(o.y=t[1][a].transform[5]))}return o},e._getOpacity=function(t,n){var r=1;if(t&&t.length==3){var s=t[0].indexOf(n.id);s!=-1&&t[1][s].opacity!=null&&(r=t[1][s].opacity)}return r},e.t=function(t,n,r){var s=e.templates[t];s==null&&console.error(`Template "${t}" does not exist!`);var o=null;if(r!=null&&s.scaleLessThen){var a=[];for(var l in s.scaleLessThen){var c=parseFloat(l);r<c&&a.push(c)}if(a.length>0){a.sort(function(d,p){return d-p});var u=s.scaleLessThen[a[0]];for(var h in u)o==null&&(o=Object.assign({},s)),o[h]=u[h]}}return n?o==null?s.min?s.min:s:o.min?o.min:o:o??s},e.setNodeSize=function(t){var n=e.t(t.templateName,t.min);t.w=n&&n.size?n.size[0]:0,t.h=n&&n.size?n.size[1]:0},e._imgs2base64=function(t,n,r,s){var o=t.getElementsByTagName(n),a=o.length;a==0&&s();for(var l=0;l<a;l++)(function(){var c=l,u=o[c];e._getDataUri(u.getAttribute(r),function(h){h.success&&u.setAttribute(r,h.result),c==a-1&&s()})})()},e._getDataUri=function(t,n){if(t.indexOf("base64")!=-1)n({success:!1});else{var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){r.status===200?s.readAsDataURL(r.response):r.status===404&&n({success:!1,result:r.status})};var s=new FileReader;s.onloadend=function(){n({success:!0,result:s.result})},r.send()}},e._convertStringToArray=function(t,n){return e.ARRAY_FIELDS.indexOf(t)!=-1?e.isNEU(n)?[]:n.split(","):n},e._convertArrayToString=function(t){return!e.isNEU(t)&&Array.isArray(t)?t.join():t},e._csvToArray=function(t,n){n=n||e.CSV_DELIMITER;for(var r=new RegExp("(\\"+n+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+n+"\\r\\n]*))","gi"),s=[[]],o=null;o=r.exec(t);){var a,l=o[1];l.length&&l!==n&&s.push([]),a=o[2]?o[2].replace(new RegExp('""',"g"),'"'):o[3],s[s.length-1].push(a)}return s},e._json2xml=function(t){for(var n=document.implementation.createDocument("","",null),r=n.createElement("nodes"),s=0;s<t.length;s++){var o=n.createElement("node"),a=t[s];for(var l in a){var c=a[l];o.setAttribute(l,e._convertArrayToString(c))}r.appendChild(o)}return n.appendChild(r),'<?xml version="1.0" encoding="utf-8" ?>'+new XMLSerializer().serializeToString(n.documentElement)},e._xml2json=function(t){for(var n=new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("node"),r=[],s=0;s<n.length;s++){for(var o=n[s],a={},l=0;l<o.attributes.length;l++){var c=o.attributes[l];a[c.name]=e._convertStringToArray(c.name,c.value)}r.push(a)}return r},e.convertNodesToCsv=function(t){return e._json2csv(t)},e._json2csv=function(t){for(var n=[],r=function(l){for(var c="",u=0;u<n.length;u++){var h;(h=n[u]=="reportsTo"?null:l[n[u]]==null?"":l[n[u]])instanceof Date&&(h=h.toLocaleString());var d=(h=h===null?"":h.toString()).replace(/"/g,'""'),p=new RegExp(`("|;|
)`,"g");d.search(p)>=0&&(d='"'+d+'"'),u>0&&(c+=e.CSV_DELIMITER),c+=d}return c+`
`},s="",o=0;o<t.length;o++)for(var a in t[o])e._arrayContains(n,a)||(n.push(a),s+=a+e.CSV_DELIMITER);for(s=s.substring(0,s.length-1),s+=`
`,o=0;o<t.length;o++)s+=r(t[o]);return s=s.substring(0,s.length-1)},e.accentFold=function(t){return(t=t.toString().toLowerCase()).replace(/([àáâãäå])|([ç])|([èéêë])|([ìíîï])|([ñ])|([òóôõöø])|([ß])|([ùúûü])|([ÿ])|([æ])/g,function(n,r,s,o,a,l,c,u,h,d,p){return r?"a":s?"c":o?"e":a?"i":l?"n":c?"o":u?"s":h?"u":d?"y":p?"ae":void 0})},e.copy=function(t){if(t===null||typeof t!="object"||"isActiveClone"in t)return t;if(t instanceof Date)var n=new t.constructor;else n=t.constructor();for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t.isActiveClone=null,n[r]=e.copy(t[r]),delete t.isActiveClone);return n},e._getScrollSensitivity=function(){var t=e._browser();return t.msie&&e.scroll.ie?e.scroll.ie:t.edge&&e.scroll.edge?e.scroll.edge:t.safari&&e.scroll.safari?e.scroll.safari:t.chrome&&e.scroll.chrome?e.scroll.chrome:t.firefox&&e.scroll.firefox?e.scroll.firefox:t.opera&&e.scroll.opera?e.scroll.opera:{smooth:e.scroll.smooth,speed:e.scroll.speed}},e.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},e.isTrial=function(){return e.remote!==void 0},e.childrenCount=function(t,n){for(var r=0,s=0;s<n.childrenIds.length;s++)t.nodes[n.childrenIds[s]]&&r++;return r},e.childrenTotalCount=function(t,n){for(var r=0,s=0;s<n.childrenIds.length;s++){var o=t.nodes[n.childrenIds[s]];o&&(r++,r+=e.childrenTotalCount(t,o))}return r},e.collapsedChildrenCount=function(t,n){for(var r=0,s=0;s<n.childrenIds.length;s++){var o=t.nodes[n.childrenIds[s]];o&&o.collapsed===!0&&r++}return r},e.collapsedChildrenTotalCount=function(t,n,r){for(var s=0,o=0;o<n.childrenIds.length;o++){var a=t.nodes[n.childrenIds[o]];a&&((r||a.collapsed===!0)&&s++,s+=e.collapsedChildrenTotalCount(t,a,!0))}return s},e._setMinMaxXY=function(t,n){(n.minX==null||t.x!=null&&t.x<n.minX)&&(n.minX=t.x),(n.minY==null||t.y!=null&&t.y<n.minY)&&(n.minY=t.y),(n.maxX==null||t.x!=null&&t.x+t.w>n.maxX)&&(n.maxX=t.x+t.w),(n.maxY==null||t.y!=null&&t.y+t.h>n.maxY)&&(n.maxY=t.y+t.h)},e.getStParentNodes=function(t,n){for(n||(n=[]);t.parent;)t=t.parent;return t.stParent&&(n.push(t.stParent),e.getStParentNodes(t.stParent,n)),n},e.getRootOf=function(t){for(;t&&t.parent;)t=t.parent;return t},e._getViewBox=function(t){var n=null;return t?(n=(n="["+(n=t.getAttribute("viewBox"))+"]").replace(/\ /g,","),n=JSON.parse(n)):null},e.isNEU=function(t){return t==null||t===""},e.gradientCircleForDefs=function(t,n,r,s){function o(l,c,u,h){var d=(h-90)*Math.PI/180;return{x:l+u*Math.cos(d),y:c+u*Math.sin(d)}}function a(l,c,u,h,d){var p=o(l,c,u,d),g=o(l,c,u,h),_=d-h<=180?"0":"1";return["M",p.x,p.y,"A",u,u,0,_,0,g.x,g.y].join(" ")}return Array.isArray(n)||(n=[n,n,n,n,n,n]),`<linearGradient id="${t}_linearColors1" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="${n[0]}"></stop>
            <stop offset="100%" stop-color="${n[1]}"></stop>
        </linearGradient>
        <linearGradient id="${t}_linearColors2" x1="0.5" y1="0" x2="0.5" y2="1">
            <stop offset="0%" stop-color="${n[1]}"></stop>
            <stop offset="100%" stop-color="${n[2]}"></stop>
        </linearGradient>
        <linearGradient id="${t}_linearColors3" x1="1" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="${n[2]}"></stop>
            <stop offset="100%" stop-color="${n[3]}"></stop>
        </linearGradient>
        <linearGradient id="${t}_linearColors4" x1="1" y1="1" x2="0" y2="0">
            <stop offset="0%" stop-color="${n[3]}"></stop>
            <stop offset="100%" stop-color="${n[4]}"></stop>
        </linearGradient>
        <linearGradient id="${t}_linearColors5" x1="0.5" y1="1" x2="0.5" y2="0">
            <stop offset="0%" stop-color="${n[4]}"></stop>
            <stop offset="100%" stop-color="${n[5]}"></stop>
        </linearGradient>
        <linearGradient id="${t}_linearColors6" x1="0" y1="1" x2="1" y2="0">
            <stop offset="0%" stop-color="${n[5]}"></stop>
            <stop offset="100%" stop-color="${n[0]}"></stop>
        </linearGradient>        
        <g id="${t}">
            <path stroke-width="${s}" fill="none" stroke="url(#${t}_linearColors1)" d="${a(r,r,r,1,60)}"  />
            <path stroke-width="${s}" fill="none" stroke="url(#${t}_linearColors2)" d="${a(r,r,r,60,120)}"/>
            <path stroke-width="${s}" fill="none" stroke="url(#${t}_linearColors3)" d="${a(r,r,r,120,180)}" />
            <path stroke-width="${s}" fill="none" stroke="url(#${t}_linearColors4)" d="${a(r,r,r,180,240)}" />
            <path stroke-width="${s}" fill="none" stroke="url(#${t}_linearColors5)" d="${a(r,r,r,240,300)}" />
            <path stroke-width="${s}" fill="none" stroke="url(#${t}_linearColors6)" d="${a(r,r,r,300,1)}"/>
        </g>`},e._intersectionObserver=function(t,n){typeof IntersectionObserver=="function"?new IntersectionObserver(function(r,s){r.forEach(function(o){var a=o.intersectionRatio>0;o.intersectionRatio==0&&(a=o.isIntersecting),n(a)})}).observe(t):n(!0)},e.convertCsvToNodes=function(t){for(var n=e._csvToArray(t),r=n[0],s=[],o=1;o<n.length;o++){for(var a={},l=0;l<n[o].length;l++){var c=r[l],u=n[o][l];a[r[l]]=e._convertStringToArray(c,u)}a.id.trim()!=""&&s.push(a)}return s},e._escapeHtml=function(t){return e.ESCAPE_HTML&&typeof t=="string"?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):t},e._escapeDoubleQuotes=function(t){return typeof t=="string"?t.replace(/"/g,"&quot;"):t},e._escapeGreaterLessSign=function(t){return typeof t=="string"?t.replace(/</g,"&lt;").replace(/>/g,"&gt;"):t},e.roundPathCorners=function(t,n,r){function s(I,k,P){var O=k.x-I.x,R=k.y-I.y,K=Math.sqrt(O*O+R*R);return o(I,k,Math.min(1,P/K))}function o(I,k,P){return{x:I.x+(k.x-I.x)*P,y:I.y+(k.y-I.y)*P}}function a(I,k){I.length>2&&(I[I.length-2]=k.x,I[I.length-1]=k.y)}function l(I){return{x:parseFloat(I[I.length-2]),y:parseFloat(I[I.length-1])}}Array.isArray(t)||(t=(t=t.split(/[,\s]/).reduce(function(I,k){var P=k.match("([a-zA-Z])(.+)");return P?(I.push(P[1]),I.push(P[2])):I.push(k),I},[])).reduce(function(I,k){return parseFloat(k)==k&&I.length?I[I.length-1].push(k):I.push([k]),I},[]));var c=[];if(t.length>1){var u=l(t[0]),h=null;t[t.length-1][0]=="Z"&&t[0].length>2&&(h=["L",u.x,u.y],t[t.length-1]=h),c.push(t[0]);for(var d=1;d<t.length;d++){var p=c[c.length-1],g=t[d],_=g==h?t[1]:t[d+1];if(_&&p&&p.length>2&&g[0]=="L"&&_.length>2&&_[0]=="L"){var v,C,T=l(p),y=l(g),A=l(_);r?(v=o(y,p.origPoint||T,n),C=o(y,_.origPoint||A,n)):(v=s(y,T,n),C=s(y,A,n)),a(g,v),g.origPoint=y,c.push(g);var E=o(v,y,.5),x=o(y,C,.5),w=["C",E.x,E.y,x.x,x.y,C.x,C.y];w.origPoint=y,c.push(w)}else c.push(g)}if(h){var S=l(c[c.length-1]);c.push(["Z"]),a(c[0],S)}}else c=t;return c.reduce(function(I,k){return I+k.join(" ")+" "},"")},e._isMoved=function(t){return t.movex!=null||t.movey!=null},e._getDynamicGridCoulumns=function(t){for(var n=1;n<t&&!(t/n-n<=0);n++);return n%2!=0&&n>2&&n--,n},e._changeRootOption=function(t,n,r){for(var s=[],o=0;o<n.length;o++)for(var a=0;a<r.length;a++)if(r[a].has(n[o])){s=r[a];break}for(o=0;o<s.length;o++){var l=t.indexOf(s[o]);l!=-1&&t.splice(l,1)}n.length&&t.push(n[0])},e._convertStringToArrayOnImport=function(t,n){return t=="tags"||t=="pids"?e.isNEU(n)?[]:n.split(","):n},e.isObject=function(t){return t&&typeof t=="object"&&!Array.isArray(t)&&t!==null&&t.constructor&&t.constructor.name.toLowerCase()=="object"},e===void 0&&(e={}),e.icon={},e.icon.png=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 550.801 550.801"><path fill="'+r+'" d="M146.747,276.708c0-13.998-9.711-22.352-26.887-22.352c-6.99,0-11.726,0.675-14.204,1.355v44.927 c2.932,0.676,6.539,0.896,11.52,0.896C135.449,301.546,146.747,292.28,146.747,276.708z"/><path fill="'+r+'" d="M488.426,197.019H475.2v-63.816c0-0.398-0.063-0.799-0.116-1.202c-0.021-2.534-0.827-5.023-2.562-6.995L366.325,3.694 c-0.032-0.031-0.063-0.042-0.085-0.076c-0.633-0.707-1.371-1.295-2.151-1.804c-0.231-0.155-0.464-0.285-0.706-0.419 c-0.676-0.369-1.393-0.675-2.131-0.896c-0.2-0.056-0.38-0.138-0.58-0.19C359.87,0.119,359.037,0,358.193,0H97.2 c-11.918,0-21.6,9.693-21.6,21.601v175.413H62.377c-17.049,0-30.873,13.818-30.873,30.873v160.545 c0,17.043,13.824,30.87,30.873,30.87h13.224V529.2c0,11.907,9.682,21.601,21.6,21.601h356.4c11.907,0,21.6-9.693,21.6-21.601 V419.302h13.226c17.044,0,30.871-13.827,30.871-30.87v-160.54C519.297,210.838,505.47,197.019,488.426,197.019z M97.2,21.605 h250.193v110.513c0,5.967,4.841,10.8,10.8,10.8h95.407v54.108H97.2V21.605z M234.344,335.86v45.831h-31.601V229.524h40.184 l31.611,55.759c9.025,16.031,18.064,34.983,24.825,52.154h0.675c-2.257-20.103-2.933-40.643-2.933-63.44v-44.473h31.614v152.167 h-36.117l-32.516-58.703c-9.049-16.253-18.971-35.892-26.438-53.727l-0.665,0.222C233.906,289.58,234.344,311.027,234.344,335.86z M71.556,381.691V231.56c10.613-1.804,25.516-3.159,46.506-3.159c21.215,0,36.353,4.061,46.509,12.192 c9.698,7.673,16.255,20.313,16.255,35.219c0,14.897-4.959,27.549-13.999,36.123c-11.738,11.063-29.123,16.031-49.441,16.031 c-4.522,0-8.593-0.231-11.736-0.675v54.411H71.556V381.691z M453.601,523.353H97.2V419.302h356.4V523.353z M485.652,374.688 c-10.61,3.607-30.713,8.585-50.805,8.585c-27.759,0-47.872-7.003-61.857-20.545c-13.995-13.1-21.684-32.97-21.452-55.318 c0.222-50.569,37.03-79.463,86.917-79.463c19.644,0,34.783,3.829,42.219,7.446l-7.214,27.543c-8.369-3.617-18.752-6.55-35.458-6.55 c-28.656,0-50.341,16.256-50.341,49.22c0,31.382,19.649,49.892,47.872,49.892c7.895,0,14.218-0.901,16.934-2.257v-31.835h-23.493 v-26.869h56.679V374.688z"/></svg>'},e.icon.pdf=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 550.801 550.801"><path fill="'+r+'" d="M160.381,282.225c0-14.832-10.299-23.684-28.474-23.684c-7.414,0-12.437,0.715-15.071,1.432V307.6 c3.114,0.707,6.942,0.949,12.192,0.949C148.419,308.549,160.381,298.74,160.381,282.225z"/><path fill="'+r+'" d="M272.875,259.019c-8.145,0-13.397,0.717-16.519,1.435v105.523c3.116,0.729,8.142,0.729,12.69,0.729 c33.017,0.231,54.554-17.946,54.554-56.474C323.842,276.719,304.215,259.019,272.875,259.019z"/><path fill="'+r+'" d="M488.426,197.019H475.2v-63.816c0-0.398-0.063-0.799-0.116-1.202c-0.021-2.534-0.827-5.023-2.562-6.995L366.325,3.694 c-0.032-0.031-0.063-0.042-0.085-0.076c-0.633-0.707-1.371-1.295-2.151-1.804c-0.231-0.155-0.464-0.285-0.706-0.419 c-0.676-0.369-1.393-0.675-2.131-0.896c-0.2-0.056-0.38-0.138-0.58-0.19C359.87,0.119,359.037,0,358.193,0H97.2 c-11.918,0-21.6,9.693-21.6,21.601v175.413H62.377c-17.049,0-30.873,13.818-30.873,30.873v160.545 c0,17.043,13.824,30.87,30.873,30.87h13.224V529.2c0,11.907,9.682,21.601,21.6,21.601h356.4c11.907,0,21.6-9.693,21.6-21.601 V419.302h13.226c17.044,0,30.871-13.827,30.871-30.87v-160.54C519.297,210.838,505.47,197.019,488.426,197.019z M97.2,21.605 h250.193v110.513c0,5.967,4.841,10.8,10.8,10.8h95.407v54.108H97.2V21.605z M362.359,309.023c0,30.876-11.243,52.165-26.82,65.333 c-16.971,14.117-42.82,20.814-74.396,20.814c-18.9,0-32.297-1.197-41.401-2.389V234.365c13.399-2.149,30.878-3.346,49.304-3.346 c30.612,0,50.478,5.508,66.039,17.226C351.828,260.69,362.359,280.547,362.359,309.023z M80.7,393.499V234.365 c11.241-1.904,27.042-3.346,49.296-3.346c22.491,0,38.527,4.308,49.291,12.928c10.292,8.131,17.215,21.534,17.215,37.328 c0,15.799-5.25,29.198-14.829,38.285c-12.442,11.728-30.865,16.996-52.407,16.996c-4.778,0-9.1-0.243-12.435-0.723v57.67H80.7 V393.499z M453.601,523.353H97.2V419.302h356.4V523.353z M484.898,262.127h-61.989v36.851h57.913v29.674h-57.913v64.848h-36.593 V232.216h98.582V262.127z"/></svg>'},e.icon.svg=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 550.801 550.801"><path fill="'+r+'" d="M488.426,197.019H475.2v-63.816c0-0.398-0.063-0.799-0.116-1.202c-0.021-2.534-0.827-5.023-2.562-6.995L366.325,3.694 c-0.032-0.031-0.063-0.042-0.085-0.076c-0.633-0.707-1.371-1.295-2.151-1.804c-0.231-0.155-0.464-0.285-0.706-0.419 c-0.676-0.369-1.393-0.675-2.131-0.896c-0.2-0.056-0.38-0.138-0.58-0.19C359.87,0.119,359.037,0,358.193,0H97.2 c-11.918,0-21.6,9.693-21.6,21.601v175.413H62.377c-17.049,0-30.873,13.818-30.873,30.873v160.545 c0,17.043,13.824,30.87,30.873,30.87h13.224V529.2c0,11.907,9.682,21.601,21.6,21.601h356.4c11.907,0,21.6-9.693,21.6-21.601 V419.302h13.226c17.044,0,30.871-13.827,30.871-30.87v-160.54C519.297,210.838,505.47,197.019,488.426,197.019z M97.2,21.605 h250.193v110.513c0,5.967,4.841,10.8,10.8,10.8h95.407v54.108H97.2V21.605z M338.871,225.672L284.545,386.96h-42.591 l-51.69-161.288h39.967l19.617,68.196c5.508,19.143,10.531,37.567,14.36,57.67h0.717c4.061-19.385,9.089-38.527,14.592-56.953 l20.585-68.918h38.77V225.672z M68.458,379.54l7.415-30.153c9.811,5.021,24.888,10.051,40.439,10.051 c16.751,0,25.607-6.935,25.607-17.465c0-10.052-7.662-15.795-27.05-22.734c-26.8-9.328-44.263-24.168-44.263-47.611 c0-27.524,22.971-48.579,61.014-48.579c18.188,0,31.591,3.823,41.159,8.131l-8.126,29.437c-6.465-3.116-17.945-7.657-33.745-7.657 c-15.791,0-23.454,7.183-23.454,15.552c0,10.296,9.089,14.842,29.917,22.731c28.468,10.536,41.871,25.365,41.871,48.094 c0,27.042-20.812,50.013-65.09,50.013C95.731,389.349,77.538,384.571,68.458,379.54z M453.601,523.353H97.2V419.302h356.4V523.353z M488.911,379.54c-11.243,3.823-32.537,9.103-53.831,9.103c-29.437,0-50.73-7.426-65.57-21.779 c-14.839-13.875-22.971-34.942-22.738-58.625c0.253-53.604,39.255-84.235,92.137-84.235c20.81,0,36.852,4.073,44.74,7.896 l-7.657,29.202c-8.859-3.829-19.849-6.95-37.567-6.95c-30.396,0-53.357,17.233-53.357,52.173c0,33.265,20.81,52.882,50.73,52.882 c8.375,0,15.072-0.96,17.94-2.395v-33.745h-24.875v-28.471h60.049V379.54L488.911,379.54z" /></svg>'},e.icon.csv=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 548.29 548.291" ><path fill="'+r+'" d="M486.2,196.121h-13.164V132.59c0-0.399-0.064-0.795-0.116-1.2c-0.021-2.52-0.824-5-2.551-6.96L364.656,3.677 c-0.031-0.034-0.064-0.044-0.085-0.075c-0.629-0.707-1.364-1.292-2.141-1.796c-0.231-0.157-0.462-0.286-0.704-0.419 c-0.672-0.365-1.386-0.672-2.121-0.893c-0.199-0.052-0.377-0.134-0.576-0.188C358.229,0.118,357.4,0,356.562,0H96.757 C84.893,0,75.256,9.649,75.256,21.502v174.613H62.093c-16.972,0-30.733,13.756-30.733,30.73v159.81 c0,16.966,13.761,30.736,30.733,30.736h13.163V526.79c0,11.854,9.637,21.501,21.501,21.501h354.777 c11.853,0,21.502-9.647,21.502-21.501V417.392H486.2c16.966,0,30.729-13.764,30.729-30.731v-159.81 C516.93,209.872,503.166,196.121,486.2,196.121z M96.757,21.502h249.053v110.006c0,5.94,4.818,10.751,10.751,10.751h94.973v53.861 H96.757V21.502z M258.618,313.18c-26.68-9.291-44.063-24.053-44.063-47.389c0-27.404,22.861-48.368,60.733-48.368 c18.107,0,31.447,3.811,40.968,8.107l-8.09,29.3c-6.43-3.107-17.862-7.632-33.59-7.632c-15.717,0-23.339,7.149-23.339,15.485 c0,10.247,9.047,14.769,29.78,22.632c28.341,10.479,41.681,25.239,41.681,47.874c0,26.909-20.721,49.786-64.792,49.786 c-18.338,0-36.449-4.776-45.497-9.77l7.38-30.016c9.772,5.014,24.775,10.006,40.264,10.006c16.671,0,25.488-6.908,25.488-17.396 C285.536,325.789,277.909,320.078,258.618,313.18z M69.474,302.692c0-54.781,39.074-85.269,87.654-85.269 c18.822,0,33.113,3.811,39.549,7.149l-7.392,28.816c-7.38-3.084-17.632-5.939-30.491-5.939c-28.822,0-51.206,17.375-51.206,53.099 c0,32.158,19.051,52.4,51.456,52.4c10.947,0,23.097-2.378,30.241-5.238l5.483,28.346c-6.672,3.34-21.674,6.919-41.208,6.919 C98.06,382.976,69.474,348.424,69.474,302.692z M451.534,520.962H96.757v-103.57h354.777V520.962z M427.518,380.583h-42.399 l-51.45-160.536h39.787l19.526,67.894c5.479,19.046,10.479,37.386,14.299,57.397h0.709c4.048-19.298,9.045-38.352,14.526-56.693 l20.487-68.598h38.599L427.518,380.583z" /></svg>'},e.icon.json=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 32 32" ><polygon fill="'+r+'"  points="31 11 31 21 29 21 27 15 27 21 25 21 25 11 27 11 29 17 29 11 31 11"/><path fill="'+r+'"  d="M21.3335,21h-2.667A1.6684,1.6684,0,0,1,17,19.3335v-6.667A1.6684,1.6684,0,0,1,18.6665,11h2.667A1.6684,1.6684,0,0,1,23,12.6665v6.667A1.6684,1.6684,0,0,1,21.3335,21ZM19,19h2V13H19Z"/><path fill="'+r+'"  d="M13.3335,21H9V19h4V17H11a2.002,2.002,0,0,1-2-2V12.6665A1.6684,1.6684,0,0,1,10.6665,11H15v2H11v2h2a2.002,2.002,0,0,1,2,2v2.3335A1.6684,1.6684,0,0,1,13.3335,21Z"/><path fill="'+r+'"  d="M5.3335,21H2.6665A1.6684,1.6684,0,0,1,1,19.3335V17H3v2H5V11H7v8.3335A1.6684,1.6684,0,0,1,5.3335,21Z"/><rect fill="'+r+'"  id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" style="fill: none;" width="32" height="32"/></svg>'},e.icon.excel=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 512 512"><path fill="#ECEFF1" d="M496,432.011H272c-8.832,0-16-7.168-16-16s0-311.168,0-320s7.168-16,16-16h224 c8.832,0,16,7.168,16,16v320C512,424.843,504.832,432.011,496,432.011z" /><path fill="'+r+'" d="M336,176.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,176.011,336,176.011z" /><path fill="'+r+'" d="M336,240.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,240.011,336,240.011z" /><path fill="'+r+'" d="M336,304.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,304.011,336,304.011z" /><path fill="'+r+'" d="M336,368.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,368.011,336,368.011z" /><path fill="'+r+'" d="M432,176.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,176.011,432,176.011z" /><path fill="'+r+'" d="M432,240.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,240.011,432,240.011z" /><path fill="'+r+'" d="M432,304.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,304.011,432,304.011z" /><path fill="'+r+'" d="M432,368.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,368.011,432,368.011z" /><path fill="'+r+'"  d="M282.208,19.691c-3.648-3.04-8.544-4.352-13.152-3.392l-256,48C5.472,65.707,0,72.299,0,80.011v352 c0,7.68,5.472,14.304,13.056,15.712l256,48c0.96,0.192,1.952,0.288,2.944,0.288c3.712,0,7.328-1.28,10.208-3.68 c3.68-3.04,5.792-7.584,5.792-12.32v-448C288,27.243,285.888,22.731,282.208,19.691z" /><path fill="#FAFAFA" d="M220.032,309.483l-50.592-57.824l51.168-65.792c5.44-6.976,4.16-17.024-2.784-22.464 c-6.944-5.44-16.992-4.16-22.464,2.784l-47.392,60.928l-39.936-45.632c-5.856-6.72-15.968-7.328-22.56-1.504 c-6.656,5.824-7.328,15.936-1.504,22.56l44,50.304L83.36,310.187c-5.44,6.976-4.16,17.024,2.784,22.464 c2.944,2.272,6.432,3.36,9.856,3.36c4.768,0,9.472-2.112,12.64-6.176l40.8-52.48l46.528,53.152 c3.168,3.648,7.584,5.504,12.032,5.504c3.744,0,7.488-1.312,10.528-3.968C225.184,326.219,225.856,316.107,220.032,309.483z" /></svg>'},e.icon.edit=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 528.899 528.899"><path fill="'+r+'" d="M328.883,89.125l107.59,107.589l-272.34,272.34L56.604,361.465L328.883,89.125z M518.113,63.177l-47.981-47.981 c-18.543-18.543-48.653-18.543-67.259,0l-45.961,45.961l107.59,107.59l53.611-53.611 C532.495,100.753,532.495,77.559,518.113,63.177z M0.3,512.69c-1.958,8.812,5.998,16.708,14.811,14.565l119.891-29.069 L27.473,390.597L0.3,512.69z" /></svg>'},e.icon.details=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 512 512"><path fill="'+r+'" d="M447.933,103.629c-0.034-3.076-1.224-6.09-3.485-8.352L352.683,3.511c-0.004-0.004-0.007-0.005-0.011-0.008 C350.505,1.338,347.511,0,344.206,0H89.278C75.361,0,64.04,11.32,64.04,25.237v461.525c0,13.916,11.32,25.237,25.237,25.237 h333.444c13.916,0,25.237-11.32,25.237-25.237V103.753C447.96,103.709,447.937,103.672,447.933,103.629z M356.194,40.931 l50.834,50.834h-49.572c-0.695,0-1.262-0.567-1.262-1.262V40.931z M423.983,486.763c0,0.695-0.566,1.261-1.261,1.261H89.278 c-0.695,0-1.261-0.566-1.261-1.261V25.237c0-0.695,0.566-1.261,1.261-1.261h242.94v66.527c0,13.916,11.322,25.239,25.239,25.239 h66.527V486.763z"/><path fill="'+r+'" d="M362.088,164.014H149.912c-6.62,0-11.988,5.367-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175 c6.62,0,11.988-5.368,11.988-11.988C374.076,169.381,368.707,164.014,362.088,164.014z"/><path fill="'+r+'" d="M362.088,236.353H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175 c6.62,0,11.988-5.368,11.988-11.988C374.076,241.721,368.707,236.353,362.088,236.353z"/><path fill="'+r+'" d="M362.088,308.691H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988h212.175 c6.62,0,11.988-5.367,11.988-11.988C374.076,314.06,368.707,308.691,362.088,308.691z"/><path fill="'+r+'" d="M256,381.031H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988H256 c6.62,0,11.988-5.367,11.988-11.988C267.988,386.398,262.62,381.031,256,381.031z"/></svg>'},e.icon.remove=function(t,n,r){return'<svg width="'+t+'" height="'+n+'"  viewBox="0 0 900.5 900.5"><path fill="'+r+'" d="M176.415,880.5c0,11.046,8.954,20,20,20h507.67c11.046,0,20-8.954,20-20V232.487h-547.67V880.5L176.415,880.5z M562.75,342.766h75v436.029h-75V342.766z M412.75,342.766h75v436.029h-75V342.766z M262.75,342.766h75v436.029h-75V342.766z"/><path fill="'+r+'" d="M618.825,91.911V20c0-11.046-8.954-20-20-20h-297.15c-11.046,0-20,8.954-20,20v71.911v12.5v12.5H141.874 c-11.046,0-20,8.954-20,20v50.576c0,11.045,8.954,20,20,20h34.541h547.67h34.541c11.046,0,20-8.955,20-20v-50.576 c0-11.046-8.954-20-20-20H618.825v-12.5V91.911z M543.825,112.799h-187.15v-8.389v-12.5V75h187.15v16.911v12.5V112.799z"/></svg>'},e.icon.add=function(t,n,r){return'<svg width="'+t+'" height="'+n+'"   viewBox="0 0 922 922"><path fill="'+r+'" d="M922,453V81c0-11.046-8.954-20-20-20H410c-11.045,0-20,8.954-20,20v149h318c24.812,0,45,20.187,45,45v198h149 C913.046,473.001,922,464.046,922,453z" /><path fill="'+r+'" d="M557,667.001h151c11.046,0,20-8.954,20-20v-174v-198c0-11.046-8.954-20-20-20H390H216c-11.045,0-20,8.954-20,20v149h194 h122c24.812,0,45,20.187,45,45v4V667.001z" /><path fill="'+r+'" d="M0,469v372c0,11.046,8.955,20,20,20h492c11.046,0,20-8.954,20-20V692v-12.501V667V473v-4c0-11.046-8.954-20-20-20H390H196 h-12.5H171H20C8.955,449,0,457.955,0,469z" /></svg>'},e.icon.search=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 485.213 485.213"><path fill="'+r+'" d="M471.882,407.567L360.567,296.243c-16.586,25.795-38.536,47.734-64.331,64.321l111.324,111.324 c17.772,17.768,46.587,17.768,64.321,0C489.654,454.149,489.654,425.334,471.882,407.567z" /><path fill="'+r+'" d="M363.909,181.955C363.909,81.473,282.44,0,181.956,0C81.474,0,0.001,81.473,0.001,181.955s81.473,181.951,181.955,181.951 C282.44,363.906,363.909,282.437,363.909,181.955z M181.956,318.416c-75.252,0-136.465-61.208-136.465-136.46 c0-75.252,61.213-136.465,136.465-136.465c75.25,0,136.468,61.213,136.468,136.465 C318.424,257.208,257.206,318.416,181.956,318.416z" /><path fill="'+r+'" d="M75.817,181.955h30.322c0-41.803,34.014-75.814,75.816-75.814V75.816C123.438,75.816,75.817,123.437,75.817,181.955z" /></svg>'},e.icon.xml=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 550.801 550.801"><path fill="'+r+'"  d="M488.426,197.019H475.2v-63.816c0-0.401-0.063-0.799-0.116-1.205c-0.021-2.534-0.827-5.023-2.562-6.992L366.325,3.691 c-0.032-0.031-0.063-0.042-0.085-0.073c-0.633-0.707-1.371-1.298-2.151-1.804c-0.231-0.158-0.464-0.287-0.706-0.422 c-0.676-0.366-1.393-0.675-2.131-0.896c-0.2-0.053-0.38-0.135-0.58-0.19C359.87,0.119,359.037,0,358.193,0H97.2 c-11.918,0-21.6,9.693-21.6,21.601v175.413H62.377c-17.049,0-30.873,13.818-30.873,30.87v160.542 c0,17.044,13.824,30.876,30.873,30.876h13.224V529.2c0,11.907,9.682,21.601,21.6,21.601h356.4c11.907,0,21.6-9.693,21.6-21.601 V419.302h13.226c17.044,0,30.871-13.827,30.871-30.87V227.89C519.297,210.838,505.47,197.019,488.426,197.019z M97.2,21.605 h250.193v110.51c0,5.967,4.841,10.8,10.8,10.8h95.407v54.108H97.2V21.605z M369.531,374.53h-32.058l-2.156-55.519 c-0.644-17.434-1.298-38.518-1.298-59.611h-0.633c-4.514,18.516-10.547,39.166-16.137,56.162l-17.645,56.601h-25.618 l-15.494-56.157c-4.725-16.996-9.671-37.658-13.123-56.6h-0.43c-0.854,19.585-1.508,41.961-2.586,60.038l-2.576,55.086h-30.343 l9.26-145.035h43.677l14.207,48.421c4.517,16.774,9.041,34.847,12.258,51.843h0.654c4.081-16.77,9.038-35.923,13.774-52.064 l15.493-48.199h42.82L369.531,374.53z M69.992,374.53l41.955-73.385l-40.444-71.65h37.655l12.688,26.465 c4.316,8.828,7.533,15.928,10.99,24.092h0.422c3.438-9.242,6.23-15.694,9.893-24.092l12.274-26.465h37.434l-40.89,70.796 l43.044,74.239h-37.866l-13.134-26.257c-5.376-10.108-8.817-17.639-12.909-26.04h-0.433c-3.009,8.401-6.674,15.932-11.19,26.04 l-12.042,26.257H69.992z M453.601,523.353H97.2V419.302h356.4V523.353z M485.325,374.53h-90.608V229.495h32.933v117.497h57.682 v27.538H485.325z"/></svg>'},e.icon.link=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 512.092 512.092"  ><path fill="'+r+'" d="M312.453,199.601c-6.066-6.102-12.792-11.511-20.053-16.128c-19.232-12.315-41.59-18.859-64.427-18.859 c-31.697-0.059-62.106,12.535-84.48,34.987L34.949,308.23c-22.336,22.379-34.89,52.7-34.91,84.318 c-0.042,65.98,53.41,119.501,119.39,119.543c31.648,0.11,62.029-12.424,84.395-34.816l89.6-89.6 c1.628-1.614,2.537-3.816,2.524-6.108c-0.027-4.713-3.87-8.511-8.583-8.484h-3.413c-18.72,0.066-37.273-3.529-54.613-10.581 c-3.195-1.315-6.867-0.573-9.301,1.877l-64.427,64.512c-20.006,20.006-52.442,20.006-72.448,0 c-20.006-20.006-20.006-52.442,0-72.448l108.971-108.885c19.99-19.965,52.373-19.965,72.363,0 c13.472,12.679,34.486,12.679,47.957,0c5.796-5.801,9.31-13.495,9.899-21.675C322.976,216.108,319.371,206.535,312.453,199.601z" /><path fill="'+r+'" d="M477.061,34.993c-46.657-46.657-122.303-46.657-168.96,0l-89.515,89.429c-2.458,2.47-3.167,6.185-1.792,9.387 c1.359,3.211,4.535,5.272,8.021,5.205h3.157c18.698-0.034,37.221,3.589,54.528,10.667c3.195,1.315,6.867,0.573,9.301-1.877 l64.256-64.171c20.006-20.006,52.442-20.006,72.448,0c20.006,20.006,20.006,52.442,0,72.448l-80.043,79.957l-0.683,0.768 l-27.989,27.819c-19.99,19.965-52.373,19.965-72.363,0c-13.472-12.679-34.486-12.679-47.957,0 c-5.833,5.845-9.35,13.606-9.899,21.845c-0.624,9.775,2.981,19.348,9.899,26.283c9.877,9.919,21.433,18.008,34.133,23.893 c1.792,0.853,3.584,1.536,5.376,2.304c1.792,0.768,3.669,1.365,5.461,2.048c1.792,0.683,3.669,1.28,5.461,1.792l5.035,1.365 c3.413,0.853,6.827,1.536,10.325,2.133c4.214,0.626,8.458,1.025,12.715,1.195h5.973h0.512l5.12-0.597 c1.877-0.085,3.84-0.512,6.059-0.512h2.901l5.888-0.853l2.731-0.512l4.949-1.024h0.939c20.961-5.265,40.101-16.118,55.381-31.403 l108.629-108.629C523.718,157.296,523.718,81.65,477.061,34.993z" /></svg>'},e.icon.happy=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 512 512"><path fill="'+r+'" d="M256,0C114.615,0,0,114.615,0,256s114.615,256,256,256s256-114.615,256-256S397.385,0,256,0z M256,480 C132.288,480,32,379.712,32,256S132.288,32,256,32s224,100.288,224,224S379.712,480,256,480z"/><path fill="'+r+'" d="M176,176c17.673,0,32,14.327,32,32h32c0-35.346-28.654-64-64-64c-35.346,0-64,28.654-64,64h32 C144,190.327,158.327,176,176,176z"/><path fill="'+r+'" d="M336,144c-35.346,0-64,28.654-64,64h32c0-17.673,14.327-32,32-32c17.673,0,32,14.327,32,32h32 C400,172.654,371.346,144,336,144z"/><path fill="'+r+'" d="M256,368c-53.019,0-96-42.981-96-96h-32c0,70.692,57.308,128,128,128s128-57.308,128-128h-32 C352,325.019,309.019,368,256,368z"/></svg>'},e.icon.sad=function(t,n,r){return'<svg width="'+t+'" height="'+n+'" viewBox="0 0 512 512"><path fill="'+r+'" d="M256,0C114.615,0,0,114.615,0,256s114.615,256,256,256s256-114.615,256-256S397.385,0,256,0z M256,480 C132.288,480,32,379.712,32,256S132.288,32,256,32s224,100.288,224,224S379.712,480,256,480z"/><path fill="'+r+'" d="M336,192c-17.673,0-32-14.327-32-32h-32c0,35.346,28.654,64,64,64c35.346,0,64-28.654,64-64h-32 C368,177.673,353.673,192,336,192z"/><path fill="'+r+'" d="M176,224c35.346,0,64-28.654,64-64h-32c0,17.673-14.327,32-32,32s-32-14.327-32-32h-32C112,195.346,140.654,224,176,224z "/><path fill="'+r+'" d="M256,256c-70.692,0-128,57.308-128,128h32c0-53.019,42.981-96,96-96s96,42.981,96,96h32C384,313.308,326.692,256,256,256 z"/></svg>'},e.icon.share=function(t,n,r,s,o){return s==null&&(s=0),o==null&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512 512">
                <path fill="${r}" d="M406,332c-29.641,0-55.761,14.581-72.167,36.755L191.99,296.124c2.355-8.027,4.01-16.346,4.01-25.124
                    c0-11.906-2.441-23.225-6.658-33.636l148.445-89.328C354.307,167.424,378.589,180,406,180c49.629,0,90-40.371,90-90
                    c0-49.629-40.371-90-90-90c-49.629,0-90,40.371-90,90c0,11.437,2.355,22.286,6.262,32.358l-148.887,89.59
                    C156.869,193.136,132.937,181,106,181c-49.629,0-90,40.371-90,90c0,49.629,40.371,90,90,90c30.13,0,56.691-15.009,73.035-37.806
                    l141.376,72.395C317.807,403.995,316,412.75,316,422c0,49.629,40.371,90,90,90c49.629,0,90-40.371,90-90
                    C496,372.371,455.629,332,406,332z"/>
                </svg>`},e.icon.user=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 24 24">
                <path fill="${r}" d="M12 11.796C14.7189 11.796 16.9231 9.60308 16.9231 6.89801C16.9231 4.19294 14.7189 2.00005 12 2.00005C9.28106 2.00005 7.07692 4.19294 7.07692 6.89801C7.07692 9.60308 9.28106 11.796 12 11.796Z" fill="#030D45"/>
                <path fill="${r}" d="M14.5641 13.8369H9.4359C6.46154 13.8369 4 16.2859 4 19.245C4 19.9593 4.30769 20.5716 4.92308 20.8777C5.84615 21.3879 7.89744 22.0001 12 22.0001C16.1026 22.0001 18.1538 21.3879 19.0769 20.8777C19.5897 20.5716 20 19.9593 20 19.245C20 16.1838 17.5385 13.8369 14.5641 13.8369Z" fill="#030D45"/>
            </svg>`},e.icon.close=function(t,n,r,s,o){return s==null&&(s=0),o==null&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512 512">
    <path fill="${r}" d="m256 0c-141.49 0-256 114.5-256 256 0 141.49 114.5 256 256 256 141.49 0 256-114.5 256-256 0-141.49-114.5-256-256-256zm-12.284 317.397-58.121 58.132c-6.565 6.553-15.283 10.166-24.557 10.166-19.196 0-34.734-15.526-34.734-34.734 0-9.274 3.612-17.992 10.166-24.557l58.132-58.121c6.785-6.784 6.785-17.783 0-24.568l-58.132-58.121c-6.553-6.565-10.166-15.283-10.166-24.557 0-19.196 15.526-34.734 34.734-34.734 9.274 0 17.992 3.613 24.557 10.166l58.121 58.132c6.785 6.773 17.784 6.773 24.568 0l58.121-58.132c6.565-6.553 15.283-10.166 24.557-10.166 19.196 0 34.734 15.526 34.734 34.734 0 9.274-3.612 17.992-10.166 24.557l-58.132 58.121c-6.785 6.784-6.785 17.783 0 24.568l58.132 58.121c6.553 6.565 10.166 15.283 10.166 24.557 0 19.196-15.526 34.734-34.734 34.734-9.274 0-17.992-3.613-24.557-10.166l-58.121-58.132c-6.784-6.784-17.784-6.773-24.568 0z"/>
    </svg>`},e.icon.undo=function(t,n,r,s,o){return s==null&&(s=0),o==null&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 24 24">
    <path fill-rule="evenodd" clip-rule="evenodd" fill="${r}" d="M3.46447 3.46447C2 4.92893 2 7.28595 2 12C2 16.714 2 19.0711 3.46447 20.5355C4.92893 22 7.28595 22 12 22C16.714 22 19.0711 22 20.5355 20.5355C22 19.0711 22 16.7141 22 12C22 7.28598 22 4.92893 20.5355 3.46447C19.0711 2 16.714 2 12 2C7.28595 2 4.92893 2 3.46447 3.46447ZM9.25871 7.97395C9.56308 7.693 9.58205 7.21851 9.3011 6.91414C9.02015 6.60978 8.54565 6.5908 8.24129 6.87175L5.99129 8.94867C5.83748 9.09065 5.75 9.29045 5.75 9.49977C5.75 9.7091 5.83748 9.9089 5.99129 10.0509L8.24129 12.1278C8.54565 12.4088 9.02015 12.3898 9.3011 12.0854C9.58205 11.781 9.56308 11.3065 9.25871 11.0256L8.41824 10.2498H14.0385C14.7376 10.2498 15.2069 10.2506 15.5652 10.2862C15.9116 10.3205 16.0724 10.3813 16.1787 10.4501C16.3272 10.5461 16.4537 10.6726 16.5497 10.8211C16.6184 10.9274 16.6793 11.0882 16.7136 11.4345C16.7491 11.7929 16.75 12.2622 16.75 12.9613C16.75 13.6604 16.7491 14.1298 16.7136 14.4881C16.6793 14.8344 16.6185 14.9952 16.5497 15.1015C16.4537 15.2501 16.3272 15.3765 16.1787 15.4726C16.0724 15.5413 15.9116 15.6021 15.5652 15.6365C15.2069 15.672 14.7376 15.6729 14.0385 15.6729H9.5C9.08579 15.6729 8.75 16.0086 8.75 16.4229C8.75 16.8371 9.08579 17.1729 9.5 17.1729H14.0758C14.7279 17.1729 15.2721 17.1729 15.7133 17.1291C16.1748 17.0834 16.6038 16.9839 16.9931 16.7322C17.3199 16.5209 17.5981 16.2427 17.8094 15.916C18.0611 15.5266 18.1605 15.0976 18.2063 14.6361C18.25 14.195 18.25 13.6508 18.25 12.9987V12.924C18.25 12.2718 18.25 11.7276 18.2063 11.2865C18.1605 10.825 18.0611 10.396 17.8093 10.0067C17.5981 9.6799 17.3199 9.40169 16.9931 9.19042C16.6038 8.9387 16.1748 8.83927 15.7133 8.7935C15.2721 8.74975 14.7279 8.74976 14.0758 8.74977L8.41824 8.74977L9.25871 7.97395Z" />
    <rect style="opacity: 0" x="2" y="2" width="20" height="20"></rect>
    </svg>`},e.icon.redo=function(t,n,r,s,o){return s==null&&(s=0),o==null&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 24 24" >
    <path fill="#f9f9f9" fill-rule="evenodd" clip-rule="evenodd" fill="${r}" d="M3.46447 3.46447C2 4.92893 2 7.28595 2 12C2 16.714 2 19.0711 3.46447 20.5355C4.92893 22 7.28595 22 12 22C16.714 22 19.0711 22 20.5355 20.5355C22 19.0711 22 16.7141 22 12C22 7.28598 22 4.92893 20.5355 3.46447C19.0711 2 16.714 2 12 2C7.28595 2 4.92893 2 3.46447 3.46447ZM15.7587 6.87273C15.4543 6.59177 14.9799 6.61075 14.6989 6.91512C14.4179 7.21948 14.4369 7.69398 14.7413 7.97493L15.5818 8.75075H9.96155C7.63558 8.75075 5.75 10.6363 5.75 12.9623C5.75 15.2883 7.63557 17.1738 9.96154 17.1738H14.5C14.9142 17.1738 15.25 16.838 15.25 16.4238C15.25 16.0096 14.9142 15.6738 14.5 15.6738H9.96154C8.464 15.6738 7.25 14.4598 7.25 12.9623C7.25 11.4647 8.464 10.2508 9.96155 10.2508H15.5818L14.7413 11.0266C14.4369 11.3075 14.4179 11.782 14.6989 12.0864C14.9799 12.3908 15.4543 12.4097 15.7587 12.1288L18.0087 10.0519C18.1625 9.90987 18.25 9.71007 18.25 9.50075C18.25 9.29143 18.1625 9.09163 18.0087 8.94965L15.7587 6.87273Z"/>
    <rect style="opacity: 0" x="2" y="2" width="20" height="20"></rect>    
    </svg>`},e.icon.ft=function(t,n,r,s,o){return`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512 512"  >
                <path fill="${r}" d="m336.061 377.731c-5.086-6.54-14.511-7.717-21.049-2.631l-44.012 34.231v-200.331c0-8.284-6.716-15-15-15s-15 6.716-15 15v200.331l-44.011-34.231c-6.538-5.086-15.962-3.908-21.049 2.631-5.086 6.539-3.908 15.963 2.631 21.049l62.429 48.556v49.664c0 8.284 6.716 15 15 15s15-6.716 15-15v-49.664l62.429-48.556c6.54-5.086 7.717-14.51 2.632-21.049z" />
                <path fill="${r}" d="m271 497v-49.664l62.429-48.556c6.54-5.086 7.717-14.51 2.631-21.049-5.086-6.54-14.511-7.717-21.049-2.631l-44.011 34.231v-200.331c0-8.284-6.716-15-15-15v318c8.284 0 15-6.716 15-15z" />
                <path fill="${r}" d="m320 512h-128c-8.284 0-15-6.716-15-15s6.716-15 15-15h128c8.284 0 15 6.716 15 15s-6.716 15-15 15z" />
                <path fill="${r}" d="m320 482h-64v30h64c8.284 0 15-6.716 15-15s-6.716-15-15-15z" />
                <path fill="${r}" d="m400 439c-61.206 0-111-49.794-111-111s49.794-111 111-111 111 49.794 111 111-49.794 111-111 111z" />
                <path fill="${r}" d="m112 439c-61.206 0-111-49.794-111-111s49.794-111 111-111 111 49.794 111 111-49.794 111-111 111z" />
                <path fill="${r}" d="m256 222c-61.206 0-111-49.794-111-111s49.794-111 111-111 111 49.794 111 111-49.794 111-111 111z" />
                <path fill="${r}" d="m367 111c0-61.206-49.794-111-111-111v222c61.206 0 111-49.794 111-111z" />
            </svg>`},e.icon.addUser=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512 512" >
                <path fill="${r}" d="M300.434,257.599c-25.945,27.304-60.622,43.875-98.602,43.875c-37.979,0-72.656-16.571-98.602-43.875 c-45.617,28.738-77.826,76.818-85.092,132.736c-1.659,12.77,8.291,24.107,21.201,24.107h225.846 c0-53.371,32.011-99.402,77.838-119.914C330.812,280.165,316.452,267.69,300.434,257.599z"/>
                <ellipse fill="${r}" cx="201.828" cy="133.868" rx="112.229" ry="133.868"/>
                <path fill="${r}" d="M396.486,316.885c-53.794,0-97.558,43.764-97.558,97.558S342.693,512,396.486,512c53.792,0,97.557-43.764,97.557-97.558 S450.279,316.885,396.486,316.885z M435.199,431.315h-21.841v21.841c0,9.318-7.554,16.872-16.872,16.872 c-9.318,0-16.872-7.554-16.872-16.872v-21.841h-21.842c-9.318,0-16.872-7.554-16.872-16.872c0-9.319,7.554-16.872,16.872-16.872 h21.842v-21.841c0-9.318,7.554-16.872,16.872-16.872c9.318,0,16.872,7.554,16.872,16.872v21.841h21.841 c9.318,0,16.872,7.554,16.872,16.872C452.072,423.761,444.518,431.315,435.199,431.315z"/>
            </svg>`},e.icon.daughter=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512.879 512.879">
                <path fill="${r}" d="M213.773,238.933c4.71,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.181-2.176,5.803-7.33,3.627-11.511 c-2.534-4.872-10.581-13.124-24.636-13.124c-14.054,0-22.101,8.252-24.636,13.124c-2.125,4.087-0.555,8.969,3.456,11.23 c4.011,2.287,9.156,0.811,11.563-3.123c0.077-0.128,0.495-0.623,1.084-1.195v5.564 C205.239,235.11,209.062,238.933,213.773,238.933z"/>
                <path fill="${r}" d="M256.439,332.8c20.028,0,30.507-9.907,31.633-11.034c3.294-3.294,3.285-8.568,0.043-11.913 c-3.234-3.354-8.61-3.439-12.015-0.247c-0.265,0.247-6.699,6.127-19.661,6.127c-12.774,0-19.209-5.709-19.652-6.118 c-3.336-3.251-8.678-3.217-11.981,0.085c-3.337,3.337-3.337,8.73,0,12.066C225.933,322.893,236.412,332.8,256.439,332.8z"/>
                <path fill="${r}" d="M365.666,293.547c-49.826-66.441-75.093-133.623-75.093-199.68c0-4.71-3.823-8.533-8.533-8.533s-8.533,3.823-8.533,8.533 c0,68.369,25.31,137.489,75.255,205.542c-12.228,21.623-50.483,76.058-92.322,76.058c-45.218,0-86.255-63.59-94.763-80.614 c-8.388-16.768-24.704-66.765-24.704-98.586v-25.754c20.378-0.572,73.404-3.405,121.813-17.246 c4.531-1.289,7.151-6.016,5.854-10.547c-1.289-4.531-6.008-7.159-10.547-5.854C196.254,153.387,129.114,153.6,128.439,153.6 c-4.71,0-8.533,3.823-8.533,8.533v34.133c0,34.935,17.254,87.723,26.496,106.214c0.452,0.905,46.797,90.052,110.037,90.052 s109.585-89.148,110.037-90.052C367.919,299.588,367.603,296.132,365.666,293.547z"/>
                <path fill="${r}" d="M316.173,392.533c-4.71,0-8.533,3.823-8.533,8.533v17.067c0,0.06,0.034,0.111,0.034,0.171 c0,0.051-0.034,0.094-0.034,0.154c-0.034,5.205-1.749,50.876-51.2,50.876s-51.166-45.986-51.2-51.2v-17.067 c0-4.71-3.823-8.533-8.533-8.533s-8.533,3.823-8.533,8.533v8.687c-116.028,1.638-168.917,35.9-178.765,65.417l-8.533,25.6 c-1.493,4.471,0.93,9.301,5.402,10.795C7.172,511.863,8.085,512,8.973,512c3.575,0,6.903-2.261,8.098-5.837l8.533-25.6 c6.076-18.227,48.034-52.335,163.132-53.845c3.106,24.422,19.721,59.682,67.704,59.682c53.999,0,68.267-44.425,68.267-67.917 c0-0.06-0.034-0.111-0.034-0.171c0-0.068,0.034-0.119,0.034-0.179v-17.067C324.706,396.356,320.883,392.533,316.173,392.533z"/>
                <path fill="${r}" d="M256.695,273.067h-0.085c-4.71,0-8.491,3.823-8.491,8.533c0,4.71,3.866,8.533,8.576,8.533 c4.719,0,8.533-3.823,8.533-8.533C265.229,276.89,261.414,273.067,256.695,273.067z"/>
                <path fill="${r}" d="M512.004,501.641l-8.533-25.591c-4.659-13.978-22.34-28.228-49.792-40.141c-4.318-1.877-9.352,0.102-11.23,4.429 c-1.869,4.318,0.111,9.353,4.437,11.221c26.266,11.401,38.178,23.219,40.388,29.884l8.533,25.6 c1.195,3.575,4.523,5.837,8.098,5.837c0.887,0,1.801-0.145,2.697-0.444C511.074,510.942,513.498,506.112,512.004,501.641z"/>
                <path fill="${r}" d="M256.439,0c-115.558,0-179.2,63.642-179.2,179.2V256c0,66.039-24.909,141.611-25.165,142.37 c-1.485,4.471,0.93,9.301,5.402,10.795c4.48,1.476,9.301-0.93,10.795-5.402c1.058-3.191,26.035-78.908,26.035-147.763v-76.8 c0-134.008,88.175-162.133,162.133-162.133c100.454,0,162.133,94.43,162.133,162.133v17.067 c0,34.458-21.111,74.163-41.532,112.572c-18.133,34.116-35.268,66.338-35.268,92.228c0,54.11,35.14,89.873,36.634,91.366 c1.596,1.604,3.772,2.5,6.033,2.5c2.261,0,4.437-0.896,6.033-2.5c1.493-1.493,36.634-37.257,36.634-91.366 c0-53.197-17.562-72.303-19.567-74.3c-3.285-3.285-8.559-3.285-11.904-0.051c-3.354,3.234-3.439,8.61-0.265,12.015 c0.145,0.154,14.669,16.256,14.669,62.336c0,33.937-16.444,60.16-25.617,72.149c-9.19-11.947-25.583-38.05-25.583-72.149 c0-21.632,16.162-52.036,33.271-84.215c21.402-40.252,43.529-81.869,43.529-120.585V179.2C435.639,94.438,362.04,0,256.439,0z"/>
            </svg>`},e.icon.son=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}"  viewBox="0 0 512.002 512.002">
                <path fill="${r}" d="M238.934,213.334c0-4.71-3.823-8.533-8.533-8.533h-34.133c-4.71,0-8.533,3.823-8.533,8.533 c0,4.71,3.823,8.533,8.533,8.533h8.533c0,4.71,3.823,8.533,8.533,8.533c4.71,0,8.533-3.823,8.533-8.533h8.533 C235.111,221.867,238.934,218.044,238.934,213.334z"/>
                <path fill="${r}" d="M121.601,255.19c4.565,13.466,17.178,49.98,24.371,64.358c13.551,27.11,51.977,72.986,110.029,72.986 s96.478-45.875,110.037-72.986c7.185-14.379,19.797-50.893,24.371-64.358c11.025-2.85,19.191-12.885,19.191-24.789v-34.133 c0-11.127-7.134-20.617-17.067-24.141v-44.126c0-33.69-17.741-95.923-83.354-101.931c-0.137-4.028-1.476-7.27-2.953-9.668 c-8.38-13.559-31.94-16.401-50.227-16.401c-151.842,0-153.6,143.616-153.6,145.067c0,4.71,3.814,8.525,8.525,8.525h0.009 c4.702,0,8.525-3.806,8.533-8.516c0.017-5.222,1.937-128.009,136.533-128.009c24.132,0,33.801,5.222,35.703,8.311 c0.282,0.435,0.998,1.604-0.666,4.941c-1.323,2.645-1.178,5.786,0.375,8.303c1.553,2.509,4.301,4.045,7.253,4.045 c75.656,0,76.791,81.86,76.8,85.333v51.2c0,4.71,3.823,8.533,8.533,8.533c4.702,0,8.533,3.831,8.533,8.533v34.133 c0,4.702-3.831,8.533-8.533,8.533c-3.669,0-6.929,2.347-8.098,5.837c-0.162,0.503-16.964,50.816-25.131,67.149 c-1.297,2.594-32.495,63.548-94.771,63.548s-93.466-60.954-94.763-63.548c-8.166-16.333-24.977-66.645-25.139-67.149 c-1.161-3.49-4.42-5.837-8.098-5.837c-4.702,0-8.533-3.831-8.533-8.533v-34.133c0-2.313,0.93-4.412,2.423-5.948 c3.396,7.62,10.607,14.481,23.177,14.481c3.234,0,6.187-1.826,7.637-4.719c7.535-15.061,15.283-30.575,17.399-46.652 c43.665-1.758,108.979-17.323,139.742-41.105c8.201,29.764,32.742,54.596,33.988,55.842c3.337,3.337,8.738,3.337,12.066,0 c3.337-3.336,3.337-8.73,0-12.066c-0.316-0.316-31.633-31.983-31.633-62.234c0-3.831-2.56-7.202-6.255-8.226 c-3.703-1.024-7.62,0.546-9.591,3.831c-14.549,24.243-94.746,47.061-146.287,47.061c-4.71,0-8.533,3.823-8.533,8.533 c0,13.295-6.127,27.102-13.286,41.6c-2.901-1.604-3.703-4.753-3.78-7.467c0-4.71-3.823-8.533-8.533-8.533 c-14.114,0-25.6,11.486-25.6,25.6v34.133C102.401,242.305,110.576,252.34,121.601,255.19z"/>
                <path fill="${r}" d="M256.001,332.801c20.028,0,30.507-9.907,31.633-11.034c3.294-3.294,3.285-8.567,0.051-11.913 c-3.243-3.354-8.619-3.439-12.023-0.247c-0.265,0.247-6.699,6.127-19.661,6.127c-12.774,0-19.209-5.709-19.652-6.118 c-3.336-3.251-8.678-3.217-11.981,0.085c-3.328,3.337-3.328,8.73,0,12.066C225.503,322.893,235.982,332.801,256.001,332.801z"/>
                <path fill="${r}" d="M264.79,281.601c0-4.71-3.814-8.533-8.533-8.533h-0.085c-4.71,0-8.491,3.823-8.491,8.533c0,4.71,3.866,8.533,8.576,8.533 C260.976,290.134,264.79,286.311,264.79,281.601z"/>
                <path fill="${r}" d="M511.745,501.394l-8.713-34.756c-4.386-13.158-30.285-55.484-178.765-56.636v-8.934c0-4.71-3.823-8.533-8.533-8.533 s-8.533,3.823-8.533,8.533v17.067c0,0.06,0.034,0.111,0.034,0.171c0,0.051-0.034,0.094-0.034,0.154 c-0.034,5.205-1.749,50.876-51.2,50.876s-51.166-45.986-51.2-51.2v-17.067c0-4.71-3.823-8.533-8.533-8.533 s-8.533,3.823-8.533,8.533v8.619C77.168,410.556,21.786,428.203,8.79,467.26l-8.533,34.133 c-1.143,4.574,1.638,9.207,6.212,10.351c4.557,1.143,9.199-1.638,10.342-6.204l8.354-33.51 c9.916-29.739,63.309-44.595,163.132-45.338c3.098,24.431,19.712,59.708,67.704,59.708c47.983,0,64.597-35.063,67.703-59.366 c116.958,0.862,157.628,28.467,162.953,44.373l8.533,34.133c0.973,3.874,4.446,6.46,8.269,6.46c0.691,0,1.382-0.077,2.082-0.256 C510.115,510.601,512.888,505.968,511.745,501.394z"/>
                <path fill="${r}" d="M298.668,230.401c4.71,0,8.533-3.823,8.533-8.533h8.533c4.71,0,8.533-3.823,8.533-8.533c0-4.71-3.823-8.533-8.533-8.533 h-34.133c-4.71,0-8.533,3.823-8.533,8.533c0,4.71,3.823,8.533,8.533,8.533h8.533 C290.134,226.578,293.957,230.401,298.668,230.401z"/>
            </svg>`},e.icon.wife=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512 512" >
                <path fill="${r}" d="M128,307.2c4.719,0,8.533-3.823,8.533-8.533V281.6c0-4.71-3.814-8.533-8.533-8.533c-4.719,0-8.533,3.823-8.533,8.533 v17.067C119.467,303.377,123.281,307.2,128,307.2z"/>
                <path fill="${r}" d="M384,273.067c-4.719,0-8.533,3.823-8.533,8.533v17.067c0,4.71,3.814,8.533,8.533,8.533c4.719,0,8.533-3.823,8.533-8.533 V281.6C392.533,276.89,388.719,273.067,384,273.067z"/>
                <path fill="${r}" d="M392.183,433.109c-0.162-0.606-0.418-1.152-0.7-1.715c-0.162-0.299-0.196-0.64-0.384-0.93 c-0.094-0.128-0.23-0.196-0.324-0.324c-0.358-0.469-0.802-0.845-1.254-1.246c-0.418-0.375-0.819-0.742-1.306-1.016 c-0.145-0.094-0.23-0.23-0.392-0.316l-34.133-17.067c-2.748-1.357-6.008-1.161-8.55,0.538l-51.209,34.133 c-2.372,1.587-3.797,4.25-3.797,7.1v30.259c-5.077,4.062-17.545,12.407-34.133,12.407c-16.427,0-29.013-8.388-34.133-12.433 v-30.234c0-2.85-1.425-5.513-3.797-7.1l-51.2-34.133c-2.543-1.698-5.803-1.894-8.55-0.538l-34.133,17.067 c-0.154,0.077-0.239,0.213-0.375,0.299c-0.512,0.29-0.939,0.674-1.374,1.075c-0.435,0.384-0.853,0.734-1.186,1.178 c-0.102,0.137-0.256,0.213-0.35,0.35c-0.205,0.307-0.239,0.657-0.401,0.99c-0.265,0.529-0.521,1.05-0.674,1.63 c-0.137,0.529-0.179,1.05-0.205,1.596c-0.034,0.538-0.06,1.058,0.008,1.604c0.068,0.597,0.265,1.143,0.461,1.707 c0.119,0.341,0.111,0.7,0.273,1.024c0.077,0.154,0.222,0.247,0.307,0.393c0.282,0.495,0.666,0.913,1.058,1.348 c0.384,0.427,0.742,0.853,1.186,1.195c0.137,0.102,0.213,0.256,0.35,0.35l51.2,34.133c1.459,0.973,3.106,1.434,4.727,1.434 c2.756,0,5.47-1.331,7.108-3.797c2.62-3.925,1.562-9.225-2.364-11.836l-38.972-25.975l16.555-8.277l43.281,28.851V486.4 c0,2.261,0.896,4.437,2.5,6.033C208.102,493.235,227.2,512,256,512s47.898-18.765,48.7-19.567c1.604-1.596,2.5-3.772,2.5-6.033 v-29.568l43.29-28.851l16.546,8.277l-38.972,25.975c-3.925,2.611-4.983,7.91-2.364,11.836c1.638,2.466,4.352,3.797,7.108,3.797 c1.621,0,3.268-0.461,4.727-1.434l51.2-34.133c0.137-0.094,0.205-0.239,0.333-0.341c0.478-0.35,0.853-0.794,1.254-1.246 c0.358-0.427,0.725-0.811,0.998-1.289c0.085-0.154,0.239-0.247,0.324-0.41c0.171-0.35,0.171-0.725,0.29-1.084 c0.179-0.538,0.367-1.05,0.435-1.613c0.077-0.58,0.051-1.126,0.009-1.698C392.354,434.108,392.32,433.613,392.183,433.109z"/>
                <path fill="${r}" d="M57.037,409.165c0.896,0.29,1.809,0.435,2.697,0.435c3.575,0,6.903-2.261,8.09-5.837 C68.89,400.572,93.867,324.855,93.867,256v-76.8C93.867,45.193,182.033,17.067,256,17.067c25.199,0,77.636,0,85.649,11.128 c0.333,0.452,0.828,1.135,0.128,3.243c-0.956,2.842-0.341,5.965,1.604,8.235c1.946,2.278,4.932,3.362,7.885,2.876 c10.863-1.792,20.412,0.93,29.184,8.354c22.895,19.396,37.683,69.76,37.683,128.299V256c0,77.457,25.071,145.22,26.138,148.062 c1.656,4.412,6.571,6.639,10.991,5.001c4.412-1.655,6.647-6.571,5.001-10.991C460.006,397.406,435.2,330.257,435.2,256v-76.8 c0-50.415-11.486-114.014-43.716-141.321c-9.745-8.243-20.932-12.621-32.836-12.902c-0.683-2.773-1.903-5.035-3.149-6.767 C343.356,1.374,303.258,0,256,0C140.442,0,76.8,63.642,76.8,179.2V256c0,66.039-24.909,141.611-25.156,142.37 C50.15,402.842,52.565,407.672,57.037,409.165z"/>
                <path fill="${r}" d="M91.802,426.923C19.814,444.919,1.195,498.492,0.444,500.77c-1.493,4.471,0.922,9.301,5.393,10.795 C6.733,511.864,7.646,512,8.533,512c3.576,0,6.904-2.261,8.09-5.837c0.162-0.469,16.316-46.942,79.309-62.686 c4.574-1.143,7.356-5.777,6.212-10.351C101.001,428.561,96.367,425.771,91.802,426.923z"/>
                <path fill="${r}" d="M213.333,238.933c4.719,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.173-2.176,5.803-7.33,3.627-11.511 c-2.534-4.873-10.59-13.124-24.636-13.124c-14.046,0-22.101,8.252-24.636,13.124c-2.125,4.087-0.546,8.969,3.456,11.23 c3.985,2.261,9.148,0.819,11.554-3.123c0.085-0.128,0.503-0.623,1.092-1.195v5.564C204.8,235.11,208.614,238.933,213.333,238.933 z"/>
                <path fill="${r}" d="M511.556,500.77c-0.751-2.278-19.371-55.851-91.358-73.847c-4.574-1.161-9.199,1.638-10.342,6.204 c-1.143,4.574,1.638,9.207,6.212,10.351c62.524,15.633,78.66,60.809,79.309,62.686c1.186,3.576,4.514,5.837,8.09,5.837 c0.888,0,1.801-0.137,2.697-0.435C510.635,510.071,513.05,505.242,511.556,500.77z"/>
                <path fill="${r}" d="M256,332.8c20.028,0,30.507-9.907,31.633-11.034c3.294-3.294,3.285-8.567,0.051-11.913 c-3.251-3.345-8.61-3.439-12.015-0.247c-0.273,0.247-6.707,6.127-19.669,6.127c-12.774,0-19.208-5.709-19.652-6.118 c-3.32-3.251-8.67-3.226-11.981,0.085c-3.337,3.337-3.337,8.73,0,12.066C225.493,322.893,235.972,332.8,256,332.8z"/>
                <path fill="${r}" d="M298.667,238.933c4.719,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.173-2.176,5.803-7.33,3.627-11.511 c-2.534-4.873-10.59-13.124-24.636-13.124c-14.046,0-22.101,8.252-24.636,13.124c-2.125,4.087-0.546,8.969,3.456,11.23 c3.994,2.261,9.156,0.819,11.554-3.123c0.085-0.128,0.503-0.623,1.092-1.195v5.564 C290.133,235.11,293.948,238.933,298.667,238.933z"/>
                <path fill="${r}" d="M389.129,189.449c-8.542-6.443-30.729-26.957-30.729-44.382c0-4.71-3.814-8.533-8.533-8.533s-8.533,3.823-8.533,8.533 c0,24.678,24.354,47.249,34.014,55.228c-1.835,33.476-24.917,95.223-33.118,111.625c-7.654,15.317-48.154,63.548-86.229,63.548 s-78.575-48.23-86.229-63.548c-8.542-17.084-33.237-83.379-33.237-115.652v-25.728c33.835-0.802,157.321-6.929,218.453-52.779 c3.772-2.825,4.54-8.175,1.707-11.947c-2.825-3.772-8.175-4.54-11.947-1.707C279.561,152.994,129.51,153.6,128,153.6 c-4.719,0-8.533,3.823-8.533,8.533v34.133c0,36.625,26.871,106.965,35.029,123.281c10.385,20.77,55.834,72.986,101.504,72.986 s91.119-52.216,101.504-72.986c8.158-16.316,35.029-86.656,35.029-123.281C392.533,193.587,391.27,191.061,389.129,189.449z"/>
            </svg>`},e.icon.husband=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512.007 512.007" >
                <path fill="${r}" d="M121.835,255.249c6.229,16.196,26.803,68.42,41.737,90.82l1.348,2.039c10.957,16.614,29.295,44.425,91.085,44.425 c61.79,0,80.128-27.81,91.085-44.425l1.348-2.039c14.933-22.4,35.507-74.624,41.737-90.82c11.145-2.773,19.43-12.86,19.43-24.849 v-34.133c0-11.127-7.134-20.617-17.067-24.141V128c0-33.69-17.741-95.923-83.362-101.931c-0.128-4.028-1.459-7.27-2.944-9.668 C297.844,2.85,274.292,0,256.005,0c-151.842,0-153.6,143.616-153.6,145.067c0,4.71,3.814,8.525,8.516,8.525h0.017 c4.702,0,8.516-3.806,8.533-8.508c0.017-5.231,1.937-128.017,136.533-128.017c24.132,0,33.801,5.222,35.712,8.311 c0.265,0.435,0.99,1.604-0.683,4.941c-1.323,2.645-1.178,5.786,0.375,8.303c1.562,2.509,4.301,4.045,7.262,4.045 c75.657,0,76.791,81.86,76.8,85.333v51.2c0,4.71,3.814,8.533,8.533,8.533c4.71,0,8.533,3.831,8.533,8.533V230.4 c0,4.702-3.823,8.533-8.533,8.533c-3.558,0-6.741,2.21-7.996,5.538c-0.247,0.674-25.446,67.644-41.771,92.126l-1.399,2.116 c-10.223,15.514-24.235,36.753-76.834,36.753c-52.599,0-66.611-21.239-76.834-36.753l-1.399-2.116 c-16.324-24.482-41.523-91.452-41.771-92.126c-1.254-3.328-4.437-5.538-7.996-5.538c-4.71,0-8.533-3.831-8.533-8.533v-34.133 c0-2.313,0.922-4.412,2.423-5.948c3.089,6.955,9.421,13.21,20.053,14.268l29.193,21.897c2.27,16.623,16.418,29.517,33.664,29.517 h17.067c18.825,0,34.133-15.309,34.133-34.133c0,18.825,15.309,34.133,34.133,34.133h17.067 c17.237,0,31.394-12.894,33.664-29.517l31.189-23.39c3.772-2.825,4.54-8.175,1.707-11.947c-2.825-3.772-8.175-4.548-11.947-1.707 l-21.751,16.316c-3.251-10.402-12.86-18.022-24.329-18.022h-34.133c-14.114,0-25.6,11.486-25.6,25.6 c0-14.114-11.486-25.6-25.6-25.6h-34.133c-11.469,0-21.077,7.62-24.328,18.022l-16.282-12.211 c6.716-16.23,12.8-40.235,14.524-57.088c26.897-0.478,104.713-3.763,139.332-25.37c7.851,30.31,33.058,55.817,34.321,57.08 c3.336,3.336,8.73,3.336,12.066,0c3.336-3.337,3.336-8.73,0-12.066c-0.316-0.316-31.633-31.983-31.633-62.234 c0-3.831-2.56-7.202-6.255-8.226c-3.661-1.016-7.629,0.546-9.591,3.831c-12.425,20.693-93.022,29.995-146.287,29.995 c-4.719,0-8.533,3.823-8.533,8.533c0,13.858-6.554,41.515-13.508,58.539c-2.722-1.638-3.49-4.693-3.558-7.339 c0-4.71-3.814-8.533-8.533-8.533c-14.114,0-25.6,11.486-25.6,25.6V230.4C102.405,242.389,110.691,252.476,121.835,255.249z M273.071,213.333c0-4.702,3.823-8.533,8.533-8.533h34.133c4.71,0,8.533,3.831,8.533,8.533v8.533 c0,9.412-7.654,17.067-17.067,17.067h-17.067c-9.412,0-17.067-7.654-17.067-17.067V213.333z M187.738,213.333 c0-4.702,3.823-8.533,8.533-8.533h34.133c4.71,0,8.533,3.831,8.533,8.533v8.533c0,9.412-7.654,17.067-17.067,17.067h-17.067 c-9.412,0-17.067-7.654-17.067-17.067V213.333z"/>
                <path fill="${r}" d="M298.663,307.226c0.009-4.702-3.797-8.533-8.499-8.559c-0.162,0-15.42-0.171-30.345-7.629 c-2.398-1.203-5.231-1.203-7.629,0c-14.925,7.458-30.182,7.629-30.319,7.629c-4.719,0-8.533,3.823-8.533,8.533 s3.814,8.533,8.533,8.533c0.725,0,16.853-0.094,34.133-7.646c17.28,7.552,33.408,7.646,34.133,7.646 C294.84,315.733,298.646,311.927,298.663,307.226z"/>
                <path fill="${r}" d="M247.471,324.267c-4.719,0-8.533,3.823-8.533,8.533c0,4.71,3.814,8.533,8.533,8.533h17.067 c4.719,0,8.533-3.823,8.533-8.533c0-4.71-3.814-8.533-8.533-8.533H247.471z"/>
                <path fill="${r}" d="M511.749,501.393l-8.721-34.756c-12.706-38.135-73.114-56.687-184.67-56.687c-0.879,0-1.758,0-2.645,0.009 c-4.053,0.009-7.544,2.867-8.337,6.852l-17.067,84.975c-0.93,4.625,2.065,9.122,6.682,10.052 c4.608,0.896,9.114-2.074,10.044-6.69l15.693-78.114c97.724,0.452,154.436,15.957,163.934,44.373l8.533,34.133 c0.973,3.874,4.446,6.468,8.269,6.46c0.683,0,1.382-0.077,2.074-0.256C510.11,510.601,512.892,505.976,511.749,501.393z"/>
                <path fill="${r}" d="M204.634,416.461c-0.794-3.994-4.292-6.861-8.363-6.861c-116.386,0-174.148,17.596-187.477,57.66l-8.533,34.133 c-1.152,4.582,1.638,9.207,6.212,10.351C7.164,511.923,7.864,512,8.547,512c3.823,0,7.296-2.586,8.269-6.46l8.346-33.51 c9.95-29.841,63.667-44.689,164.122-45.338l15.693,78.447c0.913,4.617,5.367,7.629,10.035,6.699 c4.617-0.93,7.62-5.427,6.69-10.044L204.634,416.461z"/>
                <path fill="${r}" d="M256.005,409.6c-14.114,0-25.6,11.486-25.6,25.6c0,11.11,7.159,20.489,17.067,24.021v44.245 c0,4.71,3.814,8.533,8.533,8.533c4.719,0,8.533-3.823,8.533-8.533V459.23c9.907-3.541,17.067-12.919,17.067-24.03 C281.605,421.086,270.119,409.6,256.005,409.6z M256.005,443.733c-4.71,0-8.533-3.831-8.533-8.533 c0-4.702,3.823-8.533,8.533-8.533c4.71,0,8.533,3.831,8.533,8.533C264.538,439.902,260.715,443.733,256.005,443.733z"/>
            </svg>`},e.icon.father=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512.002 512.002" >
                <path fill="${r}" d="M366.934,128.001c0-4.71-3.814-8.533-8.533-8.533c-2.091,0-51.2-0.683-51.2-59.733c0-4.71-3.814-8.533-8.533-8.533 s-8.533,3.823-8.533,8.533c0,75.921,67.584,76.8,68.267,76.8C363.12,136.534,366.934,132.711,366.934,128.001z"/>
                <path fill="${r}" d="M256.001,196.268c0-14.114-11.486-25.6-25.6-25.6h-34.133c-11.46,0-21.069,7.62-24.329,18.022l-21.751-16.316 c-3.772-2.825-9.114-2.048-11.947,1.707c-2.825,3.772-2.065,9.122,1.707,11.947l31.189,23.39 c2.278,16.623,16.418,29.517,33.664,29.517h17.067c18.825,0,34.133-15.309,34.133-34.133c0,18.825,15.309,34.133,34.133,34.133 h17.067c17.237,0,31.394-12.894,33.664-29.517l31.189-23.39c3.772-2.825,4.54-8.175,1.707-11.947 c-2.825-3.772-8.175-4.548-11.947-1.707l-21.751,16.316c-3.251-10.402-12.86-18.022-24.329-18.022h-34.133 C267.487,170.668,256.001,182.153,256.001,196.268z M238.934,204.801c0,9.412-7.654,17.067-17.067,17.067h-17.067 c-9.412,0-17.067-7.654-17.067-17.067v-8.533c0-4.702,3.831-8.533,8.533-8.533h34.133c4.702,0,8.533,3.831,8.533,8.533V204.801z M324.268,196.268v8.533c0,9.412-7.654,17.067-17.067,17.067h-17.067c-9.412,0-17.067-7.654-17.067-17.067v-8.533 c0-4.702,3.823-8.533,8.533-8.533h34.133C320.445,187.734,324.268,191.566,324.268,196.268z"/>
                <path fill="${r}" d="M298.659,307.226c0.009-4.702-3.797-8.533-8.499-8.559c-0.162,0-15.42-0.171-30.345-7.629 c-2.398-1.203-5.231-1.203-7.629,0c-14.925,7.458-30.191,7.629-30.319,7.629c-4.71,0-8.533,3.823-8.533,8.533 s3.823,8.533,8.533,8.533c0.725,0,16.845-0.094,34.133-7.646c17.28,7.552,33.408,7.646,34.133,7.646 C294.836,315.734,298.642,311.928,298.659,307.226z"/>
                <path fill="${r}" d="M120.986,237.953c4.378,18.611,18.91,76.877,34.048,99.584c10.974,16.452,36.668,54.997,100.966,54.997 s89.993-38.545,100.966-54.997c15.138-22.707,29.67-80.973,34.048-99.584c10.718-3.055,18.586-12.937,18.586-24.619v-34.133 c0-11.127-7.134-20.617-17.067-24.141v-44.126c0-1.109-1.562-110.933-136.533-110.933c-151.842,0-153.6,126.72-153.6,128 c0,4.702,3.806,8.516,8.516,8.525h0.017c4.693,0,8.516-3.806,8.533-8.499c0.017-4.54,2.048-110.959,136.533-110.959 c117.581,0,119.441,90.061,119.467,93.867v51.2c0,4.71,3.814,8.533,8.533,8.533c4.71,0,8.533,3.831,8.533,8.533v34.133 c0,4.702-3.823,8.533-8.533,8.533c-4.002,0-7.458,2.782-8.337,6.682c-0.162,0.751-16.896,75.52-32.896,99.516 c-10.257,15.386-31.599,47.403-86.767,47.403s-76.51-32.017-86.767-47.403c-15.992-23.979-32.734-98.765-32.905-99.516 c-0.87-3.9-4.326-6.682-8.329-6.682c-4.702,0-8.533-3.831-8.533-8.533v-34.133c0-4.702,3.831-8.533,8.533-8.533 c1.323,0,2.637-0.307,3.814-0.896c2.978-1.493,72.986-37.333,72.986-110.037c0-4.71-3.823-8.533-8.533-8.533 s-8.533,3.823-8.533,8.533c0,56.678-52.523,88.636-62.08,93.978c-13.022,1.186-23.253,12.169-23.253,25.489v34.133 C102.401,225.016,110.269,234.898,120.986,237.953z"/>
                <path fill="${r}" d="M196.097,416.462c-0.794-3.994-4.292-6.861-8.363-6.861c-140.399,0-168.892,27.409-178.944,57.66l-8.533,34.133 c-1.143,4.582,1.638,9.207,6.204,10.351c0.7,0.179,1.391,0.256,2.082,0.256c3.823,0,7.296-2.586,8.269-6.46l8.354-33.51 c7.339-22.025,31.718-44.527,155.58-45.338l15.693,78.447c0.913,4.617,5.393,7.603,10.035,6.699 c4.625-0.93,7.62-5.427,6.69-10.044L196.097,416.462z"/>
                <path fill="${r}" d="M511.745,501.394l-8.721-34.756c-7.117-21.342-39.689-57.216-178.782-56.678c-4.062,0.009-7.544,2.867-8.337,6.852 l-17.067,84.975c-0.93,4.625,2.065,9.122,6.682,10.052c4.591,0.896,9.114-2.074,10.044-6.69l15.693-78.114 c103.714,0.674,148.412,23.484,155.401,44.373l8.533,34.133c0.973,3.874,4.446,6.468,8.269,6.46c0.683,0,1.382-0.077,2.074-0.256 C510.106,510.601,512.888,505.976,511.745,501.394z"/>
                <path fill="${r}" d="M256.257,426.668h-0.085c-4.71,0-8.491,3.823-8.491,8.533s3.866,8.533,8.576,8.533c4.71,0,8.533-3.823,8.533-8.533 S260.967,426.668,256.257,426.668z"/>
                <path fill="${r}" d="M256.257,494.934h-0.085c-4.71,0-8.491,3.823-8.491,8.533s3.866,8.533,8.576,8.533c4.71,0,8.533-3.823,8.533-8.533 S260.967,494.934,256.257,494.934z"/>
                <path fill="${r}" d="M247.468,324.268c-4.71,0-8.533,3.823-8.533,8.533c0,4.71,3.823,8.533,8.533,8.533h17.067 c4.719,0,8.533-3.823,8.533-8.533c0-4.71-3.814-8.533-8.533-8.533H247.468z"/>
                <path fill="${r}" d="M256.257,460.801h-0.085c-4.71,0-8.491,3.823-8.491,8.533c0,4.71,3.866,8.533,8.576,8.533 c4.71,0,8.533-3.823,8.533-8.533C264.79,464.624,260.967,460.801,256.257,460.801z"/>
            </svg>`},e.icon.mother=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512.011 512.011" >
                <path fill="${r}" d="M299.355,445.356c-1.621,1.536-2.56,3.755-2.56,5.973c0,2.304,0.939,4.437,2.56,6.059 c1.536,1.621,3.755,2.475,5.973,2.475c2.304,0,4.523-0.853,6.059-2.475c1.621-1.536,2.475-3.755,2.475-6.059 c0-2.219-0.853-4.437-2.475-5.973C308.23,442.113,302.512,442.199,299.355,445.356z"/>
                <path fill="${r}" d="M276.23,458.668c-1.621,1.621-2.475,3.755-2.475,6.059c0,2.219,0.939,4.437,2.475,5.973 c1.621,1.621,3.84,2.56,6.059,2.56c2.219,0,4.437-0.939,5.973-2.56c1.621-1.536,2.56-3.755,2.56-5.973 c0-2.304-0.939-4.437-2.56-6.059C285.104,455.511,279.387,455.511,276.23,458.668z"/>
                <path fill="${r}" d="M392.539,196.268c0-2.68-1.263-5.205-3.405-6.818c-8.55-6.443-30.729-26.957-30.729-44.382 c0-4.71-3.823-8.533-8.533-8.533s-8.533,3.823-8.533,8.533c0,24.678,24.354,47.249,34.014,55.228 c-1.835,33.476-24.917,95.223-33.118,111.625c-7.654,15.317-48.154,63.548-86.229,63.548s-78.575-48.23-86.229-63.548 c-8.542-17.084-33.237-83.379-33.237-115.652V170.54c33.835-0.802,157.321-6.929,218.453-52.779 c3.772-2.825,4.531-8.175,1.707-11.947c-2.825-3.763-8.166-4.531-11.947-1.707c-65.186,48.887-215.236,49.493-216.747,49.493 c-4.71,0-8.533,3.823-8.533,8.533v34.133c0,36.625,26.871,106.965,35.029,123.281c10.394,20.77,55.834,72.986,101.504,72.986 s91.11-52.215,101.504-72.986C365.668,303.233,392.539,232.893,392.539,196.268z"/>
                <path fill="${r}" d="M249.947,463.276c-1.536,1.621-2.475,3.84-2.475,6.059c0,2.219,0.939,4.437,2.475,6.059 c1.621,1.536,3.84,2.475,6.059,2.475s4.437-0.939,6.059-2.475c1.536-1.621,2.475-3.84,2.475-6.059 c0-2.219-0.939-4.437-2.475-6.059C258.907,460.119,253.104,460.119,249.947,463.276z"/>
                <path fill="${r}" d="M34.139,230.401c0,18.85,6.75,36.659,19.098,50.688c-1.348,5.76-2.031,11.648-2.031,17.579 c0,42.342,34.458,76.8,76.8,76.8c6.494,0,12.954-0.819,19.191-2.432c4.565-1.178,7.305-5.828,6.127-10.394 c-1.178-4.565-5.828-7.305-10.394-6.127c-4.847,1.254-9.865,1.886-14.925,1.886c-32.939,0-59.733-26.795-59.733-59.733 c0-5.922,0.879-11.793,2.603-17.459c0.922-3.021,0.102-6.298-2.133-8.525c-11.307-11.298-17.536-26.308-17.536-42.283 c0-19.251,9.421-37.453,25.199-48.674c3.78-2.688,4.719-7.893,2.116-11.742c-6.707-9.89-10.249-21.461-10.249-33.451 c0-28.843,20.591-53.53,48.947-58.701c2.432-0.452,4.557-1.929,5.811-4.053c18.987-32.137,40.892-56.713,133.888-56.713 c71.714,0,128.947,23.484,142.413,58.436c0.888,2.304,2.731,4.105,5.052,4.949c23.535,8.559,39.356,31.095,39.356,56.081 c0,11.989-3.541,23.561-10.249,33.451c-2.603,3.849-1.664,9.054,2.116,11.742c15.778,11.221,25.199,29.423,25.199,48.674 c0,15.974-6.229,30.984-17.536,42.283c-2.236,2.227-3.055,5.504-2.133,8.525c1.724,5.666,2.603,11.537,2.603,17.459 c0,32.939-26.795,59.733-59.733,59.733c-5.018,0-10.001-0.623-14.814-1.852c-4.574-1.186-9.207,1.579-10.377,6.144 c-1.169,4.574,1.587,9.216,6.153,10.385c6.195,1.587,12.595,2.389,19.038,2.389c42.342,0,76.8-34.458,76.8-76.8 c0-5.931-0.683-11.819-2.031-17.579c12.348-14.029,19.098-31.838,19.098-50.688c0-22.11-9.643-43.128-26.138-57.643 c5.956-11.102,9.071-23.475,9.071-36.224c0-30.865-18.748-58.82-47.044-70.733C395.475,25.704,334.598,0.001,256.919,0.001 c-90.172,0-121.984,21.7-146.62,61.85c-34.475,8.115-59.093,38.921-59.093,74.684c0,12.749,3.115,25.122,9.071,36.224 C43.782,187.274,34.139,208.291,34.139,230.401z"/>
                <path fill="${r}" d="M316.507,424.876c-1.621,1.621-2.475,3.84-2.475,6.059c0,2.304,0.853,4.437,2.475,6.059 c1.621,1.536,3.755,2.475,5.973,2.475c2.304,0,4.437-0.939,6.059-2.475c1.621-1.621,2.475-3.755,2.475-6.059 c0-2.219-0.853-4.437-2.475-6.059C325.382,421.719,319.664,421.719,316.507,424.876z"/>
                <path fill="${r}" d="M223.664,458.668c-1.536,1.621-2.475,3.755-2.475,6.059c0,2.219,0.939,4.437,2.475,6.059 c1.621,1.536,3.84,2.475,6.059,2.475c2.304,0,4.437-0.939,6.059-2.475c1.621-1.621,2.475-3.84,2.475-6.059 c0-2.219-0.853-4.437-2.475-6.059C232.624,455.511,226.907,455.511,223.664,458.668z"/>
                <path fill="${r}" d="M337.67,411.905c1.621-1.621,2.475-3.755,2.475-6.059c0-2.219-0.853-4.437-2.475-6.059 c-3.157-3.157-8.875-3.072-12.032,0.085c-1.621,1.536-2.56,3.755-2.56,5.973c0,2.304,0.939,4.437,2.56,6.059 c1.536,1.621,3.755,2.475,5.973,2.475C333.915,414.38,336.048,413.527,337.67,411.905z"/>
                <path fill="${r}" d="M213.339,238.935c4.71,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.181-2.176,5.803-7.33,3.627-11.511 c-2.534-4.873-10.581-13.124-24.636-13.124c-14.054,0-22.101,8.252-24.636,13.124c-2.125,4.087-0.555,8.969,3.456,11.23 c4.011,2.287,9.156,0.811,11.563-3.123c0.077-0.128,0.495-0.623,1.084-1.195v5.564 C204.806,235.112,208.629,238.935,213.339,238.935z"/>
                <path fill="${r}" d="M256.006,332.801c20.028,0,30.507-9.907,31.633-11.034c3.294-3.294,3.285-8.567,0.043-11.913 c-3.234-3.345-8.61-3.439-12.015-0.247c-0.265,0.247-6.699,6.127-19.661,6.127c-12.774,0-19.208-5.709-19.652-6.118 c-3.336-3.251-8.678-3.217-11.981,0.085c-3.337,3.336-3.337,8.73,0,12.066C225.499,322.894,235.978,332.801,256.006,332.801z"/>
                <path fill="${r}" d="M298.672,238.935c4.71,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.181-2.176,5.803-7.33,3.627-11.511 c-2.534-4.873-10.581-13.124-24.636-13.124s-22.101,8.252-24.636,13.124c-2.125,4.087-0.555,8.969,3.456,11.23 c4.011,2.287,9.165,0.811,11.563-3.123c0.077-0.128,0.495-0.623,1.084-1.195v5.564 C290.139,235.112,293.962,238.935,298.672,238.935z"/>
                <path fill="${r}" d="M511.571,500.771l-8.533-25.6c-8.883-26.658-62.464-65.212-136.098-65.212c-3.482,0-6.613,2.116-7.919,5.333 c-0.316,0.802-33.015,79.642-103.014,79.642c-69.99,0-102.69-79.181-103.014-79.983c-1.306-3.226-4.437-5.35-7.919-5.35 c-106.001,0-130.97,50.185-136.098,65.57l-8.533,25.6c-1.493,4.471,0.93,9.301,5.402,10.795c4.48,1.502,9.301-0.93,10.795-5.402 l8.533-25.6c8.465-25.412,42.974-52.514,114.381-53.845c9.293,19.703,45.577,85.282,116.454,85.282 c70.827,0,107.102-65.229,116.437-84.898c64.051,1.835,108.339,35.294,114.398,53.461l8.533,25.6 c1.195,3.576,4.523,5.837,8.098,5.837c0.887,0,1.801-0.137,2.697-0.435C510.64,510.073,513.064,505.243,511.571,500.771z"/>
                <path fill="${r}" d="M375.472,281.601v17.067c0,4.71,3.823,8.533,8.533,8.533c4.71,0,8.533-3.823,8.533-8.533v-17.067 c0-4.71-3.823-8.533-8.533-8.533C379.295,273.068,375.472,276.891,375.472,281.601z"/>
                <path fill="${r}" d="M188.934,405.847c0-2.219-0.939-4.437-2.56-5.973c-3.157-3.243-8.875-3.243-12.032,0 c-1.621,1.536-2.475,3.755-2.475,5.973c0,2.304,0.853,4.437,2.475,6.059s3.755,2.475,6.059,2.475 c2.219,0,4.437-0.853,5.973-2.475C187.995,410.284,188.934,408.151,188.934,405.847z"/>
                <path fill="${r}" d="M189.531,439.468c2.219,0,4.437-0.939,5.973-2.475c1.621-1.621,2.475-3.755,2.475-6.059c0-2.219-0.853-4.437-2.475-6.059 c-3.157-3.157-8.875-3.157-12.032,0c-1.621,1.621-2.475,3.84-2.475,6.059c0,2.304,0.853,4.437,2.475,6.059 C185.008,438.529,187.227,439.468,189.531,439.468z"/>
                <path fill="${r}" d="M200.624,445.356c-1.621,1.621-2.56,3.755-2.56,6.059c0,2.219,0.939,4.437,2.56,5.973c1.621,1.621,3.755,2.56,6.059,2.56 c2.219,0,4.437-0.939,5.973-2.56c1.621-1.536,2.475-3.755,2.475-5.973c0-2.304-0.853-4.523-2.475-6.059 C209.499,442.199,203.782,442.199,200.624,445.356z"/>
                <path fill="${r}" d="M119.472,281.601v17.067c0,4.71,3.823,8.533,8.533,8.533s8.533-3.823,8.533-8.533v-17.067 c0-4.71-3.823-8.533-8.533-8.533S119.472,276.891,119.472,281.601z"/>
            </svg>`},e.icon.teddy=function(t,n,r,s,o){return e.isNEU(s)&&(s=0),e.isNEU(o)&&(o=0),`<svg width="${t}" height="${n}" x="${s}" y="${o}" viewBox="0 0 512 512">
                <path fill="${r}" d="M234.513,246.613c9.378-1.929,16.555-9.02,21.487-15.863c4.932,6.844,12.109,13.935,21.487,15.863 c1.459,0.299,3.089,0.486,4.873,0.486c6.118,0,13.978-2.304,22.34-10.667c3.337-3.337,3.337-8.73,0-12.066s-8.73-3.337-12.066,0 c-4.361,4.369-8.337,6.212-11.699,5.53c-6.912-1.408-13.611-12.203-16.401-18.364c9.523-3.866,17.067-13.577,17.067-23.799 c0-9.353-9.566-14.933-25.6-14.933c-16.026,0-25.6,5.581-25.6,14.933c0,10.223,7.535,19.934,17.067,23.799 c-2.807,6.178-9.498,16.956-16.401,18.364c-3.405,0.666-7.339-1.178-11.699-5.53c-3.336-3.337-8.73-3.337-12.066,0 s-3.337,8.73,0,12.066C218.104,247.236,228.062,247.91,234.513,246.613z M263.748,190.669c-1.502,2.944-4.873,5.598-7.748,5.598	s-6.246-2.654-7.748-5.598C251.793,189.833,260.207,189.833,263.748,190.669z"/>
                <path fill="${r}" d="M390.033,53.7c1.621,1.613,2.5,3.755,2.5,6.033s-0.879,4.42-2.5,6.025c-3.337,3.337-3.337,8.738,0,12.075 c1.664,1.664,3.849,2.5,6.033,2.5s4.369-0.836,6.033-2.492c4.838-4.838,7.501-11.273,7.501-18.108s-2.662-13.269-7.501-18.099 c-9.984-9.984-26.214-9.984-36.198,0c-3.337,3.328-3.337,8.73,0,12.066s8.73,3.337,12.066,0 C381.303,50.372,386.697,50.372,390.033,53.7z"/>
                <path fill="${r}" d="M311.467,136.533c7.057,0,12.8-5.743,12.8-12.8c0-7.057-5.743-12.8-12.8-12.8s-12.8,5.743-12.8,12.8 C298.667,130.79,304.41,136.533,311.467,136.533z"/>
                <path fill="${r}" d="M200.533,136.533c7.057,0,12.8-5.743,12.8-12.8c0-7.057-5.743-12.8-12.8-12.8s-12.8,5.743-12.8,12.8 C187.733,130.79,193.476,136.533,200.533,136.533z"/>
                <path fill="${r}" d="M115.934,80.333c2.185,0,4.369-0.836,6.042-2.5c3.328-3.337,3.328-8.738-0.009-12.075c-1.613-1.604-2.5-3.746-2.5-6.025 s0.887-4.42,2.509-6.033c3.209-3.226,8.841-3.226,12.058,0c3.328,3.337,8.738,3.328,12.066,0 c3.337-3.328,3.337-8.738,0.009-12.066c-9.677-9.677-26.539-9.668-36.207-0.009c-4.838,4.838-7.501,11.273-7.501,18.108 s2.662,13.269,7.501,18.108C111.565,79.497,113.749,80.333,115.934,80.333z"/>
                <path fill="${r}" d="M498.552,286.191c-28.262-23.945-91.742-14.2-98.884-13.005c-4.651,0.768-7.791,5.171-7.014,9.813 c0.777,4.651,5.171,7.799,9.813,7.014c17.246-2.867,66.133-6.827,85.052,9.199c5.06,4.284,7.415,9.54,7.415,16.521 c0,3.977-1.476,6.946-4.779,9.626c-24.098,19.567-114.33,5.982-147.063-0.913c-3.703-0.776-7.441,0.981-9.242,4.275 c-1.801,3.311-1.212,7.424,1.434,10.095c0.12,0.119,8.499,8.755,12.493,19.951c-2.125-0.222-4.267-0.367-6.443-0.367 c-37.641,0-68.267,34.458-68.267,76.8c0,7.629,1.024,14.993,2.884,21.956c-3.823,1.715-10.197,3.644-19.951,3.644 c-10.052,0-16.367-2.082-19.908-3.814c1.826-6.912,2.842-14.217,2.842-21.786c0-42.342-30.626-76.8-68.267-76.8 c-2.176,0-4.318,0.145-6.443,0.367c3.994-11.196,12.373-19.831,12.476-19.934c2.671-2.671,3.268-6.775,1.468-10.095 c-1.792-3.319-5.521-5.069-9.259-4.292c-32.725,6.895-122.974,20.48-147.063,0.913c-3.302-2.68-4.779-5.649-4.779-9.626 c0-6.98,2.355-12.228,7.407-16.512c18.867-15.991,67.806-12.066,85.06-9.208c4.651,0.794,9.045-2.364,9.813-7.014 c0.776-4.651-2.364-9.045-7.006-9.813c-7.151-1.195-70.613-10.957-98.884,13.005C4.651,293.649,0,303.863,0,315.733 c0,9.079,3.831,16.998,11.093,22.886c27.179,22.05,102.818,12.783,140.535,6.426c-2.825,5.47-5.188,11.896-6.11,18.825 c-25.216,11.29-43.119,38.98-43.119,71.33c0,42.342,30.626,76.8,68.267,76.8c25.446,0,47.642-15.778,59.383-39.057 c5.743,2.56,14.174,4.924,25.95,4.924c11.674,0,20.164-2.287,26.035-4.77C293.794,496.29,315.938,512,341.333,512 c37.641,0,68.267-34.458,68.267-76.8c0-32.35-17.903-60.041-43.119-71.33c-0.922-6.929-3.277-13.355-6.101-18.825 c37.717,6.357,113.365,15.633,140.527-6.426c7.262-5.888,11.093-13.807,11.093-22.886 C512,303.863,507.349,293.649,498.552,286.191z M170.667,494.933c-28.237,0-51.2-26.795-51.2-59.733s22.963-59.733,51.2-59.733 s51.2,26.795,51.2,59.733S198.904,494.933,170.667,494.933z M392.533,435.2c0,32.939-22.963,59.733-51.2,59.733 c-20.983,0-39.04-14.814-46.942-35.942c-0.145-0.614-0.324-1.186-0.606-1.766c-2.338-6.818-3.652-14.242-3.652-22.025 c0-32.939,22.963-59.733,51.2-59.733C369.57,375.467,392.533,402.261,392.533,435.2z"/>
                <path fill="${r}" d="M307.2,443.733c0,18.825,15.309,34.133,34.133,34.133c18.825,0,34.133-15.309,34.133-34.133 c0-18.825-15.309-34.133-34.133-34.133C322.509,409.6,307.2,424.909,307.2,443.733z M358.4,443.733 c0,9.412-7.654,17.067-17.067,17.067c-9.404,0-17.067-7.654-17.067-17.067c0-9.412,7.663-17.067,17.067-17.067 C350.746,426.667,358.4,434.321,358.4,443.733z"/>
                <path fill="${r}" d="M115.541,118.161c-8.619,21.709-13.141,45.525-13.141,69.572c0,67.849,52.762,136.533,153.6,136.533 s153.6-68.685,153.6-136.533c0-24.491-4.412-47.846-13.107-69.581c26.957-5.76,47.24-29.764,47.24-58.419 C443.733,26.795,416.93,0,384,0c-24.67,0-46.14,14.916-55.108,36.745C307.115,23.859,282.368,17.067,256,17.067 c-26.615,0-51.2,6.716-73.259,19.925C174.08,14.754,153.088,0,128,0C95.061,0,68.267,26.795,68.267,59.733 C68.267,88.397,88.559,112.41,115.541,118.161z M128,17.067c19.226,0,35.021,12.177,40.115,30.054 c-11.085,8.61-21.163,18.816-29.901,30.592c-2.807,3.789-2.014,9.131,1.775,11.938c3.789,2.816,9.139,2.022,11.938-1.766 c8.9-12.006,19.26-22.281,30.788-30.507C204.288,41.95,228.949,34.133,256,34.133c41.429,0,78.396,19.098,104.098,53.786 c1.681,2.253,4.25,3.447,6.869,3.447c1.766,0,3.55-0.546,5.077-1.681c3.78-2.799,4.574-8.149,1.775-11.938 c-8.969-12.092-19.157-22.485-30.345-31.104c5.427-17.374,21.632-29.577,40.525-29.577c23.526,0,42.667,19.14,42.667,42.667 S407.526,102.4,384,102.4c-2.935,0-5.658,1.502-7.228,3.985c-1.553,2.483-1.732,5.589-0.461,8.243 c10.761,22.443,16.222,47.044,16.222,73.105C392.533,247.1,345.634,307.2,256,307.2s-136.533-60.1-136.533-119.467 c0-25.617,5.615-50.901,16.23-73.122c1.263-2.637,1.084-5.751-0.478-8.226c-1.562-2.483-4.292-3.985-7.219-3.985 c-23.526,0-42.667-19.14-42.667-42.667S104.474,17.067,128,17.067z"/>
                <path fill="${r}" d="M256,290.133c47.053,0,85.333-30.626,85.333-68.267c0-36.258-36.489-76.8-85.333-76.8s-85.333,40.542-85.333,76.8 C170.667,259.507,208.947,290.133,256,290.133z M256,162.133c38.451,0,68.267,32.111,68.267,59.733 c0,28.237-30.626,51.2-68.267,51.2c-37.641,0-68.267-22.963-68.267-51.2C187.733,194.244,217.557,162.133,256,162.133z"/>
                <path fill="${r}" d="M170.667,409.6c-18.825,0-34.133,15.309-34.133,34.133c0,18.825,15.309,34.133,34.133,34.133 s34.133-15.309,34.133-34.133C204.8,424.909,189.491,409.6,170.667,409.6z M170.667,460.8c-9.412,0-17.067-7.654-17.067-17.067 c0-9.412,7.654-17.067,17.067-17.067c9.412,0,17.067,7.654,17.067,17.067C187.733,453.146,180.079,460.8,170.667,460.8z"/>
            </svg>`},e.prototype.exportPDFProfile=function(t,n){t=this._defaultExportProfileOptions(t,"pdf"),this._exportProfile(t,n)},e.prototype.exportPDFPreview=function(t){e.pdfPrevUI.show(this,t)},e.prototype.exportPNGProfile=function(t,n){t=this._defaultExportProfileOptions(t,"png"),this._exportProfile(t,n)},e.prototype.shareProfile=function(t){var n;typeof t=="object"?t=(n=t).focusId:n=this.editUI.content(t,!0,!0,"100%",!0);var r=new URL(window.location.href);r.searchParams.append("nodeId",t);var s={title:n.title,text:n.shareText,url:r.href};try{navigator.share(s)}catch(o){console.error("error: "+o)}},e.prototype.exportPDF=function(t,n){t=this._defaultExportOptions(t,"pdf"),this._export(t,n)},e.prototype.exportPNG=function(t,n){t=this._defaultExportOptions(t,"png"),this._export(t,n)},e.prototype.exportSVG=function(t,n){t=this._defaultExportOptions(t,"svg"),this._export(t,n)},e.prototype._defaultExportOptions=function(t,n){return t==null&&(t={}),n=="svg"?(t.ext="svg",t.mime="image/svg+xml"):n=="pdf"?(t.mime="application/pdf",t.ext="pdf"):n=="png"&&(t.mime="image/png",t.ext="png"),t.margin==null&&(t.margin=[50,40,50,40]),t.padding==null&&(t.padding=0),t.landscape==null&&(t.landscape=!1),t.filename==null&&(t.filename="FamilyTree."+t.ext),t.scale==null&&(t.scale="fit"),t.format==null&&(t.format="fit"),t.header==null&&(t.header=""),n=="pdf"&&t.footer==null?t.footer="Page {current-page} of {total-pages}":t.footer==null&&(t.footer=""),t.openInNewTab==null&&(t.openInNewTab=!1),t.mode==null&&(t.mode="bft-"+this.config.mode),t},e.prototype._export=function(t,n){var r=this,s={id:t.nodeId,expandChildren:t.expandChildren,min:t.min};t.margin&&t.margin[0]<2&&(t.margin[0]=2),t.margin&&t.margin[1]<2&&(t.margin[1]=2),t.margin&&t.margin[2]<2&&(t.margin[2]=2),t.margin&&t.margin[3]<2&&(t.margin[3]=2),this._draw(!1,e.action.exporting,s,function(o,a){var l=document.createElement("div");if(l.innerHTML=o,t.padding>0){var c=l.querySelector("svg"),u=e._getViewBox(c);u[0]-=t.padding,u[1]-=t.padding,u[2]+=2*t.padding,u[3]+=2*t.padding,c.setAttribute("viewBox",u.join()),c.setAttribute("width",u[2]),c.setAttribute("height",u[3])}if(t.ext=="svg")if(n)n(t,l.innerHTML);else{(c=l.querySelector("svg")).classList.add("bft-"+r.config.mode);var h={content:l.innerHTML,options:t,styles:""},d=e.events.publish("exportstart",[r,h]),p=r.element.querySelector("[data-bft-styles]");if(p&&(h.styles+=p.outerHTML),h.styles&&(l.childNodes[0].insertAdjacentHTML("afterbegin",h.styles),h.content=l.innerHTML),d===!1||(d=e.events.publish("exportend",[r,h]))===!1)return!1;e._downloadFile(t.mime,h.content,h.options.filename,h.options.openInNewTab,h.options.ext)}else r._pages(t,l.querySelector("svg"),a,function(g){var _={content:l.innerHTML,options:t,pages:g,styles:""},v=e.events.publish("exportstart",[r,_]),C=r.element.querySelector("[data-bft-styles]");if(C&&(_.styles+=C.outerHTML),v===!1)return!1;n||e.loading.show(r),n?n(r,_,l.querySelector("svg")):(_=JSON.stringify(_),e._ajax(r.config.exportUrl+"/v3","POST",_,"arraybuffer",function(T){var y=e.events.publish("exportend",[r,T]);if(e.loading.hide(r),y===!1)return!1;e._downloadFile(t.mime,T,t.filename,t.openInNewTab,t.ext)}))})})},e.prototype.exportCSV=function(t){var n=e._defaultExportProfileOptionsForCSV_SVG_JSON(t,"csv"),r=this.getNode(n.nodeId),s=null;r?(s=[],e._exportIterateForJSON_XML_CSV(this,r,n,s)):n.min===!1||n.expandChildren===!1?e._exportIterateForJSON_XML_CSV(this,this.roots,n,s):s=JSON.parse(JSON.stringify(this.config.nodes));var o={ext:"csv",filename:t,options:n,nodes:s};if(e.events.publish("exportstart",[this,o])===!1)return!1;var a=e._json2csv(o.nodes),l={ext:o.ext,filename:o.filename,options:n,nodes:o.nodes,content:a};if(e.events.publish("exportend",[this,l])===!1)return!1;e._downloadFile("text/csv;charset=utf-8;","\uFEFF"+l.content,l.options.filename,l.options.openInNewTab,l.ext)},e.prototype.exportXML=function(t){var n=e._defaultExportProfileOptionsForCSV_SVG_JSON(t,"xml"),r=this.getNode(n.nodeId),s=null;r?(s=[],e._exportIterateForJSON_XML_CSV(this,r,n,s)):n.min===!1||n.expandChildren===!1?e._exportIterateForJSON_XML_CSV(this,this.roots,n,s):s=JSON.parse(JSON.stringify(this.config.nodes));var o={ext:"xml",filename:t,options:n,nodes:s};if(e.events.publish("exportstart",[this,o])===!1)return!1;var a=e._json2xml(o.nodes),l={ext:o.ext,filename:o.filename,options:n,nodes:o.nodes,content:a};if(e.events.publish("exportend",[this,l])===!1)return!1;e._downloadFile("application/xml",l.content,l.options.filename,l.options.openInNewTab,l.ext)},e.prototype.exportJSON=function(t){var n=e._defaultExportProfileOptionsForCSV_SVG_JSON(t,"json"),r=this.getNode(n.nodeId),s=null;r?(s=[],e._exportIterateForJSON_XML_CSV(this,r,n,s)):n.min===!1||n.expandChildren===!1?e._exportIterateForJSON_XML_CSV(this,this.roots,n,s):s=JSON.parse(JSON.stringify(this.config.nodes));var o={ext:"json",filename:n.filename,options:n,nodes:s};if(e.events.publish("exportstart",[this,o])===!1)return!1;var a={ext:o.ext,filename:o.filename,options:n,nodes:o.nodes,content:JSON.stringify(o.nodes)};if(e.events.publish("exportend",[this,a])===!1)return!1;e._downloadFile("application/json",a.content,a.options.filename,a.options.openInNewTab,a.ext)},e._exportIterateForJSON_XML_CSV=function(t,n,r,s){if(Array.isArray(n))for(var o=0;o<n.length;o++)e._exportIterateForJSON_XML_CSV(t,n[o],r,s);else{var a=t.get(n.id);if(s.push(a),r.min)for(o=0;o<n.stChildrenIds.length;o++)e._exportIterateForJSON_XML_CSV(t,t.getNode(n.stChildrenIds[o]),r,s);else for(o=0;o<n.stChildren.length;o++)e._exportIterateForJSON_XML_CSV(t,n.stChildren[o],r,s);if(r.expandChildren)for(o=0;o<n.childrenIds.length;o++)e._exportIterateForJSON_XML_CSV(t,t.getNode(n.childrenIds[o]),r,s);else for(o=0;o<n.children.length;o++)e._exportIterateForJSON_XML_CSV(t,n.children[o],r,s)}},e.prototype._pages=function(t,n,r,s){t.format=="A5"&&t.scale!="fit"||t.format=="A4"&&t.scale!="fit"||t.format=="A3"&&t.scale!="fit"||t.format=="A2"&&t.scale!="fit"||t.format=="A1"&&t.scale!="fit"||t.format=="Letter"&&t.scale!="fit"||t.format=="Legal"&&t.scale!="fit"?s(this._pagesA100(t,n,t.scale)):t.format=="A5"&&t.scale=="fit"||t.format=="A4"&&t.scale=="fit"||t.format=="A3"&&t.scale=="fit"||t.format=="A2"&&t.scale=="fit"||t.format=="A1"&&t.scale=="fit"||t.format=="Letter"&&t.scale=="fit"||t.format=="Legal"&&t.scale=="fit"?s(this._pagesAfit(t,n,r)):t.format=="fit"&&s(this._pagesFit(t,n))},e.prototype._pagesFit=function(t,n){var r=n.getAttribute("width"),s=n.getAttribute("height"),o=e._getViewBox(n),a={w:parseFloat(r),h:parseFloat(s)};return[{vb:o,size:{w:a.w+(t.margin[1]+t.margin[3]),h:a.h+(t.margin[0]+t.margin[2])},innerSize:a}]},e.prototype._pagesAfit=function(t,n,r){var s=n.getAttribute("width"),o=0,a=0;switch(t.format){case"A5":o=e.A5w,a=e.A5h;break;case"A4":o=e.A4w,a=e.A4h;break;case"A3":o=e.A3w,a=e.A3h;break;case"A2":o=e.A2w,a=e.A2h;break;case"A1":o=e.A1w,a=e.A1h;break;case"Letter":o=e.Letterw,a=e.Letterh;break;case"Legal":o=e.Legalw,a=e.Legalh}var l=t.landscape?a-(t.margin[1]+t.margin[3]):o-(t.margin[1]+t.margin[3]),c=(t.landscape,t.margin[0],t.margin[2],l/s);return this._pagesA100(t,n,100*c,r)},e.prototype._pagesA100=function(t,n,r,s){var o=e._getViewBox(n),a=0,l=0;switch(t.format){case"A5":a=e.A5w,l=e.A5h;break;case"A4":a=e.A4w,l=e.A4h;break;case"A3":a=e.A3w,l=e.A3h;break;case"A2":a=e.A2w,l=e.A2h;break;case"A1":a=e.A1w,l=e.A1h;break;case"Letter":a=e.Letterw,l=e.Letterh;break;case"Legal":a=e.Legalw,l=e.Legalh}var c=o[0],u=o[1],h=o[2],d=o[3],p={w:t.landscape?l-(t.margin[1]+t.margin[3]):a-(t.margin[1]+t.margin[3]),h:t.landscape?a-(t.margin[0]+t.margin[2]):l-(t.margin[0]+t.margin[2])},g={w:t.landscape?l:a,h:t.landscape?a:l};n.setAttribute("width",p.w),n.setAttribute("height",p.h);var _=p.w*(100/r),v=p.h*(100/r),C=c,T=u,y=[],A=!0;if(!e.EXPORT_PAGES_CUT_NODES&&t.scale=="fit"){n.setAttribute("preserveAspectRatio","xMinYMin");for(var E=Object.keys(s.bordersByRootIdAndLevel),x=s.bordersByRootIdAndLevel[E[0]],w=Object.keys(x).length,S=1;S<E.length;S++)w<Object.keys(s.bordersByRootIdAndLevel[E[S]]).length&&(x=s.bordersByRootIdAndLevel[E[S]],w=Object.keys(x).length);for(var I=0,k=0;;){for(k=I;!(w<=I);){if((x[I].maxY-x[I].minY)/(100/r)>p.h){A=!1;break}var P=(x[I].minY-x[k].minY)/(100/r);if(I==w-1&&(P=(x[I].maxY-x[k].minY)/(100/r)),P>p.h)break;I++}if(!A)break;var O=(I==w?x[I-1].maxY:x[I-1].minY)-x[k].minY;if(O==0){A=!1;break}if(R=(R=[C,x[k].minY,_,O]).join(),y.push({vb:R,innerSize:{w:p.x,h:O/(100/r)-1},size:g}),I==w)break;I--}y.length&&(y[y.length-1].innerSize.h+=1)}if(!A||e.EXPORT_PAGES_CUT_NODES||t.scale!="fit")for(n.setAttribute("preserveAspectRatio","xMinYMin slice"),y=[];C<h+c;){for(;T<d+u;){var R;R=(R=[C,T,_,v]).join(),y.push({vb:R,innerSize:p,size:g}),T+=v}C+=_,T=u}return y},e.prototype._defaultExportProfileOptions=function(t,n){return e.isNEU(t)||t.id==null||t.nodeId!=null||(t.nodeId=t.id),(e.isNEU(t)||e.isNEU(t.nodeId))&&console.error("options.nodeId is not defilned"),n=="svg"?(t.ext="svg",t.mime="image/svg+xml"):n=="pdf"?(t.mime="application/pdf",t.ext="pdf"):n=="png"&&(t.mime="image/png",t.ext="png"),t.margin==null&&(t.margin=[50,40,50,40]),t.padding==null&&(t.padding=0),t.landscape==null&&(t.landscape=!1),t.filename==null&&(t.filename="Profile."+t.ext),t.scale==null&&(t.scale="fit"),t.format==null&&(t.format="A4"),t.header==null&&(t.header=""),t.footer==null&&(t.footer=""),t.openInNewTab==null&&(t.openInNewTab=!1),t.mode==null&&(t.mode="bft-"+this.config.mode),t},e._defaultExportProfileOptionsForCSV_SVG_JSON=function(t,n){return e.isNEU(t)&&(t={}),typeof t=="string"&&(t={filename:t}),e.isNEU(t.filename)&&(t.filename=`FamilyTree.${n}`),e.isNEU(t.expandChildren)&&(t.expandChildren=!0),e.isNEU(t.min)&&(t.min=!0),e.isNEU(t.openInNewTab)&&(t.openInNewTab=!1),t},e.prototype._exportProfile=function(t,n){var r=this,s=0,o=0;switch(t.format){case"A5":s=e.A5w,o=e.A5h;break;case"A4":s=e.A4w,o=e.A4h;break;case"A3":s=e.A3w,o=e.A3h;break;case"A2":s=e.A2w,o=e.A2h;break;case"A1":s=e.A1w,o=e.A1h;break;case"Letter":s=e.Letterw,o=e.Letterh;break;case"Legal":s=e.Legalw,o=e.Legalh}var a={w:t.landscape?o-(t.margin[1]+t.margin[3]):s-(t.margin[1]+t.margin[3]),h:t.landscape?s-(t.margin[0]+t.margin[2]):o-(t.margin[0]+t.margin[2])},l={w:t.landscape?o:s,h:t.landscape?s:o},c=this.editUI.content(t.nodeId,!0,!0,"100%",!0).element;e.input.init(c);var u={content:c.outerHTML,options:t,pages:[{vb:"",innerSize:a,size:l}],styles:""};if(!n){if(e.events.publish("exportstart",[r,u])===!1)return!1;e.loading.show(r)}var h=this.element.querySelector("[data-bft-styles]");h&&(u.styles+=h.outerHTML);var d=this.getSvg().querySelector("defs");if(d)for(var p=0;p<d.children.length;p++)d.children[p].nodeName.toLowerCase()=="style"&&(u.styles+=d.children[p].outerHTML);u=JSON.stringify(u),e._ajax(this.config.exportUrl+"/v3","POST",u,"arraybuffer",function(g){if(n)n(r,g);else{var _=e.events.publish("exportend",[r,g]);if(e.loading.hide(r),_===!1)return!1;e._downloadFile(t.mime,g,t.filename,t.openInNewTab,t.ext)}})},e===void 0&&(e={}),e.events=function(){var t={};return{on:function(n,r,s){Array.isArray(t[n])||(t[n]=[]),t[n].push({listener:r,event_id:s})},removeAll:function(n){Array.isArray(t[n])||(t[n]=[]),t[n]=[]},remove:function(n,r,s){var o=!1;if(t[n]&&Array.isArray(t[n])&&t[n].length>0)for(var a=t[n].length-1;a>=0;a--)(!e.isNEU(s)&&!e.isNEU(r)&&t[n][a].event_id==s&&t[n][a].listener==r||!e.isNEU(s)&&e.isNEU(r)&&t[n][a].event_id==s||e.isNEU(s)&&!e.isNEU(r)&&t[n][a].listener==r||e.isNEU(s)&&e.isNEU(r))&&(t[n].splice(a,1),o=!0);return o},has:function(n,r){if(t[n]&&Array.isArray(t[n])&&t[n].length>0){if(e.isNEU(r))return!0;for(var s=0;s<t[n].length;s++)if(t[n][s].event_id==r)return!0}return!1},removeForEventId:function(n){for(var r in t)if(Array.isArray(t[r]))for(var s=t[r].length-1;s>=0;s--)t[r][s].event_id==n&&t[r].splice(s,1)},publish:function(n,r){if(t[n]){for(var s=[],o=0;o<t[n].length;o++){var a=t[n][o];a.event_id!=null&&a.event_id!=r[0]._event_id||s.push(a.listener)}if(s.length>0){var l=!0;for(o=0;o<s.length&&(r.length==1?l=s[o](r[0])&&l:r.length==2?l=s[o](r[0],r[1])&&l:r.length==3?l=s[o](r[0],r[1],r[2])&&l:r.length==4?l=s[o](r[0],r[1],r[2],r[3])&&l:r.length==5&&(l=s[o](r[0],r[1],r[2],r[3],r[4])&&l),l!==!1);o++);return l}}}}}(),e.prototype.importCSV=function(){var t=this,n=document.createElement("INPUT");n.setAttribute("type","file"),n.setAttribute("accept",".csv"),n.style.display="none",n.onchange=function(r){var s=r.target,o=new FileReader;o.onload=function(){var a=o.result,l=e._csvToArray(a),c=[],u=l[0];e._importSetColumnNames(u,function(h){for(var d=1;d<l.length;d++){for(var p={},g=0;g<l[d].length;g++){var _=h[g],v=l[d][g];p[_]=e._convertStringToArray(_,v)}p.id.trim()!=""&&c.push(p)}var C={nodes:c,columnNames:l[0]};e.events.publish("import",[t,C])!=0&&(t._putInUndoStack(),t.clearRedo(),t.config.nodes=C.nodes,e.events.publish("updated",[t]),t.filterUI.update(),t.draw())})},o.readAsText(s.files[0])},n.click()},e._importSetColumnNames=function(t,n){if(t.indexOf("id")==-1||t.indexOf("pid")==-1){var r=document.createElement("DIV"),s=document.createElement("P");s.style.padding="5px",s.style.color="rgb(122, 122, 122)",s.innerHTML=e.IMPORT_MESSAGE,r.appendChild(s);var o=document.createElement("div"),a=document.createElement("div"),l=document.createElement("div"),c=document.createElement("span");o.setAttribute("id","bft-sampleDialog"),o.style.height="260px",o.style.width="400px",o.style.background="white",o.style.border="0.5px solid grey",o.style.position="fixed",o.style.overflow="hidden",o.style.zIndex="99",a.setAttribute("id","title"),a.style.backgroundColor="#e5e5e5",a.style.fontWeight="bold",a.style.color="rgb(122, 122, 122)",a.style.height="20px",a.style.padding="3px 0 0 7px",c.setAttribute("id","close"),c.style.cursor="pointer",c.style.position="absolute",c.style.color="rgb(122, 122, 122)",c.style.fontWeight="bold",c.style.top="2px",c.style.zIndex=100,l.setAttribute("id","content"),l.style.padding="2px",a.innerHTML="Import Organizational Chart Data",c.innerHTML="&times;";var u=document.createElement("HR");u.style.height="0.1px",u.style.backgroundColor="#aeaeae",u.style.border="none",u.style.margin="0",o.appendChild(a),o.appendChild(u),l.appendChild(r),o.appendChild(l),o.appendChild(c),document.body.appendChild(o),e._importCenter(o),c.style.left=o.offsetWidth-20+"px";var h=document.createElement("div");h.setAttribute("id","overlay"),h.style.width="100%",h.style.height="100%",h.style.left=0,h.style.top=0,h.style.position="fixed",h.style.background="grey",h.style.opacity="0.5",h.style.zIndex=98,document.body.appendChild(h),o._overlay=h;var d=document.createElement("LABEL"),p=document.createTextNode("Name:");d.setAttribute("for","bft-id-select"),d.appendChild(p),d.style.fontSize="16px",d.style.color="rgb(122, 122, 122)",d.style.padding="5px",d.style.margin="5px",d.style.width="30%",d.style.textAlign="right",d.style.display="inline-block",r.appendChild(d);var g=document.createElement("SELECT");g.id="bft-id-select",g.style.fontSize="16px",g.style.color="rgb(122, 122, 122)",g.style.padding="5px",g.style.margin="5px",g.style.width="60%",g.style.border="1px solid #aeaeae",r.appendChild(g);var _=document.createElement("BR");r.appendChild(_);for(var v=0;v<t.length;v++){(E=document.createElement("option")).setAttribute("value",t[v]);var C=document.createTextNode(t[v]);E.appendChild(C),g.appendChild(E)}var T=document.createElement("LABEL"),y=document.createTextNode("Reports to:");T.setAttribute("for","pid-select"),T.appendChild(y),T.style.fontSize="16px",T.style.color="rgb(122, 122, 122)",T.style.padding="5px",T.style.margin="5px",T.style.width="30%",T.style.textAlign="right",T.style.display="inline-block",r.appendChild(T);var A=document.createElement("SELECT");for(A.id="pid-select",A.style.fontSize="16px",A.style.color="rgb(122, 122, 122)",A.style.padding="5px",A.style.margin="5px",A.style.width="60%",A.style.border="1px solid #aeaeae",r.appendChild(A),v=0;v<t.length;v++){var E;(E=document.createElement("option")).setAttribute("value",t[v]),C=document.createTextNode(t[v]),E.appendChild(C),A.appendChild(E)}var x=document.createElement("BUTTON");x.innerHTML="Import",x.style.fontSize="16px",x.style.color="rgb(122, 122, 122)",x.style.padding="5px 20px",x.style.margin="20px auto",x.style.display="block",x.onclick=function(){o.style.display="none",o._overlay&&o._overlay.parentNode.removeChild(o._overlay);var S=g.options[g.selectedIndex].value,I=t.indexOf(S);t[I]="id";var k=A.options[A.selectedIndex].value,P=t.indexOf(k);t[P]="pid",n(t)};var w=document.createElement("DIV");return w.appendChild(x),r.appendChild(w),c.onclick=function(S){o._overlay&&o._overlay.parentNode.removeChild(o._overlay),o.parentNode.removeChild(o),S.stopPropagation()},a.onmousedown=function(S){S=S||window.event,o._dragging=!0,o._originalLeft=o.offsetLeft,o._originalTop=o.offsetTop,o._mouseLeft=S.clientX,o._mouseTop=S.clientY},document.onmousemove=function(S){S=S||window.event,o._dragging&&(o.style.left=o._originalLeft+S.clientX-o._mouseLeft+"px",o.style.top=o._originalTop+S.clientY-o._mouseTop+"px")},document.onmouseup=function(S){S=S||window.event,o._dragging&&(o.style.left=o._originalLeft+S.clientX-o._mouseLeft+"px",o.style.top=o._originalTop+S.clientY-o._mouseTop+"px",o._dragging=!1)},o}n(t)},e._importCenter=function(t){t&&(t.style.left=(window.innerWidth-t.offsetWidth)/2+"px",t.style.top=(window.innerHeight-t.offsetHeight)/2+"px")},e.prototype.importXML=function(){var t=this,n=document.createElement("INPUT");n.setAttribute("type","file"),n.setAttribute("accept",".xml"),n.style.display="none",n.onchange=function(r){var s=r.target,o=new FileReader;o.onload=function(){var a=o.result,l=e._xml2json(a);e.events.publish("import",[t,l])!=0&&(t._putInUndoStack(),t.clearRedo(),t.config.nodes=l,e.events.publish("updated",[t]),t.filterUI.update(),t.draw())},o.readAsText(s.files[0])},n.click()},e.prototype.importJSON=function(){var t=this,n=document.createElement("INPUT");n.setAttribute("type","file"),n.setAttribute("accept",".json"),n.style.display="none",n.onchange=function(r){var s=r.target,o=new FileReader;o.onload=function(){var a=o.result,l=JSON.parse(a);e.events.publish("import",[t,l])!=0&&(t._putInUndoStack(),t.clearRedo(),t.config.nodes=l,e.events.publish("updated",[t]),t.filterUI.update(),t.draw())},o.readAsText(s.files[0])},n.click()},e.prototype.__importJSON=e.prototype.importJSON,e.prototype.importJSON=function(){this.config.roots=[],this.__importJSON()},e.prototype.__importCSV=e.prototype.importCSV,e.prototype.importCSV=function(){this.config.roots=[],this.__importCSV()},e.prototype.__importXML=e.prototype.importXML,e.prototype.importXML=function(){this.config.roots=[],this.__importXML()},e._importSetColumnNames=function(t,n){n(t)},e.prototype.expand=function(t,n,r){this._resetMovableNodes();var s={id:t,ids:n};this._draw(!1,e.action.expand,s,r)},e.prototype.collapse=function(t,n,r){this._resetMovableNodes();var s={id:t,ids:n};this._draw(!1,e.action.collapse,s,r)},e.prototype.expandCollapse=function(t,n,r,s){this._resetMovableNodes(),Array.isArray(n)||(n=[]),Array.isArray(r)||(r=[]);var o={id:t,expandIds:n,collapseIds:r,ids:n.concat(r)};this._draw(!1,e.action.collapse,o,s)},e.prototype.changeRoots=function(t,n,r){this.config.roots=n;var s={id:t,changeRoots:n};this._draw(!1,e.action.update,s,r)},e.prototype._resetMovableNodes=function(){if(e.RESET_MOVABLE_ONEXPANDCOLLAPSE&&this.config.movable!=null){for(var t=!1,n=0;n<this.config.nodes.length;n++){var r=this.config.nodes[n];r.movex!=null&&(r.movex=0,t=!0),r.movey!=null&&(r.movey=0,t=!0)}t&&e.events.publish("updated",[this])}},e.prototype.maximize=function(t,n,r,s){var o=this,a={id:t,options:{}};e.isNEU(a.id)&&(a.id=this.roots[0].id,a.all=!0),a.options.horizontal=!1,a.options.vertical=!1,n&&(a.options.horizontal=n),r&&(a.options.vertical=r),this._draw(!1,e.action.maximize,a,function(){o.ripple(t),s&&s()})},e.prototype.minimize=function(t,n){var r=this,s={id:t};e.isNEU(s.id)&&(s.id=this.roots[0].id,s.all=!0),this._draw(!1,e.action.minimize,s,function(){r.ripple(t),n&&n()})},e.prototype._expCollHandler=function(t){this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide();var n=this.getNode(t),r=this.getCollapsedIds(n);if(r.length){if(e.events.publish("expcollclick",[this,!1,t,r])===!1)return!1;this.expand(t,r,!1)}else{if(e.events.publish("expcollclick",[this,!0,t,n.childrenIds])===!1)return!1;this.collapse(t,n.childrenIds,!1)}},e.prototype._upHandler=function(t){this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide();var n=this._upHandlerCreateArgs(t);if(e.events.publish("up-click",[this,n])===!1)return!1;this.changeRoots(n.id,n.roots,!1)},e.prototype._upHandlerCreateArgs=function(t){var n,r=this.getNode(t),s=Object.assign([],this.config.roots),o=this.getNode(r.pid);if(o&&(n=o),n){if(Array.isArray(s)){var a=s.indexOf(r.id);a!=-1&&s.splice(a,1)}else s=[];s.push(n.id)}return{id:r.id,roots:s}},e.prototype._upHandlerCreateArgs=function(t){var n=this.getNode(t),r=Object.assign([],this.config.roots),s=this.getRecentRootsByNodeId(t);return Array.isArray(r)||(r=[]),e._changeRootOption(r,s,this.manager.rootList),{id:n.id,roots:r}},String.prototype.replaceAll||(String.prototype.replaceAll=function(t,n){return this.replace(new RegExp(t,"g"),n)}),String.prototype.endsWith||(String.prototype.endsWith=function(t){return this.indexOf(t,this.length-t.length)!==-1}),String.prototype.splice||(String.prototype.splice=function(t,n,r){return this.slice(0,t)+r+this.slice(t+Math.abs(n))}),String.prototype.insert||(String.prototype.insert=function(t,n){return t>0?this.substring(0,t)+n+this.substr(t):n+this}),Array.prototype.unique||Object.defineProperty(Array.prototype,"unique",{value:function(){for(var t=this.concat(),n=0;n<t.length;++n)for(var r=n+1;r<t.length;++r)t[n]===t[r]&&t.splice(r--,1);return t},writable:!0,configurable:!0,enumerable:!1}),Array.prototype.has||Object.defineProperty(Array.prototype,"has",{value:function(t){for(var n=0;n<this.length;n++)if(this[n]==t)return!0;return!1},writable:!0,configurable:!0,enumerable:!1}),Array.prototype.compare||Object.defineProperty(Array.prototype,"compare",{value:function(t){if(this.length!=t.length)return!1;for(var n=0;n<this.length;n++)if(!t.has(this[n]))return!1;return!0},writable:!0,configurable:!0,enumerable:!1}),Object.assign||Object.defineProperty(Object,"assign",{value:function(t,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r},writable:!0,configurable:!0}),e.prototype._globalMouseDownHandler=function(t,n){var r={move:"mousemove",up:"mouseup",leave:"mouseleave"};if(n.type.indexOf("touch")!=-1&&(n.touches.length==1?this._touch={x:n.touches[0].clientX,y:n.touches[0].clientY}:this._touch=null,r={move:"touchmove",up:"touchend",touchstart:"touchstart"}),t==n.target)return n.stopPropagation(),n.preventDefault(),void this._mouseDownHandler(t,n,r);if(this.config.nodeMouseClick==e.action.pan){for(var s=n.target;s!=t&&!s.hasAttribute(e.attr.control_expcoll_id)&&!s.hasAttribute(e.attr.control_up_id);)s=s.parentNode;if(!s.hasAttribute(e.attr.control_expcoll_id)&&!s.hasAttribute(e.attr.control_up_id))return n.stopPropagation(),n.preventDefault(),void this._mouseDownHandler(t,n,r)}for(var o=n.target;o!=t;){if(o.hasAttribute(e.attr.node_id))return void this._nodeMouseDownHandler(o,n,r);if(o.hasAttribute(e.attr.control_node_circle_menu_name))return n.stopPropagation(),n.preventDefault(),void this._nodeCircleNodeMenuItemMouseDownHandler(o,n,r);o=o.parentNode}},e.prototype._globalClickHandler=function(t,n){if(n.type.indexOf("touch")!=-1&&this._touch&&n.changedTouches.length==1){if(n.changedTouches.length){var r={x:n.changedTouches[0].clientX,y:n.changedTouches[0].clientY},s=e.t(this.config.template,!1,this.getScale()).size,o=this.getScale(),a=Math.abs(r.x-this._touch.x)/o,l=Math.abs(r.y-this._touch.y)/o;if(this._touch=null,a>s[0]/10||l>s[1]/10)return}}else if(n.type.indexOf("touch")!=-1&&this._touch==null)return;for(var c=n.target;c!=t;){if(c.hasAttribute(e.attr.control_expcoll_id)){var u=c.getAttribute(e.attr.control_expcoll_id),h=this.getNode(u);return void this._expCollHandler(h.id)}if(c.hasAttribute(e.attr.node_id))return u=c.getAttribute(e.attr.node_id),h=this.getNode(u),void this._nodeClickHandler(h.id,n);if(c.hasAttribute(e.attr.control_node_menu_id))return n.stopPropagation(),n.preventDefault(),u=c.getAttribute(e.attr.control_node_menu_id),h=this.getNode(u),void this._nodeMenuClickHandler(h.id,c,n);if(c.hasAttribute(e.attr.control_node_circle_menu_id))return n.stopPropagation(),n.preventDefault(),u=c.getAttribute(e.attr.control_node_circle_menu_id),void this._nodeCircleMenuClickHandler(u);if(c.hasAttribute(e.attr.control_node_circle_menu_name))return n.stopPropagation(),n.preventDefault(),void this._nodeCircleMenuItemClickHandler(c,n);if(c.hasAttribute(e.attr.control_add))return void this._lonelyButtonHandler();if(c.hasAttribute(e.attr.control_up_id))return u=c.getAttribute(e.attr.control_up_id),n.stopPropagation(),n.preventDefault(),void this._upHandler(u);if(c.hasAttribute(e.attr.c_link_from))return void e.events.publish("clink-click",[this,{from:c.getAttribute(e.attr.c_link_from),to:c.getAttribute(e.attr.c_link_to),event:n}]);if(c.hasAttribute(e.attr.s_link_from))return void e.events.publish("slink-click",[this,{from:c.getAttribute(e.attr.s_link_from),to:c.getAttribute(e.attr.s_link_to),event:n}]);c=c.parentNode}},e.prototype._globalContextHandler=function(t,n){for(var r=n.target;r!=t;){if(r.hasAttribute(e.attr.node_id)){var s=r.getAttribute(e.attr.node_id),o=this.getNode(s);return void this._nodeContextHandler(o.id,n)}r=r.parentNode}},e.prototype._nodeContextHandler=function(t,n){n.preventDefault(),e.SEARCH_CLOSE_RESULT_ON_ESCAPE_OR_CLICKOUTSIDE&&this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide();var r=this.get(t),s=null;if(r!=null&&Array.isArray(r.tags))for(var o=0;o<r.tags.length;o++){var a=r.tags[o];this.config.tags[a]&&this.config.tags[a].nodeContextMenu&&(s=this.config.tags[a].nodeContextMenu)}var l=this.element.getBoundingClientRect(),c=n.clientX-l.left,u=n.clientY-l.top;this.nodeContextMenuUI.show(c,u,t,null,s)},e.prototype._globalDbClickHandler=function(t,n){for(var r=n.target;r!=t;){if(r.hasAttribute(e.attr.node_id)){var s=r.getAttribute(e.attr.node_id),o=this.getNode(s);return void this._nodeDbClickHandler(o.id,n)}r=r.parentNode}},e.prototype._mouseScrollHandler=function(t,n){this.__mouseScrollHandler(this.getSvg(),n)},e.prototype.__mouseScrollHandler=function(t,n){if(n.ctrlKey){if(this.config.mouseScrool==e.action.zoom)return}else if(this.config.mouseScrool==e.action.ctrlZoom||this.config.mouseScrool!=e.action.zoom)return;var r=this,s=!1,o=this.config.zoom.speed,a=this.config.zoom.smooth,l=0,c=this.getScale(),u=e._centerPointInPercent(t,n.pageX,n.pageY),h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(p){setTimeout(p,20)};n.preventDefault();var d=n.delta||n.wheelDelta;d===void 0&&(d=-n.detail),d=Math.max(-1,Math.min(1,d)),l+=-d*o,s||function p(){s=!0;var g=(l-c)/a;g>0?g++:g--,c+=g,r.zoom(1-g/12/50,u),parseInt(c)==parseInt(l)?s=!1:h(p)}()},e.prototype._nodeCircleNodeMenuItemMouseDownHandler=function(t,n,r){var s=t.parentNode.getAttribute(e.attr.control_node_circle_menu_wrraper_id),o=t.getAttribute(e.attr.control_node_circle_menu_name),a=this.nodeCircleMenuUI._menu[o];if(a.draggable){var l=this,c=e._getClientXY(n),u=this.getNode(s);t._dragEventFired=!1;var h=l.getScale(),d=null,p=null;this._gragStartedId=s,document.body.style.mozUserSelect=document.body.style.webkitUserSelect=document.body.style.userSelect="none";var g=this.getSvg(),_={x:c.x,y:c.y},v=t.cloneNode(!0);g.insertBefore(v,g.firstChild);var C=e._getTransform(v),T=C[4],y=C[5],A=function(S){for(;S&&!S.hasAttribute(e.attr.control_node_circle_menu_wrraper_id);)S=S.parentNode;if(S){var I=e._getTransform(S);return{x:I[4],y:I[5]}}console.error("cannot find parent"+e.attr.control_node_circle_menu_wrraper_id)}(t);v.setAttribute("transform","matrix(1,0,0,1,"+(T+A.x)+","+(y+A.y)+")"),v.style.opacity=.7;var E=function(S,I){if(S!=null){I.classList.remove("bft-drag-over");for(var k=e.getStParentNodes(l.getNode(d)),P=0;P<k.length;P++){var O=l.getNodeElement(k[P].id);O&&(O.style.opacity=1)}}},x=function(S){if(_){var I=e._getClientXY(S),k=S.target;e.isMobile()&&(k=document.elementFromPoint(I.x,I.y)),I.x+=A.x*h,I.y+=A.y*h;var P=e._getOffsetXY(l.element,S),O={left:l.width()-(P.x+l.config.padding)<0,right:P.x-l.config.padding<0,up:l.height()-(P.y+l.config.padding)<0,down:P.y-l.config.padding<0};if(O.left||O.right||O.up||O.down){g.classList&&(g.classList.remove("bft-cursor-grab"),g.classList.add("bft-cursor-move"),g.classList.remove("bft-cursor-nodrop"),g.classList.remove("bft-cursor-copy"));var R=C[4],K=C[5],ie=_.x,pe=_.y,se=I.x,Y=I.y;l.moveStart(O,function(be){C[4]=R+be.x,C[5]=K+be.y,_.x=ie-be.xWithoutScale,_.y=pe-be.yWithoutScale,I.x=se-be.xWithoutScale,I.y=Y-be.yWithoutScale,v.setAttribute("transform","matrix("+C.toString()+")")})}else{for(l.moveEnd(),g.classList&&(g.classList.add("bft-cursor-grab"),g.classList.remove("bft-cursor-move"),g.classList.remove("bft-cursor-nodrop"),g.classList.remove("bft-cursor-copy")),E(d,p),d=null,p=null;k!=null&&k!=g;){if(k.hasAttribute&&k.hasAttribute(e.attr.node_id)){var Q=k.getAttribute(e.attr.node_id);d=Q,p=k;break}k=k.parentNode}if(d!=null){p.classList.add("bft-drag-over");for(var re=l.getNode(d),ve=e.getStParentNodes(re),ae=0;ae<ve.length;ae++){var fe=l.getNodeElement(ve[ae].id);fe&&(fe.style.opacity=.1)}g.classList.remove("bft-cursor-grab"),g.classList.remove("bft-cursor-move"),g.classList.add("bft-cursor-copy"),g.classList.remove("bft-cursor-nodrop")}var Me=(I.x-_.x)/h,W=(I.y-_.y)/h;C[4]=T+Me,C[5]=y+W,!t._dragEventFired&&(Math.abs(I.x-_.x)>e.FIRE_DRAG_NOT_CLICK_IF_MOVE||Math.abs(I.y-_.y)>e.FIRE_DRAG_NOT_CLICK_IF_MOVE)&&(e.events.publish("drag",[l.nodeCircleMenuUI,{from:Q,menuItem:a,menuItemName:o}])===!1&&w(),t._dragEventFired=!0),v.setAttribute("transform","matrix("+C.toString()+")")}}},w=function(S){if(l.moveEnd(),g.classList&&(g.classList.remove("bft-cursor-grab"),g.classList.remove("bft-cursor-move"),g.classList.remove("bft-cursor-nodrop"),g.classList.remove("bft-cursor-copy")),g.removeEventListener(r.move,x),g.removeEventListener(r.up,w),r.leave&&g.removeEventListener(r.leave,w),u.id==d||d==null)return g.removeChild(v),l._gragStartedId=null,void(t._dragEventFired&&e.events.publish("drop",[l.nodeCircleMenuUI,{from:u.id,menuItemName:o,menuItem:a,event:S}]));var I=l.getNode(d);e.events.publish("drop",[l.nodeCircleMenuUI,{from:u.id,to:I.id,menuItem:a,menuItemName:o,event:S}]),E(d,p),g.removeChild(v),l._gragStartedId=null};g.addEventListener(r.move,x),g.addEventListener(r.up,w),r.leave&&g.addEventListener(r.leave,w)}},e.prototype._nodeMouseDownHandler=function(t,n,r){var s=t.getAttribute(e.attr.node_id),o=this.getNode(s);this.config.movable&&!e.getRootOf(o).stParent?this._movableHandler(t,n,r):this.config.enableDragDrop&&this._dragDropHandler(t,n,r)},e.prototype._movableHandler=function(t,n,r){var s=this,o=t.getAttribute(e.attr.node_id),a=[],l=function(Y,Q){if(Array.isArray(Y))for(var re=0;re<Y.length;re++)l(Y[re],Q);else{for(Q.push(Y.id),re=0;re<Y.stChildren.length;re++)l(Y.stChildren[re],Q);for(re=0;re<Y.children.length;re++)l(Y.children[re],Q)}},c=function(Y,Q){if(Array.isArray(Y))for(var re=0;re<Y.length;re++)l(Y[re],Q);else{for(Q.push(Y.id),re=0;re<Y.stChildrenIds.length;re++)c(s.getNode(Y.stChildrenIds[re]),Q);for(re=0;re<Y.childrenIds.length;re++)c(s.getNode(Y.childrenIds[re]),Q)}},u=this.getNode(o);l(u,a);for(var h=this.getSvg(),d=e._getClientXY(n),p=[],g=[],_=[],v=[],C=[],T=[],y=[],A=[],E=0;E<a.length;E++){var x=this.getNode(a[E]);p.push(x),_.push({x:x.x,y:x.y});var w=this.getNodeElement(a[E]);if(w){C.push(w);var S=e._getTransform(w);v.push({x:S[4],y:S[5]}),g.push(S);var I=this.element.querySelector(`[data-ctrl-ec-id="${a[E]}"]`);if(I){T.push(I);var k=e._getTransform(I);y.push(k),A.push({x:k[4],y:k[5]})}else T.push(null),y.push(null),A.push(null);if(this.config.movable==e.movable.node)break}}t._dragEventFired=!1;var P=null,O=null;this._gragStartedId=a[0],document.body.style.mozUserSelect=document.body.style.webkitUserSelect=document.body.style.userSelect="none";var R={x:d.x,y:d.y},K=s.getScale(),ie=function(Y,Q){if(Y!=null){Q.classList.remove("bft-drag-over");for(var re=s.getNode(P),ve=e.getStParentNodes(re),ae=0;ae<ve.length;ae++){var fe=s.getNodeElement(ve[ae].id);fe&&(fe.style.opacity=1)}}},pe=function(Y){if(R){var Q=e._getClientXY(Y),re=Y.target;e.isMobile()&&(re=document.elementFromPoint(Q.x,Q.y));var ve=e._getOffsetXY(s.element,Y),ae={left:s.width()-(ve.x+s.config.padding)<0,right:ve.x-s.config.padding<0,up:s.height()-(ve.y+s.config.padding)<0,down:ve.y-s.config.padding<0};if(ae.left||ae.right||ae.up||ae.down){h.classList&&(h.classList.remove("bft-cursor-grab"),h.classList.add("bft-cursor-move"),h.classList.remove("bft-cursor-nodrop"),h.classList.remove("bft-cursor-copy"));for(var fe=[],Me=[],W=[],be=[],U=0;U<g.length;U++)fe.push(g[U][4]),Me.push(g[U][5]),y[U]?(W.push(y[U][4]),be.push(y[U][5])):(W.push(null),be.push(null));var Z=R.x,J=R.y,le=Q.x,Ae=Q.y;s.moveStart(ae,function(ce){for(var G=0;G<g.length;G++){var he=fe[G],ge=Me[G],me=W[G],we=be[G];g[G][4]=he+ce.x,g[G][5]=ge+ce.y,R.x=Z-ce.xWithoutScale,R.y=J-ce.yWithoutScale,Q.x=le-ce.xWithoutScale,Q.y=Ae-ce.yWithoutScale,p[G].x=he+ce.x,p[G].y=ge+ce.y,p[G].movex=ce.x,p[G].movey=ce.y,y[G]&&(y[G][4]=me+ce.x,y[G][5]=we+ce.y);for(var ye=e.ui.link(p[G],s,K,s.response.bordersByRootIdAndLevel,s.nodes,e.action.update,!0),Oe=0;Oe<ye.length;Oe++){var Ye=ye[Oe];(De=s.element.querySelector(`[data-l-id="[${Ye.id}][${Ye.childId}]"]`))&&(De.innerHTML=Ye.html)}if(p[G].parent)for(ye=e.ui.link(p[G].parent,s,K,s.response.bordersByRootIdAndLevel,s.nodes,e.action.update,!0),Oe=0;Oe<ye.length;Oe++){var De;Ye=ye[Oe],(De=s.element.querySelector(`[data-l-id="[${Ye.id}][${Ye.childId}]"]`))&&(De.innerHTML=Ye.html)}C[G].setAttribute("transform","matrix("+g[G].toString()+")"),T[G]&&T[G].setAttribute("transform","matrix("+y[G].toString()+")")}})}else{if(s.moveEnd(),h.classList&&(h.classList.add("bft-cursor-grab"),h.classList.remove("bft-cursor-move"),h.classList.remove("bft-cursor-nodrop"),h.classList.remove("bft-cursor-copy")),ie(P,O),P=null,O=null,s.config.enableDragDrop)for(;re!=null&&re!=h;){if(re.hasAttribute&&re.hasAttribute(e.attr.node_id)){var L=re.getAttribute(e.attr.node_id);if(s._gragStartedId&&L!=s._gragStartedId){P=L,O=re;break}}re=re.parentNode}if(P!=null){O.classList.add("bft-drag-over");for(var M=s.getNode(P),D=e.getStParentNodes(M),B=0;B<D.length;B++){var H=s.getNodeElement(D[B].id);H&&(H.style.opacity=.1)}!s.canUpdateLink(p[0].id,P)&&h.classList?(h.classList.remove("bft-cursor-grab"),h.classList.remove("bft-cursor-move"),h.classList.remove("bft-cursor-copy"),h.classList.add("bft-cursor-nodrop")):h.classList&&(h.classList.remove("bft-cursor-grab"),h.classList.remove("bft-cursor-move"),h.classList.add("bft-cursor-copy"),h.classList.remove("bft-cursor-nodrop"))}var z=(Q.x-R.x)/K,te=(Q.y-R.y)/K;for(U=0;U<g.length;U++){g[U][4]=v[U].x+z,g[U][5]=v[U].y+te,y[U]&&(y[U][4]=A[U].x+z,y[U][5]=A[U].y+te),p[U].x=_[U].x+z,p[U].y=_[U].y+te,p[U].movex=z,p[U].movey=te;var ee=e.ui.link(p[U],s,K,s.response.bordersByRootIdAndLevel,s.nodes,e.action.update,!0);for(B=0;B<ee.length;B++){var X=ee[B];($=s.element.querySelector(`[data-l-id="[${X.id}][${X.childId}]"]`))&&($.innerHTML=X.html)}}if(u.parent)if(s.config.movable==e.movable.detachTree)($=s.element.querySelector(`[data-l-id="[${u.parent.id}][${u.id}]"]`))&&$.parentElement.removeChild($);else for(ee=e.ui.link(u.parent,s,K,s.response.bordersByRootIdAndLevel,s.nodes,e.action.update,!0),B=0;B<ee.length;B++){var $;X=ee[B],($=s.element.querySelector(`[data-l-id="[${X.id}][${X.childId}]"]`))&&($.innerHTML=X.html)}if(!t._dragEventFired&&(Math.abs(Q.x-R.x)>e.FIRE_DRAG_NOT_CLICK_IF_MOVE||Math.abs(Q.y-R.y)>e.FIRE_DRAG_NOT_CLICK_IF_MOVE)){if(e.events.publish("drag",[s,o,Y,a])===!1&&se(),s.config.enableDragDrop)for(U=0;U<C.length;U++)h.insertBefore(C[U],h.firstChild);t._dragEventFired=!0}for(U=0;U<g.length;U++)C[U].setAttribute("transform","matrix("+g[U].toString()+")"),T[U]&&T[U].setAttribute("transform","matrix("+y[U].toString()+")")}}},se=function(Y){for(var Q=0;Q<p.length;Q++)p[Q].x=_[Q].x,p[Q].y=_[Q].y;if(s.moveEnd(),h.classList&&(h.classList.remove("bft-cursor-grab"),h.classList.remove("bft-cursor-move"),h.classList.remove("bft-cursor-nodrop"),h.classList.remove("bft-cursor-copy")),h.removeEventListener(r.move,pe),h.removeEventListener(r.up,se),r.leave&&h.removeEventListener(r.leave,se),p[0].id!=P&&P!=null){var re=s.getNode(P);if((ve=e.events.publish("drop",[s,p[0].id,re.id,C[0],Y]))===!1)return ie(P,O),void(s._gragStartedId=null);s.canUpdateLink(p[0].id,P)?((be=s.get(p[0].id)).pid=P,be.stpid=null,s.updateNode(be,null,!0)):ie(P,O),s._gragStartedId=null}else{if(t._dragEventFired){var ve=e.events.publish("drop",[s,p[0].id,void 0,C[0],Y]);if(s.config.movable&&ve!==!1)if(s.config.movable==e.movable.detachTree){var ae=e._getTransform(s.getNodeElement(u.id));(be=s.get(u.id)).pid=null,be.stpid=null,s.updateNode(be,null,!0)}else{var fe=[];s.config.movable==e.movable.node?fe.push(u.id):c(u,fe);var Me=(ae=e._getTransform(s.getNodeElement(u.id)))[4]-u.x,W=ae[5]-u.y;for(Q=0;Q<fe.length;Q++){var be;(be=s.get(fe[Q]))&&(be.movex!=null?be.movex+=Me:be.movex=Me,be.movey!=null?be.movey+=W:be.movey=W,s.update(be))}e.events.publish("updated",[s]),s.draw(e.action.update,{dragNodeIdList:fe})}}s._gragStartedId=null}};h.addEventListener(r.move,pe),h.addEventListener(r.up,se),r.leave&&h.addEventListener(r.leave,se)},e.prototype._dragDropHandler=function(t,n,r){var s=e._getClientXY(n),o=t.getAttribute(e.attr.node_id),a=this.getNode(o);t._dragEventFired=!1;var l=null,c=null;this._gragStartedId=o,this.element.style.mozUserSelect=this.element.style.webkitUserSelect=this.element.style.userSelect="none";var u=this,h=this.getSvg(),d={x:s.x,y:s.y},p=e._getTransform(t),g=p[4],_=p[5],v=u.getScale(),C=t.cloneNode(!0);C.setAttribute("data-n-id","draging"),h.insertBefore(C,h.firstChild),C.style.opacity=.7;var T=function(E,x){if(E!=null){x.classList.remove("bft-drag-over");for(var w=u.getNode(l),S=e.getStParentNodes(w),I=0;I<S.length;I++){var k=u.getNodeElement(S[I].id);k&&(k.style.opacity=1)}}},y=function(E){if(d){var x=e._getClientXY(E),w=E.target;e.isMobile()&&(w=document.elementFromPoint(x.x,x.y));var S=e._getOffsetXY(u.element,E),I={left:u.width()-(S.x+u.config.padding)<0,right:S.x-u.config.padding<0,up:u.height()-(S.y+u.config.padding)<0,down:S.y-u.config.padding<0};if(I.left||I.right||I.up||I.down){h.classList&&(h.classList.remove("bft-cursor-grab"),h.classList.add("bft-cursor-move"),h.classList.remove("bft-cursor-nodrop"),h.classList.remove("bft-cursor-copy"));var k=p[4],P=p[5],O=d.x,R=d.y,K=x.x,ie=x.y;u.moveStart(I,function(fe){p[4]=k+fe.x,p[5]=P+fe.y,d.x=O-fe.xWithoutScale,d.y=R-fe.yWithoutScale,x.x=K-fe.xWithoutScale,x.y=ie-fe.yWithoutScale,C.setAttribute("transform","matrix("+p.toString()+")")})}else{if(u.moveEnd(),h.classList&&(h.classList.add("bft-cursor-grab"),h.classList.remove("bft-cursor-move"),h.classList.remove("bft-cursor-nodrop"),h.classList.remove("bft-cursor-copy")),T(l,c),l=null,c=null,u.config.enableDragDrop)for(;w!=null&&w!=h;){if(w.hasAttribute&&w.hasAttribute(e.attr.node_id)){var pe=w.getAttribute(e.attr.node_id);if(u._gragStartedId&&pe!=u._gragStartedId){l=pe,c=w;break}}w=w.parentNode}if(l=="draging"&&(l=null,c=null),l!=null){c.classList.add("bft-drag-over");for(var se=u.getNode(l),Y=e.getStParentNodes(se),Q=0;Q<Y.length;Q++){var re=u.getNodeElement(Y[Q].id);re&&(re.style.opacity=.1)}!u.canUpdateLink(a.id,l)&&h.classList?(h.classList.remove("bft-cursor-grab"),h.classList.remove("bft-cursor-move"),h.classList.remove("bft-cursor-copy"),h.classList.add("bft-cursor-nodrop")):h.classList&&(h.classList.remove("bft-cursor-grab"),h.classList.remove("bft-cursor-move"),h.classList.add("bft-cursor-copy"),h.classList.remove("bft-cursor-nodrop"))}var ve=(x.x-d.x)/v,ae=(x.y-d.y)/v;p[4]=g+ve,p[5]=_+ae,!t._dragEventFired&&(Math.abs(x.x-d.x)>e.FIRE_DRAG_NOT_CLICK_IF_MOVE||Math.abs(x.y-d.y)>e.FIRE_DRAG_NOT_CLICK_IF_MOVE)&&(e.events.publish("drag",[u,pe,E])===!1&&A(),t._dragEventFired=!0),C.setAttribute("transform","matrix("+p.toString()+")")}}},A=function(E){if(u.moveEnd(),h.classList&&(h.classList.remove("bft-cursor-grab"),h.classList.remove("bft-cursor-move"),h.classList.remove("bft-cursor-nodrop"),h.classList.remove("bft-cursor-copy")),h.removeEventListener(r.move,y),h.removeEventListener(r.up,A),r.leave&&h.removeEventListener(r.leave,A),a.id==l||l==null)return t._dragEventFired&&e.events.publish("drop",[u,a.id,void 0,C,E]),h.removeChild(C),void(u._gragStartedId=null);var x=u.getNode(l);if(e.events.publish("drop",[u,a.id,x.id,C,E])===!1)return T(l,c),h.removeChild(C),void(u._gragStartedId=null);if(u.canUpdateLink(a.id,l)){var w=u.get(a.id);w.pid=l,w.stpid=null,w.movex!=null&&(w.movex=void 0),w.movey!=null&&(w.movey=void 0),u.updateNode(w,null,!0)}else h.removeChild(C),T(l,c);u._gragStartedId=null};h.addEventListener(r.move,y),h.addEventListener(r.up,A),r.leave&&h.addEventListener(r.leave,A)},e.prototype._resizeHandler=function(t,n){if(this.isVisible){var r=this.getViewBox(),s=this.getSvg(),o=s.getAttribute("width"),a=s.getAttribute("height"),l=o/r[2],c=a/r[3],u=l>c?c:l;s.setAttribute("width",this.width()),s.setAttribute("height",this.height()),r[2]=this.width()/u,r[3]=this.height()/u,this.setViewBox(r),this.xScrollUI.create(this.width()),this.yScrollUI.create(this.height()),this._draw(!1,e.action.resize)}},e.prototype._nodeDbClickHandler=function(t,n){if(e.events.publish("dbclick",[this,this.get(t)])===!1)return!1;this._commonClickHandler(t,n,this.config.nodeMouseDbClick)},e.prototype._nodeClickHandler=function(t,n){var r=this.getNodeElement(t);if(r&&r._dragEventFired)r._dragEventFired=!1;else{if(e.events.publish("click",[this,{node:this.getNode(t),event:n}])===!1)return!1;this._commonClickHandler(t,n,this.config.nodeMouseClick)}},e.prototype._nodeCircleMenuItemClickHandler=function(t,n){var r=t.parentNode.getAttribute(e.attr.control_node_circle_menu_wrraper_id),s=t.getAttribute(e.attr.control_node_circle_menu_name),o=this.nodeCircleMenuUI._menu[s];e.events.publish("click",[this.nodeCircleMenuUI,{nodeId:r,menuItemName:s,menuItem:o,event:n}])},e.prototype._nodeCircleMenuClickHandler=function(t){e.SEARCH_CLOSE_RESULT_ON_ESCAPE_OR_CLICKOUTSIDE&&this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide();var n=this.getNode(t),r=null;if(Array.isArray(n.tags))for(var s=0;s<n.tags.length;s++){var o=n.tags[s];this.config.tags[o]&&this.config.tags[o].nodeCircleMenu&&(r=this.config.tags[o].nodeCircleMenu)}this.nodeCircleMenuUI.show(t,r)},e.prototype._commonClickHandler=function(t,n,r){var s;e.SEARCH_CLOSE_RESULT_ON_ESCAPE_OR_CLICKOUTSIDE&&this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide(),r==e.action.expandCollapse&&this.toggleExpandCollapse(t,n),r==e.action.edit&&(s=this.getNode(t))&&(this.editUI.show(s.id),this.ripple(s.id,n.clientX,n.clientY)),r==e.action.details&&(s=this.getNode(t))&&(this.editUI.show(s.id,!0),this.ripple(s.id,n.clientX,n.clientY))},e.prototype._menuHandlerMouseDownHandler=function(t,n){n.stopPropagation(),n.preventDefault()},e.prototype._nodeMenuClickHandler=function(t,n,r){e.SEARCH_CLOSE_RESULT_ON_ESCAPE_OR_CLICKOUTSIDE&&this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide();var s=this.getNode(t),o=null;if(Array.isArray(s.tags))for(var a=0;a<s.tags.length;a++){var l=s.tags[a];this.config.tags[l]&&this.config.tags[l].nodeMenu&&(o=this.config.tags[l].nodeMenu)}this.nodeMenuUI.showStickIn(n,t,null,o)},e.prototype._menuClickHandler=function(t,n){n.stopPropagation(),n.preventDefault(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.show(t.offsetLeft,t.offsetTop)},e.prototype._lonelyButtonHandler=function(){var t={id:this.generateId()};this.addNode(t,null,!0)!==!1&&this.center(t.id)},e.prototype.toggleExpandCollapse=function(t,n){var r=this.getNode(t),s=this.getCollapsedIds(r);if(s.length){if(e.events.publish("expcollclick",[this,!1,t,s])===!1)return!1;this.expand(t,s,!1)}else{if(e.events.publish("expcollclick",[this,!0,t,r.childrenIds])===!1)return!1;this.collapse(t,r.childrenIds,!1)}n&&this.ripple(r.id,n.clientX,n.clientY)},e.prototype._move=function(t,n,r){r[0]=n,r[1]=t,this.setViewBox(r),this.xScrollUI.setPosition(),this.yScrollUI.setPosition()},e.prototype.moveStart=function(t,n,r,s){if(t){if(!this._moveInterval){var o=this,a=this.getViewBox().slice(0),l=this.getScale(),c=0,u=0,h=1;e.isNEU(r)&&(r=e.anim.inSin),e.isNEU(s)&&(s=3e3),this._moveInterval=setInterval(function(){var d={x:0,y:0,xWithoutScale:0,yWithoutScale:0};t.left?(c++,d.x=c*e.MOVE_STEP/l,d.xWithoutScale=c*e.MOVE_STEP):t.right&&(c++,d.x=-c*e.MOVE_STEP/l,d.xWithoutScale=-c*e.MOVE_STEP),t.up?(u++,d.y=u*e.MOVE_STEP/l,d.yWithoutScale=u*e.MOVE_STEP):t.down&&(u++,d.y=-u*e.MOVE_STEP/l,d.yWithoutScale=-u*e.MOVE_STEP);var p=r((10*h-10)/s);d.x=d.x*p,d.xWithoutScale=d.xWithoutScale*p,d.y=d.y*p,d.yWithoutScale=d.yWithoutScale*p,o.setViewBox([a[0]+d.x,a[1]+d.y,a[2],a[3]]),n&&n(d),h+=1},10)}}else console.error("movePosition parameter not defined")},e.prototype.moveEnd=function(){this._moveInterval&&(clearInterval(this._moveInterval),this._moveInterval=null)},e===void 0&&(e={}),e.node=function(t,n,r,s){this.templateName=s,this.id=t,this.pid=n,this.children=[],this.childrenIds=[],this.parent=null,this.stpid=null,this.stParent=null,this.stChildren=[],this.stChildrenIds=[],this.tags=r,this.tags||(this.tags=[])},e.prototype._mouseDownHandler=function(t,n,r){var s=this;e.HIDE_EDIT_FORM_ON_PAN&&this.editUI.hide(),e.SEARCH_CLOSE_RESULT_ON_ESCAPE_OR_CLICKOUTSIDE&&this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide();var o=this.getViewBox(),a=this.getScale(),l=e._getClientTouchesXY(n,0),c=e._getClientTouchesXY(n,1),u={diffX:0,diffY:0,x0:l.x,y0:l.y,type:"pan",viewBoxLeft:o[0],viewBoxTop:o[1]};n.touches&&n.touches.length>1&&(u.type="pinch",u.dist=Math.sqrt((l.x-c.x)*(l.x-c.x)+(l.y-c.y)*(l.y-c.y))),u.type=="pan"&&(this._hideBeforeAnimation(),this._changeCursorOnPanStart(o,a,n));var h=function(p){var g=e._getClientTouchesXY(p,0);if(u&&u.type=="pan"){s._hideBeforeAnimation(),u.diffX=g.x-u.x0,u.diffY=g.y-u.y0;var _=-u.diffY/a+u.viewBoxTop,v=-u.diffX/a+u.viewBoxLeft;s._move(_,v,o)}else if(u&&u.type=="pinch"){var C=e._getClientTouchesXY(p,1),T=Math.sqrt((g.x-C.x)*(g.x-C.x)+(g.y-C.y)*(g.y-C.y)),y=1+(T-u.dist)/(u.dist/100)/100;u.dist=T;var A=e._pinchMiddlePointInPercent(s.element,s.width(),s.height(),p);s.zoom(y,A)}},d=function(){u.type=="pan"&&s.config.sticky?setTimeout(function(){e._moveToBoundaryArea(t,s.getViewBox(),s.response.boundary,function(){s._draw(!0,e.action.pan)})},0):u.type!="pan"||s.config.sticky||setTimeout(function(){s._draw(!0,e.action.pan)},0),u.type=="pan"&&s._changeCursorOnPanEnd(),u=null,t.removeEventListener(r.move,h),t.removeEventListener(r.up,d),r.leave&&t.removeEventListener(r.leave,d),r.touchstart&&t.removeEventListener(r.touchstart,d)};this.config.enablePan&&(t.addEventListener(r.move,h),t.addEventListener(r.up,d),r.leave&&t.addEventListener(r.leave,d),r.touchstart&&t.addEventListener(r.touchstart,d))},e.prototype._changeCursorOnPanStart=function(t,n,r){var s=this.getPointerElement(),o=e._getOffsetXY(this.element,r),a=o.x/n+t[0]-16/n,l=o.y/n+t[1]-16/n;s.style.display="inherit",s.setAttribute("transform","matrix(0,0,0,0,"+a+","+l+")"),e.animate(s,{transform:[0,0,0,0,a,l],opacity:0},{transform:[1/n,0,0,1/n,a,l],opacity:1},300,e.anim.outBack)},e.prototype._changeCursorOnPanEnd=function(){this.getPointerElement().style.display="none"},e.searchUI=function(){this.lastSearch=[],this._searchAfterEnterPress=!1,this._event_id=e._guid(),this.instance=null},e.searchUI.prototype.init=function(t){this.instance=t,this.obj=this.instance,this._initSearchFields();var n=this,r=this.instance.config.padding-10,s=this.instance.config.padding-10,o=this.instance.getMenuButton();if(o){var a=o.getBoundingClientRect(),l=this.instance.getSvg().getBoundingClientRect();r=l.right-a.left+10,s=a.top-l.top-10}var c=document.createElement("div");c.classList.add("bft-search"),c.style.right=r+"px",c.style.top=s+"px";var u=e.elements.textbox({},{label:e.SEARCH_PLACEHOLDER,btn:"X"},"320px");c.innerHTML+=u.html,this.xBtn=c.querySelector("[data-input-btn]"),this.xBtn.style.display="none",this.searchTableWrapper=document.createElement("div"),c.appendChild(this.searchTableWrapper);var h=this.instance.getSvg().nextSibling;this.instance.element.insertBefore(c,h),e.input.init(c),this.input=document.getElementById(u.id),this.xBtn.addEventListener("click",function(g){g.preventDefault(),n.hide()}),this.input.addEventListener("keypress",function(g){g.key=="Enter"&&g.preventDefault()}),this.input.addEventListener("focus",function(g){n.xBtn.style.display="",n._search()}),this.input.addEventListener("blur",function(g){e.isNEU(n.input.value)&&e.SEARCH_HELP_SYMBOL!=n.input.value&&(n.xBtn.style.display="none")}),this.input.addEventListener("keydown",function(g){(g.key=="ArrowDown"||g.key=="ArrowUp")&&g.preventDefault()}),this.input.addEventListener("keyup",function(g){g.key=="ArrowDown"?d():g.key=="ArrowUp"?p():g.key=="Enter"?n._enterHandler():g.key=="Escape"?n.hide():this.value.length>=e.MINIMUM_SYMBOLS_IN_SEARCH_INPUT&&n._search()});var d=function(){var g=n.instance.element.querySelectorAll("[data-search-item-id]"),_=n.instance.element.querySelector('[data-selected="yes"]');_==null&&g.length>0?g[0].setAttribute("data-selected","yes"):g.length>0&&_.nextSibling&&_.nextSibling.setAttribute&&(_.removeAttribute("data-selected"),_.nextSibling.setAttribute("data-selected","yes"))},p=function(){var g=n.instance.element.querySelectorAll("[data-search-item-id]"),_=n.instance.element.querySelector('[data-selected="yes"]');_==null&&g.length>0?g[g.length-1].setAttribute("data-selected","yes"):g.length>0&&_.previousSibling&&_.previousSibling.setAttribute&&(_.removeAttribute("data-selected"),_.previousSibling.setAttribute("data-selected","yes"))}},e.searchUI.prototype._enterHandler=function(){var t=this.instance.element.querySelector('[data-selected="yes"]');if(t){if(t.hasAttribute("data-search-item-id")){var n=t.getAttribute("data-search-item-id");if(this.input.value!=e.SEARCH_HELP_SYMBOL){var r=e.events.publish("",[this.instance,n]),s=e.events.publish("searchclick",[this,{nodeId:n}]);r===!1&&(s=!1),s!=0&&this.instance.center(n)}else this.input.value=n+" ",this.searchTableWrapper.innerHTML=""}}else this._searchAfterEnterPress=!0,this.__search(),this.searchTableWrapper.innerHTML="",this.instance.draw()},e.searchUI.prototype._initSearchFields=function(){if(this.instance.config.searchFields==null){this._searchFields=[];for(var t=0;t<this.instance.response.allFields.length;t++){var n=this.instance.response.allFields[t];n=="tags"||e._fieldIsImg(this.instance.config,n)||this._searchFields.indexOf(n)==-1&&this._searchFields.push(n)}}else this._searchFields=this.instance.config.searchFields;if(this.instance.config.searchFieldsAbbreviation==null)for(this.searchFieldsAbbreviation={},t=0;t<this._searchFields.length;t++){for(var r=this._searchFields[t],s=0,o=r.slice(0,s+1).toLowerCase();this.searchFieldsAbbreviation[o];)s++,o=r.slice(0,s+1).toLowerCase();this.searchFieldsAbbreviation[o]=r}else this.searchFieldsAbbreviation=this.instance.config.searchFieldsAbbreviation;this._searchFieldsAbbreviation=this.searchFieldsAbbreviation},e.searchUI.prototype.find=function(t){this.input&&(this.input.value=t,document.activeElement==this.input?this._search(t):this.input.focus())},e.searchUI.prototype.addMatchTag=function(t){if(this._searchAfterEnterPress){for(var n=0;n<this.lastSearch.length;n++)if(this.lastSearch[n].id==t)return!0;return!1}return null},e.searchUI.prototype.__search=function(){this.lastSearch=e._search.search(this.instance.config.nodes,this.input.value,this._searchFields,this._searchFields,this.instance.config.searchDisplayField,this.instance.config.searchFieldsWeight,this.searchFieldsAbbreviation)},e.searchUI.prototype._search=function(){var t,n=this;if(this._searchAfterEnterPress=!1,this.input.value==e.SEARCH_HELP_SYMBOL)t=this.helpView();else{this.__search();var r=e._getFistImgField(this.instance.config);t=`<table border="0" cellspacing="0" cellpadding="0">
                        <tbody>
                            ${function(){for(var a="",l=0;l<n.lastSearch.length&&!(l>=e.SEARCH_RESULT_LIMIT);l++){var c=n.lastSearch[l],u="";if(r){var h=n.instance._get(c.id);typeof r=="function"?u=r(n.instance,n.instance.getNode(c.id),h):h[r]&&(u=h[r])}var d="",p="";n.instance.config.searchDisplayField==c.__searchField?d=c.__searchMarks:n.instance.config.searchDisplayField?(d=c[n.instance.config.searchDisplayField],e.isNEU(d)&&(d=""),p=c.__searchMarks):d=c.__searchMarks;var g={img:u,nodeId:c.id,first:d,second:p,searchItem:c,html:e.searchUI.createItem(u,c.id,d,p)};e.events.publish("add-item",[n,g]),a+=g.html}return a}()}  
                        </tbody>
                    </table>`}this.searchTableWrapper.innerHTML=t;for(var s=this.instance.element.querySelectorAll("[data-search-item-id]"),o=0;o<s.length;o++)s[o].addEventListener("click",function(){if(this.hasAttribute("data-search-item-id")){var a=this.getAttribute("data-search-item-id");if(n.input.value!=e.SEARCH_HELP_SYMBOL){var l=e.events.publish("searchclick",[n.instance,a]),c=e.events.publish("searchclick",[n,{nodeId:a}]);if(l===!1&&(c=!1),c!==!1){n.instance.center(this.getAttribute("data-search-item-id"));var u=n.instance.element.querySelector('[data-selected="yes"]');u&&u.removeAttribute("data-selected"),this.setAttribute("data-selected","yes"),n.input.focus()}}else n.input.value=a+" ",n.searchTableWrapper.innerHTML="",n.input.focus()}});e.events.publish("show-items",[this,{}])},e.searchUI.prototype.helpView=function(){var t='<table border="0" cellspacing="0" cellpadding="0">';for(var n in this.searchFieldsAbbreviation)t+=`<tr data-search-item-id="${n}" style="height: 50px;"><td class="bft-search-image-td" style="text-align: center;">${n}</td><td class="bft-search-text-td">${this.searchFieldsAbbreviation[n]}</td></tr>`;return t+="</table>"},e.searchUI.createItem=function(t,n,r,s){return r&&(r="<b>"+r+"</b>"),`<tr data-search-item-id="${n}">
                <td class="bft-search-image-td">
                    ${t=t?`<div class="bft-search-photo" style="background-image: url(${t})"></div>`:`<div class="bft-search-photo">${e.icon.user(32,32,"#aeaeae")}</div>`}
                </td>
                <td class="bft-search-text-td">${r} <br/>${s}</td>
            </tr>`},e.searchUI.prototype.hide=function(){if(e.events.publish("hide",[this])===!1)return!1;this._searchAfterEnterPress&&(this._searchAfterEnterPress=!1,this.instance.draw()),this.lastSearch=[],this.xBtn&&(this.xBtn.style.display="none"),this.searchTableWrapper&&(this.searchTableWrapper.innerHTML=""),this.input&&(this.input.value="",document.activeElement==this.input&&this.input.blur(),document.activeElement==this.xBtn&&e.input.blurHandler(this.input))},e.searchUI.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e===void 0&&(e={}),e.manager=function(t){this.config=t.config,this.layoutConfigs=t._layoutConfigs,this.visibleNodeIds=[],this.viewBox=null,this.action=null,this.actionParams=null,this.nodes={},this.oldNodes={},this.maxX=null,this.maxY=null,this.minX=null,this.minY=null,this.bordersByRootIdAndLevel=null,this.roots=null,this.state=null,this.vbIsInitializedFromState=!1,this.rootList=[],this.instance=t,this._fixAdjustForExport={x:0,y:0}},e.manager.prototype.read=function(t,n,r,s,o,a,l,c){var u=this;e.state._get(this.config.state,n,r,function(h){u.state=h,u.action=o,u.actionParams=a,o!=e.action.init||!u.state||a&&a.method&&a.method=="fit"?(u.viewBox=s,u.vbIsInitializedFromState=!1):(u.viewBox=u.state.vb,u.vbIsInitializedFromState=!0,Array.isArray(u.state.roots)&&(u.config.roots=u.state.roots));var d=u.maxX,p=u.maxY,g=u.minX,_=u.minY,v=u.bordersByRootIdAndLevel,C=u.roots,T=u.nodes;if(t){var y=e.manager._getResponse(n,r,u.visibleNodeIds,u.config,d,p,g,_,u.viewBox,C,u.action,u.actionParams,T,u.oldNodes,u.vbIsInitializedFromState);o!=e.action.exporting&&(u.maxX=d,u.maxY=p,u.minX=g,u.minY=_,u.roots=C,u.nodes=T,u.visibleNodeIds=y.visibleNodeIds),y.bordersByRootIdAndLevel=v,y.roots=C,y.adjustify={x:0,y:0},u.state&&(y.adjustify=u.state.adjustify),l(y)}else u.oldNodes=T||null,u._read(function(A){d=A.maxX,p=A.maxY,g=A.minX,_=A.minY,v=A.bordersByRootIdAndLevel,C=A.roots,T=A.nodes;var E=e.manager._getResponse(n,r,u.visibleNodeIds,u.config,d,p,g,_,u.viewBox,C,u.action,u.actionParams,T,u.oldNodes,u.vbIsInitializedFromState);E.notif=A.limit,E.roots=C,E.bordersByRootIdAndLevel=v,E.adjustify=A.adjustify,o!=e.action.exporting&&(u.maxX=d,u.maxY=p,u.minX=g,u.minY=_,u.roots=C,u.nodes=T,u.visibleNodeIds=E.visibleNodeIds,u.bordersByRootIdAndLevel=v,u.rootList=A.rootList),l(E)},c)})},e.manager.prototype._read=function(t,n){var r=this,s=e.manager._createNodes(this.instance);n(s);var o=s.nodes,a=s.roots,l=e.remote;l==null&&(l=e.local),l._setPositions(a,r.layoutConfigs,function(c){var u=e.manager._doNotChangePositionOfClickedNodeIfAny(a,o,r.action,r.actionParams,r.oldNodes,r.config.orientation);r.state&&r.action==e.action.init&&(u=r.state.adjustify),r.action==e.action.exporting?u=r._fixAdjustForExport:r._fixAdjustForExport=u;for(var h={minX:null,minY:null,maxX:null,maxY:null},d={},p=[],g=0;g<a.length;g++)e.manager._setMinMaxXYAdjustifyIterate(a[g],a[g],h,0,d,u,r.config.orientation,p);for(var _ in p)for(var v in p[_]){var C=d[_][v],T=p[_][v];C.minX==null&&C.minY==null&&C.maxX==null&&C.maxY==null&&e._setMinMaxXY(T,C)}t({minX:h.minX,minY:h.minY,maxX:h.maxX,maxY:h.maxY,bordersByRootIdAndLevel:d,nodes:o,roots:a,rootList:s.rootList,limit:c,adjustify:u})},o)},e===void 0&&(e={}),e.manager._initDinamicNode=function(t,n,r){n&&(t.lcn=n),r&&(t.isAssistant=!0);var s=e.t(t.templateName);t.w=s&&s.size?s.size[0]:0,t.h=s&&s.size?s.size[1]:0,t.isSplit=t.templateName=="split",t.isMirror=t.templateName=="mirror",t.isSubLevel=t.templateName=="subLevel"},e.manager._setCollpasedProperty=function(t,n,r,s,o,a,l){t.collapsed==null&&n.collapse&&n.collapse.allChildren?t.collapsed=!0:t.collapsed==null&&(t.collapsed=!1),o==e.action.expand&&r.ids.indexOf(t.id)!=-1&&(t.collapsed=!1),o==e.action.collapse&&(r.expandIds||r.collapseIds)?r.expandIds&&r.expandIds.indexOf(t.id)!=-1?t.collapsed=!1:r.collapseIds&&r.collapseIds.indexOf(t.id)!=-1&&(t.collapsed=!0):o==e.action.collapse&&r.ids.indexOf(t.id)!=-1&&(t.collapsed=!0),o==e.action.expand&&r.ids=="all"&&(t.collapsed=!1),o==e.action.exporting&&r.expandChildren&&(t.collapsed=!1),o==e.action.init&&l!=null?t.collapsed=!l.exp.has(t.id):o==e.action.init?t.tags.indexOf("left-partner")!=-1||t.tags.indexOf("right-partner")!=-1||t.tags.indexOf("partner")!=-1||t.parentPartner?t.collapsed=n.collapse&&a>=n.collapse.level&&s.indexOf(t.id)==-1:t.collapsed=n.collapse&&a>=n.collapse.level-1&&s.indexOf(t.id)==-1:o==e.action.centerNode||o==e.action.insert||o==e.action.expand||o==e.action.collapse?s.has(t.id)&&(t.collapsed=!1):o==e.action.update&&r&&r.changeRoots&&r.changeRoots.has(t.id)&&(t.collapsed=!1)},e.manager._initNode=function(t,n,r,s,o,a,l){var c=l.manager.config,u=l.manager.layoutConfigs,h=l.manager.action,d=l.manager.actionParams,p=l.manager.state,g=u[r||"base"];t.parent==null&&e.manager._setCollpasedProperty(t,g,d,o,h,s-1,p);for(var _=0;_<t.childrenIds.length;_++){var v=n[t.childrenIds[_]];if(e.manager._setCollpasedProperty(v,g,d,o,h,s,p),!v.collapsed){if(v.parent=t,v.ppid!=null){var C=n[v.ppid];C&&(v.parentPartner=C)}(v.tags.indexOf("left-partner")!=-1||v.tags.indexOf("right-partner")!=-1||v.tags.indexOf("partner")!=-1||v.parentPartner)&&a.indexOf(t.id)==-1&&a.push(t.id),t.children.push(v)}}if(h!=e.action.minimize||t.min?h==e.action.maximize&&t.min===!0?(d.all||d.id==t.id)&&(t.min=!1):h==e.action.exporting&&d.min===!1?t.min=!1:h==e.action.init&&p!=null&&(t.min=p.min.has(t.id)):(d.all||d.id==t.id)&&(t.min=!0),!t.min)for(_=0;_<t.stChildrenIds.length;_++)v=n[t.stChildrenIds[_]],t.tags&&t.tags.has("filter")||(v.stParent=t,t.stChildren.push(v));s!=null&&(t.level=s),r&&(t.lcn=r);var T=e._getSubLevels(t.tags,c.tags);T>0&&(t.subLevels=T),t.tags.indexOf("assistant")!=-1&&t.parent!=null&&(t.isAssistant=!0);var y=e.t(t.templateName,t.min);t.w=y&&y.size?y.size[0]:0,t.h=y&&y.size?y.size[1]:0,t.padding=y&&y.padding?y.padding:[0,0,0,0];var A={node:t};e.events.publish("node-initialized",[l,A])},e.manager._iterate=function(t,n,r,s,o,a,l,c,u,h,d,p){var g=p.manager.layoutConfigs;if(e.manager._initNode(n,r,u,s,h,d,p),n.isAssistant&&(a[n.pid]||(a[n.pid]=[]),a[n.pid].push(n.id)),n.subLevels>0&&l.push(n.id),e.MIXED_LAYOUT_FOR_NODES_WITH_COLLAPSED_CHILDREN&&!n.isAssistant&&n.parent){if(n.parent&&n.parent.children.length&&n.parent.children[n.parent.children.length-1]==n){for(var _=[],v=0,C=0,T=0;T<n.parent.children.length;T++)(y=n.parent.children[T]).tags.indexOf("partner")==-1&&y.tags.indexOf("left-partner")==-1&&y.tags.indexOf("right-partner")==-1&&y.tags.indexOf("assistant")==-1&&y.children.length==0?_.push(y.id):y.tags.indexOf("assistant")!=-1?v++:y.tags.indexOf("partner")==-1&&y.tags.indexOf("left-partner")==-1&&y.tags.indexOf("right-partner")==-1||C++;(e.MIXED_LAYOUT_ALL_NODES&&_.length>1&&_.length==n.parent.children.length-v-C||!e.MIXED_LAYOUT_ALL_NODES&&_.length>1)&&(c[n.pid]=_)}}else if(!n.isAssistant&&n.childrenIds.length==0&&n.parent&&!c[n.pid]){for(_=[],v=0,C=0,T=0;T<n.parent.children.length;T++){var y;(y=n.parent.children[T]).tags.indexOf("partner")==-1&&y.tags.indexOf("left-partner")==-1&&y.tags.indexOf("right-partner")==-1&&y.tags.indexOf("assistant")==-1&&y.childrenIds.length==0?_.push(y.id):y.tags.indexOf("assistant")!=-1?v++:y.tags.indexOf("partner")==-1&&y.tags.indexOf("left-partner")==-1&&y.tags.indexOf("right-partner")==-1||C++}(e.MIXED_LAYOUT_ALL_NODES&&_.length>e.MIXED_LAYOUT_IF_NUMBER_OF_CHILDREN_IS_MORE_THEN&&_.length==n.parent.childrenIds.length-v-C||!e.MIXED_LAYOUT_ALL_NODES&&_.length>e.MIXED_LAYOUT_IF_NUMBER_OF_CHILDREN_IS_MORE_THEN)&&(c[n.pid]=_)}n.stChildren.length&&(t.stContainerNodes||(t.stContainerNodes=[]),t.stContainerNodes.push(n));for(var A=0;A<n.stChildren.length;A++){var E="";for(T=0;T<n.tags.length;T++)if(g[n.tags[T]]){E=n.tags[T];break}o.push(n.stChildren[A].id),e.manager._iterate(t,n.stChildren[A],r,0,o,a,l,c,E,h,d,p)}for(s++,A=0;A<n.children.length;A++)e.manager._iterate(t,n.children[A],r,s,o,a,l,c,u,h,d,p)},e.manager.__createNodes=function(t,n,r,s,o,a,l,c){for(var u=[],h=e._addDottedLines(r),d=0;d<h.length;d++){var p,g=h[d];p=e.STRING_TAGS?g.tags?g.tags.split(","):[]:Array.isArray(g.tags)?g.tags.slice(0):[],c.filterUI.addFilterTag(g)&&p.unshift("filter");var _=c.searchUI.addMatchTag(g.id);_===!0?p.unshift("match"):_===!1&&p.unshift("no-match");var v=e._getTemplate(p,r.tags,r.template),C=new e.node(g.id,g.pid,p,v);e.isNEU(g.ppid)||(C.ppid=g.ppid),e.isNEU(g.stpid)||(C.stpid=g.stpid),r.orderBy!=null&&(C.order=e.manager._getOrderFieldValue(g,r.orderBy)),g.movex!=null&&(C.movex=g.movex),g.movey!=null&&(C.movey=g.movey),t[g.id]=C,u.push(g.id)}for(r.orderBy!=null&&u.sort(function(w,S){var I=t[w].order,k=t[S].order;return typeof I=="number"||typeof k=="number"?(I==null&&(I=-1),k==null&&(k=-1),r.orderBy.desc?k-I:I-k):typeof I=="string"||typeof k=="string"?(I==null&&(I=""),k==null&&(k=""),r.orderBy.desc?k.localeCompare(I):I.localeCompare(k)):void 0}),d=0;d<u.length;d++){var T=u[d],y=(C=t[T],a?a[T]:null),A=t[C.stpid],E=t[C.pid];if(A||(C.stpid=null),E||(C.pid=null),A){var x=a?a[A.id]:null;x&&(A.min=x.min),A.stChildrenIds.push(C.id)}else E?(y&&(C.collapsed=y.collapsed,C.min=y.min),E.childrenIds.push(C.id)):(y&&(C.collapsed=y.collapsed,C.min=y.min),n.push(C),l.push(C.id));s==e.action.init&&(C.min=e._getMin(C,r))}},e.manager._createNodes=function(t){var n=t.manager.config,r=t.manager.layoutConfigs,s=t.manager.action,o=t.manager.actionParams,a=t.manager.oldNodes,l=t.manager.state,c={},u=[],h=[];if(e.manager.__createNodes(c,u,n,s,o,a,h,t),n.roots!=null){u=[];for(var d=0;d<n.roots.length;d++){var p=c[n.roots[d]];if(p&&s==e.action.centerNode){for(var g=p;g.pid!=null||g.stpid!=null;)g=g.pid==null&&g.stpid!=null?c[g.stpid]:c[g.pid];for(var _=c[o.id];(_.pid!=null||_.stpid!=null)&&_!=p;)_=_.pid==null&&_.stpid!=null?c[_.stpid]:c[_.pid];g==_&&(p=g)}if(p){for(var v=!1,C=0;C<u.length;C++)if(u[C].id==p.id){v=!0;break}v||(e.isNEU(p.pid)||(et=(A=c[p.pid]).childrenIds.indexOf(p.id))>-1&&A.childrenIds.splice(et,1),u.push(p))}}for(n.roots=[],d=0;d<u.length;d++)n.roots.push(u[d].id)}s==e.action.exporting&&o.id!=null&&(y=c[o.id])&&(y.pid=null,u=[y]);var T=[];if(s==e.action.init&&n.expand&&n.expand.nodes&&l==null)for(d=0;d<n.expand.nodes.length;d++){var y=c[n.expand.nodes[d]];for(n.expand.allChildren===!0&&e.manager._addExpandedNodeIdsIterate(y,c,T);y;)T.push(y.id),y.pid==null&&y.stpid!=null?(y=c[y.stpid]).min=!1:y=c[y.pid]}else if(s==e.action.expand&&o.ids&&o.ids!="all"||s==e.action.collapse&&o&&o.expandIds)for(G=s==e.action.expand?o.ids:o.expandIds,d=0;d<G.length;d++)for(var A=c[(y=c[G[d]]).pid];A;)T.push(A.id),A.pid==null&&A.stpid!=null?(A=c[A.stpid]).min=!1:A=c[A.pid];else if(s==e.action.centerNode){for(var E=c[o.id];E;){if(T.push(E.id),o.options.parentState===e.COLLAPSE_PARENT_NEIGHBORS&&E)for(d=0;d<E.childrenIds.length;d++)(W=c[E.childrenIds[d]]).collapsed=!0;E.pid==null&&E.stpid!=null?(E=c[E.stpid]).min=!1:E=c[E.pid]}if(E=c[o.id],o.options.childrenState===e.COLLAPSE_SUB_CHILDRENS)for(d=0;d<E.childrenIds.length;d++){(w=c[E.childrenIds[d]]).collapsed=!1;for(var x=0;x<w.childrenIds.length;x++)c[w.childrenIds[x]].collapsed=!0}if(o.options.parentState===e.COLLAPSE_PARENT_SUB_CHILDREN_EXCEPT_CLICKED&&(A=c[E.pid]))for(d=0;d<A.childrenIds.length;d++){var w;if((w=c[A.childrenIds[d]])!=E)for(w.collapsed=!1,x=0;x<w.childrenIds.length;x++)c[w.childrenIds[x]].collapsed=!0}}else if(s==e.action.insert)for(y=c[o.insertedNodeId];y;)T.push(y.id),y.pid==null&&y.stpid!=null?(y=c[y.stpid]).min=!1:y=c[y.pid];var S=[],I={},k=[],P={},O=[];for(d=0;d<u.length;d++)e.manager._iterate(u[d],u[d],c,0,S,I,k,P,"",T,O,t);if(s==e.action.collapse&&o&&Array.isArray(o.expandIds)&&Array.isArray(o.collapseIds))for(d=0;d<o.ids.length;d++)o.expandIds.has(o.collapseIds[d])?console.error(`id ${o.collapseIds[d]} exist in both collapseIds and expandIds`):(y=c[o.collapseIds[d]])&&(y.collapsed=!0);for(d=u.length-1;d>=0;d--)u[d].collapsed&&u.splice(d,1);for(d=0;d<O.length;d++){y=c[O[d]];var R=[],K=[],ie=[],pe={},se=0,Y=0,Q=0,re=[],ve=[];for(x=0;x<y.children.length;x++)(W=y.children[x]).isAssistant?R.push(W.id):W.tags.indexOf("right-partner")!=-1?(W.isPartner=1,W.children=[],K.push(W.id)):W.tags.indexOf("left-partner")!=-1?(W.isPartner=2,W.children=[],ie.push(W.id)):W.tags.indexOf("partner")==-1||se%2?W.tags.indexOf("partner")!=-1&&se%2?(W.isPartner=2,W.children=[],ie.push(W.id),se++):W.parentPartner?(pe[W.parentPartner.id]||(pe[W.parentPartner.id]=[]),pe[W.parentPartner.id].push(W.id)):R.push(W.id):(W.isPartner=1,W.children=[],K.push(W.id),se++);y.children=[];var ae=[];for(x=0;x<K.length;x++){pe[(W=c[K[x]]).id]?y.children.push(W):y.children.splice(0,0,W);for(var fe=0;fe<W.childrenIds.length;fe++)ae.push(W.childrenIds[fe])}var Me=[];for(x=0;x<ie.length;x++)for(pe[(W=c[ie[x]]).id]?y.children.push(W):y.children.splice(0,0,W),fe=0;fe<W.childrenIds.length;fe++)Me.push(W.childrenIds[fe]);for(x=0;x<Me.length;x++)(W=c[Me[x]]).collapsed||(W.parentPartner=W.parent,W.parent=y,W.isChildOfPartner=!0,y.children.push(W));for(x=ie.length-1;x>=0;x--)if(pe[ie[x]])for(C=0;C<pe[ie[x]].length;C++)y.children.push(c[pe[ie[x]][C]]),Y++,ve.indexOf(ie[x])==-1&&ve.push(ie[x]);for(x=0;x<R.length;x++){var W=c[R[x]];y.children.push(W)}for(x=0;x<K.length;x++)if(pe[K[x]])for(C=0;C<pe[K[x]].length;C++)y.children.push(c[pe[K[x]][C]]),Q++,re.indexOf(K[x])==-1&&re.push(K[x]);for(x=0;x<ae.length;x++)(W=c[ae[x]]).collapsed||(W.parentPartner=W.parent,W.parent=y,W.isChildOfPartner=!0,y.children.push(W));y.partnerSeparation=Math.max(ve.length,re.length)*n.partnerChildrenSplitSeparation+n.minPartnerSeparation,R.length||!Y||Q?R.length||Y||!Q?R.length||Y!=1||Q!=1?R.length||Y||Q?!R.length||Y||Q?R.length&&(Y||Q)?y.hasPartners=7:y.hasPartners=1:y.hasPartners=6:y.hasPartners=5:y.hasPartners=4:y.hasPartners=3:y.hasPartners=2}for(d=0;d<k.length;d++){var be=r[(y=c[k[d]]).lcn?y.lcn:"base"];for(x=0;x<y.subLevels;x++){var U=new e.node(y.id+"_sub_level_index_"+x,y.pid,[],"subLevel");e.manager._initDinamicNode(U,y.lcn),(A=y.parent)&&((et=A.children.indexOf(y))>-1&&(A.children.splice(et,1),A.children.splice(et,0,U)),U.children.push(y),U.parent=A,y.parent=U,c[U.id]=U)}}for(var Z in I){(A=c[Z]).hasAssistants=!0,U=new e.node(A.id+"_split_assitant_0",A.id,["assistant"],"split"),e.manager._initDinamicNode(U,A.lcn,!0),c[U.id]=U;var J=[];for(x=A.children.length-1;x>=0;x--)(W=A.children[x]).isAssistant?(W.parent=null,A.children.splice(x,1),J.splice(0,0,W.id)):W.isPartner||(W.parent&&P[W.parent.id]&&U&&W.parent.id!=U.id&&(Object.defineProperty(P,U.id,Object.getOwnPropertyDescriptor(P,W.parent.id)),delete P[W.parent.id]),W.parent=U,U.children.unshift(W),A.children.splice(x,1));if(J.length%2){var le=c[J[J.length-1]],Ae=new e.node(le.id+"_mirror",A.pid,[],"mirror");e.manager._initDinamicNode(Ae,le.lcn,!0),Ae.isAssistant=!0,Ae.w=le.w,Ae.h=le.h,c[Ae.id]=Ae,J.splice(J.length-1,0,Ae.id)}var L=1;for(x=J.length-1;x>=0;x--)if(x%2&&x!=J.length-1){var M=new e.node(A.id+"_split_assitant_"+L,A.pid,[],"split");e.manager._initDinamicNode(M,A.lcn,!0),c[M.id]=M,J.splice(x,0,M.id),L++}else x%2&&J.splice(x,0,U.id);for(x=0;x<J.length;x+=3){var D=null;D=x==0?A:c[J[x-2]];var B=c[J[x]],H=c[J[x+1]],z=c[J[x+2]];B.parent=D,H.parent=D,z.parent=D,D.children.push(B),D.children.push(H),D.children.push(z)}}var te=!1;for(var ee in r)if((be=r[ee]).layout!=0){te=!0;break}var X=e.events.has("node-layout",t._event_id);if(te||X){var $={nodes:c,config:n,action:s,actionParams:o};if(k.length){var ce=!1;for(var Z in P){var G=P[Z];for(d=0;d<G.length;d++)if((y=c[G[d]]).subLevels){ce=!0;break}if(ce)break}if(ce){var he={},ge={},me={};for(var Z in P){G=P[Z];var we=!1,ye=null;for(d=0;d<G.length;d++){var Oe=G[d];(ye===null||k.has(Oe))&&(ye=c[Oe].parent.id,we||e.isNEU(c[Oe].subLevels)||(we=c[Oe].subLevels>0)),he[ye]||(he[ye]=[]),he[ye].push(Oe),we&&(me[ye]=Z,ge[ye]||(ge[ye]=[]),ge[ye].push(Oe))}}for(var Z in P={},ge)if(ge[Z].length>e.MIXED_LAYOUT_IF_NUMBER_OF_CHILDREN_IS_MORE_THEN){var Ye=me[Z];for(d=c[Ye].children.length-1;d>=0;d--)W=c[Ye].children[d],ge[Z].has(W.id)&&c[Ye].children.splice(d,1)}for(var Z in he)he[Z].length>e.MIXED_LAYOUT_IF_NUMBER_OF_CHILDREN_IS_MORE_THEN&&(P[Z]=he[Z])}}for(var Z in P){for(var De=A=c[Z];De.isSplit;)De=c[De.pid];for(;De.isSubLevel;)De=c[De.pid];if((be=r[A.lcn?A.lcn:"base"]).layout!=0||X){$.pnode=A,$.layout=be.layout,$.layoutGridColumns=n.layoutGridColumns,$.childrenIds=P[Z],$.lastChildrenPidIds=P,$.subLevels=0,$.layouts=[],e.events.publish("node-layout",[t,$]),e.events.publish("layout",[$]),$.layouts.length||$.layouts.push({layout:$.layout,childrenIds:$.childrenIds,subLevels:$.subLevels,layoutGridColumns:$.layoutGridColumns});for(var ot=0;ot<$.layouts.length;ot++){var xe=$.layouts[ot];for(e.isNEU(xe.subLevels)&&(xe.subLevels=0),e.isNEU(xe.layout)&&(xe.layout=be.layout),De=A=c[Z];De.isSplit;)De=c[De.pid];for(;De.isSubLevel;)De=c[De.pid];var Kt=A;for(x=0;x<xe.subLevels;x++)U=new e.node(ot+"_sublevel_layout_"+x,Kt.id,[],"subLevel"),e.manager._initDinamicNode(U,Kt.lcn),U.parent=Kt,Kt.children.push(U),c[U.id]=U,Kt=U;if(xe.subLevels){for(x=0;x<xe.childrenIds.length;x++){var et;W=c[xe.childrenIds[x]],(et=A.children.indexOf(W))!=-1&&A.children.splice(et,1),W.parent=Kt,Kt.children.push(W)}A=Kt}if(xe.layout==e.layout.grid&&xe.childrenIds.length>2){xe.layoutGridColumns=="dynamic"&&(xe.layoutGridColumns=e._getDynamicGridCoulumns(xe.childrenIds.length));var gt=A.id;for(d=A.children.length-1;d>=0;d--)for(x=0;x<xe.childrenIds.length;x++)if(Oe=xe.childrenIds[x],A.children[d].id==Oe){A.children.splice(d,1);break}var Jt=xe.layoutGridColumns;for(Jt%2!=0&&Jt>2&&Jt--,d=0;d<xe.childrenIds.length;d+=Jt){var hn=null;for(x=0;x<Jt;x++){var Fo=d+Jt>=xe.childrenIds.length;if(xe.childrenIds.length-1<d+x)break;(W=c[Oe=xe.childrenIds[d+x]]).parent=c[gt],c[gt].children.push(W),Fo||(Jt/2-1==x&&(hn=new e.node(xe.childrenIds[d+x-1]+"_grid_pseudo_node_"+xe.childrenIds[d+x+1],gt,[],"subLevel"),e.manager._initDinamicNode(hn,A.lcn),hn.parent=c[gt],c[gt].children.push(hn),c[hn.id]=hn),Jt-1==x&&(gt=hn.id))}}}if(xe.layout==e.layout.mixed){var gr=xe.childrenIds;for(d=gr.length-1;d>=0;d--){for(A=(W=c[gr[d]]).parent,W.layout=e.layout.mixed,x=A.children.length-1;x>=0;x--)if(W.id==A.children[x].id){A.children.splice(x,1);break}if(d>0){var li=c[gr[d-1]];W.parent=li,W.layout=e.layout.mixed,li.children.push(W)}else A.children.push(W)}}else if(xe.layout>1){U=new e.node(ot+"_"+A.id+"_split_0",De.id,[],"split"),e.manager._initDinamicNode(U,A.lcn),c[U.id]=U,U.layout=xe.layout;var mt=[];for(d=xe.childrenIds.length-1;d>=0;d--){for(W=c[xe.childrenIds[d]],x=0;x<A.children.length;x++)A.children[x].id==W.id&&A.children.splice(x,1);if(W.parent=null,W.layout=xe.layout,xe.layout!=e.layout.treeRightOffset&&xe.layout!=e.layout.treeRight||mt.splice(0,0,W.id),xe.layout>2){var zn=new e.node(ot+"_"+W.id+"_mirror",De.id,[],"mirror");e.manager._initDinamicNode(zn,W.lcn),zn.layout=xe.layout,c[zn.id]=zn,mt.splice(0,0,zn.id)}xe.layout!=e.layout.treeRightOffset&&xe.layout!=e.layout.treeRight&&mt.splice(0,0,W.id)}for(L=1,x=mt.length-1;x>=0;x--)x%2&&x!=mt.length-1?(M=new e.node(ot+"_"+A.id+"_split_"+L,De.id,[],"split"),e.manager._initDinamicNode(M,A.lcn),M.layout=xe.layout,c[M.id]=M,mt.splice(x,0,M.id),L++):x%2&&mt.splice(x,0,U.id);for(x=0;x<mt.length;x+=3)D=null,x==0&&(D=A),B=c[mt[x]],H=c[mt[x+1]],z=c[mt[x+2]],x!=0&&(D=c[mt[x-3]]),x==0||H||(D=c[mt[x-2]]),B.parent=D,D.children.push(B),H&&(x!=0&&(D=c[mt[x-2]]),H.parent=D,D.children.push(H)),z&&(x!=0&&(D=c[mt[x-1]]),z.parent=D,D.children.push(z))}}}}}if(e.VERTICAL_CHILDREN_ASSISTANT)for(d=0;d<u.length;d++)e.manager._verticalAssistantIterate(u[d],c);return $={nodes:c,roots:u},e.events.publish("nodes-initialized",[t,$]),{nodes:$.nodes,roots:$.roots,rootList:h}},e.manager._getOrderFieldValue=function(t,n){var r=n;return n.field&&(r=n.field),t[r]},e.manager._getNodeWidth=function(t,n){switch(n.orientation){case e.orientation.top:case e.orientation.top_left:case e.orientation.bottom:case e.orientation.bottom_left:return t.w;case e.orientation.right:case e.orientation.right_top:case e.orientation.left:case e.orientation.left_top:return t.h}return 0},e.manager._isVisible=function(t,n,r,s){if(t.x!=null&&t.y!=null){if(n.lazyLoading&&s!==e.action.exporting){let a=function(l,c){var u=l.x,h=l.y,d=l.w,p=l.h,g=c[0]-e.LAZY_LOADING_FACTOR,_=c[2]+e.LAZY_LOADING_FACTOR+c[0],v=c[1]-e.LAZY_LOADING_FACTOR,C=c[3]+e.LAZY_LOADING_FACTOR+c[1],T=u+d>g&&_>u;return T&&(T=h+p>v&&C>h),T};if(a(t,r))return!0;for(var o=0;o<t.children.length;o++)if(a(t.children[o],r))return!0;return!1}return!0}},e.manager.getAllFields=function(t){var n=[e.TAGS];for(var r in t.nodeBinding)n.push(t.nodeBinding[r]);for(r=0;r<t.nodes.length;r++)for(var s in t.nodes[r])s!==e.ID&&s!==e.TAGS&&s!==e.NODES&&s!==e.PID&&s!==e.STPID&&s!=="movex"&&s!=="movey"&&(t.nodeBinding[s]||n.has(s)||n.push(s));return n},e.manager._getMostDeepChild=function(t){if(t){var n=t;return function r(s){s.sl>n.sl&&(n=s);for(var o=0;o<s.children.length;o++)r(s.children[o])}(t),n}},e.manager._getResponse=function(t,n,r,s,o,a,l,c,u,h,d,p,g,_,v){var C=h[0],T=[],y={top:null,left:null,bottom:null,right:null,minX:null,maxX:null,minY:null,maxY:null},A=[[],[],[]],E=o-l+2*s.padding,x=a-c+2*s.padding,w=e.getScale(u,t,n,s.scaleInitial,s.scaleMax,s.scaleMin,E,x);if(y.top=c-s.padding,y.left=l-s.padding,y.bottom=a+s.padding-n/w,y.right=o+s.padding-t/w,y.maxX=o,y.minX=l,y.maxY=a,y.minY=c,h.length==0||u==null&&!v&&s.align==e.CENTER){var S=Math.ceil(t/w),I=Math.ceil(n/w),k=0,P=0;if(S-2*s.padding>=o-l)switch(k=(o+l)/2-S/2,s.orientation){case e.orientation.right:case e.orientation.right_top:k=(l-o)/2-S/2}else switch(k=C.x-S/2+e.manager._getNodeWidth(C,s)/2,s.orientation){case e.orientation.right:case e.orientation.right_top:(k=-(S/2-(l-o)/2))<s.padding-S&&(k=s.padding-S);break;case e.orientation.left:case e.orientation.bottom_left:case e.orientation.top_left:case e.orientation.left_top:(k=-(S/2-(o-l)/2))>-s.padding&&(k=-s.padding)}if(I-2*s.padding>=a-c)switch(P=(a+c)/2-I/2,s.orientation){case e.orientation.bottom:case e.orientation.bottom_left:P=(c-a)/2-I/2}else switch((P=-(I/2-(a-c)/2))>-s.padding&&(P=-s.padding),s.orientation){case e.orientation.bottom:case e.orientation.bottom_left:(P=-(I/2-(c-a)/2))<s.padding-I&&(P=s.padding-I);break;case e.orientation.left:case e.orientation.right:P=C.y-I/2+e.manager._getNodeWidth(C,s)/2}u=[k,P,S,I]}else if(u==null&&!v&&s.align==e.ORIENTATION){switch(S=Math.ceil(t/w),I=Math.ceil(n/w),k=0,P=0,s.orientation){case e.orientation.top:k=C.x-S/2+e.manager._getNodeWidth(C,s)/2,P=-s.padding;break;case e.orientation.bottom:k=C.x-S/2+e.manager._getNodeWidth(C,s)/2,P=s.padding-I;break;case e.orientation.left:k=-s.padding,P=C.y-I/2+e.manager._getNodeWidth(C,s)/2;break;case e.orientation.right:k=s.padding-S,P=C.y-I/2+e.manager._getNodeWidth(C,s)/2;break;case e.orientation.top_left:k=-s.padding,P=-s.padding;break;case e.orientation.right_top:k=s.padding-S,P=-s.padding;break;case e.orientation.left_top:k=-s.padding,P=-s.padding;break;case e.orientation.bottom_left:k=-s.padding,P=s.padding-I}u=[k,P,S,I],s.sticky&&(u[0]<y.left&&u[0]<y.right&&(u[0]=y.left>y.right?y.right:y.left),u[0]>y.right&&u[0]>y.left&&(u[0]=y.left>y.right?y.left:y.right),u[1]<y.top&&u[1]<y.bottom&&(u[1]=y.top>y.bottom?y.bottom:y.top),u[1]>y.bottom&&u[1]>y.top&&(u[1]=y.top>y.bottom?y.top:y.bottom))}if(d==e.action.centerNode||d==e.action.maximize){var O=g[p.id];p.options.horizontal==1&&(u[0]=O.x+O.w/2-u[2]/2),p.options.vertical==1&&(u[1]=O.y+O.h/2-u[3]/2),s.sticky&&(u[0]<y.left&&u[0]<y.right&&(u[0]=y.left>y.right?y.right:y.left),u[0]>y.right&&u[0]>y.left&&(u[0]=y.left>y.right?y.left:y.right),u[1]<y.top&&u[1]<y.bottom&&(u[1]=y.top>y.bottom?y.bottom:y.top),u[1]>y.bottom&&u[1]>y.top&&(u[1]=y.top>y.bottom?y.top:y.bottom))}if(d==e.action.insert||d==e.action.expand||d==e.action.collapse||d==e.action.update||d==e.action.centerNode){var R=null;if(d==e.action.insert&&p&&p.insertedNodeId!=null&&p.insertedNodeId!=null)R=g[p.insertedNodeId];else if(d==e.action.update&&p&&p.visId!=null&&p.visId!=null)R=g[p.visId];else if(d!=e.action.expand&&d!=e.action.collapse||!p||p.id==null||p.id==null){if(d==e.action.centerNode){switch(s.orientation){case e.orientation.top:case e.orientation.top_left:case e.orientation.bottom:case e.orientation.bottom_left:p.options.vertical||(R=g[p.id]);break;case e.orientation.right:case e.orientation.right_top:case e.orientation.left:case e.orientation.left_top:p.options.horizontal||(R=g[p.id])}R&&(R=e.manager._getMostDeepChild(R,g))}}else R=g[p.id],R=e.manager._getMostDeepChild(R,g);if(!e.FIXED_POSITION_ON_CLICK&&R)switch(s.orientation){case e.orientation.top:case e.orientation.top_left:var K=R.y+R.h-u[3]+s.padding;u[1]<K&&(u[1]=K);break;case e.orientation.bottom:case e.orientation.bottom_left:K=R.y-s.padding,u[1]>K&&(u[1]=K);break;case e.orientation.right:case e.orientation.right_top:K=R.x-s.padding,u[0]>K&&(u[0]=K);break;case e.orientation.left:case e.orientation.left_top:K=R.x+R.w-u[2]+s.padding,u[0]<K&&(u[0]=K)}}for(var ie=0;ie<h.length;ie++)e.manager._iterate2(h[ie],g,s,u,d,p,T,_,r,A);return{animations:A,boundary:y,viewBox:u,visibleNodeIds:T,nodes:g,allFields:e.manager.getAllFields(s)}},e.manager._iterate2=function(t,n,r,s,o,a,l,c,u,h){if(e.manager._isVisible(t,r,s,o)){l.push(t.id);var d=null;if((o==e.action.expand||o==e.action.collapse||o==e.action.maximize)&&c&&c[t.id]&&a.method=="expandCollapseToLevel"){if(d={x:(v=c[t.id]).x,y:v.y},v){d={x:v.x,y:v.y};for(var p=t,g=null;p!=null;)c[p.id]&&c[p.id].collapsed&&(g=p),p=p.parent;g&&g.parent&&(d={x:g.parent.x,y:g.parent.y})}if(C=n[a.id]){for(p=t.parent;p!=null;)p=p.parent;p&&(d={x:C.x+C.w/2-t.w/2,y:C.y+C.h/2-t.h/2})}}else if((o==e.action.expand||o==e.action.collapse)&&c&&c[t.id]){if(d={x:(v=c[t.id]).x,y:v.y},a.ids=="all"&&v){for(d={x:v.x,y:v.y},p=t,g=null;p!=null;)c[p.id]&&c[p.id].collapsed&&(g=p),p=p.parent;g&&g.parent&&(d={x:g.parent.x,y:g.parent.y})}if(C=n[a.id]){for(p=t.parent;p!=null&&a.ids.indexOf(t.id)==-1&&a.ids.indexOf(p.id)==-1;)p=p.parent;p&&(d={x:C.x+C.w/2-t.w/2,y:C.y+C.h/2-t.h/2})}}else if(o==e.action.centerNode&&c&&c[t.id])(v=c[t.id]).x!=null&&v.y!=null&&(d={x:v.x,y:v.y}),(_=n[a.id])&&_==t&&(p=t.parent)&&p.id==a.id&&(d={x:_.x+_.w/2-t.w/2,y:_.y+_.h/2-t.h/2});else if(o==e.action.maximize&&c&&c[t.id]){var _;(v=c[t.id]).x!=null&&v.y!=null&&(d={x:v.x,y:v.y}),(_=n[a.id])&&_==t&&(p=t.parent)&&p.id==a.id&&(d={x:_.x+_.w/2-t.w/2,y:_.y+_.h/2-t.h/2})}else if(o==e.action.minimize&&c&&c[t.id])d={x:(v=c[t.id]).x,y:v.y};else if(o==e.action.insert&&a&&a.insertedNodeId==t.id&&t.parent)d={x:t.parent.x,y:t.parent.y};else if(o!=e.action.update&&o!=e.action.insert||!c)o!==e.action.exporting&&o!==e.action.init&&u.indexOf(t.id)==-1&&(h[0].push(t.id),h[1].push({opacity:0}),h[2].push({opacity:1}));else{var v,C;if((!(v=c[t.id])||e.isNEU(v.x)&&e.isNEU(v.y))&&a){if(C=n[a.id]){for(p=C;p&&p.id==t.id;)p=p.parent;p&&(d={x:C.x,y:C.y})}}else v&&(d={x:v.x,y:v.y})}d!=null&&d.x!=null&&d.y!=null&&(d.x!=t.x||d.y!=t.y)&&(a&&a.dragNodeIdList&&a.dragNodeIdList.indexOf(t.id)!=-1||(h[0].push(t.id),h[1].push({transform:[1,0,0,1,d.x,d.y]}),h[2].push({transform:[1,0,0,1,t.x,t.y]})))}for(var T=0;T<t.stChildren.length;T++)e.manager._iterate2(t.stChildren[T],n,r,s,o,a,l,c,u,h);for(T=0;T<t.children.length;T++)e.manager._iterate2(t.children[T],n,r,s,o,a,l,c,u,h)},e.manager._addExpandedNodeIdsIterate=function(t,n,r){for(var s=0;s<t.childrenIds.length;s++)r.push(t.childrenIds[s]),e.manager._addExpandedNodeIdsIterate(n[t.childrenIds[s]],n,r)},e.manager._setMinMaxXYAdjustifyIterate=function(t,n,r,s,o,a,l,c){t.x+=a.x,t.y+=a.y;for(var u=0;u<t.stChildren.length;u++)e.manager._setMinMaxXYAdjustifyIterate(t.stChildren[u],t.stChildren[u],r,0,o,a,l,c);for(t.isPartner?t.sl=s-1:t.sl=s,o[n.id]==null&&(o[n.id]={}),o[n.id][t.sl]==null&&(o[n.id][t.sl]={minX:null,minY:null,maxX:null,maxY:null}),t.layout?(c[n.id]==null&&(c[n.id]={}),c[n.id][t.sl]==null&&(c[n.id][t.sl]=t)):e._setMinMaxXY(t,o[n.id][t.sl]),t.movex!=null&&(t.x+=t.movex),t.movey!=null&&(t.y+=t.movey),e._setMinMaxXY(t,r),s++,u=0;u<t.children.length;u++)e.manager._setMinMaxXYAdjustifyIterate(t.children[u],n,r,s,o,a,l,c)},e.manager._doNotChangePositionOfClickedNodeIfAny=function(t,n,r,s,o,a){if(r!=e.action.expand&&r!=e.action.collapse&&r!=e.action.minimize&&r!=e.action.maximize&&r!=e.action.centerNode&&r!=e.action.update&&r!=e.action.insert)return{x:0,y:0};if(r==e.action.update&&(!s||s.id==null)){if(!t||!t.length)return{x:0,y:0};s={id:t[0].id}}if(s.id==null)return{x:0,y:0};var l=s.id;(r==e.action.minimize&&n[l].parent||r==e.action.maximize&&n[l].parent)&&(l=n[l].pid);var c=n[l],u=o[l];if(!u)return{x:0,y:0};var h=u.movex!=null?u.movex:0,d=u.movey!=null?u.movey:0;return{x:(u.x?u.x-h:0)-c.x,y:(u.y?u.y-d:0)-c.y}},e.manager._verticalAssistantIterate=function(t,n){for(var r=0;r<t.stChildren.length;r++)e.manager._verticalAssistantIterate(t.stChildren[r],n);if(t.children.length==3)e.manager._verticalAssistantIterate(t.children[0],n),e.manager._verticalAssistantIterate(t.children[2],n),e.manager._verticalAssistantIterate(t.children[1],n);else for(r=0;r<t.children.length;r++)e.manager._verticalAssistantIterate(t.children[r],n);if(t.isAssistant&&t.isSplit&&t.children.length){for(var s=t.parent.children[0],o=t.parent.children[2],a=t.parent;!a.hasAssistants;)a=a.parent;var l={max:0},c={max:0};e.manager._verticalAssistantLevelCountIterate(s,0,l),e.manager._verticalAssistantLevelCountIterate(o,0,c);var u=Math.max(l.max,c.max),h=[];for(r=0;r<u;r++){var d=new e.node(t.parent.id+"_split_assitant_level_"+r,t.pid,[],"subLevel");e.manager._initDinamicNode(d,t.lcn,!0),r>0&&(h[r-1].children.push(d),d.parent=h[r-1]),n[d.id]=d,h.push(d)}if(h.length){for(var p=h[h.length-1],g=h[0],_=t.children.length-1;_>=0;_--){var v=t.children[_];p.children.unshift(v),v.parent=p,t.children.splice(_,1)}t.children.push(g),g.parent=t}}},e.manager._verticalAssistantLevelCountIterate=function(t,n,r){r.max<n&&(r.max=n),n++;for(var s=0;s<t.children.length;s++)e.manager._verticalAssistantLevelCountIterate(t.children[s],n,r)},e._addDottedLines=function(t){var n=t.nodes;if((t.groupDottedLines.length||t.dottedLines.length)&&(n=JSON.parse(JSON.stringify(n))),t.groupDottedLines.length)for(var r=[],s=0;s<t.groupDottedLines.length;s++){var o=t.groupDottedLines[s];o.rootId==null&&(o.rootId=o.to);var a=`balkan_group_dotted_${o.rootId}`;if(!r.has(a)){for(var l=0;l<n.length;l++)if(n[l].id==o.rootId){(d=JSON.parse(JSON.stringify(n[l]))).id=`balkan_group_dotted_${o.rootId}_balkan_id_${n[l].id}`,d.pid=void 0,d.stpid=n[l].id,n.push(d),r.push(a),n[l].tags||(n[l].tags=[]),n[l].tags.push("group-dotted-lines"),n[l].tags.push("group-dotted-lines-"+a);break}}for(l=0;l<n.length;l++)if(n[l].id==o.from){if((d=JSON.parse(JSON.stringify(n[l]))).id=`balkan_group_dotted_${o.rootId}_balkan_id_${n[l].id}`,d.pid=`balkan_group_dotted_${o.rootId}_balkan_id_${o.to}`,d.tags){var c=d.tags.indexOf("group-dotted-lines");c!=-1&&d.tags.splice(c,1)}if(d.tags||(d.tags=[]),d.tags.push("bft-dotted-connector"),o.tags)for(var u=0;u<o.tags.length;u++)d.tags.push(o.tags[u]);n.push(d);break}}if(t.dottedLines.length)for(s=0;s<t.dottedLines.length;s++){var h=t.dottedLines[s];for(h.rootId==null&&(h.rootId=h.to),l=0;l<n.length;l++)if(n[l].id==h.from){var d;if((d=JSON.parse(JSON.stringify(n[l]))).id=`balkan_dotted_${h.rootId}_balkan_id_${n[l].id}`,h.rootId==h.to?d.pid=h.to:d.pid=`balkan_dotted_${h.rootId}_balkan_id_${h.to}`,d.tags||(d.tags=[]),d.tags.push("bft-dotted-connector"),h.tags)for(u=0;u<h.tags.length;u++)d.tags.push(h.tags[u]);n.push(d);break}}return n},e.manager.__createNodes=function(t,n,r,s,o,a,l,c){for(var u=r.nodes,h=[],d={},p={},g=0;g<u.length;g++){var _,v=u[g];_=e.STRING_TAGS?v.tags?v.tags.split(","):[]:Array.isArray(v.tags)?v.tags.slice(0):[],c.filterUI.addFilterTag(v)&&_.push("filter");var C=c.searchUI.addMatchTag(v.id);C===!0?_.unshift("match"):C===!1&&_.unshift("no-match"),v.gender&&_.push(v.gender);var T=e._getTemplate(_,r.tags,r.template);v.templateName&&(T=v.templateName);var y=new e.node(v.id,v.pid,_,T);y.ftChildrenIds=[],y.rids=[],e.isNEU(v.ppid)||(y.ppid=v.ppid),e.isNEU(v.stpid)||(y.stpid=v.stpid),e.isNEU(v.mid)||(y.mid=v.mid),e.isNEU(v.fid)||(y.fid=v.fid),e.isNEU(v.gender)||(y.gender=v.gender),Array.isArray(v.pids)?y.pids=v.pids:y.pids=[],r.orderBy!=null&&(y.order=e.manager._getOrderFieldValue(v,r.orderBy)),t[v.id]=y,e.isNEU(y.stpid)?(e.isNEU(y.mid)||(d[y.mid]||(d[y.mid]=[]),d[y.mid].push(y.id)),e.isNEU(y.fid)||(d[y.fid]||(d[y.fid]=[]),d[y.fid].push(y.id)),e.isNEU(y.mid)&&e.isNEU(y.fid)&&e.isNEU(y.stpid)&&(h.has(y.id)||h.push(y.id))):(p[y.stpid]||(p[y.stpid]=[]),p[y.stpid].push(y.id))}if(r.orderBy!=null&&d)for(var A in d)d[A].sort(function(O,R){var K=t[O].order,ie=t[R].order;return typeof K=="number"||typeof ie=="number"?(K==null&&(K=-1),ie==null&&(ie=-1),r.orderBy.desc?ie-K:K-ie):typeof K=="string"||typeof ie=="string"?(K==null&&(K=""),ie==null&&(ie=""),r.orderBy.desc?ie.localeCompare(K):K.localeCompare(ie)):void 0});for(g=0;g<h.length;g++){var E=t[h[g]];if(E){var x=[];e.manager._iterateSetRootIds(E.id,E.id,p,d,t,x),l.push(x)}}for(g=0;g<l.length;g++)for(var w=0;w<l.length;w++)if(w!=g){for(var S=l[g],I=l[w],k=!1,P=0;P<S.length;P++)if(I.has(S[P])){k=!0;break}k&&(l[g]=S.concat(I).unique(),l[w]=[])}for(g=l.length-1;g>=0;g--)l[g].length||l.splice(g,1);if(!r.roots||!r.roots.length)for(r.roots=[],g=l.length-1;g>=0;g--)r.roots.push(l[g][0]);for(g=0;g<r.roots.length;g++)e.manager._iterateFT(r.roots[g],p,d,t,a,n,s,o,r)},e.manager._iterateSetRootIds=function(t,n,r,s,o,a){var l=o[t];if(l){l.rids.has(n)||l.rids.push(n);for(var c=0;c<l.rids.length;c++)a.has(l.rids[c])||a.push(l.rids[c]);for(c=0;c<l.pids.length;c++){var u=o[l.pids[c]];if(u)for(var h=0;h<u.rids.length;h++)a.has(u.rids[h])||a.push(u.rids[h])}if(r[l.id])for(c=0;c<r[l.id].length;c++)e.manager._iterateSetRootIds(r[l.id][c],n,r,s,o,a);if(s[l.id])for(c=0;c<s[l.id].length;c++)e.manager._iterateSetRootIds(s[l.id][c],n,r,s,o,a)}},e.manager._iterateFT=function(t,n,r,s,o,a,l,c,u){var h,d=s[t],p=o?o[t]:null,g=s[d.stpid],_=s[d.mid],v=s[d.fid];if(g||(d.stpid=null),_?v&&(_.tags.has("partner")||_.tags.has("left-partner")||_.tags.has("right-partner"))?(d.pid=v.id,h=v,d.ppid=_.id):(d.pid=_.id,h=_,v&&(d.ppid=v.id)):v?_&&(v.tags.has("partner")||v.tags.has("left-partner")||v.tags.has("right-partner"))?(d.pid=_.id,h=_,d.ppid=v.id):(d.pid=v.id,h=v,_&&(d.ppid=_.id)):d.pid,g){var C=o?o[g.id]:null;C&&(g.min=C.min),g.stChildrenIds.push(d.id)}else _||v?(p&&(d.collapsed=p.collapsed,d.min=p.min),h&&!h.childrenIds.has(d.id)&&h.childrenIds.push(d.id),_&&!_.ftChildrenIds.has(d.id)&&_.ftChildrenIds.push(d.id),v&&!v.ftChildrenIds.has(d.id)&&v.ftChildrenIds.push(d.id)):(p&&(d.collapsed=p.collapsed,d.min=p.min),a.push(d));l==e.action.init&&(d.min=e._getMin(d,u));for(var T=0;T<d.pids.length;T++){var y=s[d.pids[T]];if(y){y.pid=d.id;var A=o?o[y.id]:null;if(A&&(y.collapsed=A.collapsed,y.min=A.min),l==e.action.init&&(y.min=e._getMin(y,u)),c&&p&&A&&c.id==d.id?A.hasPartners&&p.isPartner==1?y.tags.push("left-partner"):A.hasPartners&&p.isPartner==2||p.isPartner==1?y.tags.push("right-partner"):p.isPartner==2?y.tags.push("left-partner"):y.tags.push("partner"):A&&A.isPartner==2?y.tags.push("left-partner"):A&&A.isPartner==1?y.tags.push("right-partner"):y.tags.push("partner"),!e.isNEU(y)&&r[y.id])for(var E=0;E<r[y.id].length;E++){var x=s[r[y.id][E]];x&&(e.isNEU(x.fid)||e.isNEU(x.mid))&&e.manager._iterateFT(r[y.id][E],n,r,s,o,a,l,c,u)}d.childrenIds.push(y.id)}}if(n[t])for(E=0;E<n[t].length;E++)e.manager._iterateFT(n[t][E],n,r,s,o,a,l,c,u);if(r[t])for(E=0;E<r[t].length;E++)e.manager._iterateFT(r[t][E],n,r,s,o,a,l,c,u)},e.manager.getAllFields=function(t){var n=[e.TAGS];for(var r in t.nodeBinding)n.push(t.nodeBinding[r]);for(r=0;r<t.nodes.length;r++)for(var s in t.nodes[r])s!==e.ID&&s!==e.TAGS&&s!==e.NODES&&s!==e.PID&&s!==e.STPID&&s!=="mid"&&s!=="fid"&&s!=="pids"&&(t.nodeBinding[s]||n.has(s)||n.push(s));return n},e.templates={},e.templates.base={defs:`<g transform="matrix(1,0,0,1,0,0)" id="dot"><circle class="bft-fill" cx="0" cy="0" r="5" stroke="#aeaeae" stroke-width="1"></circle></g>
            <g id="base_node_menu" style="cursor:pointer;"><rect x="0" y="0" fill="transparent" width="22" height="22"></rect><circle cx="4" cy="11" r="2" fill="#aeaeae"></circle><circle cx="11" cy="11" r="2" fill="#aeaeae"></circle><circle cx="18" cy="11" r="2" fill="#aeaeae"></circle></g>
            <g style="cursor: pointer;" id="base_tree_menu">
                <rect x="0" y="0" width="25" height="25" fill="transparent"></rect>
                ${e.icon.addUser(25,25,"#fff",0,0)}
            </g>
            <g style="cursor: pointer;" id="base_tree_menu_close">
                <circle cx="12.5" cy="12.5" r="12" fill="#F57C00"></circle>
                ${e.icon.close(25,25,"#fff",0,0)}
            </g>            
            <g id="base_up">
                <circle cx="15" cy="15" r="15" fill="#fff" stroke="#aeaeae" stroke-width="1"></circle>
                ${e.icon.ft(20,20,"#aeaeae",5,5)}
            </g>
            <clipPath id="base_img_0"><rect id="base_img_0_stroke" stroke-width="3" stroke="#fff" x="170" y="-5" rx="25" ry="25" width="70" height="70"></rect></clipPath>`,size:[250,120],linkAdjuster:{fromX:0,fromY:0,toX:0,toY:0},ripple:{radius:0,color:"#e6e6e6",rect:null},expandCollapseSize:0,svg:'<svg class="{randId} {template}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  style="display:block;" width="{w}" height="{h}" viewBox="{viewBox}">{content}</svg>',link:'<path stroke-linejoin="round" stroke="#aeaeae" stroke-width="1px" fill="none" d="{rounded}" />',assistanseLink:'<path stroke-linejoin="round" stroke="#aeaeae" stroke-width="2px" fill="none" d="M{xa},{ya} {xb},{yb} {xc},{yc} {xd},{yd} L{xe},{ye}"/>',pointer:'<g data-pointer="pointer" transform="matrix(0,0,0,0,100,100)"><radialGradient id="pointerGradient"><stop stop-color="#ffffff" offset="0" /><stop stop-color="#C1C1C1" offset="1" /></radialGradient><circle cx="16" cy="16" r="16" stroke-width="1" stroke="#acacac" fill="url(#pointerGradient)"></circle></g>',node:'<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" stroke="#aeaeae" rx="7" ry="7"></rect>',menuButton:'<div style="position:absolute;right:{p}px;top:{p}px; width:40px;height:50px;cursor:pointer;" '+e.attr.control_export_menu+'=""><hr style="background-color: #7A7A7A; height: 3px; border: none;"><hr style="background-color: #7A7A7A; height: 3px; border: none;"><hr style="background-color: #7A7A7A; height: 3px; border: none;"></div>',padding:[50,20,35,20],nodeMenuButton:`<use ${e.attr.control_node_menu_id}="{id}" x="220" y="95" xlink:href="#base_node_menu"/>`,nodeTreeMenuButton:'<use data-ctrl-n-t-menu-id="{id}" x="10" y="10" xlink:href="#base_tree_menu"/>',nodeTreeMenuCloseButton:'<use data-ctrl-n-t-menu-c="" x="10" y="10" xlink:href="#base_tree_menu_close"/>',up:'<use x="110" y="-10" xlink:href="#base_up"/>',img_0:'<use xlink:href="#base_img_0_stroke" /><image preserveAspectRatio="xMidYMid slice" clip-path="url(#base_img_0)" xlink:href="{val}"  x="170" y="-5"  width="70" height="70"></image>',link_field_0:'<text text-anchor="middle" fill="#aeaeae" '+e.attr.width+'="290" x="0" y="0" style="font-size:10px;">{val}</text>'},e.templates.dot=Object.assign({},e.templates.base),e.templates.dot.node='<circle cx="5" cy="5" r="5" fill="none" stroke-width="1" stroke="#aeaeae"></circle>',e.templates.dot.size=[10,10],e.templates.dot.nodeMenuButton="",e.templates.dot.nodeTreeMenuButton="",e.templates.dot.nodeTreeMenuCloseButton="",e.templates.dot.up="",e.templates.john=Object.assign({},e.templates.base),e.templates.john.nodeMenuButton=`<use ${e.attr.control_node_menu_id}="{id}" x="90" y="50" xlink:href="#base_node_menu"/>`,e.templates.john.defs=`<style>                          
                                        .{randId} .bft-edit-form-header, .{randId} .bft-img-button{
                                            background-color: #aeaeae;
                                        }
                                        .{randId}.male .bft-edit-form-header, .{randId}.male .bft-img-button{
                                            background-color: #039BE5;
                                        }        
                                        .{randId}.male div.bft-img-button:hover{
                                            background-color: #F57C00;
                                        }
                                        .{randId}.female .bft-edit-form-header, .{randId}.female .bft-img-button{
                                            background-color: #F57C00;
                                        }        
                                        .{randId}.female div.bft-img-button:hover{
                                            background-color: #039BE5;
                                        }
                                    </style>
                                    <clipPath id="john_img_0"><rect  x="6" y="6" rx="54" ry="54" width="108" height="108"></rect></clipPath>
                                    ${e.gradientCircleForDefs("circle","#aeaeae",60,5)}
                                    ${e.gradientCircleForDefs("male_circle","#039BE5",60,5)}
                                    ${e.gradientCircleForDefs("female_circle","#F57C00",60,5)}`,e.templates.john.field_0="<text "+e.attr.width+'="230" style="font-size: 16px;font-weight:bold;" fill="#aeaeae" x="60" y="135" text-anchor="middle">{val}</text>',e.templates.john.field_1="<text "+e.attr.width+'="150" style="font-size: 13px;" fill="#aeaeae" x="60" y="150" text-anchor="middle">{val}</text>',e.templates.john.node='<use x="0" y="0" xlink:href="#circle" />',e.templates.john.img_0='<image preserveAspectRatio="xMidYMid slice" clip-path="url(#john_img_0)" xlink:href="{val}"  x="6" y="6"  width="108" height="108"></image>',e.templates.john.ripple={radius:60,color:"#e6e6e6",rect:null},e.templates.john.size=[120,120],e.templates.john_male=Object.assign({},e.templates.john),e.templates.john_male.node+='<use x="0" y="0" xlink:href="#male_circle" />',e.templates.john_male.ripple={radius:60,color:"#039BE5",rect:null},e.templates.john_female=Object.assign({},e.templates.john),e.templates.john_female.node+='<use x="0" y="0" xlink:href="#female_circle" />',e.templates.john_female.ripple={radius:60,color:"#F57C00",rect:null},e.templates.tommy=Object.assign({},e.templates.base),e.templates.tommy.defs=`<style>                          
                                        .{randId} .bft-edit-form-header, .{randId} .bft-img-button{
                                            background-color: #aeaeae;
                                        }
                                        .{randId}.male .bft-edit-form-header, .{randId}.male .bft-img-button{
                                            background-color: #039BE5;
                                        }        
                                        .{randId}.male div.bft-img-button:hover{
                                            background-color: #F57C00;
                                        }
                                        .{randId}.female .bft-edit-form-header, .{randId}.female .bft-img-button{
                                            background-color: #F57C00;
                                        }        
                                        .{randId}.female div.bft-img-button:hover{
                                            background-color: #039BE5;
                                        }
                                    </style>`,e.templates.tommy.field_0="<text "+e.attr.width+'="230" style="font-size: 18px;font-weight:bold;" fill="#ffffff" x="10" y="90" text-anchor="start">{val}</text>',e.templates.tommy.field_1="<text "+e.attr.width+'="150" style="font-size: 14px;" fill="#ffffff" x="10" y="65" text-anchor="start">{val}</text>',e.templates.tommy.node='<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" fill="#aeaeae" stroke="#aeaeae" rx="7" ry="7"></rect>',e.templates.tommy_male=Object.assign({},e.templates.tommy),e.templates.tommy_male.node='<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" fill="#039BE5" stroke="#aeaeae" rx="7" ry="7"></rect>',e.templates.tommy_female=Object.assign({},e.templates.tommy),e.templates.tommy_female.node='<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" fill="#F57C00" stroke="#aeaeae" rx="7" ry="7"></rect>',e.templates.hugo=Object.assign({},e.templates.base),e.templates.hugo.up='<use x="200" y="10" xlink:href="#hugo_up"/>',e.templates.hugo.nodeMenuButton=`<use x="225" y="10" ${e.attr.control_node_menu_id}="{id}" xlink:href="#hugo_node_menu"/>`,e.templates.hugo.defs=`<clipPath id="hugo_img_0"><rect id="hugo_img_0_stroke" stroke-width="2" stroke="#fff" x="90" y="-5" rx="25" ry="25" width="70" height="70"></rect></clipPath>
                                    <linearGradient id="hugo_grad_female" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#FF8024;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#FF46A3;stop-opacity:1" />
                                    </linearGradient>
                                    <linearGradient id="hugo_grad_male" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#00D3A5;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#00A7D4;stop-opacity:1" />
                                    </linearGradient>
                                    <linearGradient id="hugo_grad" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#D0D0D0;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#909090;stop-opacity:1" />
                                    </linearGradient>
                                    <g id="hugo_up">
                                        <circle cx="12" cy="12" r="15" fill="transparent" ></circle>
                                        ${e.icon.ft(24,24,"#fff",0,0)}
                                    </g>
                                    <g id="hugo_node_menu" style="cursor:pointer;"><rect x="0" y="0" fill="transparent" width="22" height="22"></rect><circle cx="11" cy="4" r="2" fill="#ffffff"></circle><circle cx="11" cy="11" r="2" fill="#ffffff"></circle><circle cx="11" cy="18" r="2" fill="#ffffff"></circle></g>
                                    <style>
                                        .{randId} .bft-edit-form-header{
                                            background: linear-gradient(90deg, #D0D0D0 0%, #909090 100%);
                                        }
                                        .{randId}.male .bft-edit-form-header{
                                            background: linear-gradient(90deg, #00D3A5 0%, #00A7D4 100%);
                                        }
                                        .{randId}.female .bft-edit-form-header{
                                            background: linear-gradient(90deg, #FF8024 0%, #FF46A3 100%);
                                        }  
                                        .{randId} .bft-img-button{
                                            background-color: #909090;
                                        }      
                                        .{randId} .bft-img-button:hover{
                                            background-color: #D0D0D0;
                                        }
                                        .{randId}.male .bft-img-button{
                                            background-color: #00A7D4;
                                        }      
                                        .{randId}.male .bft-img-button:hover{
                                            background-color: #00D3A5;
                                        }
                                        .{randId}.female .bft-img-button{
                                            background-color: #FF46A3;
                                        }      
                                        .{randId}.female .bft-img-button:hover{
                                            background-color: #FF8024;
                                        }
                                        
                                    </style>`,e.templates.hugo.img_0='<use xlink:href="#hugo_img_0_stroke" /><image preserveAspectRatio="xMidYMid slice" clip-path="url(#hugo_img_0)" xlink:href="{val}"  x="90" y="-5"  width="70" height="70"></image>',e.templates.hugo.field_0="<text "+e.attr.width+'="230" style="font-size: 18px;font-weight:bold;" fill="#ffffff" x="125" y="85" text-anchor="middle">{val}</text>',e.templates.hugo.field_1="<text "+e.attr.width+'="230" style="font-size: 14px;" fill="#ffffff" x="125" y="105" text-anchor="middle">{val}</text>',e.templates.hugo.node='<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" fill=url(#hugo_grad) stroke="#aeaeae" rx="7" ry="7"></rect>',e.templates.hugo_male=Object.assign({},e.templates.hugo),e.templates.hugo_male.node='<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" fill=url(#hugo_grad_male) stroke="#aeaeae" rx="7" ry="7"></rect>',e.templates.hugo_female=Object.assign({},e.templates.hugo),e.templates.hugo_female.node='<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" fill=url(#hugo_grad_female) stroke="#aeaeae" rx="7" ry="7"></rect>',e.templates.mother=Object.assign({},e.templates.base),e.templates.mother.up="",e.templates.mother.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;"  stroke-width="1" stroke="#F57C00" rx="5" ry="5"></rect><text style="font-size: 18px;" fill="#F57C00" x="240" y="30" text-anchor="end">Add mother</text>'+e.icon.mother(70,70,"#F57C00",10,40),e.templates.mother.field_0="",e.templates.mother.field_1="",e.templates.father=Object.assign({},e.templates.mother),e.templates.father.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#039BE5;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#039BE5" x="240" y="30" text-anchor="end">Add father</text>'+e.icon.father(70,70,"#039BE5",10,40),e.templates.partner=Object.assign({},e.templates.mother),e.templates.partner.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#aeaeae;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#aeaeae" x="240" y="30" text-anchor="end">Add partner</text>',e.templates.son=Object.assign({},e.templates.mother),e.templates.son.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#039BE5;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#039BE5" x="240" y="30" text-anchor="end">Add son</text>'+e.icon.son(70,70,"#039BE5",10,40),e.templates.daughter=Object.assign({},e.templates.mother),e.templates.daughter.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#F57C00;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#F57C00" x="240" y="30" text-anchor="end">Add daughter</text>'+e.icon.daughter(70,70,"#F57C00",10,40),e.templates.husband=Object.assign({},e.templates.mother),e.templates.husband.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#039BE5;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#039BE5" x="240" y="30" text-anchor="end">Add husband</text>'+e.icon.husband(70,70,"#039BE5",10,40),e.templates.wife=Object.assign({},e.templates.mother),e.templates.wife.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#F57C00;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#F57C00" x="240" y="30" text-anchor="end">Add wife</text>'+e.icon.wife(70,70,"#F57C00",10,40),e.templates.pet=Object.assign({},e.templates.mother),e.templates.pet.node='<rect x="0" y="0" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#F57C00;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#F57C00" x="240" y="30" text-anchor="end">Add pet</text>'+e.icon.teddy(70,70,"#F57C00",10,40),e.templates.cgroup=Object.assign({},e.templates.base),e.templates.cgroup.defs="",e.templates.cgroup.size=[250,120],e.templates.cgroup.padding=[0,0,0,0],e.templates.cgroup.node="",e.templates.split=Object.assign({},e.templates.base),e.templates.split.size=[10,10],e.templates.split.node='<circle cx="5" cy="5" r="5" fill="none" stroke-width="1" stroke="#aeaeae"></circle>',e.templates.mirror={linkAdjuster:{},link:"",node:"",nodeMenuButton:"",size:[0,0]},e.ui={_defsIds:{},defs:function(t){var n="";for(var r in e.templates){var s=e.templates[r];s.defs&&(e.ui._defsIds[r]=e.randomId(),n+=s.defs.replaceAll("{randId}",e.ui._defsIds[r]))}return"<defs>"+n+t+"</defs>"},lonely:function(t){return t.nodes&&t.nodes.length?"":e.IT_IS_LONELY_HERE.replace("{link}",e.RES.IT_IS_LONELY_HERE_LINK)},pointer:function(t,n,r){return n===e.action.exporting?"":e.t(t.template,!1,r).pointer},node:function(t,n,r,s,o,a,l,c,u,h){var d=e.t(t.templateName,t.min,u),p=d.node.replaceAll("{w}",t.w).replaceAll("{h}",t.h);d.defs&&(p=p.replaceAll("{randId}",e.ui._defsIds[t.templateName])),l==null&&(l=s.nodeBinding);var g={node:t,data:n};for(var _ in l){var v,C=l[_];n&&(v=n[C]);var T=e._lblIsImg(s,_);if(g.value=v,g.element=d[_],g.name=C,g.field=_,e.events.publish("field",[h,g])!==!1&&g.value!=null&&g.value!=null&&g.element!=null&&(!T||T&&!e.isNEU(g.value))){if(!T&&typeof g.value=="string"){var y=g.element;y&&(y=y.replaceAll("{ew}",t.w-(t.padding?t.padding[1]:0)).replaceAll("{cw}",t.w/2)),g.value=e.wrapText(g.value,y)}var A=g.element.replace("{val}",g.value);p+=A=A.replaceAll("{ew}",t.w-(t.padding?t.padding[1]:0)).replaceAll("{cw}",t.w/2).replaceAll("{randId}",e.randomId()).replaceAll("{randId2}",e.randomId())}}var E=e._getPosition(r,t,o,a),x="node";Array.isArray(t.tags)&&t.tags.length&&(x+=" "+t.tags.join(" ")),t.layout&&(x+=" tree-layout");var w="";t.lcn&&(w='lcn="'+t.lcn+'"');var S=e.nodeOpenTag.replace("{lcn}",w).replace("{id}",t.id).replace("{class}",x).replace("{sl}",t.sl).replace("{level}",t.level).replace("{x}",E.x).replace("{y}",E.y),I=e._getOpacity(r,t);return p=(S=S.replace("{opacity}",I))+(p+=e.ui.nodeBtns(s,t,c,d,h))+e.grCloseTag},nodeBtns:function(t,n,r,s,o){var a="";return t.nodeMenu==null||n.isSplit||r===e.action.exporting||(a+=s.nodeMenuButton.replace("{id}",n.id).replace("{cw}",n.w/2).replace("{ch}",n.h/2).replace("{ew}",n.w-(n.padding?n.padding[1]:0)).replace("{eh}",n.h-(n.padding?n.padding[2]:0))),t.nodeCircleMenu==null||n.isSplit||r===e.action.exporting||e.isNEU(s.nodeCircleMenuButton)||(a+='<g style="cursor:pointer;" transform="matrix(1,0,0,1,'+s.nodeCircleMenuButton.x+","+s.nodeCircleMenuButton.y+')" '+e.attr.control_node_circle_menu_id+'="'+n.id+'"><circle cx="0" cy="0" fill="'+s.nodeCircleMenuButton.color+'" r="'+s.nodeCircleMenuButton.radius+'" stroke-width="1" stroke="'+s.nodeCircleMenuButton.stroke+'"></circle><line x1="-'+s.nodeCircleMenuButton.radius/2+'" y1="-6" x2="'+s.nodeCircleMenuButton.radius/2+'" y2="-6" stroke-width="2" stroke="'+s.nodeCircleMenuButton.stroke+'"></line><line x1="-'+s.nodeCircleMenuButton.radius/2+'" y1="0" x2="'+s.nodeCircleMenuButton.radius/2+'" y2="0" stroke-width="2" stroke="'+s.nodeCircleMenuButton.stroke+'"></line><line x1="-'+s.nodeCircleMenuButton.radius/2+'" y1="6" x2="'+s.nodeCircleMenuButton.radius/2+'" y2="6" stroke-width="2" stroke="'+s.nodeCircleMenuButton.stroke+'"></line></g>'),a},expandCollapseBtn:function(t,n,r,s,o){var a="";if(s!==e.action.exporting&&!n.isSplit){var l=r[n.lcn?n.lcn:"base"],c=0,u=0,h=e.t(n.templateName,n.min,o);if(n.childrenIds.length>0){if(n.hasPartners){for(var d=!1,p=0;p<n.childrenIds.length;p++){var g=t.getNode(n.childrenIds[p]);!g||g.parentPartner||g.isPartner||(d=!0)}if(!d)return""}switch(l.orientation){case e.orientation.top:case e.orientation.top_left:c=n.x+n.w/2,u=n.y+n.h;break;case e.orientation.bottom:case e.orientation.bottom_left:c=n.x+n.w/2,u=n.y;break;case e.orientation.right:case e.orientation.right_top:c=n.x,u=n.y+n.h/2;break;case e.orientation.left:case e.orientation.left_top:c=n.x+n.w,u=n.y+n.h/2}if(c-=h.expandCollapseSize/2,u-=h.expandCollapseSize/2,t.getCollapsedIds(n).length?(a+=e.expcollOpenTag.replace("{id}",n.id).replace("{x}",c).replace("{y}",u),a+=h.plus,a+=e.grCloseTag):(a+=e.expcollOpenTag.replace("{id}",n.id).replace("{x}",c).replace("{y}",u),a+=h.minus,a+=e.grCloseTag),a.indexOf("{collapsed-children-count}")!=-1){var _=e.collapsedChildrenCount(t,n);a=a.replace("{collapsed-children-count}",_)}if(a.indexOf("{collapsed-children-total-count}")!=-1){var v=e.collapsedChildrenTotalCount(t,n);a=a.replace("{collapsed-children-total-count}",v)}if(a.indexOf("{children-count}")!=-1){var C=e.childrenCount(t,n);a=a.replace("{children-count}",C)}if(a.indexOf("{children-total-count}")!=-1){var T=e.childrenTotalCount(t,n);a=a.replace("{children-total-count}",T)}}t._nodeHasHiddenParent(n)&&(a+=e.upOpenTag.replace("{id}",n.id).replace("{x}",n.x).replace("{y}",n.y),a+=h.up,a+=e.grCloseTag)}var y={html:a,node:n};return e.events.publish("renderbuttons",[t,y]),y.html},link:function(t,n,r,s,o,a,l){var c=t.lcn?t.lcn:"base",u=n._layoutConfigs[c],h=e.t(t.templateName,t.min,r),d=[],p=[],g=u.levelSeparation/2;t.layout>0&&(g=u.mixedHierarchyNodesSeparation/2);var _=0,v=e.getRootOf(t).id,C=s[v][t.sl],T=void 0;if(t.hasPartners){T={ids:[],indexes:{},ppnodes:{},lastLeft:null,firstRight:null,maxSidePartnersWithChildren:0,rightIds:[],leftIds:[],partnerChildrenSplitSeparation:n.config.partnerChildrenSplitSeparation};for(var y=0;y<t.children.length;y++)(E=t.children[y]).parentPartner?(T.ppnodes[E.id]=E.parentPartner,T.ids.push(E.id),E.parentPartner.isPartner==1?(T.rightIds.indexOf(E.parentPartner.id)==-1&&T.rightIds.push(E.parentPartner.id),T.indexes[E.id]=T.rightIds.indexOf(E.parentPartner.id),T.firstRight||(T.firstRight=E)):E.parentPartner.isPartner==2&&(T.leftIds.indexOf(E.parentPartner.id)==-1&&T.leftIds.push(E.parentPartner.id),T.indexes[E.id]=T.leftIds.indexOf(E.parentPartner.id),T.lastLeft=E)):E.isPartner||(T.lastLeft=E,T.firstRight||(T.firstRight=E));T.maxSidePartnersWithChildren=Math.max(T.leftIds.length,T.rightIds.length),_=T.maxSidePartnersWithChildren==0?n.config.minPartnerSeparation/2:n.config.minPartnerSeparation/2+T.partnerChildrenSplitSeparation*T.maxSidePartnersWithChildren+T.partnerChildrenSplitSeparation/2}for(y=0;y<t.children.length;y++){var A,E=t.children[y],x=s[v][E.sl],w={xa:0,ya:0,xb:0,yb:0,xc:0,yc:0,xd:0,yd:0,x:0,y:0,rotate:0},S=(h=e.t(E.templateName,E.min,r)).link;if(E.isChildOfPartner)switch(u.orientation){case e.orientation.top:case e.orientation.top_left:var I=E.layout==1?void 0:x.minY-(x.minY-C.maxY)/2;w=e.ui._linkTopToBottom(E.parentPartner,E,h,g,I);break;case e.orientation.bottom:case e.orientation.bottom_left:I=E.layout==1?void 0:x.maxY-(x.maxY-C.minY)/2,w=e.ui._linkBottomToTop(E.parentPartner,E,h,g,I);break;case e.orientation.right:case e.orientation.right_top:I=E.layout==1?void 0:x.maxX-(x.maxX-C.minX)/2,w=e.ui._linkRightToLeft(E.parentPartner,E,h,g,I);break;case e.orientation.left:case e.orientation.left_top:I=E.layout==1?void 0:x.minX-(x.minX-C.maxX)/2,w=e.ui._linkLeftToRight(E.parentPartner,E,h,g,I)}else if(T&&T.ids.indexOf(E.id)!=-1)switch(u.orientation){case e.orientation.top:case e.orientation.top_left:w=e.ui._linkPpTop(T,t,E,x,C,h);break;case e.orientation.bottom:case e.orientation.bottom_left:w=e.ui._linkPpBottom(T,t,E,x,C,h);break;case e.orientation.right:case e.orientation.right_top:w=e.ui._linkPpRight(T,t,E,x,C,h);break;case e.orientation.left:case e.orientation.left_top:w=e.ui._linkPpLeft(T,t,E,x,C,h)}else{var k=E.isAssistant&&E.rightNeighbor&&E.rightNeighbor.isAssistant&&E.parent==E.rightNeighbor.parent,P=E.isAssistant&&E.leftNeighbor&&E.leftNeighbor.isAssistant&&E.parent==E.leftNeighbor.parent;if((k||E.layout>1)&&E.rightNeighbor&&E.rightNeighbor.isSplit)switch(u.orientation){case e.orientation.top:case e.orientation.top_left:case e.orientation.bottom:case e.orientation.bottom_left:w=e.ui._linkRightToLeft(E.rightNeighbor,E,h,g);break;case e.orientation.right:case e.orientation.right_top:case e.orientation.left:case e.orientation.left_top:w=e.ui._linkBottomToTop(E.rightNeighbor,E,h,g)}else if((P||E.layout>1)&&E.leftNeighbor&&E.leftNeighbor.isSplit)switch(u.orientation){case e.orientation.top:case e.orientation.top_left:case e.orientation.bottom:case e.orientation.bottom_left:w=e.ui._linkLeftToRight(E.leftNeighbor,E,h,g);break;case e.orientation.right:case e.orientation.right_top:case e.orientation.left:case e.orientation.left_top:w=e.ui._linkTopToBottom(E.leftNeighbor,E,h,g)}else switch(u.orientation){case e.orientation.top:case e.orientation.top_left:E.isPartner==1?w=e.ui._linkLeftToRight(t,E,h,_):E.isPartner==2?w=e.ui._linkRightToLeft(t,E,h,_):(I=E.layout==1?void 0:x.minY-(x.minY-C.maxY)/2,w=e.ui._linkTopToBottom(t,E,h,g,I));break;case e.orientation.bottom:case e.orientation.bottom_left:E.isPartner==1?w=e.ui._linkLeftToRight(t,E,h,_):E.isPartner==2?w=e.ui._linkRightToLeft(t,E,h,_):(I=E.layout==1?void 0:x.maxY-(x.maxY-C.minY)/2,w=e.ui._linkBottomToTop(t,E,h,g,I));break;case e.orientation.right:case e.orientation.right_top:E.isPartner==1?w=e.ui._linkTopToBottom(t,E,h,_):E.isPartner==2?w=e.ui._linkBottomToTop(t,E,h,_):(I=E.layout==1?void 0:x.maxX-(x.maxX-C.minX)/2,w=e.ui._linkRightToLeft(t,E,h,g,I));break;case e.orientation.left:case e.orientation.left_top:E.isPartner==1?w=e.ui._linkTopToBottom(t,E,h,_):E.isPartner==2?w=e.ui._linkBottomToTop(t,E,h,_):(I=E.layout==1?void 0:x.minX-(x.minX-C.maxX)/2,w=e.ui._linkLeftToRight(t,E,h,g,I))}}var O=e.ui._draggableLinkPath(n,t,E,w,g,u.orientation);if(O)A=O,S=S.replaceAll("{rounded}",O).replaceAll("{edge}",O).replaceAll("{curve}",A);else if(S.indexOf("{rounded}")!=-1)if(w.xa==w.xb&&w.xa==w.xc&&w.xa==w.xd||w.ya==w.yb&&w.ya==w.yc&&w.ya==w.yd)A="M"+w.xa+","+w.ya+" L"+w.xd+","+w.yd,S=S.replaceAll("{rounded}",A);else if(Math.abs(w.xa-w.xd)<=e.LINK_ROUNDED_CORNERS&&Math.abs(w.xa-w.xc)<=e.LINK_ROUNDED_CORNERS&&Math.abs(w.xa-w.xb)<=e.LINK_ROUNDED_CORNERS)A="M"+w.xa+","+w.ya+" L"+w.xa+","+w.yd,S=S.replaceAll("{rounded}",A);else if(Math.abs(w.ya-w.yd)<=e.LINK_ROUNDED_CORNERS&&Math.abs(w.ya-w.yc)<=e.LINK_ROUNDED_CORNERS&&Math.abs(w.ya-w.yb)<=e.LINK_ROUNDED_CORNERS)A="M"+w.xa+","+w.ya+" L"+w.xd+","+w.ya,S=S.replaceAll("{rounded}",A);else{var R=e.ui._roundedEdge(w.xa,w.ya,w.xb,w.yb,w.xc,w.yc),K=e.ui._roundedEdge(w.xb,w.yb,w.xc,w.yc,w.xd,w.yd);A="M"+R.x1+","+R.y1+" "+R.x2+","+R.y2+" Q"+R.qx1+","+R.qy1+" "+R.qx2+","+R.qy2+" L"+K.x2+","+K.y2+" Q"+K.qx1+","+K.qy1+" "+K.qx2+","+K.qy2+" L"+K.x3+","+K.y3,S=S.replaceAll("{rounded}",A)}else S.indexOf("{edge}")!=-1?(A="M"+w.xa+","+w.ya+" "+w.xb+","+w.yb+" "+w.xc+","+w.yc+" L"+w.xd+","+w.yd,S=S.replaceAll("{edge}",A)):S.indexOf("{curve}")!=-1?(A="M"+w.xa+","+w.ya+" C"+w.xb+","+w.yb+" "+w.xc+","+w.yc+" "+w.xd+","+w.yd,S=S.replaceAll("{curve}",A)):(A=S.replaceAll("{xa}",w.xa).replaceAll("{ya}",w.ya).replaceAll("{xb}",w.xb).replaceAll("{yb}",w.yb).replaceAll("{xc}",w.xc).replaceAll("{yc}",w.yc).replaceAll("{xd}",w.xd).replaceAll("{yd}",w.yd),S=A);d.push(e.linkOpenTag.replaceAll("{id}",t.id).replaceAll("{class}","link "+E.tags.join(" ")).replaceAll("{child-id}",E.id));var ie={node:t,cnode:E,p:w,html:S,action:a};e.events.publish("render-link",[n,ie]),d.push(ie.html),l&&p.push({id:t.id,childId:E.id,html:ie.html});var pe="";for(var se in n.config.linkBinding){var Y=n.config.linkBinding[se],Q=n._get(E.id);if(Q){var re=Q[Y];ie.value=re,ie.element=h[se],ie.name=Y,e.events.publish("label",[n,ie])!==!1&&(e.isNEU(ie.value)||e.isNEU(ie.element)||(pe+=ie.element.replace("{val}",ie.value)))}}if(pe!=""){var ve=w.x,ae=w.y;E.movey!=null&&(ae+=E.movey),pe=e.linkFieldsOpenTag.replace("{x}",ve).replace("{y}",ae).replace("{rotate}",0)+pe+e.grCloseTag,d.push(pe)}d.push(e.grCloseTag)}return l?p:d.join("")},svg:function(t,n,r,s,o,a){return e.t(s.template,!1,a).svg.replace("{w}",t).replace("{h}",n).replace("{viewBox}",r).replace("{randId}",e.ui._defsIds[s.template]).replace("{mode}",s.mode).replace("{template}",s.template).replace("{content}",function(){return o})},menuButton:function(t){return t.menu==null?"":e.t(t.template,!1).menuButton.replaceAll("{p}",t.padding)},_roundedEdge:function(t,n,r,s,o,a){var l,c,u,h=e.LINK_ROUNDED_CORNERS,d=0;return t==r&&t==o||n==s&&n==a?(l=u=r,c=d=s):(t!=o&&r==o&&(l=u=r,c=s,n<a?d=s+h:n>a&&(d=s-h)),t<o&&r==o?r-=h:t>o&&r==o&&(r+=h),n!=a&&s==a&&(l=r,c=d=s,t<o?u=r+h:t>o&&(u=r-h)),n<a&&s==a?s-=h:n>a&&s==a&&(s+=h)),{x1:t,y1:n,x2:r,y2:s,x3:o,y3:a,qx1:l,qy1:c,qx2:u,qy2:d}},_linkTopToBottom:function(t,n,r,s,o){var a,l,c,u,h,d=0;return a=t.x+t.w/2+r.linkAdjuster.toX,l=t.y+t.h+r.linkAdjuster.toY,u=c=n.x+n.w/2+r.linkAdjuster.fromX,h=n.y+r.linkAdjuster.fromY,{xa:a,ya:l,xb:a,yb:d=t.rightNeighbor&&t.rightNeighbor.isAssistant&&n.templateName=="split"?t.rightNeighbor.y+t.rightNeighbor.h+s:t.templateName=="split"&&(n.isAssistant||n.layout>1)?h:n.templateName=="split"?l+s:o??h-s,xc:c,yc:d,xd:u,yd:h,x:c,y:e.isNEU(n.parentPartner)?d+16:d,rotate:0}},_linkBottomToTop:function(t,n,r,s,o){var a,l,c,u,h,d=0;return a=t.x+t.w/2+r.linkAdjuster.toX,l=t.y+r.linkAdjuster.toY,u=c=n.x+n.w/2+r.linkAdjuster.fromX,h=n.y+n.h+r.linkAdjuster.fromY,{xa:a,ya:l,xb:a,yb:d=t.rightNeighbor&&t.rightNeighbor.isAssistant&&n.templateName=="split"?t.rightNeighbor.y-s:t.templateName=="split"&&(n.isAssistant||n.layout>1)?h:n.templateName=="split"?l-s:o??h+s,xc:c,yc:d,xd:u,yd:h,x:c,y:d-14,rotate:0}},_linkRightToLeft:function(t,n,r,s,o){var a,l,c,u,h,d,p=0;return a=t.x+r.linkAdjuster.toX,l=t.y+t.h/2+r.linkAdjuster.toY,h=n.x+n.w+r.linkAdjuster.fromX,d=u=n.y+n.h/2+r.linkAdjuster.fromY,c=l,{xa:a,ya:l,xb:p=t.rightNeighbor&&t.rightNeighbor.isAssistant&&n.templateName=="split"?t.rightNeighbor.x-s:t.templateName=="split"&&(n.isAssistant||n.layout>1)?h:n.templateName=="split"?a-s:o??h+s,yb:c,xc:p,yc:u,xd:h,yd:d,x:p-16,y:u,rotate:90}},_linkLeftToRight:function(t,n,r,s,o){var a,l,c,u,h,d,p=0;return a=t.x+t.w+r.linkAdjuster.toX,l=t.y+t.h/2+r.linkAdjuster.toY,h=n.x+r.linkAdjuster.fromX,d=u=n.y+n.h/2+r.linkAdjuster.fromY,c=l,{xa:a,ya:l,xb:p=t.rightNeighbor&&t.rightNeighbor.isAssistant&&n.templateName=="split"?t.rightNeighbor.x+t.rightNeighbor.w+s:t.templateName=="split"&&(n.isAssistant||n.layout>1)?h:n.templateName=="split"?a+s:o??h-s,yb:c,xc:p,yc:u,xd:h,yd:d,x:p+14,y:u,rotate:270}},_linkPpTop:function(t,n,r,s,o,a){var l=t.ppnodes[r.id],c=l.y+l.h/2,u=s.minY-(s.minY-o.maxY)/2,h=(s.minY-o.maxY)/t.maxSidePartnersWithChildren/4,d=e.ui.__linkPpBottomTop(t,n,r,u,h,l),p=d.x;return u=d.mid,e.ui._linkTopToBottom({x:p,y:c,w:0,h:0},r,a,0,u)},_linkPpBottom:function(t,n,r,s,o,a){var l=t.ppnodes[r.id],c=l.y+l.h/2,u=s.maxY-(s.maxY-o.minY)/2,h=(s.maxY-o.minY)/t.maxSidePartnersWithChildren/4,d=e.ui.__linkPpBottomTop(t,n,r,u,h,l),p=d.x;return u=d.mid,e.ui._linkBottomToTop({x:p,y:c,w:0,h:0},r,a,0,u)},_linkPpLeft:function(t,n,r,s,o,a){var l=t.ppnodes[r.id],c=s.minX-(s.minX-o.maxX)/2,u=(s.minX-o.maxX)/t.maxSidePartnersWithChildren/4,h=l.x+l.w/2,d=e.ui.__linkPpLeftRight(t,n,r,c,u,l),p=d.y;return c=d.mid,e.ui._linkLeftToRight({x:h,y:p,w:0,h:0},r,a,0,c)},_linkPpRight:function(t,n,r,s,o,a){var l=t.ppnodes[r.id],c=s.maxX-(s.maxX-o.minX)/2,u=(s.maxX-o.minX)/t.maxSidePartnersWithChildren/4,h=l.x+l.w/2,d=e.ui.__linkPpLeftRight(t,n,r,c,u,l),p=d.y;return c=d.mid,e.ui._linkRightToLeft({x:h,y:p,w:0,h:0},r,a,0,c)},__linkPpBottomTop:function(t,n,r,s,o,a){var l=0;return a.isPartner==1?(l=a.x-n.partnerSeparation/2+t.indexes[r.id]*t.partnerChildrenSplitSeparation-(t.rightIds.length-1)*t.partnerChildrenSplitSeparation/2,t.lastLeft&&l<t.lastLeft.x+t.lastLeft.w/2?l<r.x+r.w/2?s-=(t.indexes[r.id]+1)*o:s-=(t.rightIds.length-t.indexes[r.id])*o:l<r.x+r.w/2?s+=(t.rightIds.length-t.indexes[r.id])*o:s+=(t.indexes[r.id]+1)*o):a.isPartner==2&&(l=a.x+a.w+n.partnerSeparation/2+t.indexes[r.id]*t.partnerChildrenSplitSeparation-(t.leftIds.length-1)*t.partnerChildrenSplitSeparation/2,t.firstRight&&l>t.firstRight.x+t.firstRight.w/2?l<r.x+r.w/2?s-=(t.indexes[r.id]+1)*o:s-=(t.leftIds.length-t.indexes[r.id])*o:l<r.x+r.w/2?s+=(t.leftIds.length-t.indexes[r.id])*o:s+=(t.indexes[r.id]+1)*o),{x:l,mid:s}},__linkPpLeftRight:function(t,n,r,s,o,a){var l=0;return a.isPartner==1?(l=a.y-n.partnerSeparation/2+t.indexes[r.id]*t.partnerChildrenSplitSeparation-(t.rightIds.length-1)*t.partnerChildrenSplitSeparation/2,t.lastLeft&&l<t.lastLeft.y+t.lastLeft.h/2?l<r.y+r.h/2?s-=(t.indexes[r.id]+1)*o:s-=(t.rightIds.length-t.indexes[r.id])*o:l<r.y+r.h/2?s+=(t.rightIds.length-t.indexes[r.id])*o:s+=(t.indexes[r.id]+1)*o):a.isPartner==2&&(l=a.y+a.h+n.partnerSeparation/2+t.indexes[r.id]*t.partnerChildrenSplitSeparation-(t.leftIds.length-1)*t.partnerChildrenSplitSeparation/2,t.firstRight&&l>t.firstRight.y+t.firstRight.h/2?l<r.y+r.h/2?s-=(t.indexes[r.id]+1)*o:s-=(t.leftIds.length-t.indexes[r.id])*o:l<r.y+r.h/2?s+=(t.leftIds.length-t.indexes[r.id])*o:s+=(t.indexes[r.id]+1)*o),{y:l,mid:s}},_draggableLinkPath:function(t,n,r,s,o,a){if(r.isPartner||r.isAssistant)return null;if(e._isMoved(r)&&!e._isMoved(n)){var l=[];switch(a){case e.orientation.top:case e.orientation.top_left:if(s.yb+o/2<s.yd)return null;u=s.xa<s.xd?r.x-o/2:r.x+r.w+o/2,h=r.y-o/2;break;case e.orientation.bottom:case e.orientation.bottom_left:if(s.yb-o/2>s.yd)return null;u=s.xa<s.xd?r.x-o/2:r.x+r.w+o/2,h=r.y+r.h+o/2;break;case e.orientation.right:case e.orientation.right_top:if(s.xb-o/2>s.xd)return null;h=s.ya<s.yd?r.y-o/2:r.y+r.h+o/2,u=r.x+r.w+o/2;break;case e.orientation.left:case e.orientation.left_top:if(s.xb+o/2<s.xd)return null;h=s.ya<s.yd?r.y-o/2:r.y+r.h+o/2,u=r.x-o/2}switch(a){case e.orientation.top:case e.orientation.top_left:case e.orientation.bottom:case e.orientation.bottom_left:l.push(["M",s.xa,s.ya]),l.push(["L",s.xb,s.yb]),l.push(["L",u,s.yb]),l.push(["L",u,h]),l.push(["L",s.xd,h]),l.push(["L",s.xd,s.yd]);break;case e.orientation.right:case e.orientation.right_top:case e.orientation.left:case e.orientation.left_top:(l=[]).push(["M",s.xa,s.ya]),l.push(["L",s.xb,s.yb]),l.push(["L",s.xb,h]),l.push(["L",u,h]),l.push(["L",u,s.yd]),l.push(["L",s.xd,s.yd])}return e.roundPathCorners(l,e.LINK_ROUNDED_CORNERS,!1)}if(!e._isMoved(r)&&e._isMoved(n)){var c=!1;switch(l=[],a){case e.orientation.top:case e.orientation.top_left:if(s.ya+o/2>s.yb)c=!0,u=s.xa<s.xd?n.x+n.w+o/2:n.x-o/2,h=n.y+n.h+o;else{if(s.yb+o/2<s.yd)return null;u=s.xa<s.xd?r.x-o/2:r.x+r.w+o/2,h=r.y-o/2}break;case e.orientation.bottom:case e.orientation.bottom_left:if(s.ya-o/2<s.yb)c=!0,u=s.xa<s.xd?n.x+n.w+o/2:n.x-o/2,h=n.y-o;else{if(s.yb-o/2>s.yd)return null;u=s.xa<s.xd?r.x-o/2:r.x+r.w+o/2,h=r.y+r.h+o/2}break;case e.orientation.right:case e.orientation.right_top:if(s.xa-o/2<s.xb)c=!0,h=s.ya<s.yd?n.y+n.h+o/2:n.y-o/2,u=n.x-o;else{if(s.xb-o/2>s.xd)return null;h=s.ya<s.yd?r.y-o/2:r.y+r.h+o/2,u=r.x+r.w+o/2}break;case e.orientation.left:case e.orientation.left_top:if(s.xa+o/2>s.xb)c=!0,h=s.ya<s.yd?n.y+n.h+o/2:n.y-o/2,u=n.x+n.w+o;else{if(s.xb+o/2<s.xd)return null;h=s.ya<s.yd?r.y-o/2:r.y+r.h+o/2,u=r.x-o/2}}if(c)switch(a){case e.orientation.top:case e.orientation.top_left:case e.orientation.bottom:case e.orientation.bottom_left:l.push(["M",s.xa,s.ya]),l.push(["L",s.xa,h]),l.push(["L",u,h]),l.push(["L",u,s.yc]),l.push(["L",s.xc,s.yc]),l.push(["L",s.xd,s.yd]);break;case e.orientation.right:case e.orientation.right_top:case e.orientation.left:case e.orientation.left_top:l.push(["M",s.xa,s.ya]),l.push(["L",u,s.ya]),l.push(["L",u,h]),l.push(["L",s.xc,h]),l.push(["L",s.xc,s.yc]),l.push(["L",s.xd,s.yd])}else switch(a){case e.orientation.top:case e.orientation.top_left:case e.orientation.bottom:case e.orientation.bottom_left:l.push(["M",s.xa,s.ya]),l.push(["L",s.xb,s.yb]),l.push(["L",u,s.yb]),l.push(["L",u,h]),l.push(["L",s.xd,h]),l.push(["L",s.xd,s.yd]);break;case e.orientation.right:case e.orientation.right_top:case e.orientation.left:case e.orientation.left_top:l.push(["M",s.xa,s.ya]),l.push(["L",s.xb,s.yb]),l.push(["L",s.xb,h]),l.push(["L",u,h]),l.push(["L",u,s.yd]),l.push(["L",s.xd,s.yd])}return e.roundPathCorners(l,e.LINK_ROUNDED_CORNERS,!1)}if(e._isMoved(r)&&e._isMoved(n)){switch(l=[],a){case e.orientation.top:case e.orientation.top_left:if(s.ya+o>s.yd){var u=s.xa<s.xd?n.x+n.w+o/2:n.x-o/2,h=n.y+n.h+o,d=r.y-o;l.push(["M",s.xa,s.ya]),l.push(["L",s.xa,h]),l.push(["L",u,h]),l.push(["L",u,d]),l.push(["L",s.xc,d]),l.push(["L",s.xd,s.yd])}else l.push(["M",s.xa,s.ya]),l.push(["L",s.xa,n.y+n.h+o]),l.push(["L",s.xc,n.y+n.h+o]),l.push(["L",s.xd,s.yd]);break;case e.orientation.bottom:case e.orientation.bottom_left:s.ya-o<s.yd?(u=s.xa<s.xd?n.x+n.w+o/2:n.x-o/2,h=n.y-o,d=r.y+r.h+o,l.push(["M",s.xa,s.ya]),l.push(["L",s.xa,h]),l.push(["L",u,h]),l.push(["L",u,d]),l.push(["L",s.xc,d]),l.push(["L",s.xd,s.yd])):(l.push(["M",s.xa,s.ya]),l.push(["L",s.xa,n.y-o]),l.push(["L",s.xc,n.y-o]),l.push(["L",s.xd,s.yd]));break;case e.orientation.right:case e.orientation.right_top:if(s.xa-o<s.xd){h=s.ya<s.yd?n.y+n.h+o/2:n.y-o/2,u=n.x-o;var p=r.x+r.w+o;l.push(["M",s.xa,s.ya]),l.push(["L",u,s.ya]),l.push(["L",u,h]),l.push(["L",p,h]),l.push(["L",p,s.yc]),l.push(["L",s.xd,s.yd])}else l.push(["M",s.xa,s.ya]),l.push(["L",n.x-o,s.ya]),l.push(["L",n.x-o,s.yc]),l.push(["L",s.xd,s.yd]);break;case e.orientation.left:case e.orientation.left_top:s.xa+o>s.xd?(h=s.ya<s.yd?n.y+n.h+o/2:n.y-o/2,u=n.x+n.w+o,p=r.x-o,l.push(["M",s.xa,s.ya]),l.push(["L",u,s.ya]),l.push(["L",u,h]),l.push(["L",p,h]),l.push(["L",p,s.yc]),l.push(["L",s.xd,s.yd])):(l.push(["M",s.xa,s.ya]),l.push(["L",n.x+n.w+o,s.ya]),l.push(["L",n.x+n.w+o,s.yc]),l.push(["L",s.xd,s.yd]))}return e.roundPathCorners(l,e.LINK_ROUNDED_CORNERS,!1)}return null}},e.ui._base_nodeBtns=e.ui.nodeBtns,e.ui.nodeBtns=function(t,n,r,s,o){var a="";return o._tree_menu_temp?!n.isSplit&&r!==e.action.exporting&&s.nodeTreeMenuCloseButton&&o._tree_menu_temp.id==n.id&&(a+=s.nodeTreeMenuCloseButton):(a=e.ui._base_nodeBtns(t,n,r,s,o),t.nodeTreeMenu!=null&&!n.isSplit&&r!==e.action.exporting&&s.nodeTreeMenuButton&&(a+=s.nodeTreeMenuButton.replace("{id}",n.id))),a},e.ui._base_expandCollapseBtn=e.ui.expandCollapseBtn,e.ui.expandCollapseBtn=function(t,n,r,s,o){return t._tree_menu_temp?"":e.ui._base_expandCollapseBtn(t,n,r,s,o)},e.xScrollUI=function(t,n,r,s,o){this.element=t,this.requestParams=r,this.config=n,this.onSetViewBoxCallback=s,this.onDrawCallback=o,this.position=0,this.bar=null,this._event_id=e._guid()},e.xScrollUI.prototype.addListener=function(t){var n=this;if((this.config.mouseScrool==e.action.xScroll||this.config.mouseScrool==e.action.scroll)&&this.bar){var r=navigator.userAgent.indexOf("Mac OS")!==-1,s=e._getScrollSensitivity();(function(o,a,l){var c=!1;function u(){c=!0;var d=(n.position-n.bar.scrollLeft)/l;if(d>0)d++;else{if(d==0)return void(c=!1);d--}Math.ceil(n.bar.scrollLeft)==Math.ceil(n.position)?c=!1:(n.bar.scrollLeft+=d,h(u))}o.addEventListener("wheel",function(d){if(!d.ctrlKey){var p=0;if(n.config.mouseScrool==e.action.xScroll)(p=d.deltaX||d.wheelDeltaX)||(p=d.deltaY||d.wheelDeltaY);else if(n.config.mouseScrool==e.action.scroll&&!(p=r||!d.shiftKey?d.deltaX||d.wheelDeltaX:d.deltaY||d.wheelDeltaY))return;p=-p,p=Math.max(-1,Math.min(1,p)),n.position+=-p*a;var g=parseFloat(n.innerBar.clientWidth)-parseFloat(n.bar.clientWidth);n.position<0&&(n.position=0),n.position>g&&(n.position=g),c||u()}},{passive:!0});var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(d){setTimeout(d,20)}})(t,s.speed,s.smooth)}},e.xScrollUI.prototype.create=function(t){if(this.config.showXScroll===e.scroll.visible||this.config.mouseScrool===e.action.scroll||this.config.mouseScrool===e.action.xScroll){var n=this;this.bar&&this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar),this.bar=document.createElement("div"),this.innerBar=document.createElement("div"),this.requestParams(),this.innerBar.innerHTML="&nbsp",Object.assign(this.bar.style,{position:"absolute",left:0,bottom:0,width:t+"px","overflow-x":"scroll",height:"20px"}),this.element.appendChild(this.bar),this.bar.appendChild(this.innerBar),this.bar.addEventListener("scroll",function(){if(this.ignore)this.ignore=!1;else{var r=n.requestParams(),s=(parseFloat(n.innerBar.clientWidth)-parseFloat(n.bar.clientWidth))/100,o=this.scrollLeft/s,a=(r.boundary.right-r.boundary.left)/100;r.viewBox[0]=o*a+r.boundary.left,n.onSetViewBoxCallback(r.viewBox),clearTimeout(this._timeout),this._timeout=setTimeout(function(){n.onDrawCallback()},500)}})}},e.xScrollUI.prototype.setPosition=function(){if(this.bar){var t=this.requestParams(),n=(Math.abs(t.boundary.maxX-t.boundary.minX)+2*this.config.padding)*t.scale;switch(this.config.orientation){case e.orientation.right:case e.orientation.right_top:n=Math.abs(t.boundary.minX*t.scale)}this.innerBar.style.width=n+"px";var r=(t.boundary.right-t.boundary.left)/100,s=(t.viewBox[0]-t.boundary.left)/r;s<0?s=0:s>100&&(s=100);var o=(parseFloat(this.innerBar.clientWidth)-parseFloat(this.bar.clientWidth))/100,a=s*o;this.bar.ignore=!0,this.bar.scrollLeft=a,this.position=this.bar.scrollLeft,this.bar.style.visibility=o<=0?"hidden":"",this.config.showXScroll!==e.scroll.visible&&(this.bar.style.visibility="hidden"),e.events.publish("change",[this,{isScrollBarVisible:this.bar.style.visibility!="hidden"}])}},e.xScrollUI.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e.yScrollUI=function(t,n,r,s,o){this.element=t,this.requestParams=r,this.config=n,this.onSetViewBoxCallback=s,this.onDrawCallback=o,this.position=0,this.bar=null,this._event_id=e._guid()},e.yScrollUI.prototype.addListener=function(t){var n=this;if((this.config.mouseScrool==e.action.yScroll||this.config.mouseScrool==e.action.scroll)&&this.bar){var r=navigator.userAgent.indexOf("Mac OS")!==-1,s=e._getScrollSensitivity();(function(o,a,l){var c=!1;function u(){c=!0;var d=(n.position-n.bar.scrollTop)/l;if(d>0)d++;else{if(d==0)return void(c=!1);d--}Math.ceil(n.bar.scrollTop)==Math.ceil(n.position)?c=!1:(n.bar.scrollTop+=d,h(u))}o.addEventListener("wheel",function(d){if(!d.ctrlKey){var p=0;if(n.config.mouseScrool==e.action.yScroll)(p=d.deltaY||d.wheelDeltaY)||(p=d.deltaX||d.wheelDeltaX);else if(n.config.mouseScrool==e.action.scroll&&!(p=r||!d.shiftKey?d.deltaY||d.wheelDeltaY:d.deltaX||d.wheelDeltaX))return;p=-p,p=Math.max(-1,Math.min(1,p)),n.position+=-p*a;var g=parseFloat(n.innerBar.clientHeight)-parseFloat(n.bar.clientHeight);n.position<0&&(n.position=0),n.position>g&&(n.position=g),c||u()}},{passive:!0});var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(d){setTimeout(d,20)}})(t,s.speed,s.smooth)}},e.yScrollUI.prototype.create=function(t){if(this.config.showYScroll===e.scroll.visible||this.config.mouseScrool===e.action.scroll||this.config.mouseScrool===e.action.yScroll){var n=this;this.bar&&this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar),this.bar=document.createElement("div"),this.innerBar=document.createElement("div"),this.innerBar.innerHTML="&nbsp",Object.assign(this.bar.style,{position:"absolute",right:0,bottom:0,height:t+"px","overflow-y":"scroll",width:"20px"}),this.element.appendChild(this.bar),this.bar.appendChild(this.innerBar),this.bar.addEventListener("scroll",function(){if(this.ignore)this.ignore=!1;else{var r=n.requestParams(),s=(parseFloat(n.innerBar.clientHeight)-parseFloat(n.bar.clientHeight))/100,o=this.scrollTop/s,a=(r.boundary.bottom-r.boundary.top)/100;r.viewBox[1]=o*a+r.boundary.top,n.onSetViewBoxCallback(r.viewBox),clearTimeout(this._timeout),this._timeout=setTimeout(function(){n.onDrawCallback()},500)}})}},e.yScrollUI.prototype.setPosition=function(){if(this.bar){var t=this.requestParams(),n=(Math.abs(t.boundary.maxY-t.boundary.minY)+2*this.config.padding)*t.scale;switch(this.config.orientation){case e.orientation.bottom:case e.orientation.bottom_left:n=Math.abs(t.boundary.minY*t.scale)}this.innerBar.style.height=n+"px";var r=(t.boundary.bottom-t.boundary.top)/100,s=(t.viewBox[1]-t.boundary.top)/Math.abs(r);s<0?s=0:s>100&&(s=100);var o=(parseFloat(this.innerBar.clientHeight)-parseFloat(this.bar.clientHeight))/100,a=s*o;this.bar.ignore=!0,this.bar.scrollTop=a,this.position=this.bar.scrollTop,this.bar.style.visibility=o<=0?"hidden":"",this.config.showYScroll!==e.scroll.visible&&(this.bar.style.visibility="hidden"),e.events.publish("change",[this,{isScrollBarVisible:this.bar.style.visibility!="hidden"}])}},e.yScrollUI.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e.prototype.zoom=function(t,n,r,s){var o=this.getViewBox().slice(0),a=o,l=o[2],c=o[3];t===!0?(o[2]=o[2]/e.SCALE_FACTOR,o[3]=o[3]/e.SCALE_FACTOR):t===!1?(o[2]=o[2]*e.SCALE_FACTOR,o[3]=o[3]*e.SCALE_FACTOR):(o[2]=o[2]/t,o[3]=o[3]/t),n||(n=[50,50]),o[0]=a[0]-(o[2]-l)/(100/n[0]),o[1]=a[1]-(o[3]-c)/(100/n[1]);var u=this.getScale(o);if(o[2]=this.width()/u,o[3]=this.height()/u,t===!0&&u<this.config.scaleMax||t===!1&&u>this.config.scaleMin||t!=0&&t!=1&&u<this.config.scaleMax&&u>this.config.scaleMin){this._hideBeforeAnimation();var h=this;r?(clearTimeout(h._timeout),e.animate(this.getSvg(),{viewbox:this.getViewBox()},{viewbox:o},this.config.anim.duration,this.config.anim.func,function(){clearTimeout(h._timeout),h._timeout=setTimeout(function(){h._draw(!0,e.action.zoom,null,s)},500)})):(this.setViewBox(o),clearTimeout(h._timeout),h._timeout=setTimeout(function(){h._draw(!0,e.action.zoom,null,s)},500))}},e.loading={},e.loading.show=function(t){var n=document.createElement("div");n.id="bft-loading",n.innerHTML='<style>@-webkit-keyframes dot-keyframes {0% { opacity: .4; -webkit-transform: scale(1, 1);transform: scale(1, 1);}50% {opacity: 1;-webkit-transform: scale(1.2, 1.2);transform: scale(1.2, 1.2);}100% {opacity: .4;-webkit-transform: scale(1, 1);transform: scale(1, 1);}}@keyframes dot-keyframes {0% {opacity: .4;-webkit-transform: scale(1, 1);transform: scale(1, 1);}50% {opacity: 1;-webkit-transform: scale(1.2, 1.2);transform: scale(1.2, 1.2);}100% {opacity: .4;-webkit-transform: scale(1, 1);transform: scale(1, 1);}}.bft-loading-dots div {margin: 10px;}      .bft-dot-1 {background-color: #039BE5;}.bft-dot-2 {background-color: #F57C00;}.bft-dot-3 {background-color: #FFCA28;}      .bft-loading-dots {text-align: center;width: 100%; position: absolute; top: 0;}.bft-loading-dots--dot {-webkit-animation: dot-keyframes 1.5s infinite ease-in-out;animation: dot-keyframes 1.5s infinite ease-in-out;        border-radius: 10px;display: inline-block;height: 10px;width: 10px;}.bft-loading-dots--dot:nth-child(2) {-webkit-animation-delay: .5s;animation-delay: .5s;}.bft-loading-dots--dot:nth-child(3) {-webkit-animation-delay: 1s;animation-delay: 1s;}</style><div class="bft-loading-dots"><div class="bft-loading-dots--dot bft-dot-1"></div><div class="bft-loading-dots--dot bft-dot-2"></div><div class="bft-loading-dots--dot bft-dot-3"></div></div>',t.element.appendChild(n)},e.loading.hide=function(t){var n=t.element.querySelector("#bft-loading");n&&n.parentNode.removeChild(n)},e.pdfPrevUI={},e.loc||(e.loc={}),e.loc.ppdfCmdTitle="PDF Preview",e.loc.ppdfSave="Save",e.loc.ppdfCancel="Cancel",e.loc.ppdfFormat="Format",e.loc.ppdfFitToDrwaing="Fit",e.loc.ppdfA4="A4",e.loc.ppdfA3="A3",e.loc.ppdfA2="A2",e.loc.ppdfA1="A1",e.loc.ppdfLetter="Letter",e.loc.ppdfLegal="Legal",e.loc.ppdfLayout="Layout",e.loc.ppdfPortrait="Portrait",e.loc.ppdfLandscape="Landscape",e.loc.ppdfFittopagewidth="Fit to page width",e.loc.ppdfMargin="Margin",e.loc.ppdfHeader="Header",e.loc.ppdfFooter="Footer",e.loc.ppdfScale="Scale",e.pdfPrevUI.show=function(t,n){e.pdfPrevUI.hide(t),n=t._defaultExportOptions(n,"pdf");var r=document.createElement("div");r.classList.add(t.config.mode),r.id="bft-ppdf-btns",Object.assign(r.style,{position:"absolute",top:0,left:0,"background-color":"#fff","z-index":5,margin:"0 0 0 -265px","box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",width:"265px",height:"100%","font-family":"Roboto,Helvetica",color:"#757575","text-align":"right",padding:"10px"}),t.element.appendChild(r),r.innerHTML="<h1>"+e.loc.ppdfCmdTitle+'</h1><div><button type="button" id="bft-prev-save" style="font-size: 14px; width: 90px;">'+e.loc.ppdfSave+'</button>&nbsp;<button type="button" id="bft-prev-cancel" style="width: 90px;font-size: 14px;">'+e.loc.ppdfCancel+'</button></div><div style="margin-top:30px; height:10px;border-bottom:1px solid #eeeeee;"></div><div style="padding-top:30px;"><label for="bft-size">'+e.loc.ppdfFormat+': </label><select id="bft-ppdf-size" style="color: #757575; width: 150px; font-size: 14px;" id="bft-size"><option value="fit">'+e.loc.ppdfFitToDrwaing+'</option><option value="A4">'+e.loc.ppdfA4+'</option><option value="A3">'+e.loc.ppdfA3+'</option><option value="A2">'+e.loc.ppdfA2+'</option><option value="A1">'+e.loc.ppdfA1+'</option><option value="Letter">'+e.loc.ppdfLetter+'</option><option value="Legal">'+e.loc.ppdfLegal+'</option></select></div><div style="padding-top:10px;"><label for="bft-ppdf-layout">'+e.loc.ppdfLayout+': </label><select id="bft-ppdf-layout" style="color: #757575; width: 150px;font-size: 14px;" ><option value="false">'+e.loc.ppdfPortrait+'</option><option value="true">'+e.loc.ppdfLandscape+'</option></select></div><div style="padding-top:10px;"><label for="bft-scale">'+e.loc.ppdfScale+': </label><select id="bft-ppdf-scale" style="color: #757575; width: 150px;font-size: 14px;" id="bft-scale"><option value="fit">'+e.loc.ppdfFittopagewidth+'</option><option value="10">10%</option><option value="20">20%</option><option value="30">30%</option><option value="40">40%</option><option value="50">50%</option><option value="60">60%</option><option value="70">70%</option><option value="80">80%</option><option value="90">90%</option><option value="100">100%</option><option value="110">110%</option><option value="120">120%</option><option value="130">130%</option><option value="140">140%</option><option value="150">150%</option><option value="160">160%</option><option value="170">170%</option><option value="180">180%</option><option value="190">190%</option><option value="200">200%</option></select></div><div style="margin-top:10px;margin-bottom:10px; height:10px;border-bottom:1px solid #eeeeee;"></div><div style="padding-top:10px;"><label for="bft-ppdf-header">'+e.loc.ppdfHeader+': </label><input id="bft-ppdf-header" type="text" style="color: #757575; width: 100px;font-size: 14px;" ></div><div style="padding-top:10px;"><label for="bft-ppdf-footer">'+e.loc.ppdfFooter+': </label><input id="bft-ppdf-footer" type="text" style="color: #757575; width: 100px;font-size: 14px;" ></div><div style="padding-top:10px;"><label for="bft-ppdf-margin">'+e.loc.ppdfMargin+': </label><input id="bft-ppdf-margin" type="text" style="color: #757575; width: 100px;font-size: 14px;" ></div>';var s=document.createElement("div");s.id="bft-ppdf-wrapper",Object.assign(s.style,{"overflow-y":"scroll","z-index":11,position:"absolute",top:0,left:"285px","background-color":"#eee",width:t.width()-270+"px",height:"100%"}),t.element.appendChild(s),s.innerHTML='<div id="bft-ppdf-content" style="width: 100%;margin-top:10px;margin-bottom:10px;opacity:0;"></div>';var o,a,l,c=t.element.querySelector("#bft-ppdf-size"),u=t.element.querySelector("#bft-ppdf-layout"),h=t.element.querySelector("#bft-ppdf-scale"),d=t.element.querySelector("#bft-ppdf-margin"),p=t.element.querySelector("#bft-ppdf-header"),g=t.element.querySelector("#bft-ppdf-footer");c.value=n.format,u.value=n.landscape,h.value=n.scale,d.value=n.margin,p.value=n.header,g.value=n.footer,e.animate(t.element.querySelector("#bft-ppdf-btns"),{margin:[0,0,0,-250]},{margin:[0,0,0,0]},300,e.anim.outSin,function(){t.exportPDF(n,e.pdfPrevUI._handler)}),t.element.querySelector("#bft-prev-cancel").addEventListener("click",function(){e.pdfPrevUI.hide(t)}),t.element.querySelector("#bft-prev-save").addEventListener("click",function(){t.exportPDF(n),e.pdfPrevUI.hide(t)}),e.pdfPrevUI._showHide(c,u,h),c.addEventListener("change",function(){e.animate(t.element.querySelector("#bft-ppdf-content"),{opacity:1},{opacity:0},300,e.anim.inSin,function(){t.element.querySelector("#bft-ppdf-content").innerHTML="",n.format=c.value,t.exportPDF(n,e.pdfPrevUI._handler),e.pdfPrevUI._showHide(c,u,h)})}),u.addEventListener("change",function(){e.animate(t.element.querySelector("#bft-ppdf-content"),{opacity:1},{opacity:0},300,e.anim.inSin,function(){t.element.querySelector("#bft-ppdf-content").innerHTML="",n.landscape=u.value=="true",t.exportPDF(n,e.pdfPrevUI._handler),e.pdfPrevUI._showHide(c,u,h)})}),h.addEventListener("change",function(){e.animate(t.element.querySelector("#bft-ppdf-content"),{opacity:1},{opacity:0},300,e.anim.inSin,function(){t.element.querySelector("#bft-ppdf-content").innerHTML="",n.scale=h.value,t.exportPDF(n,e.pdfPrevUI._handler),e.pdfPrevUI._showHide(c,u,h)})}),d.addEventListener("keyup",function(){clearTimeout(o),o=setTimeout(function(){e.animate(t.element.querySelector("#bft-ppdf-content"),{opacity:1},{opacity:0},300,e.anim.inSin,function(){t.element.querySelector("#bft-ppdf-content").innerHTML="";var _=d.value.split(",");if(_.length==4){for(var v=0;v<_.length;v++)_[v]=parseInt(_[v]);n.margin=_,t.exportPDF(n,e.pdfPrevUI._handler)}})},1e3)}),p.addEventListener("keyup",function(){clearTimeout(a),a=setTimeout(function(){e.animate(t.element.querySelector("#bft-ppdf-content"),{opacity:1},{opacity:0},300,e.anim.inSin,function(){t.element.querySelector("#bft-ppdf-content").innerHTML="",n.header=p.value,t.exportPDF(n,e.pdfPrevUI._handler)})},1e3)}),g.addEventListener("keyup",function(){clearTimeout(l),l=setTimeout(function(){e.animate(t.element.querySelector("#bft-ppdf-content"),{opacity:1},{opacity:0},300,e.anim.inSin,function(){t.element.querySelector("#bft-ppdf-content").innerHTML="",n.footer=g.value,t.exportPDF(n,e.pdfPrevUI._handler)})},1e3)})},e.pdfPrevUI._showHide=function(t,n,r){t.value=="A4"||t.value=="A3"||t.value=="A2"||t.value=="A1"||t.value=="Letter"||t.value=="Legal"?(n.parentNode.style.display="block",r.parentNode.style.display="block"):(n.parentNode.style.display="none",r.parentNode.style.display="none")},e.pdfPrevUI._handler=function(t,n,r){var s=n.options,o=n.pages,a=s.margin[0],l=s.margin[2],c=document.createElement("div");c.classList.add(t.config.mode),c.innerHTML=r.outerHTML,e._browser().msie&&(c.innerHTML=new XMLSerializer().serializeToString(r));for(var u=c.querySelector("svg"),h=t.element.querySelector("#bft-ppdf-content"),d=0;d<o.length;d++){var p=document.createElement("iframe");Object.assign(p.style,{display:"block",margin:"10px auto",border:"1px solid #eeeeee","box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"}),h.appendChild(p),u&&u.style.backgroundColor?p.style.backgroundColor=u.style.backgroundColor:p.style.backgroundColor="#fff";var g=p.contentWindow.document;g.open(),p.style.width=o[d].size.w+"px",p.style.height=o[d].size.h+"px",p.style.margin="10 auto",o[d].backgroundColor&&(p.style.backgroundColor=o[d].backgroundColor);var _=s.header;o[d].header&&(_=o[d].header),_&&(_=_.replace("{current-page}",d+1).replace("{total-pages}",o.length));var v=s.footer;o[d].footer&&(v=o[d].footer),v&&(v=v.replace("{current-page}",d+1).replace("{total-pages}",o.length)),o[d].html?g.write(e._exportHtml(o[d].html,n.styles,s,o[d].innerSize.w,o[d].innerSize.h,_,v,t.config.mode)):(u.setAttribute("viewBox",o[d].vb),g.write(e._exportHtml(c.innerHTML,n.styles,s,o[d].innerSize.w,o[d].innerSize.h,_,v,t.config.mode)));var C=g.getElementById("bft-header"),T=g.getElementById("bft-footer");if(C){var y=a-C.offsetHeight-7;C.style.top=y+"px"}if(T){var A=l-T.offsetHeight-7;T.style.bottom=A+"px"}g.close()}var E=t.element.querySelector("#bft-ppdf-content");e.animate(E,{opacity:0},{opacity:1},300,e.anim.outSin)},e.pdfPrevUI._getViewBox=function(t){var n=null;return t?(n=(n="["+(n=t.getAttribute("viewBox"))+"]").replace(/\ /g,","),n=JSON.parse(n)):null},e._exportHtml=function(t,n,r,s,o,a,l,c){for(var u="",h=0;h<r.margin.length;h++)u+=r.margin[h]+"px ";var d='<!DOCTYPE html><html style="margin:0;padding:0;"><head></head>'+n+'<body class="bft-'+c+'" style="margin:0; padding:0;"><div style="margin: '+u+";overflow:hidden;width:"+s+"px;height:"+o+'px">';return a&&(d+='<div id="bft-header" style="width:'+s+"px;color:#757575;position:absolute;left:"+r.margin[3]+'px;top:0;">'+a+"</div>"),d+=t,l&&(d+='<div id="bft-footer" style="width:'+s+"px;color:#757575;position:absolute;left:"+r.margin[3]+'px;bottom:0;">'+l+"</div>"),d+="</div>",d+="</body></html>"},e.pdfPrevUI.hide=function(t){var n=t.element.querySelector("#bft-ppdf-wrapper");if(n){n.parentNode.removeChild(n),n.style.opacity=0;var r=t.element.querySelector("#bft-ppdf-btns");r.parentNode.removeChild(r)}},e===void 0&&(e={}),e.events.on("renderdefs",function(t,n){for(var r=0;r<t.config.clinks.length;r++){var s=t.config.clinks[r].template;s||(s="orange");var o=e.clinkTemplates[s];n.defs+=o.defs}}),e.events.on("prerender",function(t,n){e.RENDER_CLINKS_BEFORE_NODES&&t._clink(t,n)}),e.events.on("render",function(t,n){e.RENDER_CLINKS_BEFORE_NODES||t._clink(t,n)}),e.events.on("drag",function(t,n,r,s){if(t instanceof e&&t.config.movable&&s)for(var o=0;o<s.length;o++){for(var a=s[o],l=t.element.querySelectorAll(`[data-c-l-from="${a}"]`),c=t.element.querySelectorAll(`[data-c-l-to="${a}"]`),u=0;u<l.length;u++)l[u].parentNode.removeChild(l[u]);for(u=0;u<c.length;u++)c[u].parentNode.removeChild(c[u])}}),e.prototype._clink=function(t,n){for(var r="",s=0;s<this.config.clinks.length;s++){let I=function(k,P,O){O==null&&(O=1);var R=P.x-k.x,K=P.y-k.y,ie=Math.sqrt(Math.pow(P.x-k.x,2)+Math.pow(P.y-k.y,2))/3;return ie=ie/(Math.sqrt(R*R+K*K)*O)*e.clinkCurve(o),{x:k.x+R/2-K*ie,y:k.y+K/2+R*ie}};var o=this.config.clinks[s],a=t.getNode(o.from),l=t.getNode(o.to);if(a&&n.res.visibleNodeIds.indexOf(a.id)!=-1&&l&&n.res.visibleNodeIds.indexOf(l.id)!=-1){var c=a.x,u=a.y,h=l.x,d=l.y,p={},g={},_=c+a.w/2,v=h+l.w/2,C=u+a.h/2,T=d+l.h/2,y=1;switch(this.config.orientation){case e.orientation.top:case e.orientation.top_left:_<=v?(y=1,p.x=_+a.w/10,g.x=v-l.w/10):(y=-1,p.x=_-a.w/10,g.x=v+l.w/10),u==d?(y=1,p.y=u,g.y=d):u>d?(p.y=u,g.y=d+l.h):(p.y=u+a.h,g.y=d);break;case e.orientation.bottom:case e.orientation.bottom_left:_<=v?(y=-1,p.x=_+a.w/10,g.x=v+l.w/10):(y=1,p.x=_-a.w/10,g.x=v+l.w/10),u==d?(y=-1,p.y=u+a.h,g.y=d+l.h):u>d?(p.y=u,g.y=d+l.h):(p.y=u+a.h,g.y=d);break;case e.orientation.left:case e.orientation.left_top:C<=T?(y=-1,p.y=C+a.h/5,g.y=T+l.h/5):(y=1,p.y=C-a.h/5,g.y=T+l.h/5),c==h?(y=-1,p.x=c,g.x=h):c>h?(p.x=c,g.x=h+l.w):(p.x=c+a.w,g.x=h);break;case e.orientation.right:case e.orientation.right_top:C<=T?(y=1,p.y=C+a.h/5,g.y=T+l.h/5):(y=-1,p.y=C-a.h/5,g.y=T+l.h/5),c==h?(y=1,p.x=c+a.w,g.x=h+l.w):c>h?(p.x=c,g.x=h+l.w):(p.x=c+a.w,g.x=h)}var A=I(p,g,y),E=o.template;E||(E="orange");var x=e.clinkTemplates[E];if(o.label){var w=e.clinkLabelPosition(o,p,g,A);r+=x.label.replace("{x}",w.x).replace("{y}",w.y).replace("{val}",o.label)}var S="M"+p.x+","+p.y+"C"+p.x+","+p.y+" "+A.x+","+A.y+" "+g.x+","+g.y;r+=("<g "+e.attr.c_link_from+'="{from}" '+e.attr.c_link_to+'="{to}">').replace("{from}",a.id).replace("{to}",l.id)+x.link.replaceAll("{d}",S)+'<path stroke="transparent" stroke-width="15" fill="none" d="'+S+'" />',r+=e.grCloseTag}}n.content+=r},e.clinkLabelPosition=function(t,n,r,s){var o=(r.x-n.x)/2+n.x,a=(r.y-n.y)/2+n.y;return{x:(o-s.x)/2+s.x,y:(a-s.y)/2+s.y}},e.clinkCurve=function(t){return e.CLINK_CURVE},e.prototype.addClink=function(t,n,r,s){this._putInUndoStack(),this.clearRedo();for(var o=this.config.clinks.length-1;o>=0;o--){var a=this.config.clinks[o];a.from==t&&a.to==n&&this.config.clinks.splice(o,1)}return this.config.clinks.push({from:t,to:n,label:r,template:s}),e.events.publish("updated",[this]),this},e.prototype.removeClink=function(t,n){this._putInUndoStack(),this.clearRedo();for(var r=this.config.clinks.length-1;r>=0;r--){var s=this.config.clinks[r];s.from==t&&s.to==n&&this.config.clinks.splice(r,1)}return e.events.publish("updated",[this]),this},e.clinkTemplates={},e.clinkTemplates.orange={defs:'<marker id="arrowOrange" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#F57C00" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotOrange" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#F57C00" /></marker>',link:'<path marker-start="url(#dotOrange)" marker-end="url(#arrowOrange)" stroke="#F57C00" stroke-width="2" fill="none" d="{d}" />',label:'<text fill="#F57C00" text-anchor="middle" x="{x}" y="{y}">{val}</text>'},e.clinkTemplates.blue={defs:'<marker id="arrowBlue" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#039BE5" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotBlue" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#039BE5" /></marker>',link:'<path marker-start="url(#dotBlue)" marker-end="url(#arrowBlue)" stroke="#039BE5" stroke-width="2" fill="none" d="{d}" />',label:'<text fill="#039BE5"  text-anchor="middle" x="{x}" y="{y}">{val}</text>'},e.clinkTemplates.yellow={defs:'<marker id="arrowYellow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#FFCA28" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotYellow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#FFCA28" /></marker>',link:'<path marker-start="url(#dotYellow)" marker-end="url(#arrowYellow)" stroke="#FFCA28" stroke-width="2" fill="none" d="{d}" />',label:'<text fill="#FFCA28"  text-anchor="middle" x="{x}" y="{y}">{val}</text>'},e===void 0&&(e={}),e.events.on("renderdefs",function(t,n){for(var r=0;r<t.config.slinks.length;r++){var s=t.config.slinks[r].template;s||(s="orange");var o=e.slinkTemplates[s];n.defs+=o.defs}}),e.events.on("render",function(t,n){t._slinks(t,n)}),e.events.on("drag",function(t,n,r,s){if(t instanceof e&&t.config.movable&&s)for(var o=0;o<s.length;o++){for(var a=s[o],l=t.element.querySelectorAll(`[data-s-l-from="${a}"]`),c=t.element.querySelectorAll(`[data-s-l-to="${a}"]`),u=0;u<l.length;u++)l[u].parentNode.removeChild(l[u]);for(u=0;u<c.length;u++)c[u].parentNode.removeChild(c[u])}}),e.prototype._slinks=function(t,n){var r="",s=this.getScale(),o=n.res.boundary;function a(d,p,g){var _=[],v=null,C="left",T=d.lcn?d.lcn:"base",y=t._layoutConfigs[T];switch(y.orientation){case e.orientation.top:case e.orientation.top_left:case e.orientation.bottom:case e.orientation.bottom_left:p.x>d.x&&(C="right");break;case e.orientation.left:case e.orientation.left_top:case e.orientation.right:case e.orientation.right_top:C="top",p.y>d.y&&(C="bottom")}var A=e.t(d.templateName,d.min,s),E=y.levelSeparation;d.parent&&d.parent.layout&&(E=y.mixedHierarchyNodesSeparation);var x={p:d.x+d.w/2+A.expandCollapseSize,q:d.y,r:d.x+d.w/2+A.expandCollapseSize,s:o.minY+E};if(d.sl==p.sl)switch(v=p,y.orientation){case e.orientation.top:case e.orientation.top_left:_.push([x.p,x.q]),_.push([x.p,x.q-E/3]),A=e.t(v.templateName,v.min,s),_.push([v.x+v.w/2+A.expandCollapseSize,_[_.length-1][1]]),_.push([_[_.length-1][0],v.y]);break;case e.orientation.bottom:case e.orientation.bottom_left:x.q=d.y+d.h,x.s=o.maxY-E,_.push([x.p,x.q]),_.push([x.r,d.y+d.h+E/3]),A=e.t(v.templateName,v.min,s),_.push([v.x+v.w/2+A.expandCollapseSize,_[_.length-1][1]]),_.push([_[_.length-1][0],v.y+v.h]);break;case e.orientation.left:case e.orientation.left_top:x.p=d.x,x.q=d.y+d.h/2+A.expandCollapseSize,x.r=o.minX-E,x.s=d.y+d.h/2+A.expandCollapseSize,_.push([x.p,x.q]),_.push([d.x-E/3,x.q]),A=e.t(v.templateName,v.min,s),_.push([_[_.length-1][0],v.y+v.h/2+A.expandCollapseSize]),_.push([v.x,_[_.length-1][1]]);break;case e.orientation.right:case e.orientation.right_top:x.p=d.x+d.w,x.q=d.y+d.h/2+A.expandCollapseSize,x.r=o.maxX+E,x.s=d.y+d.h/2+A.expandCollapseSize,_.push([x.p,x.q]),_.push([d.x+d.w+E/3,x.q]),A=e.t(v.templateName,v.min,s),_.push([_[_.length-1][0],v.y+v.h/2+A.expandCollapseSize]),_.push([v.x+v.w,_[_.length-1][1]])}else{switch(y.orientation){case e.orientation.top:case e.orientation.top_left:_.push([x.p,x.q]),_.push([x.r,d.y-E/3]);break;case e.orientation.bottom:case e.orientation.bottom_left:x.q=d.y+d.h,x.s=o.maxY-E,_.push([x.p,x.q]),_.push([x.r,d.y+d.h+E/3]);break;case e.orientation.left:case e.orientation.left_top:x.p=d.x,x.q=d.y+d.h/2+A.expandCollapseSize,x.r=o.minX-E,x.s=d.y+d.h/2+A.expandCollapseSize,_.push([x.p,x.q]),_.push([d.x-E/3,x.q]);break;case e.orientation.right:case e.orientation.right_top:x.p=d.x+d.w,x.q=d.y+d.h/2+A.expandCollapseSize,x.r=o.maxX+E,x.s=d.y+d.h/2+A.expandCollapseSize,_.push([x.p,x.q]),_.push([d.x+d.w+E/3,x.q])}for(var w=d,S=d;S.parent;)S=S.parent;for(;v==null;){var I=!1,k=w.parent,P=k.leftNeighbor,O=k.rightNeighbor;if(k.id==p.id?v=k:e._intersects(k,x,y)&&(x=e._addPoint(k,_,y,x,C),I=!0),k.id!=p.id){for(;P;){if(P.id==p.id){v=P;break}e._intersects(P,x,y)&&(x=e._addPoint(P,_,y,x,C),I=!0),P=P.leftNeighbor}for(;O;){if(O.id==p.id){v=O;break}e._intersects(O,x,y)&&(x=e._addPoint(O,_,y,x,C),I=!0),O=O.rightNeighbor}}if(!I){var R=_[_.length-1][0],K=0;if(k.parent){E=y.levelSeparation,k.parent.layout&&(E=y.mixedHierarchyNodesSeparation);var ie=t.manager.bordersByRootIdAndLevel[S.id][k.parent.sl];switch(y.orientation){case e.orientation.top:case e.orientation.top_left:K=ie.maxY+E*(2/3);break;case e.orientation.bottom:case e.orientation.bottom_left:K=ie.minY-E*(2/3);break;case e.orientation.left:case e.orientation.left_top:R=ie.maxX+E*(2/3),K=_[_.length-1][1];break;case e.orientation.right:case e.orientation.right_top:R=ie.minX-E*(2/3),K=_[_.length-1][1]}}_.push([R,K])}w=k}switch(A=e.t(v.templateName,v.min,s),_.splice(_.length-1,1),y.orientation){case e.orientation.top:case e.orientation.top_left:_.push([v.x+v.w/2+A.expandCollapseSize,_[_.length-1][1]]),_.push([_[_.length-1][0],v.y+v.h]);break;case e.orientation.bottom:case e.orientation.bottom_left:_.push([v.x+v.w/2+A.expandCollapseSize,_[_.length-1][1]]),_.push([_[_.length-1][0],v.y]);break;case e.orientation.left:case e.orientation.left_top:_.push([_[_.length-1][0],v.y+v.h/2+A.expandCollapseSize]),_.push([v.x+v.w,_[_.length-1][1]]);break;case e.orientation.right:case e.orientation.right_top:_.push([_[_.length-1][0],v.y+v.h/2+A.expandCollapseSize]),_.push([v.x,_[_.length-1][1]])}}var pe=c.template;pe||(pe="orange");var se,Y,Q=null;switch((A=e.slinkTemplates[pe]).labelPosition){case"start":Q={x:_[1][0],y:_[1][1]};break;case"middle":var re=Math.ceil(_.length/2);se=_[re],Y=_[re-1],Q={x:(se[0]+Y[0])/2,y:(se[1]+Y[1])/2};break;case"end":Q={x:_[_.length-2][0],y:_[_.length-2][1]}}g&&(_=_.reverse()),_[0].unshift("M");for(var ve=1;ve<_.length;ve++)_[ve].unshift("L");var ae=e.roundPathCorners(_,e.LINK_ROUNDED_CORNERS,!1);if(c.label){var fe=A.label.replace("{x}",Q.x).replace("{y}",Q.y).replace("{val}",c.label),Me=e._getLabelSize(fe),W=-Me.height/2;switch(y.orientation){case e.orientation.bottom:case e.orientation.bottom_left:W=Me.height}r+=A.label.replace("{x}",Q.x).replace("{y}",Q.y+W).replace("{val}",c.label)}var be=d.id,U=p.id;g&&(be=p.id,U=d.id),r+=("<g "+e.attr.s_link_from+'="{from}" '+e.attr.s_link_to+'="{to}">').replace("{from}",be).replace("{to}",U)+A.link.replaceAll("{d}",ae)+'<path stroke="transparent" stroke-width="15" fill="none" d="'+ae+'" />',r+=e.grCloseTag}for(var l=0;l<this.config.slinks.length;l++){var c=this.config.slinks[l],u=t.getNode(c.from),h=t.getNode(c.to);u&&h&&n.res.visibleNodeIds.indexOf(h.id)!=-1&&n.res.visibleNodeIds.indexOf(u.id)!=-1&&(u.sl>=h.sl?a(u,h,!1):a(h,u,!0))}n.content+=r},e.prototype.addSlink=function(t,n,r,s){this._putInUndoStack(),this.clearRedo();for(var o=this.config.slinks.length-1;o>=0;o--){var a=this.config.slinks[o];a.from==t&&a.to==n&&this.config.slinks.splice(o,1)}return this.config.slinks.push({from:t,to:n,label:r,template:s}),e.events.publish("updated",[this]),this},e.prototype.removeSlink=function(t,n){this._putInUndoStack(),this.clearRedo();for(var r=this.config.slinks.length-1;r>=0;r--){var s=this.config.slinks[r];s.from==t&&s.to==n&&this.config.slinks.splice(r,1)}return e.events.publish("updated",[this]),this},e.slinkTemplates={},e.slinkTemplates.orange={defs:'<marker id="arrowSlinkOrange" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#F57C00" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotSlinkOrange" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#F57C00" /></marker>',link:'<path stroke-dasharray="4, 2" marker-start="url(#dotSlinkOrange)" marker-end="url(#arrowSlinkOrange)" stroke-linejoin="round" stroke="#F57C00" stroke-width="2" fill="none" d="{d}" />',label:'<text dominant-baseline="middle" fill="#F57C00" alignment-baseline="middle" text-anchor="middle" x="{x}" y="{y}">{val}</text>',labelPosition:"middle"},e.slinkTemplates.blue={defs:'<marker id="arrowSlinkBlue" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#039BE5" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotSlinkBlue" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#039BE5" /></marker>',link:'<path stroke-dasharray="4, 2" marker-start="url(#dotSlinkBlue)" marker-end="url(#arrowSlinkBlue)" stroke-linejoin="round" stroke="#039BE5" stroke-width="2" fill="none" d="{d}" />',label:'<text fill="#039BE5" text-anchor="middle" x="{x}" y="{y}">{val}</text>',labelPosition:"middle"},e.slinkTemplates.yellow={defs:'<marker id="arrowSlinkYellow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#FFCA28" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotSlinkYellow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#FFCA28" /></marker>',link:'<path stroke-dasharray="4, 2" marker-start="url(#dotSlinkYellow)" marker-end="url(#arrowSlinkYellow)" stroke-linejoin="round" stroke="#FFCA28" stroke-width="2" fill="none" d="{d}" />',label:'<text  fill="#FFCA28" text-anchor="middle" x="{x}" y="{y}">{val}</text>',labelPosition:"middle"},e.events.on("renderbuttons",function(t,n){if(n.node&&n.node.tags&&n.node.tags.has("group-dotted-lines")){var r=t.getScale(),s=e.t(n.node.templateName,n.node.min,r),o="";n.node.min?(s.nodeGroupDottedOpenButton||console.error(`[${n.node.templateName}].nodeGroupDottedOpenButton is not defined`),o+=`<g style="cursor:pointer;"  data-ctrl-n-dotted-open="${n.node.id}" transform="matrix(1,0,0,1,${n.node.x},${n.node.y})">`,o+=s.nodeGroupDottedOpenButton):(s.nodeGroupDottedCloseButton||console.error(`[${n.node.templateName}].nodeGroupDottedCloseButton is not defined`),o+=`<g style="cursor:pointer;" transform="matrix(1,0,0,1,${n.node.x},${n.node.y})" data-ctrl-n-dotted-close="${n.node.id}">`,o+=s.nodeGroupDottedCloseButton),o=(o+="</g>").replaceAll("{cw}",n.node.w/2).replaceAll("{ch}",n.node.h/2).replaceAll("{ew}",n.node.w-(n.node.padding?n.node.padding[1]:0)).replaceAll("{eh}",n.node.h-(n.node.padding?n.node.padding[2]:0));var a=t.getNode(n.node.stChildrenIds[0]);if(o.indexOf("{collapsed-children-count}")!=-1){var l=e.collapsedChildrenCount(t,a);o=o.replace("{collapsed-children-count}",l)}if(o.indexOf("{collapsed-children-total-count}")!=-1){var c=e.collapsedChildrenTotalCount(t,a);o=o.replace("{collapsed-children-total-count}",c)}if(o.indexOf("{children-count}")!=-1){var u=e.childrenCount(t,a);o=o.replace("{children-count}",u)}if(o.indexOf("{children-total-count}")!=-1){var h=e.childrenTotalCount(t,a);o=o.replace("{children-total-count}",h)}n.html+=o}}),e.events.on("redraw",function(t,n){if(t.config.groupDottedLines.length){for(var r=t.element.querySelectorAll("[data-ctrl-n-dotted-close]"),s=0;s<r.length;s++)r[s].addEventListener("click",function(){var a=this.getAttribute("data-ctrl-n-dotted-close");t.minimize(a)});var o=t.element.querySelectorAll("[data-ctrl-n-dotted-open]");for(s=0;s<o.length;s++)o[s].addEventListener("click",function(){var a=this.getAttribute("data-ctrl-n-dotted-open");t.maximize(a)})}}),e===void 0&&(e={}),e.prototype.undo=function(t){if(this.config.undoRedoStorageName){var n=this.undoStepsCount();if(n!=0){this._putInRedoStack();var r=`${this.config.undoRedoStorageName}_undo_`+(n-1),s=sessionStorage.getItem(r);sessionStorage.removeItem(r);var o=JSON.parse(s);this.config.nodes=o.nodes,this.config.clinks=o.clinks,this.config.slinks=o.slinks,this.config.groupDottedLines=o.groupDottedLines,this.config.dottedLines=o.dottedLines,e.events.publish("updated",[this]),this.filterUI.update(),this.draw(e.action.update,void 0,t),this.undoRedoUI.refresh()}}},e.prototype.redo=function(t){if(this.config.undoRedoStorageName){var n=this.redoStepsCount();if(n!=0){this._putInUndoStack();var r=`${this.config.undoRedoStorageName}_redo_`+(n-1),s=sessionStorage.getItem(r);sessionStorage.removeItem(r);var o=JSON.parse(s);this.config.nodes=o.nodes,this.config.clinks=o.clinks,this.config.slinks=o.slinks,this.config.groupDottedLines=o.groupDottedLines,this.config.dottedLines=o.dottedLines,e.events.publish("updated",[this]),this.filterUI.update(),this.draw(e.action.update,void 0,t),this.undoRedoUI.refresh()}}},e.prototype.clearRedo=function(){if(this.config.undoRedoStorageName){for(var t=`${this.config.undoRedoStorageName}_redo_`,n=Object.keys(sessionStorage),r=0;n.indexOf(t+r)!=-1;)sessionStorage.removeItem(t+r),r++;this.undoRedoUI.refresh()}},e.prototype.clearUndo=function(){if(this.config.undoRedoStorageName){for(var t=`${this.config.undoRedoStorageName}_undo_`,n=Object.keys(sessionStorage),r=0;n.indexOf(t+r)!=-1;)sessionStorage.removeItem(t+r),r++;this.undoRedoUI.refresh()}},e.prototype.undoStepsCount=function(){for(var t=`${this.config.undoRedoStorageName}_undo_`,n=Object.keys(sessionStorage),r=0;n.indexOf(t+r)!=-1;)r++;return r},e.prototype.redoStepsCount=function(){for(var t=`${this.config.undoRedoStorageName}_redo_`,n=Object.keys(sessionStorage),r=0;n.indexOf(t+r)!=-1;)r++;return r},e.prototype._putInUndoStack=function(){if(this.config.undoRedoStorageName){var t=`${this.config.undoRedoStorageName}_undo_`+this.undoStepsCount();sessionStorage.setItem(t,JSON.stringify({nodes:this.config.nodes,clinks:this.config.clinks,slinks:this.config.slinks,groupDottedLines:this.config.groupDottedLines,dottedLines:this.config.dottedLines}))}},e.prototype._putInRedoStack=function(){if(this.config.undoRedoStorageName){var t=`${this.config.undoRedoStorageName}_redo_`+this.redoStepsCount();sessionStorage.setItem(t,JSON.stringify({nodes:this.config.nodes,clinks:this.config.clinks,slinks:this.config.slinks,groupDottedLines:this.config.groupDottedLines,dottedLines:this.config.dottedLines}))}},e===void 0&&(e={}),e.undoRedoUI=function(){this.instance=null,this._event_id=e._guid()},e.undoRedoUI.prototype.init=function(t){t.config.undoRedoStorageName&&(this.instance=t,this.refresh())},e.undoRedoUI.prototype.refresh=function(){var t=this;if(this.instance.config.undoRedoStorageName){var n={undoStepsCount:this.instance.undoStepsCount(),redoStepsCount:this.instance.redoStepsCount()};if(e.events.publish("change",[this,n])!==!1){var r=this.instance.element.querySelector("[data-undo]"),s=this.instance.element.querySelector("[data-redo]");if(!r||!s){var o=document.createElement("div");o.classList.add("bft-undo-redo"),o.innerHTML=`<span data-undo>${e.icon.undo(50,50,"")}<span class="bft-undo-i"></span></span>
                            <span data-redo>${e.icon.redo(50,50,"")}<span class="bft-redo-i"></span></span>`,this.instance.element.appendChild(o),r=this.instance.element.querySelector("[data-undo]"),s=this.instance.element.querySelector("[data-redo]"),r.addEventListener("click",function(){t.instance.undo()}),s.addEventListener("click",function(){t.instance.redo()})}n.undoStepsCount>0?(r.classList.add("bft-ur-clickable"),r.querySelector(".bft-undo-i").innerHTML=n.undoStepsCount,r.querySelector(".bft-undo-i").style.display="inline-block"):(r.classList.remove("bft-ur-clickable"),r.querySelector(".bft-undo-i").style.display="none"),n.redoStepsCount>0?(s.classList.add("bft-ur-clickable"),s.querySelector(".bft-redo-i").innerHTML=n.redoStepsCount,s.querySelector(".bft-redo-i").style.display="inline-block"):(s.classList.remove("bft-ur-clickable"),s.querySelector(".bft-redo-i").style.display="none")}}},e.undoRedoUI.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e.undoRedoUI.prototype.onChange=function(t){return this.on("change",function(n,r){return t.call(n,r)})},e.events.on("redraw",function(t,n){if(t.config.miniMap){if(t.manager.action!=e.action.move){e.miniMap._settings._scale=Math.min(e.miniMap.width/(t.response.boundary.maxX-t.response.boundary.minX),e.miniMap.height/(t.response.boundary.maxY-t.response.boundary.minY)),e.miniMap._settings._translateX=-t.response.boundary.minX*e.miniMap._settings._scale+(e.miniMap.width-(t.response.boundary.maxX-t.response.boundary.minX)*e.miniMap._settings._scale)/2,e.miniMap._settings._translateY=-t.response.boundary.minY*e.miniMap._settings._scale+(e.miniMap.height-(t.response.boundary.maxY-t.response.boundary.minY)*e.miniMap._settings._scale)/2;var r=t.getViewBox();e.miniMap._init(t),e.miniMap._drawMainCanvas(t),e.miniMap._drawRectSelectorCanvas(t,r);var s,o,a,l,c=t.element.querySelector('[data-id="mini-map-focus"]'),u=!1,h=null;c.onmousedown=function(p){var g,_,v,C=c.getBoundingClientRect(),T=C.left,y=C.top;if(s=parseInt(p.clientX-T),o=parseInt(p.clientY-y),g=o,_=(s-e.miniMap._settings._translateX)/e.miniMap._settings._scale,v=(g-e.miniMap._settings._translateY)/e.miniMap._settings._scale,_>r[0]&&_<r[0]+r[2]&&v>r[1]&&v<r[1]+r[3])return p.preventDefault(),p.stopPropagation(),void(u=!0)},c.onmousemove=function(p){if(u){p.preventDefault(),p.stopPropagation(),e.miniMap._mouseMove=!0;var g=c.getBoundingClientRect(),_=g.left,v=g.top;a=parseInt(p.clientX-_),l=parseInt(p.clientY-v);var C=(a-s)/e.miniMap._settings._scale,T=(l-o)/e.miniMap._settings._scale;r[0]=C+r[0],r[1]=T+r[1],t.setViewBox(r),h&&(clearTimeout(h),h=null),h=setTimeout(function(){t._draw(!0,e.action.move)},300),e.miniMap._drawRectSelectorCanvas(t,r),s=a,o=l}},c.onmouseup=function(p){u&&(p.preventDefault(),p.stopPropagation(),u=!1)},c.onmouseout=function(p){u&&(p.preventDefault(),p.stopPropagation(),u=!1,e.miniMap._mouseMove=!1)},c.onclick=function(p){if(p.preventDefault(),p.stopPropagation(),e.miniMap._mouseMove)e.miniMap._mouseMove=!1;else{var g=c.getBoundingClientRect(),_=g.left,v=g.top;a=parseInt(p.clientX-_),l=parseInt(p.clientY-v);var C=a/e.miniMap._settings._scale,T=l/e.miniMap._settings._scale;r[0]=C-(r[0]+r[2]-r[0])/2-e.miniMap._settings._translateX/e.miniMap._settings._scale,r[1]=T-(r[1]+r[3]-r[1])/2-e.miniMap._settings._translateY/e.miniMap._settings._scale,t.setViewBox(r),h&&(clearTimeout(h),h=null),h=setTimeout(function(){t._draw(!0,e.action.move)},300),e.miniMap._drawRectSelectorCanvas(t,r)}}}}else{var d=t.element.querySelector('[data-id="mini-map"]');d&&d.parentNode.removeChild(d)}}),e.miniMap={},e.miniMap._settings={_translateX:0,_translateY:0,_scale:1},e.miniMap._drawMainCanvas=function(t){var n=t.element.querySelector('[data-id="mini-map-main"]'),r=n.getContext("2d");e.miniMap._initCtx(t,n,1);var s=0,o=[];(function a(l,c){if(Array.isArray(c))for(var u=0;u<c.length;u++)a(l,c[u]);else{for(r.fillStyle=e.miniMap.colors[3],r.beginPath(),r.lineWidth="0.5",r.fillRect(c.x,c.y,c.w,c.h),r.strokeRect(c.x,c.y,c.w,c.h),u=0;u<c.stChildrenIds.length;u++)s++,o.includes(c.id)||(s==1?r.fillStyle=e.miniMap.colors[0]:s==2?r.fillStyle=e.miniMap.colors[1]:s==3&&(r.fillStyle=e.miniMap.colors[2]),r.beginPath(),r.fillRect(c.x,c.y,c.w,c.h),r.strokeRect(c.x,c.y,c.w,c.h),o.push(c.id)),a(l,l.getNode(c.stChildrenIds[u])),s--;for(u=0;u<c.childrenIds.length;u++)a(l,l.getNode(c.childrenIds[u]))}})(t,t.roots)},e.miniMap._drawRectSelectorCanvas=function(t,n){var r=t.element.querySelector('[data-id="mini-map-focus"]'),s=r.getContext("2d");e.miniMap._initCtx(t,r,e.miniMap.opacity);var o=n[0],a=n[1],l=n[2],c=n[3];s.lineWidth=.5/e.miniMap._settings._scale,s.strokeStyle=e.miniMap.focusStroke,s.globalAlpha=1,s.clearRect(o,a,l,c),s.strokeRect(o,a,l,c)},e.miniMap._initCtx=function(t,n,r){var s=n.getContext("2d");n.width=n.width,n.height=n.height,s.clearRect(0,0,e.miniMap.width,e.miniMap.height),s.globalAlpha=r,r!=1&&(s.fillStyle=e.miniMap.selectorBackgroundColor,s.fillRect(0,0,e.miniMap.width,e.miniMap.height)),s.translate(e.miniMap._settings._translateX,e.miniMap._settings._translateY),s.scale(e.miniMap._settings._scale,e.miniMap._settings._scale)},e.miniMap._init=function(t){if(!t.element.querySelector('[data-id="mini-map"]')){var n=document.createElement("canvas");n.width=e.miniMap.width,n.height=e.miniMap.height,n.setAttribute("data-id","mini-map-main"),n.style.display="inline-block",n.style.backgroundColor=e.miniMap.backgroundColor,n.style.position="absolute",n.style.top=0,n.style.left=0;var r=document.createElement("canvas");r.width=e.miniMap.width,r.height=e.miniMap.height,r.setAttribute("data-id","mini-map-focus"),r.style.display="inline-block",r.style.position="absolute",r.style.top=0,r.style.left=0;var s=document.createElement("div");s.setAttribute("data-id","mini-map"),s.style.position="absolute";for(var o=["top","right","left","bottom"],a=0;a<o.length;a++){var l=o[a];e.isNEU(e.miniMap.position[l])||(e.miniMap.position[l]=="padding"?s.style[l]=t.config.padding+"px":s.style[l]=e.miniMap.position[l]+"px")}s.style.border=e.miniMap.border,s.style.padding=e.miniMap.padding+"px",s.style.backgroundColor=e.miniMap.backgroundColor;var c=document.createElement("div");c.style.position="relative",c.style.width=e.miniMap.width+"px",c.style.height=e.miniMap.height+"px",c.appendChild(n),c.appendChild(r),s.appendChild(c),t.element.appendChild(s);var u=function(_,v){t.__mouseScrollHandler(s,v)};t._addEvent(s,"DOMMouseScroll",u),t._addEvent(s,"mousewheel",u);var h=0,d=0,p=function(_){e.miniMap._mouseMove=!0;var v=_.clientX-h,C=_.clientY-d;if(!e.isNEU(s.style.left)){var T=parseFloat(s.style.left)+v;s.style.left=`${T}px`}if(!e.isNEU(s.style.right)){var y=parseFloat(s.style.right)-v;s.style.right=`${y}px`}if(!e.isNEU(s.style.bottom)){var A=parseFloat(s.style.bottom)-C;s.style.bottom=`${A}px`}if(!e.isNEU(s.style.top)){var E=parseFloat(s.style.top)+C;s.style.top=`${E}px`}h=_.clientX,d=_.clientY},g=function(){document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)};e.miniMap.draggable&&s.addEventListener("mousedown",function(_){h=_.clientX,d=_.clientY,document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)})}},e.miniMap.colors=["#E0E0E0","#BDBDBD","#9E9E9E","#757575"],e.miniMap.selectorBackgroundColor="white",e.miniMap.backgroundColor="white",e.miniMap.focusStroke="#f57c00",e.miniMap.opacity=.4,e.miniMap.border="1px solid #aeaeae",e.miniMap.width=250,e.miniMap.height=140,e.miniMap.padding=5,e.miniMap.position={top:void 0,left:"padding",right:void 0,bottom:"padding"},e.miniMap.draggable=!0,e._search={},e._search.search=function(t,n,r,s,o,a,l){var c=[],u=n.toLowerCase(),h=u.split(" ");if(l&&h.length>1){var d=h[0];l[d]&&(r=[l[d]],h=(u=u.replace(d,"").trim()).split(" "))}h=h.filter(function(E,x,w){return w.indexOf(E)===x});for(var p={},g=0;g<t.length;g++)for(var _=t[g],v=0;v<r.length;v++){var C=r[v];if(!e.isNEU(_[C])){var T=_[C];if((n=e._search.searchAndComputeScore(h,T,C,a))!=null){var y=_.id;if(p[y]){if(p[y]&&p[y]<n.__score){p[y]=n.__score;for(var A=c.length-1;A>=0;A--)c[A].id==y&&c.splice(A,1);e._search.addNodeToResult(c,s,_,n,C,o)}}else p[y]=n.__score,e._search.addNodeToResult(c,s,_,n,C,o)}}}return c.sort(function(E,x){return E.__score<x.__score?1:E.__score>x.__score?-1:0}),c},e._search.addNodeToResult=function(t,n,r,s,o,a){var l={};l.id=r.id,e.isNEU(r[a])||(l[a]=r[a]);for(var c=0;c<n.length;c++){var u=n[c];e.isNEU(r[u])||e.isNEU(l[u])&&(l[u]=r[u])}s!=null&&(e.isNEU(l.__score)&&(l.__score=s.__score),e.isNEU(l.__searchField)&&(l.__searchField=o),e.isNEU(l.__searchMarks)&&(l.__searchMarks=s.__searchMarks)),t.push(l)},e._search.searchAndComputeScore=function(t,n,r,s){if(e.isNEU(n)||e.isNEU(t)||!t.length)return null;typeof n!="string"&&(n=n.toString());var o=n.toLowerCase(),a=e._search.searchIndexesOf(o,t);if(!a.length)return null;for(var l=o.length/100,c=0,u=0,h=c>0?100:0,d=0,p=0;p<t.length;p++)for(var g=t[p],_=0;_<a.length;_++)if(g.indexOf(a[_].searchPhrase)!=-1){d++;break}var v=100/(t.length/d);if(a.length){for(u=a[0].start,_=0;_<a.length;_++)if(c+=a[_].length,a[_].start<u&&(u=a[_].start),_>=1&&a[_-1].start>a[_].start){h=0;break}}var C=0;c!=0&&(C=c/l);var T=c>0?100:0;u!=0&&(T=100-u/l);var y=0;s&&s[r]&&(y=s[r]),v&&(v=v/100*50),C>0&&(C=C/100*10),T>0&&(T=T/100*10),h>0&&(h=h/100*10),y>0&&(y=y/100*20);var A=Math.round(1e4*(v+C+T+h+y));for(a.sort(function(x,w){return x.start<w.start?-1:x.start>w.start?1:0}),_=a.length-1;_>=0;_--)for(p=0;p<a.length;p++)p<_&&a[p].start+a[p].length>a[_].start&&a.splice(_,1);var E=n;for(_=a.length-1;_>=0;_--)E=(E=E.insert(a[_].start+a[_].length,"</mark>")).insert(a[_].start,"<mark>");return{__searchMarks:E,__score:A}},e._search.searchIndexesOf=function(t,n){var r=[];if(!e.isNEU(t))for(var s=0;s<n.length;s++){var o=n[s];if(!e.isNEU(o))for(var a=0;(a=t.indexOf(o,a))>-1;)r.push({length:o.length,start:a,searchPhrase:o}),a+=o.length}return r.sort(function(l,c){return l.length<c.length?1:l.length>c.length||l.start<c.start?-1:l.start>c.start?1:0}),r=r.filter(function(l){for(var c=!1,u=0;u<r.length;u++){var h=r[u].start,d=r[u].start+r[u].length-1,p=l.start,g=l.start+l.length-1;if(h==p&&d==g){c=!1;break}if(h>=p&&d<=g){c=!0;break}if(h<=p&&d>=g){c=!0;break}}return!c})},e.events.on("redraw",function(t,n){if(t.config.state){var r=[],s=[];(function o(a){if(Array.isArray(a))for(var l=0;l<a.length;l++)o(a[l]);else{for((typeof a.id!="string"||typeof a.id=="string"&&a.id.indexOf("split")==-1&&a.id.indexOf("mirror")==-1)&&(r.push(a.id),a.min==1&&s.push(a.id)),l=0;l<a.stChildren.length;l++)o(a.stChildren[l]);for(l=0;l<a.children.length;l++)o(a.children[l])}})(t.roots),e.state._put(t.config.roots,t.width(),t.height(),t.response.viewBox,r,s,t.response.adjustify,t.config.state)}}),e.state={},e.state._buildStateNames=function(t){return{paramScale:t+"-scale",paramX:t+"-x",paramY:t+"-y",paramExp:t+"-exp",paramMin:t+"-min",paramRoots:t+"-roots",paramAdjustify:t+"-adjustify"}},e.state._put=function(t,n,r,s,o,a,l,c){if(c&&!e.isNEU(o)&&o.length!=0){var u=e.state._buildStateNames(c.name),h={roots:t,scale:Math.min(n/s[2],r/s[3]),x:s[0],y:s[1],exp:o,min:a,adjustify:l};if(c.writeToUrlParams){var d=new URLSearchParams(window.location.search);d.has(u.paramScale)?d.set(u.paramScale,h.scale):d.append(u.paramScale,h.scale),d.has(u.paramX)?d.set(u.paramX,h.x):d.append(u.paramX,h.x),d.has(u.paramY)?d.set(u.paramY,h.y):d.append(u.paramY,h.y),d.has(u.paramExp)?d.set(u.paramExp,h.exp.join("*")):d.append(u.paramExp,h.exp.join("*")),d.has(u.paramRoots)&&Array.isArray(h.roots)?d.set(u.paramRoots,h.roots.join("*")):Array.isArray(h.roots)&&d.append(u.paramRoots,h.roots.join("*")),d.has(u.paramMin)?d.set(u.paramMin,h.min.join("*")):d.append(u.paramMin,h.min.join("*")),d.has(u.paramAdjustify)?d.set(u.paramAdjustify,h.adjustify.x+"*"+h.adjustify.y):d.append(u.paramAdjustify,h.adjustify.x+"*"+h.adjustify.y),window.history.replaceState(null,null,"?"+d)}c.writeToIndexedDB&&(h.id=c.name,e.idb.put(h,function(p){p==0&&console.error("Cannot write row - "+c.name)})),c.writeToLocalStorage&&e.localStorage.setItem(c.name,JSON.stringify(h))}},e.state._get=function(t,n,r,s){if(t){var o=e.state._buildStateNames(t.name);if(t.readFromUrlParams){var a=new URLSearchParams(window.location.search);if(a.has(o.paramScale)&&a.has(o.paramX)&&a.has(o.paramY)&&a.has(o.paramExp)&&a.has(o.paramMin)&&a.has(o.paramAdjustify)){var l={},c=parseFloat(a.get(o.paramScale)),u=parseFloat(a.get(o.paramX)),h=parseFloat(a.get(o.paramY));(p=[])[0]=u,p[1]=h,p[2]=n/c,p[3]=r/c,l.vb=p,l.scale=c,l.x=u,l.y=h,l.roots=null,a.has(o.paramRoots)&&(l.roots=a.get(o.paramRoots).split("*")),l.exp=a.get(o.paramExp).split("*"),l.min=a.get(o.paramMin).split("*");var d=a.get(o.paramAdjustify).split("*");return l.adjustify={x:parseFloat(d[0]),y:parseFloat(d[1])},void s(l)}if(!t.readFromIndexedDB&&!t.readFromLocalStorage)return void s(null)}if(t.readFromLocalStorage){var p;if((l=e.localStorage.getItem(t.name))!=null)return l=JSON.parse(l),(p=[])[0]=l.x,p[1]=l.y,p[2]=n/l.scale,p[3]=r/l.scale,l.vb=p,void s(l);if(!t.readFromIndexedDB)return void s(null)}t.readFromIndexedDB&&e.idb.read(t.name,function(g,_){if(g==0)console.error("Cannot read from - "+t.name),s(null);else if(g==null)s(null);else{var v=[];v[0]=_.x,v[1]=_.y,v[2]=n/_.scale,v[3]=r/_.scale,_.vb=v,s(_)}})}else s(null)},e.state.clear=function(t){if(!t)return!1;try{localStorage.removeItem(t);var n=e.state._buildStateNames(t),r=new URLSearchParams(window.location.search);r.has(n.paramScale)&&r.delete(n.paramScale),r.has(n.paramX)&&r.delete(n.paramX),r.has(n.paramY)&&r.delete(n.paramY),r.has(n.paramExp)&&r.delete(n.paramExp),r.has(n.paramRoots)&&r.delete(n.paramRoots),r.has(n.paramMin)&&r.delete(n.paramMin),r.has(n.paramAdjustify)&&r.delete(n.paramAdjustify),window.history.replaceState(null,null,"?"+r),e.idb.delete(t,function(s){s==0&&console.error("Cannot delete row - "+t)})}catch{}},e._magnify={},e.prototype.magnify=function(t,n,r,s,o){s||(s=this.config.anim);var a=this.getNode(t),l=this.getNodeElement(t);if(a||l){var c=e._magnify[t];c&&(c.timer!=null&&clearInterval(c.timer),c.timerBack!=null&&clearInterval(c.timerBack),l.setAttribute("transform","matrix("+c.transformStart.toString()+")"),e._magnify[t]=null),r&&(l=l.cloneNode(!0),this.getSvg().appendChild(l));var u=e._getTransform(l),h=JSON.parse(JSON.stringify(u));h[0]=n,h[3]=n;var d=a.w+a.w*(n-1),p=a.h+a.h*(n-1);h[4]+=(a.w-d)/2,h[5]+=(a.h-p)/2;var g=e.animate(l,{transform:u},{transform:h},s.duration,s.func);e._magnify[t]={timer:g,transformStart:u,nodeElement:l,front:r},o&&o(l)}},e.prototype.magnifyBack=function(t,n,r){n||(n=this.config.anim);var s=e._magnify[t];if(s){s.timer!=null&&clearInterval(s.timer),s.timerBack!=null&&clearInterval(s.timerBack);var o=e._getTransform(s.nodeElement);s.timerBack=e.animate(s.nodeElement,{transform:o},{transform:s.transformStart},n.duration,n.func,function(a){var l=a[0].getAttribute(e.attr.node_id);e._magnify[l]&&e._magnify[l].front&&(a[0].parentNode.removeChild(a[0]),e._magnify[l]=null),r&&r(a[0])})}},e===void 0&&(e={}),e.events.on("init",function(t,n){if(t.config.keyNavigation&&(t._addEvent(window,"keydown",t._windowKeyDownHandler),e.isNEU(t._keyNavigationActiveNodeId)&&t.roots&&t.roots.length)){var r=t.roots[0].id;e.isNEU(t.config.keyNavigation.focusId)||(r=t.config.keyNavigation.focusId),t._keyNavigationActiveNodeId=r,t.center(t._keyNavigationActiveNodeId)}}),e.prototype._windowKeyDownHandler=function(t,n){for(var r=n.target,s=null;r&&r!=this.element;){if(r.hasAttribute&&r.hasAttribute(e.attr.node_id)){s=r.getAttribute(e.attr.node_id);break}r=r.parentNode}if(r){var o=s?this.getNode(s):null,a={node:o,data:s?this.get(s):null,event:n};if(e.events.publish("key-down",[this,a])!==!1&&o){if(n.code=="KeyF")this.searchUI.find("");else if(n.code=="ArrowRight"||o.isAssistant&&n.code=="ArrowDown"||o.isPartner&&n.code=="ArrowDown"){if(u=this.getNode(o.pid)){var l=u.childrenIds.indexOf(o.id);if(++l<u.childrenIds.length){var c=u.childrenIds[l];this._keyNavigationActiveNodeId=c,this.center(c)}}}else if(n.code=="ArrowLeft")(u=this.getNode(o.pid))&&(l=u.childrenIds.indexOf(o.id),--l>=0&&(c=u.childrenIds[l],this._keyNavigationActiveNodeId=c,this.center(c)));else if(n.code=="ArrowUp"){var u;(u=this.getNode(o.pid))&&(c=u.id,(o.isAssistant||u.hasAssistants||o.isPartner||u.hasPartners)&&(l=u.childrenIds.indexOf(o.id),--l>=0&&(c=u.childrenIds[l])),this._keyNavigationActiveNodeId=c,this.center(c))}else if(n.code=="ArrowDown")o.childrenIds.length&&(this._keyNavigationActiveNodeId=o.childrenIds[0],this.center(o.childrenIds[0]));else if(n.code=="Space"){var h=r.getAttribute(e.attr.node_id);return void this.toggleExpandCollapse(h,n)}}}},e.events.on("redraw",function(t,n){t.config.keyNavigation&&e._keyNavigation(t)}),e.events.on("click",function(t,n){t.config&&t.config.keyNavigation&&(t._keyNavigationActiveNodeId=n.node.id,t.center(n.node.id))}),e._keyNavigation=function(t){var n=t.element.querySelector(":focus");if(n&&n.parentElement&&n.parentElement.hasAttribute(e.attr.node_id)){var r=n.parentElement;(o=(s=n).querySelector("title"))&&o.parentNode.removeChild(o),s.removeAttribute("tabindex")}if(!e.isNEU(t._keyNavigationActiveNodeId)&&(r=t.getNodeElement(t._keyNavigationActiveNodeId))&&r.children.length){var s;(s=r.children[0]).setAttribute("tabindex",2);var o,a={text:"",id:t._keyNavigationActiveNodeId};e.events.publish("screen-reader-text",[t,a]),!e.isNEU(a.text)&&((o=document.createElementNS("http://www.w3.org/2000/svg","title")).innerHTML=a.text,s.appendChild(o)),e.SEARCH_CLOSE_RESULT_ON_ESCAPE_OR_CLICKOUTSIDE&&t.searchUI.hide(),s.focus()}},e.elements={},e.elements.textbox=function(t,n,r,s){var o=e.elements._vidrf(t,n,s);if(o.doNotRender)return{html:""};var a="";return n.btn&&(a=`<a href="#" data-input-btn="" class="bft-link bft-link-bft-button">${n.btn}</a>`),{html:`<div class="bft-form-field" style="min-width: ${r};">
                    <div class="bft-input" data-bft-input="" ${o.disabledAttribute} ${o.vlidators}>
                        <label for="${o.id}">${e._escapeGreaterLessSign(o.label)}</label>
                        <input ${o.readOnlyAttribute} data-binding="${e._escapeDoubleQuotes(o.binding)}" maxlength="256" id="${o.id}" name="${o.id}" type="text" value="${e._escapeDoubleQuotes(o.value)}" autocomplete="off">
                        ${a}
                    </div>
                </div>`,id:o.id,value:o.value}},e.elements.checkbox=function(t,n,r,s){var o=e.elements._vidrf(t,n,s);if(o.doNotRender)return{html:""};var a=o.value?"checked":"",l=s?'onclick="return false;"':"";return{html:`<div class="bft-form-field"  style="min-width: ${r};" >
                        <label class="bft-checkbox" data-bft-input="" ${o.disabledAttribute}>
                            <input ${a} ${l} data-binding="${e._escapeDoubleQuotes(o.binding)}" type="checkbox"><span class="bft-checkbox-checkmark" type="checkbox"></span>${e._escapeGreaterLessSign(o.label)}
                        </label>
                    </div>`,id:o.id,value:a}},e.elements.select=function(t,n,r,s){if(s)return e.elements.textbox(t,n,r,s);var o=e.elements._vidrf(t,n,s);return o.doNotRender?{html:""}:{html:`<div class="bft-form-field" style="min-width: ${r};">
                    <div class="bft-input" data-bft-input="" ${o.disabledAttribute} ${o.vlidators}>
                        <label for="${o.id}">${e._escapeGreaterLessSign(o.label)}</label>
                        <select data-binding="${e._escapeDoubleQuotes(o.binding)}" ${o.readOnlyAttribute} id="${o.id}" name="${o.id}">
                            ${function(){for(var a="",l=0;l<o.options.length;l++){var c=o.options[l];a+=`<option ${c.value==o.value?"selected":""} value="${e._escapeDoubleQuotes(c.value)}">${e._escapeGreaterLessSign(c.text)}</option>`}return a}()}                           
                        </select>
                    </div>
                </div>`,id:o.id,value:o.value}},e.elements.multiSelect=function(t,n,r,s){if(s)return e.elements.textbox(t,n,r,s);var o=e.elements._vidrf(t,n,s);return o.doNotRender?{html:""}:{html:`<div class="bft-form-field" style="min-width: ${r};">
                    <div class="bft-input" data-bft-input="" ${o.disabledAttribute} ${o.vlidators}>
                        <label for="${o.id}">${e._escapeGreaterLessSign(o.label)}</label>
                        <select class="multiple" data-binding="${e._escapeDoubleQuotes(o.binding)}" ${o.readOnlyAttribute} id="${o.id}" name="${o.id}" multiple>
                            ${function(){for(var a="",l=0;l<o.options.length;l++){var c=o.options[l];a+=`<option ${o.value.includes(c.value)?"selected":""} value="${e._escapeDoubleQuotes(c.value)}">${e._escapeGreaterLessSign(c.text)}</option>`}return a}()}                           
                        </select>
                    </div>
                </div>`,id:o.id,value:o.value}},e.elements.date=function(t,n,r,s){var o=e.elements._vidrf(t,n,s);return o.doNotRender?{html:""}:{html:`<div class="bft-form-field" style="min-width: ${r};">
                    <div class="bft-input" data-bft-input="" ${o.disabledAttribute} ${o.vlidators}>
                        <label for="${o.id}" class="hasval">${e._escapeGreaterLessSign(o.label)}</label>
                        <input data-binding="${e._escapeDoubleQuotes(o.binding)}" ${o.readOnlyAttribute} maxlength="256" id="${o.id}" name="${o.id}" type="date" value="${e._escapeDoubleQuotes(o.value)}" autocomplete="off">
                    </div>
                </div>`,id:o.id,value:o.value}},e.elements._vidrf=function(t,n,r){var s={};if(n.binding||(n.binding=""),n.label||(n.label=""),n.type!="select"||Array.isArray(n.options)?s.options=n.options:s.options=[],s.value=t&&!e.isNEU(t[n.binding])?t[n.binding]:"",r&&s.options){for(var o=0;o<s.options.length;o++)if(s.options[o].value==s.value){s.value=s.options[o].text;break}}if(s.id=e.elements.generateId(),s.disabledAttribute=r?"data-bft-input-disabled":"",s.readOnlyAttribute=r?"readonly":"",s.id=s.id,r&&e.isNEU(s.value)&&(s.doNotRender=!0),r&&n.binding=="photo"&&(s.id=null,s.doNotRender=!0),s.binding=n.binding,s.label=n.label,s.vlidators="",n.vlidators)for(var a in n.vlidators)s.vlidators+=`data-v-${a}="${n.vlidators[a]}" `;return s},e.elements.ids=[],e.elements.generateId=function(){for(;;){var t="_"+("0000"+(Math.random()*Math.pow(36,4)|0).toString(36)).slice(-4);if(!e.elements.ids.has(t))return e.elements.ids.push(t),t}},e.input={},e.input._timeout=null,e.input.initWithTimeout=function(){e.input._timeout&&(clearTimeout(e.input._timeout),e.input._timeout=null),e.input._timeout=setTimeout(e.input.init,200)},e.input.init=function(t){var n;n=t?t.querySelectorAll("[data-bft-input]"):document.querySelectorAll("[data-bft-input]");for(var r=0;r<n.length;r++){var s=n[r],o=null;s.type&&s.type.toLowerCase()=="hidden"&&(o=s),o||(o=s.querySelector("input")),o||(o=s.querySelector("select"));var a=s.querySelector("label");a&&(o.value||o.type=="select-one"&&o.selectedOptions&&o.selectedOptions.length&&o.selectedOptions[0].value==""&&o.selectedOptions[0].innerHTML)&&a.classList.add("hasval"),o.type.toLowerCase()!="checkbox"&&o.addEventListener("focus",function(){this.classList.remove("bft-validation-error");var l=this.parentNode.querySelector("label");l.classList.add("focused");var c=l.querySelector(".bft-validation-error-message");c&&c.parentNode.removeChild(c)}),o.type.toLowerCase()!="checkbox"&&o.addEventListener("blur",function(){e.input.blurHandler(this)})}},e.input.blurHandler=function(t){var n=t.parentNode.querySelector("label");n.classList.remove("focused"),t.value||t.type=="date"?n.classList.add("hasval"):n.classList.remove("hasval")},e.input.validate=function(t){var n=null;t.type&&t.type.toLowerCase()=="hidden"&&(n=t),n||(n=t.querySelector("input")),n||(n=t.querySelector("select"));var r=t.querySelector("label");if(n.classList.remove("bft-validation-error"),r){var s=r.querySelector(".bft-validation-error-message");s&&s.parentNode.removeChild(s)}!n.selectedOptions&&n.value&&(n.value=n.value.trim());var o=t.getAttribute("data-v-required"),a=t.getAttribute("data-v-password"),l=t.getAttribute("data-v-email"),c=t.getAttribute("data-v-emails");return o&&n.value==""?(r.innerHTML+='<span class="bft-validation-error-message">&nbsp;'+o+"</span>",n.classList.add("bft-validation-error"),!1):a&&!e.input.validatePassword(n.value)?(r.innerHTML+='<span class="bft-validation-error-message">&nbsp;'+a+"</span>",n.classList.add("bft-validation-error"),!1):l&&!e.input.isValidEmail(n.value)?(r.innerHTML+='<span class="bft-validation-error-message">&nbsp;'+l+"</span>",n.classList.add("bft-validation-error"),!1):!(c&&!e.input.isValidEmails(n.value))||(r.innerHTML+='<span class="bft-validation-error-message">&nbsp;'+c+"</span>",n.classList.add("bft-validation-error"),!1)},e.input.validateAndGetData=function(t){for(var n=t.querySelectorAll("[data-bft-input]"),r=!0,s=0;s<n.length;s++){var o=n[s];e.input.validate(o)||(r=!1)}if(!r)return!1;var a=t.querySelectorAll("[data-binding]"),l={};for(s=0;s<a.length;s++){var c=a[s],u=c.getAttribute("data-binding");if(c.type.toLowerCase()=="checkbox")l[u]=c.checked;else if(c.selectedOptions&&c.hasAttribute("multiple")){var h=c.selectedOptions;l[u]=Array.from(h).map(({value:d})=>d)}else l[u]=c.value}return l},e.input.validatePassword=function(t){return t&&(t=t.trim()),!(t.length<5)&&!(t.length>18)&&t.indexOf(" ")==-1},e.input.isValidEmails=function(t){if(t)for(var n=t.split(","),r=0;r<n.length;r++){var s=n[r].trim();if(!e.input.isValidEmail(s))return!1}return!0},e.input.isValidEmail=function(t){return t&&(t=t.trim()),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase())},e.prototype.hideTreeMenu=function(t,n){if(this._tree_menu_temp){var r=this._tree_menu_temp;if(this.manager.oldNodes=this.nodes,this.nodes=r.nodes,this.manager.maxX=r.maxX,this.manager.maxY=r.maxY,this.manager.minX=r.minX,this.manager.minY=r.minY,this.manager.roots=r.roots,this.manager.nodes=r.nodes,this.manager.rootList=r.rootList,this.manager.visibleNodeIds=r.visibleNodeIds,this.manager.bordersByRootIdAndLevel=r.bordersByRootIdAndLevel,this.config.roots=r.config.roots,this.config.nodes=r.config.nodes,this._tree_menu_temp=null,t){var s={id:r.id,animFromClickedNode:!1};this._draw(!0,e.action.update,s,function(){n&&n()})}}},e.prototype.showTreeMenu=function(t){this.editUI.hide(),t==null&&console.error("Call addNode without id");var n=this.getNode(t);n||console.error("Cannot get node id: "+t);var r=this.getNode(n.fid),s=this.getNode(n.mid),o=null,a=null,l=[],c=[];r&&(o=this.get(r.id)),s&&(a=this.get(s.id));for(var u=0;u<n.pids.length;u++){var h=this.get(n.pids[u]);h&&l.push(h)}for(u=0;u<n.ftChildrenIds.length;u++)c.push(this.get(n.ftChildrenIds[u]));var d=this.get(t);this._tree_menu_temp={maxX:this.manager.maxX,maxY:this.manager.maxY,minX:this.manager.minX,minY:this.manager.minY,roots:this.manager.roots,nodes:this.manager.nodes,rootList:this.manager.rootList,visibleNodeIds:this.manager.visibleNodeIds,bordersByRootIdAndLevel:this.manager.bordersByRootIdAndLevel,id:t,config:{roots:this.config.roots,nodes:this.config.nodes}},this.config.nodes=[];var p=[];if(a)p.push(a);else{var g={id:"_ft_mother",templateName:"mother",_ft_method:"addParentNode",_ft_childId:t,_ft_type:"mid",_ft_data:{gender:"female"}};d.mid=g.id,o?(o.pids=[g.id],g.pids=[o.id],g._ft_data.pids=[o.id]):g.pids=["_ft_father"],p.push(g)}if(o)p.push(o);else{var _={id:"_ft_father",templateName:"father",_ft_method:"addParentNode",_ft_childId:t,_ft_type:"fid",_ft_data:{gender:"male"}};d.fid=_.id,a?(a.pids=[_.id],_.pids=[a.id],_._ft_data.pids=[a.id]):_.pids=["_ft_mother"],p.push(_)}for(u=0;u<l.length;u++)p.push(l[u]);d.pids||(d.pids=[]);var v={id:"_ft_partner",pids:[t],templateName:"partner",_ft_method:"addPartnerNode",_ft_data:{pids:[t]}};if(d.gender=="male"?(v.templateName="wife",v._ft_data.gender="female"):d.gender=="female"&&(v.templateName="husband",v._ft_data.gender="male"),d.pids.push(v.id),p.push(v),d.pids)for(u=0;u<d.pids.length;u++){if(p.push({id:"_ft_child_group_"+u,mid:t,fid:d.pids[u],tags:["children-group"]}),d.pids[u]=="_ft_partner"){var C={id:"_ft_son_"+u,stpid:"_ft_child_group_"+u,templateName:"son",_ft_method:"addChildAndPartnerNodes",_ft_childData:{mid:n.id,fid:v.id,gender:"male"},_ft_partnerData:{pids:[t]},_ft_id:t},T={id:"_ft_daughter_"+u,stpid:"_ft_child_group_"+u,templateName:"daughter",_ft_method:"addChildAndPartnerNodes",_ft_childData:{mid:n.id,fid:v.id,gender:"female"},_ft_partnerData:{pids:[t]},_ft_id:t};d.gender=="male"&&v._ft_data.gender=="female"?(C._ft_childData.mid=v.id,C._ft_childData.fid=d.id,C._ft_partnerData.gender=v._ft_data.gender,T._ft_childData.mid=v.id,T._ft_childData.fid=d.id,T._ft_partnerData.gender=v._ft_data.gender):d.gender=="female"&&v._ft_data.gender=="male"&&(C._ft_childData.mid=d.id,C._ft_childData.fid=v.id,C._ft_partnerData.gender=v._ft_data.gender,T._ft_childData.mid=d.id,T._ft_childData.fid=v.id,T._ft_partnerData.gender=v._ft_data.gender),p.push(C),p.push(T)}else p.push({id:"_ft_son_"+u,stpid:"_ft_child_group_"+u,templateName:"son",_ft_method:"addChildNode",_ft_data:{mid:t,fid:d.pids[u],gender:"male"}}),p.push({id:"_ft_daughter_"+u,stpid:"_ft_child_group_"+u,templateName:"daughter",_ft_method:"addChildNode",_ft_data:{mid:t,fid:d.pids[u],gender:"female"}});for(var y=0;y<c.length;y++)c[y].mid!=d.pids[u]&&c[y].fid!=d.pids[u]||(c[y].mid=void 0,c[y].fid=void 0,c[y].stpid="_ft_child_group_"+u,p.push(c[y]))}var A=[];for(y=0;y<c.length;y++)(c[y].fid==d.id&&e.isNEU(c[y].mid)||c[y].mid==d.id&&e.isNEU(c[y].fid))&&(c[y].fid==d.id?c[y].mid="_ft_partner_for_single_child":c[y].mid==d.id&&(c[y].fid="_ft_partner_for_single_child"),p.push(c[y]),A.push(c[y].id));if(A.length){var E={id:"_ft_partner_for_single_child",pids:[t],templateName:"partner",_ft_method:"addPartnerAndParentNodes",_ft_childIds:A,_ft_partnerData:{pids:[t]},_ft_id:t};d.gender=="male"?(E.templateName="wife",E._ft_partnerData.gender="female"):d.gender=="female"&&(E.templateName="husband",E._ft_partnerData.gender="male"),d.pids.push(E.id),p.push(E)}var x={nodes:p,node:d};e.events.publish("node-tree-menu-show",[this,x]),x.nodes.push(x.node),this.config.nodes=x.nodes,d=this.get(t);var w=this;e.isNEU(d.mid)?e.isNEU(d.fid)||(this.config.roots=[d.fid]):this.config.roots=[d.mid];var S={id:t,treeMenuMode:!0};this._draw(!1,e.action.update,S,function(){e._moveToBoundaryArea(w.getSvg(),w.getViewBox(),w.response.boundary)})},e.ui.css=function(){return'<style data-bft-styles>.bft-button{background-color:#039be5;cursor:pointer;width:calc(100%);height:50px;color:#fff;padding-top:5px;padding-left:7px;padding-right:7px;text-align:center;text-transform:uppercase;border:1px solid #3fc0ff;display:inline-block;border-radius:5px}.bft-button.orange{background-color:#f57c00;border:1px solid #ffa03e}.bft-button.yellow{background-color:#ffca28;border:1px solid #ffdf7c}.bft-button.lower{text-transform:unset}.bft-button.transparent{background-color:transparent}.bft-button:hover{background-color:#35afea}.bft-button.orange:hover{background-color:#f79632}.bft-button.yellow:hover{background-color:#ffd452}.bft-button:active{transform:matrix(.98,0,0,.98,0,0)}.bft-button-icon{text-align:initial;cursor:pointer;margin-bottom:15px;color:#039be5}.bft-dark .bft-button-icon:hover{background-color:#2d2d2d}.bft-light .bft-button-icon:hover{background-color:#ececec}.bft-button-icon>img{height:24px;width:24px;vertical-align:middle;padding:7px}.bft-button:focus{outline:0}.bft-button-icon>img{filter:invert(46%) sepia(66%) saturate(2530%) hue-rotate(171deg) brightness(95%) contrast(98%)}.bft-light .bft-button.transparent{color:#039be5}.bft-light .bft-button.transparent:hover{color:#fff}.bft-button-loading{background-color:transparent;cursor:pointer;width:calc(100% - 2px);height:50px;color:#fff;text-align:center;text-transform:uppercase;border:1px solid #027cb7;display:inline-block;display:flex;justify-content:center;align-items:center;display:none}.bft-button-loading .bft-loading-dots div{margin:0 10px}.bft-link-bft-button{position:absolute;right:10px;top:-1px}@media screen and (max-width:1000px){.bft-link-bft-button{right:50px}}[data-bft-input-disabled] .bft-link-bft-button{display:none}[dir=rtl] .bft-link-bft-button{left:10px;right:unset}.bft-img-button{width:48px;height:48px;cursor:pointer;border-radius:50%;background-color:#039be5;background-repeat:no-repeat;background-size:24px 24px;background-position:center center;margin:3px;display:inline-block}.bft-img-button:hover{background-color:#f57c00}.bft-checkbox{display:block;position:relative;padding-left:35px;margin-bottom:12px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}.bft-checkbox input{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.bft-checkbox-checkmark{position:absolute;top:0;left:0;height:25px;width:25px;border-radius:5px}.bft-dark [data-bft-input-disabled] .bft-checkbox-checkmark,.bft-dark [data-bft-input-disabled].bft-checkbox input:checked~.bft-checkbox-checkmark,.bft-light [data-bft-input-disabled] .bft-checkbox-checkmark,.bft-light [data-bft-input-disabled].bft-checkbox input:checked~.bft-checkbox-checkmark{background-color:#aeaeae!important}[data-bft-input-disabled].bft-checkbox{cursor:default}[dir=rtl] .bft-checkbox-checkmark{right:0}[dir=rtl] .bft-checkbox{padding-left:unset;padding-right:35px}.bft-dark .bft-checkbox-checkmark{background-color:#333;border:1px solid #5b5b5b}.bft-light .bft-checkbox-checkmark{background-color:#fff;border:1px solid #c7c7c7}.bft-dark .bft-checkbox:hover input~.bft-checkbox-checkmark{background-color:#3c3c3c}.bft-light .bft-checkbox:hover input~.bft-checkbox-checkmark{background-color:#f8f9f9}.bft-dark .bft-checkbox input:checked~.bft-checkbox-checkmark{background-color:#039be5}.bft-light .bft-checkbox input:checked~.bft-checkbox-checkmark{background-color:#039be5}.bft-checkbox-checkmark:after{content:"";position:absolute;display:none}.bft-checkbox input:checked~.bft-checkbox-checkmark:after{display:block}.bft-checkbox .bft-checkbox-checkmark:after{left:9px;top:5px;width:5px;height:10px;border:solid #fff;border-width:0 3px 3px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.bft-filter{user-select:none}.bft-light .bft-filter{color:#757575}.bft-dark .bft-filter{color:#ccc}.bft-filter>div>div{display:inline-block;padding:3px 10px;cursor:pointer}.bft-filter-menu fieldset,.bft-filter>div,.filter-field-selected{border-radius:5px}.bft-filter-menu fieldset{overflow-y:auto;max-height:300px}.bft-filter>div.bft-filter-menu{padding:10px}.bft-light .bft-filter>div.bft-filter-menu,.bft-light .filter-field-selected{background-color:#f8f9f9}.bft-dark .bft-filter>div.bft-filter-menu,.bft-dark .filter-field-selected{background-color:#3c3c3c}.bft-light .bft-filter>div{background-color:#eee}.bft-dark .bft-filter>div{background-color:#333}.bft-form-perspective{transform-style:preserve-3d;perspective:500px;position:absolute;top:32px}.bft-form{box-shadow:rgba(0,0,0,.2) 0 6px 6px 0,rgba(0,0,0,.19) 0 13px 20px 0;padding:14px;transform-origin:top center;user-select:none;display:none;position:relative;max-height:calc(100vh - 100px);overflow-y:auto;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.bft-form-bottom{border-bottom-left-radius:unset;border-bottom-right-radius:unset;border-top-left-radius:5px;border-top-right-radius:5px}.bft-form .separator{margin:0 10px}@media screen and (max-width:1000px){.bft-form-perspective{min-width:100%;max-height:calc(100% - 32px);left:unset!important;right:unset!important;transform:none!important}.bft-form .set{max-height:calc(100vh - 74px)}.bft-form-fieldset{max-width:unset!important}}.bft-light .bft-form .separator{border-bottom:1px solid #c7c7c7}.bft-dark .bft-form .separator{border-bottom:1px solid #5b5b5b}.bft-light .bft-form{background-color:#fff}.bft-dark .bft-form{background-color:#252526}.bft-item{padding:6px 12px 6px 12px;display:flex;flex-direction:row}.bft-light .bft-form .bft-item.selected,.bft-light .bft-form .bft-item:hover{background-color:#0074e8;color:#fff}.bft-dark .bft-form .bft-item.selected,.bft-dark .bft-form .bft-item:hover{background-color:#094771;color:#fff}.bft-item.selected img,.bft-item:hover img{filter:invert(100%)}.bft-item.selected img{visibility:visible!important}.bft-form-fieldset{display:flex;flex-wrap:wrap;margin:0!important}.bft-form-field{flex:1 0 21%;margin:3px;min-width:200px}.bft-form-field-100{flex:1 0 96%;margin:3px;min-width:200px}.bft-input{position:relative}.bft-input>input,.bft-input>select{height:50px;padding:18px 10px 2px 9px;width:100%;box-sizing:border-box;border-style:solid;border-width:1px}.bft-input select{height:50px;padding:20px 5px 4px 5px}[data-bft-input-disabled].bft-input>input,[data-bft-input-disabled].bft-input>select{border-color:transparent!important}.bft-light [data-bft-input-disabled]>input,.bft-light [data-bft-input-disabled]>select{background-color:#fff!important}.bft-dark [data-bft-input-disabled]>input,.bft-dark [data-bft-input-disabled]>select{background-color:#252526!important}[data-bft-input-disabled]>select{appearance:none;padding-left:8px}.bft-input>label{display:inline-block;position:absolute;padding-left:10px;padding-right:10px;color:#acacac;cursor:text;-webkit-transition:all .1s ease-out;-moz-transition:all .1s ease-out;-ms-transition:all .1s ease-out;-o-transition:all .1s ease-out;transition:all .1 ease-out;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:initial;text-align:initial;white-space:nowrap}.bft-input>label{top:12px;overflow:hidden;text-overflow:ellipsis;max-width:calc(100% - 14px)}.bft-input>label.focused,.bft-input>label.hasval{top:-1px}.bft-input>input,.bft-input>select{outline:0;border-radius:5px}.bft-dark .bft-input>label.focused,.bft-light .bft-input>label.focused{color:#039be5}.bft-dark .bft-input>input,.bft-dark .bft-input>select{color:#ccc;background-color:#333;border-color:#5b5b5b}.bft-light .bft-input>input,.bft-light .bft-input>select{color:#757575;background-color:#fff;border-color:#c7c7c7}.bft-light .bft-input>input:focus,.bft-light .bft-input>select:focus{border-color:#039be5;background-color:#f8f9f9}.bft-dark .bft-input>input:focus,.bft-dark .bft-input>select:focus{border-color:#039be5;background-color:#3c3c3c}.bft-dark .bft-input>input.bft-validation-error,.bft-dark .bft-input>select.bft-validation-error,.bft-light .bft-input>input.bft-validation-error,.bft-light .bft-input>select.bft-validation-error{border-color:#ca2a2a}.bft-dark .bft-validation-error-message,.bft-light .bft-validation-error-message{color:#ca2a2a}.bft-input select.multiple{height:initial}.bft-link{color:#039be5;cursor:pointer;text-decoration:underline}.bft-link:hover{color:#f57c00}.bft-dark ::-webkit-scrollbar,.bft-light ::-webkit-scrollbar{width:15px;height:15px}.bft-dark ::-webkit-scrollbar-corner{background:#1e1e1e}.bft-dark ::-webkit-scrollbar-track{background:#1e1e1e;border-left:1px solid #333;border-top:1px solid #333}.bft-dark ::-webkit-scrollbar-thumb{background:#424242}.bft-dark ::-webkit-scrollbar-thumb:hover{background:#4f4f4f}.bft-dark ::-webkit-scrollbar-thumb:active{background:#5e5e5e}.bft-light ::-webkit-scrollbar-corner{background:#fff}.bft-light ::-webkit-scrollbar-track{background:#fff;border-left:1px solid #ddd;border-top:1px solid #ddd}.bft-light ::-webkit-scrollbar-thumb{background:#c1c1c1}.bft-light ::-webkit-scrollbar-thumb:hover{background:#929292}.bft-light ::-webkit-scrollbar-thumb:active{background:#666}.bft-edit-form{position:fixed;top:0;right:0;height:100%;width:100%;box-shadow:rgba(0,0,0,.2) 0 6px 6px 0,rgba(0,0,0,.19) 0 13px 20px 0;display:flex;flex-direction:column;height:100%;width:400px}@media screen and (max-width:1000px){.bft-edit-form{width:100%}}.bft-dark .bft-edit-form{background-color:#252526}.bft-light .bft-edit-form{background-color:#fff}.bft-edit-form-header{height:200px;text-align:center;border-radius:10px}.export-service .bft-edit-form-header{border-radius:unset}.bft-edit-form-title{color:#fff;margin:0;padding:14px 17px 7px 17px}.bft-edit-form-avatar{border-radius:50%;width:150px;height:150px;position:absolute;top:75px;border:5px solid #fff;left:50%;transform:translateX(-50%);background-color:#cacaca;box-shadow:rgba(0,0,0,.2) 0 6px 6px 0,rgba(0,0,0,.19) 0 13px 20px 0}.bft-edit-form-close{position:absolute;right:14px;top:14px;width:34px;height:34px;cursor:pointer}.bft-edit-form-fields{flex-grow:1;overflow-y:auto;overflow-x:hidden}.bft-edit-form-fields-inner{margin:0 7px 20px 7px}.bft-family-menu{opacity:0;display:inline-block;position:absolute;text-align:left;user-select:none;min-width:270px;box-shadow:rgba(0,0,0,.2) 0 4px 8px 0,rgba(0,0,0,.19) 0 6px 20px 0;font:13px/28px Helvetica,"Segoe UI",Arial,sans-serif;border-radius:10px}.bft-family-menu>div:hover img{filter:invert(100%)}.bft-family-menu [data-item]{text-align:start;padding:7px 10px}.bft-dark .bft-family-menu [data-item]{background-color:#252526;color:#acacac;border-bottom:1px solid #333}.bft-dark .bft-family-menu [data-item]:hover{background-color:#094771!important;color:#fff!important}.bft-dark .bft-family-menu [data-item]:hover svg{filter:brightness(0) invert(1)}.bft-light .bft-family-menu [data-item]{background-color:#fff;color:#333;border-bottom:1px solid #c7c7c7}.bft-light .bft-family-menu [data-item]:hover{background-color:#0074e8!important;color:#fff!important}.bft-light .bft-family-menu [data-item]:hover svg{filter:brightness(0) invert(1)}.bft-family-menu [data-item] svg{vertical-align:middle}.bft-family-menu [data-item]:first-child{border-top-left-radius:7px;border-top-right-radius:7px}.bft-family-menu [data-item]:last-child{border-bottom-width:0;border-bottom-style:none;border-bottom-left-radius:7px;border-bottom-right-radius:7px}.bft-search{position:absolute}@media screen and (max-width:500px){.bft-search{width:calc(100% - 30px);left:15px}}.bft-search .bft-input{margin-bottom:0}.bft-search-input{color:#7a7a7a;width:100%;border:none;outline:0;padding-top:10px;padding-right:47px}.bft-search-image-td{width:43px}.bft-search-text-td{padding-inline-end:7px;line-height:15px;text-align:start}.bft-search table{box-shadow:rgba(0,0,0,.2) 0 4px 8px 0,rgba(0,0,0,.19) 0 6px 20px 0;margin:0 3.5px 0 3.5px;width:calc(100% - 7px);border-radius:7px}.bft-search table tr:first-child td:first-child{border-top-left-radius:7px}.bft-search table tr:first-child td:last-child{border-top-right-radius:7px}[dir=rtl] .bft-search table tr:first-child td:first-child{border-top-left-radius:unset;border-top-right-radius:7px}[dir=rtl] .bft-search table tr:first-child td:last-child{border-top-right-radius:unset;border-top-left-radius:7px}.bft-search table tr:last-child td:first-child{border-bottom-left-radius:7px}.bft-search table tr:last-child td:last-child{border-bottom-right-radius:7px}[dir=rtl] .bft-search table tr:last-child td:first-child{border-bottom-left-radius:unset;border-bottom-right-radius:7px}[dir=rtl] .bft-search table tr:last-child td:last-child{border-bottom-right-radius:unset;border-bottom-left-radius:7px}.bft-dark .bft-search table{background-color:#252526;color:#acacac}.bft-search [data-search-item-id]{cursor:pointer}.bft-search-photo{margin:7px 7px 0 7px;width:32px;height:32px;background-size:cover;background-position:top center;border-radius:50%;display:inline-block;border:1px solid #8c8c8c}.bft-search [data-search-item-id]:hover .bft-link{color:#ffca28}.bft-search [data-search-item-id]:hover .bft-link:hover{color:#f57c00}.bft-dark .bft-search [data-search-item-id] td{border-top:1px solid #333}.bft-dark .bft-search [data-search-item-id]:hover,.bft-dark .bft-search [data-selected=yes]{background-color:#094771;color:#fff}.bft-light .bft-search table{background-color:#fff;color:#333}.bft-light .bft-search [data-search-item-id] td{border-top:1px solid #c7c7c7}.bft-light .bft-search [data-search-item-id]:hover,.bft-light .bft-search [data-selected=yes]{background-color:#0074e8;color:#fff}.bft-search [data-search-item-id]:first-child td{border-top:unset}.bft-ripple-container{position:absolute;top:0;right:0;bottom:0;left:0}.bft-drag-over rect{opacity:.5}.bft-ripple-container span{transform:scale(0);border-radius:100%;position:absolute;opacity:.75;background-color:#fff;animation:bft-ripple 1s}@-moz-keyframes bft-ripple{to{opacity:0;transform:scale(2)}}@-webkit-keyframes bft-ripple{to{opacity:0;transform:scale(2)}}@-o-keyframes bft-ripple{to{opacity:0;transform:scale(2)}}@keyframes bft-ripple{to{opacity:0;transform:scale(2)}}.bft-slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;-webkit-transition:.4s;transition:.4s}.bft-slider:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:#fff;-webkit-transition:.4s;transition:.4s}.bft-slider.round{border-radius:24px}.bft-slider.round:before{border-radius:50%}svg text:hover{cursor:default}svg.bft-cursor-grab,svg.bft-cursor-grab text:hover{cursor:grab}svg.bft-cursor-nodrop,svg.bft-cursor-nodrop text:hover{cursor:no-drop}svg.bft-cursor-copy,svg.bft-cursor-copy text:hover{cursor:copy}svg.bft-cursor-move,svg.bft-cursor-move text:hover{cursor:move}#bft-close-btn:focus,#bft-close-btn:hover{color:#000;text-decoration:none;cursor:pointer}#bft-id-select:focus{outline:.5px solid #aeaeae}#bft-sampleDialog #title:hover{cursor:default;background:gray}.bft-light{background-color:#fff;font:13px/28px Helvetica,"Segoe UI",Arial,sans-serif}.bft-dark{background-color:#1e1e1e;font:13px/28px Helvetica,"Segoe UI",Arial,sans-serif}.bft-light .bft-fill{fill:#fff}.bft-dark .bft-fill{fill:#1e1e1e}.bft-dark input,.bft-dark select,.bft-light input,.bft-light select{font:16px Helvetica,"Segoe UI",Arial,sans-serif}.bft-dark h1,.bft-light h1{font-size:30px;line-height:1}.bft-edit-form{position:absolute;border-radius:10px}.export-service .bft-edit-form{border-radius:unset}.bft-dark .bft-edit-form{color:#acacac}.bft-light .bft-edit-form{color:#333}.bft-dark ::-webkit-calendar-picker-indicator{filter:invert(70%)}.bft-light ::-webkit-calendar-picker-indicator{filter:invert(50%)}.bft-edit-form-instruments{margin:42px 10px 0 10px;text-align:center;min-height:70px}.bft-img-button svg{position:relative;top:12px}.bft-light .bft-toolbar-container svg circle,.bft-light .bft-toolbar-container svg line,.bft-light .bft-toolbar-container svg path{stroke:#8c8c8c!important}.bft-dark .bft-toolbar-container svg circle,.bft-dark .bft-toolbar-container svg line,.bft-dark .bft-toolbar-container svg path{stroke:#8c8c8c!important}.bft-dark .bft-toolbar-container svg rect{fill:#252526!important}.bft-dark .bft-toolbar-container [data-tlbr=minus] svg{border-left:1px solid #5b5b5b!important;border-right:1px solid #5b5b5b!important;border-bottom:1px solid #5b5b5b!important}.bft-dark .bft-toolbar-container [data-tlbr=plus] svg{border-left:1px solid #5b5b5b!important;border-right:1px solid #5b5b5b!important;border-top:1px solid #5b5b5b!important}.bft-dark .bft-toolbar-container [data-tlbr]>svg{border:1px solid #5b5b5b!important;background-color:#252526!important}.bft-toolbar-layout{height:123px;padding-top:20px;position:absolute;width:100%;left:"0";bottom:"-145px"}.bft-light .bft-toolbar-layout{border-top:1px solid #c7c7c7;background-color:#f9f9f9}.bft-dark .bft-toolbar-layout{border-top:1px solid #5b5b5b;background-color:#2b2b2b}.bft-dotted-connector path{stroke-dasharray:7}.bft-undo-redo{position:absolute;top:23px;left:23px}@media screen and (max-width:500px){.bft-undo-redo{position:absolute;top:83px;left:23px}}.bft-light .bft-undo-redo path{fill:#cacaca}.bft-dark .bft-undo-redo path{fill:#5b5b5b}.bft-light .bft-undo-redo .bft-ur-clickable path{fill:#9c9c9c}.bft-dark .bft-undo-redo .bft-ur-clickable path{fill:#8c8c8c}.bft-undo-redo .bft-ur-clickable rect{cursor:pointer}.bft-undo-redo>span{position:relative;display:inline-block;user-select:none}.bft-undo-redo .bft-undo-i{left:-6px;top:-6px}.bft-undo-redo .bft-redo-i{right:-6px;bottom:6px}.bft-undo-redo>span>span{color:#fff;position:absolute;display:inline-block;min-width:20px;min-height:20px;border-radius:50%;line-height:20px;text-align:center;padding:1px;user-select:none;cursor:pointer}.bft-light .bft-undo-redo>span>span{background-color:#9c9c9c}.bft-dark .bft-undo-redo>span>span{background-color:#8c8c8c}</style>'},e.events.on("render",function(t,n){if(t.recentRoots||(t.recentRoots=[]),t.config.roots)for(var r=0;r<t.config.roots.length;r++){var s=t.recentRoots.indexOf(t.config.roots[r]);s!=-1&&t.recentRoots.splice(s,1),t.recentRoots.unshift(t.config.roots[r])}}),e.events.on("show",function(t,n){if(t instanceof e.editUI&&t.obj._tree_menu_temp)return!1}),e.events.on("render-link",function(t,n){n.cnode.ppid!=null&&n.cnode.layout!=e.mixed&&(n.html+='<use xlink:href="#dot" x="'+n.p.xa+'" y="'+n.p.ya+'"/>')}),e.events.on("click",function(t,n){if(t instanceof e){var r=t._get(n.node.id);if(r._ft_method)return r._ft_method=="addParentNode"?t[r._ft_method](r._ft_childId,r._ft_type,r._ft_data,null,!0):r._ft_method=="addChildAndPartnerNodes"?t[r._ft_method](r._ft_id,r._ft_childData,r._ft_partnerData,null,!0):r._ft_method=="addPartnerAndParentNodes"?t[r._ft_method](r._ft_id,r._ft_childIds,r._ft_partnerData,null,!0):t[r._ft_method](r._ft_data,null,!0),!1;for(var s=n.event.target;s;){if(s.getAttribute&&(s.hasAttribute("data-ctrl-n-t-menu-id")||s.hasAttribute("data-ctrl-n-t-menu-c"))){var o=s.getAttribute("data-ctrl-n-t-menu-id");return e.isNEU(o)?t.hideTreeMenu(!0):t.showTreeMenu(o),n.event.stopPropagation(),n.event.preventDefault(),!1}s=s.parentNode}}}),e===void 0&&(e={}),e.prototype.onField=function(t){return this.on("field",function(n,r){return t.call(n,r)})},e.prototype.onInit=function(t){return this.on("init",function(n){return t.call(n)})},e.prototype.onRedraw=function(t){return this.on("redraw",function(n){return t.call(n)})},e.prototype.onUpdateNode=function(t){return this.on("update",function(n,r,s){var o={oldData:r,newData:s};return t.call(n,o)})},e.prototype.onUpdated=function(t){return this.on("updated",function(n){return t.call(n)})},e.prototype.onRemoveNode=function(t){return this.on("remove",function(n,r,s){var o={id:r,newPidsAndStpidsForIds:s};return t.call(n,o)})},e.prototype.onAddNode=function(t){return this.on("add",function(n,r){var s={data:r};return t.call(n,s)})},e.prototype.onDrop=function(t){return this.on("drop",function(n,r,s,o,a){var l={dragId:r,dropId:s,dragNodeElement:o,event:a};return t.call(n,l)})},e.prototype.onDrag=function(t){return this.on("drag",function(n,r,s,o){var a={dragId:r,event:s,nodeIds:o};return t.call(n,a)})},e.prototype.onExpandCollpaseButtonClick=function(t){return this.on("expcollclick",function(n,r,s,o){var a={collapsing:r,id:s,ids:o};return t.call(n,a)})},e.prototype.onExportStart=function(t){return this.on("exportstart",function(n,r){return t.call(n,r)})},e.prototype.onExportEnd=function(t){return this.on("exportend",function(n,r){return t.call(n,r)})},e.prototype.onNodeClick=function(t){return this.on("click",function(n,r){return t.call(n,r)})},e.prototype.onNodeDoubleClick=function(t){return this.on("dbclick",function(n,r){var s={data:r};return t.call(n,s)})},e.prototype.onUpdateNode=function(t){return this.on("update",function(n,r){return t.call(n,r)})},e.prototype.onNodeTreeMenuShow=function(t){return this.on("node-tree-menu-show",function(n,r){return t.call(n,r)})},e.prototype.onRemoveNode=null,e.prototype.onAddNode=null,e.filterUI=function(){},e.filterUI.prototype.init=function(t){this.instance=t,this.element=null,this.filterBy=null,this._event_id=e._guid()},e.filterUI.prototype.addFilterTag=function(t){if(!this.instance.config.filterBy||e.isNEU(t))return!1;if(this.filterBy!==null||typeof this.instance.config.filterBy!="object"||Array.isArray(this.instance.config.filterBy)||(this.filterBy=JSON.parse(JSON.stringify(this.instance.config.filterBy))),this.filterBy!=null)for(var n in this.filterBy){var r=t[n];if(r!=null){var s=this.filterBy[n];if(s!=null){var o=s[r];if(o!=null&&o.checked===!1)return!0}}}return!1},e.filterUI.prototype.show=function(t){var n=this.element.querySelector('[data-filter-field="'+t+'"]');n&&n.click()},e.filterUI.prototype.hide=function(){var t=this.instance.element.querySelector("[data-filter-close]");t&&t.click()},e.filterUI.prototype.update=function(){if(this.instance.config.filterBy){var t={};if(this.instance.config.filterBy=="all")for(var n=e.manager.getAllFields(this.instance.config),r=0;r<n.length;r++){var s=n[r];s!="tags"&&s!="id"&&s!="pid"&&s!="ppid"&&s!="stpid"&&(t[s]={})}else if(Array.isArray(this.instance.config.filterBy))for(r=0;r<this.instance.config.filterBy.length;r++)t[this.instance.config.filterBy[r]]={};else if(typeof this.instance.config.filterBy=="object")for(var o in this.instance.config.filterBy)t[o]={};for(var a in t){var l=t[a];for(r=0;r<this.instance.config.nodes.length;r++){var c=this.instance.config.nodes[r][a];c!=null&&(l[c]||(l[c]={checked:!0,text:c}))}}if(this.filterBy!=null){for(var u in t)if(this.filterBy[u])for(var h in t[u])this.filterBy[u][h]&&(t[u][h]=this.filterBy[u][h])}if(e.FILTER_ALPHABETICALLY){var d=Object.keys(t).sort(),p=t;for(t={},r=0;r<d.length;r++)t[g=d[r]]=p[g];for(var a in t)for(l=t[a],t[a]={},d=Object.keys(l).sort(),r=0;r<d.length;r++){var g=d[r];t[a][g]=l[g]}}this.filterBy=t;var _=this;this.element=this.instance.element.querySelector("[data-filter]"),this.element&&this.element.parentNode.removeChild(this.element),this.element=document.createElement("div"),this.element.setAttribute("data-filter",""),this.element.style.position="absolute",this.element.setAttribute("class","bft-filter"),this.instance.config.undoRedoStorageName?(this.element.style.top=0,this.element.style.left="50%",this.element.style.transform="translate(-50%)"):(this.element.style.top=this.instance.config.padding+"px",this.element.style.left=this.instance.config.padding+"px");var v="";for(var u in this.filterBy){var C={name:u,html:`<div data-filter-field="${u}">${u}</div>`};e.events.publish("add-filter",[_,C]),v+=C.html}this.element.innerHTML=`<div>${v}</div>`,this.element.addEventListener("click",function(T){if(T.target.hasAttribute("data-filter-close")||T.target.hasAttribute("data-filter-field")){for(var y=T.target.getAttribute("data-filter-field"),A=_.instance.element.querySelectorAll("[data-filter-menu]"),E=0;E<A.length;E++)A[E].style.display="none";var x=_.instance.element.querySelectorAll(".filter-field-selected");for(E=0;E<x.length;E++)x[E].classList.remove("filter-field-selected");var w=_.instance.element.querySelector("[data-filter-close]");if(w&&w.parentNode.removeChild(w),T.target.hasAttribute("data-filter-close")||!T.target.hasAttribute("data-filter-field"))return;var S=_.instance.element.querySelector(`[data-filter-menu="${y}"]`);if(!S){var I={name:y,text:e.filterUI.all,value:y,checked:!0,html:`<div>
                        <input data-all type="checkbox" id="${y}" name="${y}" checked>
                        <label for="${y}">${e.filterUI.all}</label>
                    </div>`};e.events.publish("add-item",[_,I]);var k=I.html;for(var P in _.filterBy[y]){var O=_.filterBy[y][P],R=O.text;R==null&&(R=P),I={name:y,text:R,value:P,checked:O.checked,html:`<div>
                            <input  type="checkbox" id="${y}_${P}" name="${P}" ${O.checked?"checked":""}>
                            <label for="${y}_${P}">${R}</label>
                        </div>`},e.events.publish("add-item",[_,I]),k+=I.html}S=document.createElement("div");var K=e.filterUI.textFilterBy;S.innerHTML=`<fieldset>
                                                    <legend>${K} ${y}:</legend>
                                                    ${k}
                                                </fieldset>`,S.setAttribute("data-filter-menu",y),S.classList.add("bft-filter-menu"),T.target.parentNode.parentNode.appendChild(S);var ie=S.querySelectorAll("input");for(E=0;E<ie.length;E++)ie[E].addEventListener("change",function(pe){for(var se=pe.target;se&&!se.hasAttribute("data-filter-menu");)se=se.parentNode;if(se){var Y=se.getAttribute("data-filter-menu");if(pe.target.hasAttribute("data-all")){for(var Q=pe.target.parentNode.parentNode.querySelectorAll("input"),re=0;re<Q.length;re++)if(Q[re]!=pe.target)for(var ve in Q[re].checked=pe.target.checked,_.filterBy[Y])_.filterBy[Y][ve].checked=pe.target.checked}else if(_.filterBy[Y][this.name]!=null&&(_.filterBy[Y][this.name].checked=this.checked),this.checked){for(var ae=_.instance.config.nodes,fe=0;fe<ae.length;fe++)if(ae[fe][Y]==this.name){for(var Me=ae[fe];Me;)if(e.isNEU(Me.stpid))Me=e.isNEU(Me.pid)?null:_.instance._get(Me.pid);else if((Me=_.instance._get(Me.stpid))[Y]){var W=pe.target.parentNode.parentNode.querySelector('[name="'+Me[Y]+'"]');W?(W.checked=this.checked,_.filterBy[Y][Me[Y]].checked=this.checked):console.error('Cannot find element with selector: [name="'+Me[Y]+'"]')}}}_.instance.draw()}})}S.style.display="block",T.target.classList.add("filter-field-selected"),(w=document.createElement("div")).classList.add("close"),w.innerHTML="x",w.setAttribute("data-filter-close",""),T.target.parentNode.appendChild(w),e.events.publish("show-items",[_,{name:y}])}}),this.instance.element.appendChild(this.element),e.events.publish("update",[this,{}])}},e.filterUI.prototype.on=function(t,n){return e.events.on(t,n,this._event_id),this},e.filterUI.textFilterBy="Filter by",e.filterUI.all="[All]",e===void 0&&(e={}),e.remote===void 0&&(e.remote={}),e.LIMIT_NODES=!0,e.remote._fromResDTO=function(t,n,r,s,o){var a=n[t.id];t.x=a.p[0],t.y=a.p[1],t.w=a.p[2],t.h=a.p[3],a.ln!=null&&(t.leftNeighbor=o[a.ln]),a.rn!=null&&(t.rightNeighbor=o[a.rn]);for(var l=0;l<t.stChildren.length;l++)e.remote._fromResDTO(t.stChildren[l],n,r,s,o);for(l=0;l<t.children.length;l++)e.remote._fromResDTO(t.children[l],n,r,s,o)},e.remote._toReqDTO=function(t,n){var r={p:[t.id,t.parent!=null?t.parent.id:null,t.stParent!=null?t.stParent.id:null,t.w,t.h]};t.children.length>0&&(r.c=e.remote._convertToIdArray(t.children)),t.stChildren.length>0&&(r.v=e.remote._convertToIdArray(t.stChildren)),t.layout!=null&&t.layout!=0&&(r.l=t.layout),t.isAssistant&&(r.a=1),t.isSplit&&(r.s=t.isSplit),t.isMirror&&(r.im=t.isMirror),t.padding&&(r.q=t.padding),t.lcn&&(r.k=t.lcn),t.stContainerNodes&&(r.b=e.remote._convertToIdArray(t.stContainerNodes)),t.isPartner&&(r.i=t.isPartner),t.hasPartners&&(r.g=t.hasPartners),t.partnerSeparation&&(r.e=t.partnerSeparation),n.push(r);for(var s=0;s<t.stChildren.length;s++)e.remote._toReqDTO(t.stChildren[s],n);for(s=0;s<t.children.length;s++)e.remote._toReqDTO(t.children[s],n)},e.remote._toReqLayoutConfigsDTO=function(t){var n={};for(var r in t){var s=t[r];n[r]||(n[r]=[]),n[r][0]=s.orientation,n[r][1]=s.levelSeparation,n[r][2]=s.mixedHierarchyNodesSeparation,n[r][3]=s.subtreeSeparation,n[r][4]=s.siblingSeparation,n[r][5]=s.layout,n[r][6]=s.columns,n[r][7]=s.collapse,n[r][8]=s.assistantSeparation,n[r][9]=s.partnerNodeSeparation}return n},e.remote._convertToIdArray=function(t){for(var n=[],r=0;r<t.length;r++)n.push(t[r].id);return n},e.remote._setPositions=function(t,n,r,s){for(var o=[],a=[],l=e.remote._toReqLayoutConfigsDTO(n),c=0;c<t.length;c++)a.push(t[c].id),e.remote._toReqDTO(t[c],o);var u={n:o,c:l,r:a,v:"8.14.00"};if(e.LIMIT_NODES||(u.l=!0),e.remote._fromReqDTO!=null)e.remote._fromReqDTO(u.n,u.r,u.c,function(d){for(var p=0;p<t.length;p++)e.remote._fromResDTO(t[p],d,0,t,s);r()});else{u=JSON.stringify(u);var h=e.localStorage.getItem(u);h&&(h=JSON.parse(h)),h&&!h.limit?e.remote._proceed(t,h,s,r):e.remote._findRegion(function(d){e._ajax(d,"post",u,"json",function(p){p.error?r(2):(e.remote._proceed(t,p,s,r),e.localStorage.setItem(u,JSON.stringify(p)))})})}},e.remote._proceed=function(t,n,r,s){if(typeof n=="string"&&(n=JSON.parse(n)),n.limit&&n.limit==1)s(n.limit);else{for(var o=0;o<t.length;o++)e.remote._fromResDTO(t[o],n,0,t,r);s()}},e.remote._findRegion=function(t){var n=e.localStorage.getItem(e.FUNC_URL_NAME);if(n)t(n);else{for(var r=["defunc2","cusfunc2","bsfunc2","acfunc2","kcfunc2","safunc2","wifunc2"],s=[],o=0;o<r.length;o++)s.push(new XMLHttpRequest);for(o=0;o<r.length;o++)(function(){var a="https://"+r[o]+e.SERVER_PREFIX,l=s[o];l.onreadystatechange=function(){if(this.readyState==4&&this.status==200){e.localStorage.setItem(e.FUNC_URL_NAME,a),t(a);for(var c=0;c<s.length;c++)s[c].abort()}},l.open("GET",a,!0),l.send()})()}}}(Ec)),Ec.exports}var g5=p5();const ke=f5(g5),m5=()=>{};var np={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe=function(i,e){if(!i)throw ts(e)},ts=function(i){return new Error("Firebase Database ("+zm.SDK_VERSION+") INTERNAL ASSERT FAILED: "+i)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},_5=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const r=i[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const s=i[t++];e[n++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=i[t++],o=i[t++],a=i[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=i[t++],o=i[t++];e[n++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},xl={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<i.length;r+=3){const s=i[r],o=r+1<i.length,a=o?i[r+1]:0,l=r+2<i.length,c=l?i[r+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let d=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(d=64)),n.push(t[u],t[h],t[d],t[p])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(Hm(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):_5(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<i.length;){const s=t[i.charAt(r++)],a=r<i.length?t[i.charAt(r)]:0;++r;const c=r<i.length?t[i.charAt(r)]:64;++r;const h=r<i.length?t[i.charAt(r)]:64;if(++r,s==null||a==null||c==null||h==null)throw new y5;const d=s<<2|a>>4;if(n.push(d),c!==64){const p=a<<4&240|c>>2;if(n.push(p),h!==64){const g=c<<6&192|h;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class y5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jm=function(i){const e=Hm(i);return xl.encodeByteArray(e,!0)},Ma=function(i){return jm(i).replace(/\./g,"")},Oa=function(i){try{return xl.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v5(i){return qm(void 0,i)}function qm(i,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:i===void 0&&(i={});break;case Array:i=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!b5(t)||(i[t]=qm(i[t],e[t]));return i}function b5(i){return i!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5=()=>w5().__FIREBASE_DEFAULTS__,x5=()=>{if(typeof process>"u"||typeof np>"u")return;const i=np.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},I5=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&Oa(i[1]);return e&&JSON.parse(e)},Il=()=>{try{return m5()||E5()||x5()||I5()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},S5=i=>{var e,t;return(t=(e=Il())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[i]},A5=i=>{const e=S5(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Wm=()=>{var i;return(i=Il())===null||i===void 0?void 0:i.config},C5=i=>{var e;return(e=Il())===null||e===void 0?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T5(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=i.iat||0,s=i.sub||i.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},i);return[Ma(JSON.stringify(t)),Ma(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(En())}function k5(){var i;const e=(i=Il())===null||i===void 0?void 0:i.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function R5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function N5(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function Gm(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function P5(){return zm.NODE_ADMIN===!0}function L5(){return!k5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Km(){try{return typeof indexedDB=="object"}catch{return!1}}function M5(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O5="FirebaseError";class oi extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=O5,Object.setPrototypeOf(this,oi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ns.prototype.create)}}class ns{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?D5(s,n):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new oi(r,a,n)}}function D5(i,e){return i.replace(U5,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const U5=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ho(i){return JSON.parse(i)}function St(i){return JSON.stringify(i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym=function(i){let e={},t={},n={},r="";try{const s=i.split(".");e=ho(Oa(s[0])||""),t=ho(Oa(s[1])||""),r=s[2],n=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:n,signature:r}},V5=function(i){const e=Ym(i),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},F5=function(i){const e=Ym(i).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function Hr(i,e){if(Object.prototype.hasOwnProperty.call(i,e))return i[e]}function ip(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function Da(i,e,t){const n={};for(const r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=e.call(t,i[r],r,i));return n}function Ua(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const s=i[r],o=e[r];if(rp(s)&&rp(o)){if(!Ua(s,o))return!1}else if(s!==o)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function rp(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eh(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)n[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)n[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){const d=n[h-3]^n[h-8]^n[h-14]^n[h-16];n[h]=(d<<1|d>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let h=0;h<80;h++){h<40?h<20?(c=a^s&(o^a),u=1518500249):(c=s^o^a,u=1859775393):h<60?(c=s&o|a&(s|o),u=2400959708):(c=s^o^a,u=3395469782);const d=(r<<5|r>>>27)+c+l+u+n[h]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=d}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const n=t-this.blockSize;let r=0;const s=this.buf_;let o=this.inbuf_;for(;r<t;){if(o===0)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<t;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[n]=this.chain_[r]>>s&255,++n;return e}}function $5(i,e){const t=new z5(i,e);return t.subscribe.bind(t)}class z5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");H5(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:n},r.next===void 0&&(r.next=xc),r.error===void 0&&(r.error=xc),r.complete===void 0&&(r.complete=xc);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function H5(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function xc(){}function j5(i,e){return`${i} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q5=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);if(r>=55296&&r<=56319){const s=r-55296;n++,oe(n<i.length,"Surrogate pair missing trail surrogate.");const o=i.charCodeAt(n)-56320;r=65536+(s<<10)+o}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Sl=function(i){let e=0;for(let t=0;t<i.length;t++){const n=i.charCodeAt(t);n<128?e++:n<2048?e+=2:n>=55296&&n<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(i){return i&&i._delegate?i._delegate:i}class xn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new uo;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(K5(e))try{this.getOrInitializeService({instanceIdentifier:Wi})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});n.resolve(s)}catch{}}}}clearInstance(e=Wi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wi){return this.instances.has(e)}getOptions(e=Wi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);n===a&&o.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(r))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:G5(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Wi){return this.component?this.component.multipleInstances?e:Wi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function G5(i){return i===Wi?void 0:i}function K5(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new W5(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Ne||(Ne={}));const X5={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},Q5=Ne.INFO,J5={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},Z5=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),r=J5[e];if(r)console[r](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ao{constructor(e){this.name=e,this._logLevel=Q5,this._logHandler=Z5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?X5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}const eb=(i,e)=>e.some(t=>i instanceof t);let sp,op;function tb(){return sp||(sp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nb(){return op||(op=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Xm=new WeakMap,su=new WeakMap,Qm=new WeakMap,Ic=new WeakMap,xh=new WeakMap;function ib(i){const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("success",s),i.removeEventListener("error",o)},s=()=>{t(bi(i.result)),r()},o=()=>{n(i.error),r()};i.addEventListener("success",s),i.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Xm.set(t,i)}).catch(()=>{}),xh.set(e,i),e}function rb(i){if(su.has(i))return;const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("complete",s),i.removeEventListener("error",o),i.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{n(i.error||new DOMException("AbortError","AbortError")),r()};i.addEventListener("complete",s),i.addEventListener("error",o),i.addEventListener("abort",o)});su.set(i,e)}let ou={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return su.get(i);if(e==="objectStoreNames")return i.objectStoreNames||Qm.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bi(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function sb(i){ou=i(ou)}function ob(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(Sc(this),e,...t);return Qm.set(n,e.sort?e.sort():[e]),bi(n)}:nb().includes(i)?function(...e){return i.apply(Sc(this),e),bi(Xm.get(this))}:function(...e){return bi(i.apply(Sc(this),e))}}function ab(i){return typeof i=="function"?ob(i):(i instanceof IDBTransaction&&rb(i),eb(i,tb())?new Proxy(i,ou):i)}function bi(i){if(i instanceof IDBRequest)return ib(i);if(Ic.has(i))return Ic.get(i);const e=ab(i);return e!==i&&(Ic.set(i,e),xh.set(e,i)),e}const Sc=i=>xh.get(i);function lb(i,e,{blocked:t,upgrade:n,blocking:r,terminated:s}={}){const o=indexedDB.open(i,e),a=bi(o);return n&&o.addEventListener("upgradeneeded",l=>{n(bi(o.result),l.oldVersion,l.newVersion,bi(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const cb=["get","getKey","getAll","getAllKeys","count"],ub=["put","add","delete","clear"],Ac=new Map;function ap(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(Ac.get(e))return Ac.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=ub.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||cb.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return Ac.set(e,s),s}sb(i=>({...i,get:(e,t,n)=>ap(e,t)||i.get(e,t,n),has:(e,t)=>!!ap(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(db(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function db(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const au="@firebase/app",lp="0.11.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=new Ao("@firebase/app"),fb="@firebase/app-compat",pb="@firebase/analytics-compat",gb="@firebase/analytics",mb="@firebase/app-check-compat",_b="@firebase/app-check",yb="@firebase/auth",vb="@firebase/auth-compat",bb="@firebase/database",wb="@firebase/data-connect",Eb="@firebase/database-compat",xb="@firebase/functions",Ib="@firebase/functions-compat",Sb="@firebase/installations",Ab="@firebase/installations-compat",Cb="@firebase/messaging",Tb="@firebase/messaging-compat",kb="@firebase/performance",Rb="@firebase/performance-compat",Nb="@firebase/remote-config",Pb="@firebase/remote-config-compat",Lb="@firebase/storage",Mb="@firebase/storage-compat",Ob="@firebase/firestore",Db="@firebase/vertexai",Ub="@firebase/firestore-compat",Vb="firebase",Fb="11.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu="[DEFAULT]",Bb={[au]:"fire-core",[fb]:"fire-core-compat",[gb]:"fire-analytics",[pb]:"fire-analytics-compat",[_b]:"fire-app-check",[mb]:"fire-app-check-compat",[yb]:"fire-auth",[vb]:"fire-auth-compat",[bb]:"fire-rtdb",[wb]:"fire-data-connect",[Eb]:"fire-rtdb-compat",[xb]:"fire-fn",[Ib]:"fire-fn-compat",[Sb]:"fire-iid",[Ab]:"fire-iid-compat",[Cb]:"fire-fcm",[Tb]:"fire-fcm-compat",[kb]:"fire-perf",[Rb]:"fire-perf-compat",[Nb]:"fire-rc",[Pb]:"fire-rc-compat",[Lb]:"fire-gcs",[Mb]:"fire-gcs-compat",[Ob]:"fire-fst",[Ub]:"fire-fst-compat",[Db]:"fire-vertex","fire-js":"fire-js",[Vb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=new Map,$b=new Map,cu=new Map;function cp(i,e){try{i.container.addComponent(e)}catch(t){ti.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function Vn(i){const e=i.name;if(cu.has(e))return ti.debug(`There were multiple attempts to register component ${e}.`),!1;cu.set(e,i);for(const t of Va.values())cp(t,i);for(const t of $b.values())cp(t,i);return!0}function zb(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Qn(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wi=new ns("app","Firebase",Hb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is=Fb;function Jm(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n=Object.assign({name:lu,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw wi.create("bad-app-name",{appName:String(r)});if(t||(t=Wm()),!t)throw wi.create("no-options");const s=Va.get(r);if(s){if(Ua(t,s.options)&&Ua(n,s.config))return s;throw wi.create("duplicate-app",{appName:r})}const o=new Y5(r);for(const l of cu.values())o.addComponent(l);const a=new jb(t,n,o);return Va.set(r,a),a}function Zm(i=lu){const e=Va.get(i);if(!e&&i===lu&&Wm())return Jm();if(!e)throw wi.create("no-app",{appName:i});return e}function sn(i,e,t){var n;let r=(n=Bb[i])!==null&&n!==void 0?n:i;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ti.warn(a.join(" "));return}Vn(new xn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="firebase-heartbeat-database",Wb=1,fo="firebase-heartbeat-store";let Cc=null;function e0(){return Cc||(Cc=lb(qb,Wb,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(fo)}catch(t){console.warn(t)}}}}).catch(i=>{throw wi.create("idb-open",{originalErrorMessage:i.message})})),Cc}async function Gb(i){try{const t=(await e0()).transaction(fo),n=await t.objectStore(fo).get(t0(i));return await t.done,n}catch(e){if(e instanceof oi)ti.warn(e.message);else{const t=wi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ti.warn(t.message)}}}async function up(i,e){try{const n=(await e0()).transaction(fo,"readwrite");await n.objectStore(fo).put(e,t0(i)),await n.done}catch(t){if(t instanceof oi)ti.warn(t.message);else{const n=wi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ti.warn(n.message)}}}function t0(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb=1024,Yb=30;class Xb{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Jb(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=hp();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>Yb){const o=Zb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ti.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=hp(),{heartbeatsToSend:n,unsentEntries:r}=Qb(this._heartbeatsCache.heartbeats),s=Ma(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ti.warn(t),""}}}function hp(){return new Date().toISOString().substring(0,10)}function Qb(i,e=Kb){const t=[];let n=i.slice();for(const r of i){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),dp(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),dp(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class Jb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Km()?M5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Gb(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return up(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return up(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function dp(i){return Ma(JSON.stringify({version:2,heartbeats:i})).length}function Zb(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(i){Vn(new xn("platform-logger",e=>new hb(e),"PRIVATE")),Vn(new xn("heartbeat",e=>new Xb(e),"PRIVATE")),sn(au,lp,i),sn(au,lp,"esm2017"),sn("fire-js","")}e4("");var fp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ei,n0;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,S){function I(){}I.prototype=S.prototype,w.D=S.prototype,w.prototype=new I,w.prototype.constructor=w,w.C=function(k,P,O){for(var R=Array(arguments.length-2),K=2;K<arguments.length;K++)R[K-2]=arguments[K];return S.prototype[P].apply(k,R)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(w,S,I){I||(I=0);var k=Array(16);if(typeof S=="string")for(var P=0;16>P;++P)k[P]=S.charCodeAt(I++)|S.charCodeAt(I++)<<8|S.charCodeAt(I++)<<16|S.charCodeAt(I++)<<24;else for(P=0;16>P;++P)k[P]=S[I++]|S[I++]<<8|S[I++]<<16|S[I++]<<24;S=w.g[0],I=w.g[1],P=w.g[2];var O=w.g[3],R=S+(O^I&(P^O))+k[0]+3614090360&4294967295;S=I+(R<<7&4294967295|R>>>25),R=O+(P^S&(I^P))+k[1]+3905402710&4294967295,O=S+(R<<12&4294967295|R>>>20),R=P+(I^O&(S^I))+k[2]+606105819&4294967295,P=O+(R<<17&4294967295|R>>>15),R=I+(S^P&(O^S))+k[3]+3250441966&4294967295,I=P+(R<<22&4294967295|R>>>10),R=S+(O^I&(P^O))+k[4]+4118548399&4294967295,S=I+(R<<7&4294967295|R>>>25),R=O+(P^S&(I^P))+k[5]+1200080426&4294967295,O=S+(R<<12&4294967295|R>>>20),R=P+(I^O&(S^I))+k[6]+2821735955&4294967295,P=O+(R<<17&4294967295|R>>>15),R=I+(S^P&(O^S))+k[7]+4249261313&4294967295,I=P+(R<<22&4294967295|R>>>10),R=S+(O^I&(P^O))+k[8]+1770035416&4294967295,S=I+(R<<7&4294967295|R>>>25),R=O+(P^S&(I^P))+k[9]+2336552879&4294967295,O=S+(R<<12&4294967295|R>>>20),R=P+(I^O&(S^I))+k[10]+4294925233&4294967295,P=O+(R<<17&4294967295|R>>>15),R=I+(S^P&(O^S))+k[11]+2304563134&4294967295,I=P+(R<<22&4294967295|R>>>10),R=S+(O^I&(P^O))+k[12]+1804603682&4294967295,S=I+(R<<7&4294967295|R>>>25),R=O+(P^S&(I^P))+k[13]+4254626195&4294967295,O=S+(R<<12&4294967295|R>>>20),R=P+(I^O&(S^I))+k[14]+2792965006&4294967295,P=O+(R<<17&4294967295|R>>>15),R=I+(S^P&(O^S))+k[15]+1236535329&4294967295,I=P+(R<<22&4294967295|R>>>10),R=S+(P^O&(I^P))+k[1]+4129170786&4294967295,S=I+(R<<5&4294967295|R>>>27),R=O+(I^P&(S^I))+k[6]+3225465664&4294967295,O=S+(R<<9&4294967295|R>>>23),R=P+(S^I&(O^S))+k[11]+643717713&4294967295,P=O+(R<<14&4294967295|R>>>18),R=I+(O^S&(P^O))+k[0]+3921069994&4294967295,I=P+(R<<20&4294967295|R>>>12),R=S+(P^O&(I^P))+k[5]+3593408605&4294967295,S=I+(R<<5&4294967295|R>>>27),R=O+(I^P&(S^I))+k[10]+38016083&4294967295,O=S+(R<<9&4294967295|R>>>23),R=P+(S^I&(O^S))+k[15]+3634488961&4294967295,P=O+(R<<14&4294967295|R>>>18),R=I+(O^S&(P^O))+k[4]+3889429448&4294967295,I=P+(R<<20&4294967295|R>>>12),R=S+(P^O&(I^P))+k[9]+568446438&4294967295,S=I+(R<<5&4294967295|R>>>27),R=O+(I^P&(S^I))+k[14]+3275163606&4294967295,O=S+(R<<9&4294967295|R>>>23),R=P+(S^I&(O^S))+k[3]+4107603335&4294967295,P=O+(R<<14&4294967295|R>>>18),R=I+(O^S&(P^O))+k[8]+1163531501&4294967295,I=P+(R<<20&4294967295|R>>>12),R=S+(P^O&(I^P))+k[13]+2850285829&4294967295,S=I+(R<<5&4294967295|R>>>27),R=O+(I^P&(S^I))+k[2]+4243563512&4294967295,O=S+(R<<9&4294967295|R>>>23),R=P+(S^I&(O^S))+k[7]+1735328473&4294967295,P=O+(R<<14&4294967295|R>>>18),R=I+(O^S&(P^O))+k[12]+2368359562&4294967295,I=P+(R<<20&4294967295|R>>>12),R=S+(I^P^O)+k[5]+4294588738&4294967295,S=I+(R<<4&4294967295|R>>>28),R=O+(S^I^P)+k[8]+2272392833&4294967295,O=S+(R<<11&4294967295|R>>>21),R=P+(O^S^I)+k[11]+1839030562&4294967295,P=O+(R<<16&4294967295|R>>>16),R=I+(P^O^S)+k[14]+4259657740&4294967295,I=P+(R<<23&4294967295|R>>>9),R=S+(I^P^O)+k[1]+2763975236&4294967295,S=I+(R<<4&4294967295|R>>>28),R=O+(S^I^P)+k[4]+1272893353&4294967295,O=S+(R<<11&4294967295|R>>>21),R=P+(O^S^I)+k[7]+4139469664&4294967295,P=O+(R<<16&4294967295|R>>>16),R=I+(P^O^S)+k[10]+3200236656&4294967295,I=P+(R<<23&4294967295|R>>>9),R=S+(I^P^O)+k[13]+681279174&4294967295,S=I+(R<<4&4294967295|R>>>28),R=O+(S^I^P)+k[0]+3936430074&4294967295,O=S+(R<<11&4294967295|R>>>21),R=P+(O^S^I)+k[3]+3572445317&4294967295,P=O+(R<<16&4294967295|R>>>16),R=I+(P^O^S)+k[6]+76029189&4294967295,I=P+(R<<23&4294967295|R>>>9),R=S+(I^P^O)+k[9]+3654602809&4294967295,S=I+(R<<4&4294967295|R>>>28),R=O+(S^I^P)+k[12]+3873151461&4294967295,O=S+(R<<11&4294967295|R>>>21),R=P+(O^S^I)+k[15]+530742520&4294967295,P=O+(R<<16&4294967295|R>>>16),R=I+(P^O^S)+k[2]+3299628645&4294967295,I=P+(R<<23&4294967295|R>>>9),R=S+(P^(I|~O))+k[0]+4096336452&4294967295,S=I+(R<<6&4294967295|R>>>26),R=O+(I^(S|~P))+k[7]+1126891415&4294967295,O=S+(R<<10&4294967295|R>>>22),R=P+(S^(O|~I))+k[14]+2878612391&4294967295,P=O+(R<<15&4294967295|R>>>17),R=I+(O^(P|~S))+k[5]+4237533241&4294967295,I=P+(R<<21&4294967295|R>>>11),R=S+(P^(I|~O))+k[12]+1700485571&4294967295,S=I+(R<<6&4294967295|R>>>26),R=O+(I^(S|~P))+k[3]+2399980690&4294967295,O=S+(R<<10&4294967295|R>>>22),R=P+(S^(O|~I))+k[10]+4293915773&4294967295,P=O+(R<<15&4294967295|R>>>17),R=I+(O^(P|~S))+k[1]+2240044497&4294967295,I=P+(R<<21&4294967295|R>>>11),R=S+(P^(I|~O))+k[8]+1873313359&4294967295,S=I+(R<<6&4294967295|R>>>26),R=O+(I^(S|~P))+k[15]+4264355552&4294967295,O=S+(R<<10&4294967295|R>>>22),R=P+(S^(O|~I))+k[6]+2734768916&4294967295,P=O+(R<<15&4294967295|R>>>17),R=I+(O^(P|~S))+k[13]+1309151649&4294967295,I=P+(R<<21&4294967295|R>>>11),R=S+(P^(I|~O))+k[4]+4149444226&4294967295,S=I+(R<<6&4294967295|R>>>26),R=O+(I^(S|~P))+k[11]+3174756917&4294967295,O=S+(R<<10&4294967295|R>>>22),R=P+(S^(O|~I))+k[2]+718787259&4294967295,P=O+(R<<15&4294967295|R>>>17),R=I+(O^(P|~S))+k[9]+3951481745&4294967295,w.g[0]=w.g[0]+S&4294967295,w.g[1]=w.g[1]+(P+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+O&4294967295}n.prototype.u=function(w,S){S===void 0&&(S=w.length);for(var I=S-this.blockSize,k=this.B,P=this.h,O=0;O<S;){if(P==0)for(;O<=I;)r(this,w,O),O+=this.blockSize;if(typeof w=="string"){for(;O<S;)if(k[P++]=w.charCodeAt(O++),P==this.blockSize){r(this,k),P=0;break}}else for(;O<S;)if(k[P++]=w[O++],P==this.blockSize){r(this,k),P=0;break}}this.h=P,this.o+=S},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var S=1;S<w.length-8;++S)w[S]=0;var I=8*this.o;for(S=w.length-8;S<w.length;++S)w[S]=I&255,I/=256;for(this.u(w),w=Array(16),S=I=0;4>S;++S)for(var k=0;32>k;k+=8)w[I++]=this.g[S]>>>k&255;return w};function s(w,S){var I=a;return Object.prototype.hasOwnProperty.call(I,w)?I[w]:I[w]=S(w)}function o(w,S){this.h=S;for(var I=[],k=!0,P=w.length-1;0<=P;P--){var O=w[P]|0;k&&O==S||(I[P]=O,k=!1)}this.g=I}var a={};function l(w){return-128<=w&&128>w?s(w,function(S){return new o([S|0],0>S?-1:0)}):new o([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return v(c(-w));for(var S=[],I=1,k=0;w>=I;k++)S[k]=w/I|0,I*=4294967296;return new o(S,0)}function u(w,S){if(w.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(w.charAt(0)=="-")return v(u(w.substring(1),S));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=c(Math.pow(S,8)),k=h,P=0;P<w.length;P+=8){var O=Math.min(8,w.length-P),R=parseInt(w.substring(P,P+O),S);8>O?(O=c(Math.pow(S,O)),k=k.j(O).add(c(R))):(k=k.j(I),k=k.add(c(R)))}return k}var h=l(0),d=l(1),p=l(16777216);i=o.prototype,i.m=function(){if(_(this))return-v(this).m();for(var w=0,S=1,I=0;I<this.g.length;I++){var k=this.i(I);w+=(0<=k?k:4294967296+k)*S,S*=4294967296}return w},i.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(g(this))return"0";if(_(this))return"-"+v(this).toString(w);for(var S=c(Math.pow(w,6)),I=this,k="";;){var P=A(I,S).g;I=C(I,P.j(S));var O=((0<I.g.length?I.g[0]:I.h)>>>0).toString(w);if(I=P,g(I))return O+k;for(;6>O.length;)O="0"+O;k=O+k}},i.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function g(w){if(w.h!=0)return!1;for(var S=0;S<w.g.length;S++)if(w.g[S]!=0)return!1;return!0}function _(w){return w.h==-1}i.l=function(w){return w=C(this,w),_(w)?-1:g(w)?0:1};function v(w){for(var S=w.g.length,I=[],k=0;k<S;k++)I[k]=~w.g[k];return new o(I,~w.h).add(d)}i.abs=function(){return _(this)?v(this):this},i.add=function(w){for(var S=Math.max(this.g.length,w.g.length),I=[],k=0,P=0;P<=S;P++){var O=k+(this.i(P)&65535)+(w.i(P)&65535),R=(O>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);k=R>>>16,O&=65535,R&=65535,I[P]=R<<16|O}return new o(I,I[I.length-1]&-2147483648?-1:0)};function C(w,S){return w.add(v(S))}i.j=function(w){if(g(this)||g(w))return h;if(_(this))return _(w)?v(this).j(v(w)):v(v(this).j(w));if(_(w))return v(this.j(v(w)));if(0>this.l(p)&&0>w.l(p))return c(this.m()*w.m());for(var S=this.g.length+w.g.length,I=[],k=0;k<2*S;k++)I[k]=0;for(k=0;k<this.g.length;k++)for(var P=0;P<w.g.length;P++){var O=this.i(k)>>>16,R=this.i(k)&65535,K=w.i(P)>>>16,ie=w.i(P)&65535;I[2*k+2*P]+=R*ie,T(I,2*k+2*P),I[2*k+2*P+1]+=O*ie,T(I,2*k+2*P+1),I[2*k+2*P+1]+=R*K,T(I,2*k+2*P+1),I[2*k+2*P+2]+=O*K,T(I,2*k+2*P+2)}for(k=0;k<S;k++)I[k]=I[2*k+1]<<16|I[2*k];for(k=S;k<2*S;k++)I[k]=0;return new o(I,0)};function T(w,S){for(;(w[S]&65535)!=w[S];)w[S+1]+=w[S]>>>16,w[S]&=65535,S++}function y(w,S){this.g=w,this.h=S}function A(w,S){if(g(S))throw Error("division by zero");if(g(w))return new y(h,h);if(_(w))return S=A(v(w),S),new y(v(S.g),v(S.h));if(_(S))return S=A(w,v(S)),new y(v(S.g),S.h);if(30<w.g.length){if(_(w)||_(S))throw Error("slowDivide_ only works with positive integers.");for(var I=d,k=S;0>=k.l(w);)I=E(I),k=E(k);var P=x(I,1),O=x(k,1);for(k=x(k,2),I=x(I,2);!g(k);){var R=O.add(k);0>=R.l(w)&&(P=P.add(I),O=R),k=x(k,1),I=x(I,1)}return S=C(w,P.j(S)),new y(P,S)}for(P=h;0<=w.l(S);){for(I=Math.max(1,Math.floor(w.m()/S.m())),k=Math.ceil(Math.log(I)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),O=c(I),R=O.j(S);_(R)||0<R.l(w);)I-=k,O=c(I),R=O.j(S);g(O)&&(O=d),P=P.add(O),w=C(w,R)}return new y(P,w)}i.A=function(w){return A(this,w).h},i.and=function(w){for(var S=Math.max(this.g.length,w.g.length),I=[],k=0;k<S;k++)I[k]=this.i(k)&w.i(k);return new o(I,this.h&w.h)},i.or=function(w){for(var S=Math.max(this.g.length,w.g.length),I=[],k=0;k<S;k++)I[k]=this.i(k)|w.i(k);return new o(I,this.h|w.h)},i.xor=function(w){for(var S=Math.max(this.g.length,w.g.length),I=[],k=0;k<S;k++)I[k]=this.i(k)^w.i(k);return new o(I,this.h^w.h)};function E(w){for(var S=w.g.length+1,I=[],k=0;k<S;k++)I[k]=w.i(k)<<1|w.i(k-1)>>>31;return new o(I,w.h)}function x(w,S){var I=S>>5;S%=32;for(var k=w.g.length-I,P=[],O=0;O<k;O++)P[O]=0<S?w.i(O+I)>>>S|w.i(O+I+1)<<32-S:w.i(O+I);return new o(P,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,n0=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,Ei=o}).apply(typeof fp<"u"?fp:typeof self<"u"?self:typeof window<"u"?window:{});var ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var i0,Ls,r0,va,uu,s0,o0,a0;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,m,b){return f==Array.prototype||f==Object.prototype||(f[m]=b.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof ra=="object"&&ra];for(var m=0;m<f.length;++m){var b=f[m];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var n=t(this);function r(f,m){if(m)e:{var b=n;f=f.split(".");for(var N=0;N<f.length-1;N++){var V=f[N];if(!(V in b))break e;b=b[V]}f=f[f.length-1],N=b[f],m=m(N),m!=N&&m!=null&&e(b,f,{configurable:!0,writable:!0,value:m})}}function s(f,m){f instanceof String&&(f+="");var b=0,N=!1,V={next:function(){if(!N&&b<f.length){var F=b++;return{value:m(F,f[F]),done:!1}}return N=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}r("Array.prototype.values",function(f){return f||function(){return s(this,function(m,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(f){var m=typeof f;return m=m!="object"?m:f?Array.isArray(f)?"array":m:"null",m=="array"||m=="object"&&typeof f.length=="number"}function c(f){var m=typeof f;return m=="object"&&f!=null||m=="function"}function u(f,m,b){return f.call.apply(f.bind,arguments)}function h(f,m,b){if(!f)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,N),f.apply(m,V)}}return function(){return f.apply(m,arguments)}}function d(f,m,b){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,d.apply(null,arguments)}function p(f,m){var b=Array.prototype.slice.call(arguments,1);return function(){var N=b.slice();return N.push.apply(N,arguments),f.apply(this,N)}}function g(f,m){function b(){}b.prototype=m.prototype,f.aa=m.prototype,f.prototype=new b,f.prototype.constructor=f,f.Qb=function(N,V,F){for(var ne=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)ne[Qe-2]=arguments[Qe];return m.prototype[V].apply(N,ne)}}function _(f){const m=f.length;if(0<m){const b=Array(m);for(let N=0;N<m;N++)b[N]=f[N];return b}return[]}function v(f,m){for(let b=1;b<arguments.length;b++){const N=arguments[b];if(l(N)){const V=f.length||0,F=N.length||0;f.length=V+F;for(let ne=0;ne<F;ne++)f[V+ne]=N[ne]}else f.push(N)}}class C{constructor(m,b){this.i=m,this.j=b,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function T(f){return/^[\s\xa0]*$/.test(f)}function y(){var f=a.navigator;return f&&(f=f.userAgent)?f:""}function A(f){return A[" "](f),f}A[" "]=function(){};var E=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function x(f,m,b){for(const N in f)m.call(b,f[N],N,f)}function w(f,m){for(const b in f)m.call(void 0,f[b],b,f)}function S(f){const m={};for(const b in f)m[b]=f[b];return m}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(f,m){let b,N;for(let V=1;V<arguments.length;V++){N=arguments[V];for(b in N)f[b]=N[b];for(let F=0;F<I.length;F++)b=I[F],Object.prototype.hasOwnProperty.call(N,b)&&(f[b]=N[b])}}function P(f){var m=1;f=f.split(":");const b=[];for(;0<m&&f.length;)b.push(f.shift()),m--;return f.length&&b.push(f.join(":")),b}function O(f){a.setTimeout(()=>{throw f},0)}function R(){var f=Q;let m=null;return f.g&&(m=f.g,f.g=f.g.next,f.g||(f.h=null),m.next=null),m}class K{constructor(){this.h=this.g=null}add(m,b){const N=ie.get();N.set(m,b),this.h?this.h.next=N:this.g=N,this.h=N}}var ie=new C(()=>new pe,f=>f.reset());class pe{constructor(){this.next=this.g=this.h=null}set(m,b){this.h=m,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let se,Y=!1,Q=new K,re=()=>{const f=a.Promise.resolve(void 0);se=()=>{f.then(ve)}};var ve=()=>{for(var f;f=R();){try{f.h.call(f.g)}catch(b){O(b)}var m=ie;m.j(f),100>m.h&&(m.h++,f.next=m.g,m.g=f)}Y=!1};function ae(){this.s=this.s,this.C=this.C}ae.prototype.s=!1,ae.prototype.ma=function(){this.s||(this.s=!0,this.N())},ae.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function fe(f,m){this.type=f,this.g=this.target=m,this.defaultPrevented=!1}fe.prototype.h=function(){this.defaultPrevented=!0};var Me=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var f=!1,m=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const b=()=>{};a.addEventListener("test",b,m),a.removeEventListener("test",b,m)}catch{}return f}();function W(f,m){if(fe.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var b=this.type=f.type,N=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=m,m=f.relatedTarget){if(E){e:{try{A(m.nodeName);var V=!0;break e}catch{}V=!1}V||(m=null)}}else b=="mouseover"?m=f.fromElement:b=="mouseout"&&(m=f.toElement);this.relatedTarget=m,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:be[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&W.aa.h.call(this)}}g(W,fe);var be={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var U="closure_listenable_"+(1e6*Math.random()|0),Z=0;function J(f,m,b,N,V){this.listener=f,this.proxy=null,this.src=m,this.type=b,this.capture=!!N,this.ha=V,this.key=++Z,this.da=this.fa=!1}function le(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Ae(f){this.src=f,this.g={},this.h=0}Ae.prototype.add=function(f,m,b,N,V){var F=f.toString();f=this.g[F],f||(f=this.g[F]=[],this.h++);var ne=M(f,m,N,V);return-1<ne?(m=f[ne],b||(m.fa=!1)):(m=new J(m,this.src,F,!!N,V),m.fa=b,f.push(m)),m};function L(f,m){var b=m.type;if(b in f.g){var N=f.g[b],V=Array.prototype.indexOf.call(N,m,void 0),F;(F=0<=V)&&Array.prototype.splice.call(N,V,1),F&&(le(m),f.g[b].length==0&&(delete f.g[b],f.h--))}}function M(f,m,b,N){for(var V=0;V<f.length;++V){var F=f[V];if(!F.da&&F.listener==m&&F.capture==!!b&&F.ha==N)return V}return-1}var D="closure_lm_"+(1e6*Math.random()|0),B={};function H(f,m,b,N,V){if(Array.isArray(m)){for(var F=0;F<m.length;F++)H(f,m[F],b,N,V);return null}return b=ge(b),f&&f[U]?f.K(m,b,c(N)?!!N.capture:!1,V):z(f,m,b,!1,N,V)}function z(f,m,b,N,V,F){if(!m)throw Error("Invalid event type");var ne=c(V)?!!V.capture:!!V,Qe=G(f);if(Qe||(f[D]=Qe=new Ae(f)),b=Qe.add(m,b,N,ne,F),b.proxy)return b;if(N=te(),b.proxy=N,N.src=f,N.listener=b,f.addEventListener)Me||(V=ne),V===void 0&&(V=!1),f.addEventListener(m.toString(),N,V);else if(f.attachEvent)f.attachEvent($(m.toString()),N);else if(f.addListener&&f.removeListener)f.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return b}function te(){function f(b){return m.call(f.src,f.listener,b)}const m=ce;return f}function ee(f,m,b,N,V){if(Array.isArray(m))for(var F=0;F<m.length;F++)ee(f,m[F],b,N,V);else N=c(N)?!!N.capture:!!N,b=ge(b),f&&f[U]?(f=f.i,m=String(m).toString(),m in f.g&&(F=f.g[m],b=M(F,b,N,V),-1<b&&(le(F[b]),Array.prototype.splice.call(F,b,1),F.length==0&&(delete f.g[m],f.h--)))):f&&(f=G(f))&&(m=f.g[m.toString()],f=-1,m&&(f=M(m,b,N,V)),(b=-1<f?m[f]:null)&&X(b))}function X(f){if(typeof f!="number"&&f&&!f.da){var m=f.src;if(m&&m[U])L(m.i,f);else{var b=f.type,N=f.proxy;m.removeEventListener?m.removeEventListener(b,N,f.capture):m.detachEvent?m.detachEvent($(b),N):m.addListener&&m.removeListener&&m.removeListener(N),(b=G(m))?(L(b,f),b.h==0&&(b.src=null,m[D]=null)):le(f)}}}function $(f){return f in B?B[f]:B[f]="on"+f}function ce(f,m){if(f.da)f=!0;else{m=new W(m,this);var b=f.listener,N=f.ha||f.src;f.fa&&X(f),f=b.call(N,m)}return f}function G(f){return f=f[D],f instanceof Ae?f:null}var he="__closure_events_fn_"+(1e9*Math.random()>>>0);function ge(f){return typeof f=="function"?f:(f[he]||(f[he]=function(m){return f.handleEvent(m)}),f[he])}function me(){ae.call(this),this.i=new Ae(this),this.M=this,this.F=null}g(me,ae),me.prototype[U]=!0,me.prototype.removeEventListener=function(f,m,b,N){ee(this,f,m,b,N)};function we(f,m){var b,N=f.F;if(N)for(b=[];N;N=N.F)b.push(N);if(f=f.M,N=m.type||m,typeof m=="string")m=new fe(m,f);else if(m instanceof fe)m.target=m.target||f;else{var V=m;m=new fe(N,f),k(m,V)}if(V=!0,b)for(var F=b.length-1;0<=F;F--){var ne=m.g=b[F];V=ye(ne,N,!0,m)&&V}if(ne=m.g=f,V=ye(ne,N,!0,m)&&V,V=ye(ne,N,!1,m)&&V,b)for(F=0;F<b.length;F++)ne=m.g=b[F],V=ye(ne,N,!1,m)&&V}me.prototype.N=function(){if(me.aa.N.call(this),this.i){var f=this.i,m;for(m in f.g){for(var b=f.g[m],N=0;N<b.length;N++)le(b[N]);delete f.g[m],f.h--}}this.F=null},me.prototype.K=function(f,m,b,N){return this.i.add(String(f),m,!1,b,N)},me.prototype.L=function(f,m,b,N){return this.i.add(String(f),m,!0,b,N)};function ye(f,m,b,N){if(m=f.i.g[String(m)],!m)return!0;m=m.concat();for(var V=!0,F=0;F<m.length;++F){var ne=m[F];if(ne&&!ne.da&&ne.capture==b){var Qe=ne.listener,It=ne.ha||ne.src;ne.fa&&L(f.i,ne),V=Qe.call(It,N)!==!1&&V}}return V&&!N.defaultPrevented}function Oe(f,m,b){if(typeof f=="function")b&&(f=d(f,b));else if(f&&typeof f.handleEvent=="function")f=d(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:a.setTimeout(f,m||0)}function Ye(f){f.g=Oe(()=>{f.g=null,f.i&&(f.i=!1,Ye(f))},f.l);const m=f.h;f.h=null,f.m.apply(null,m)}class De extends ae{constructor(m,b){super(),this.m=m,this.l=b,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Ye(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ot(f){ae.call(this),this.h=f,this.g={}}g(ot,ae);var xe=[];function Kt(f){x(f.g,function(m,b){this.g.hasOwnProperty(b)&&X(m)},f),f.g={}}ot.prototype.N=function(){ot.aa.N.call(this),Kt(this)},ot.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var et=a.JSON.stringify,gt=a.JSON.parse,Jt=class{stringify(f){return a.JSON.stringify(f,void 0)}parse(f){return a.JSON.parse(f,void 0)}};function hn(){}hn.prototype.h=null;function Fo(f){return f.h||(f.h=f.i())}function gr(){}var li={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function mt(){fe.call(this,"d")}g(mt,fe);function zn(){fe.call(this,"c")}g(zn,fe);var Fi={},Vd=null;function Bo(){return Vd=Vd||new me}Fi.La="serverreachability";function Fd(f){fe.call(this,Fi.La,f)}g(Fd,fe);function ds(f){const m=Bo();we(m,new Fd(m))}Fi.STAT_EVENT="statevent";function Bd(f,m){fe.call(this,Fi.STAT_EVENT,f),this.stat=m}g(Bd,fe);function $t(f){const m=Bo();we(m,new Bd(m,f))}Fi.Ma="timingevent";function $d(f,m){fe.call(this,Fi.Ma,f),this.size=m}g($d,fe);function fs(f,m){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){f()},m)}function ps(){this.g=!0}ps.prototype.xa=function(){this.g=!1};function xy(f,m,b,N,V,F){f.info(function(){if(f.g)if(F)for(var ne="",Qe=F.split("&"),It=0;It<Qe.length;It++){var Be=Qe[It].split("=");if(1<Be.length){var Tt=Be[0];Be=Be[1];var kt=Tt.split("_");ne=2<=kt.length&&kt[1]=="type"?ne+(Tt+"="+Be+"&"):ne+(Tt+"=redacted&")}}else ne=null;else ne=F;return"XMLHTTP REQ ("+N+") [attempt "+V+"]: "+m+`
`+b+`
`+ne})}function Iy(f,m,b,N,V,F,ne){f.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+V+"]: "+m+`
`+b+`
`+F+" "+ne})}function mr(f,m,b,N){f.info(function(){return"XMLHTTP TEXT ("+m+"): "+Ay(f,b)+(N?" "+N:"")})}function Sy(f,m){f.info(function(){return"TIMEOUT: "+m})}ps.prototype.info=function(){};function Ay(f,m){if(!f.g)return m;if(!m)return null;try{var b=JSON.parse(m);if(b){for(f=0;f<b.length;f++)if(Array.isArray(b[f])){var N=b[f];if(!(2>N.length)){var V=N[1];if(Array.isArray(V)&&!(1>V.length)){var F=V[0];if(F!="noop"&&F!="stop"&&F!="close")for(var ne=1;ne<V.length;ne++)V[ne]=""}}}}return et(b)}catch{return m}}var $o={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},zd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Zl;function zo(){}g(zo,hn),zo.prototype.g=function(){return new XMLHttpRequest},zo.prototype.i=function(){return{}},Zl=new zo;function ci(f,m,b,N){this.j=f,this.i=m,this.l=b,this.R=N||1,this.U=new ot(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Hd}function Hd(){this.i=null,this.g="",this.h=!1}var jd={},ec={};function tc(f,m,b){f.L=1,f.v=Wo(Hn(m)),f.m=b,f.P=!0,qd(f,null)}function qd(f,m){f.F=Date.now(),Ho(f),f.A=Hn(f.v);var b=f.A,N=f.R;Array.isArray(N)||(N=[String(N)]),of(b.i,"t",N),f.C=0,b=f.j.J,f.h=new Hd,f.g=If(f.j,b?m:null,!f.m),0<f.O&&(f.M=new De(d(f.Y,f,f.g),f.O)),m=f.U,b=f.g,N=f.ca;var V="readystatechange";Array.isArray(V)||(V&&(xe[0]=V.toString()),V=xe);for(var F=0;F<V.length;F++){var ne=H(b,V[F],N||m.handleEvent,!1,m.h||m);if(!ne)break;m.g[ne.key]=ne}m=f.H?S(f.H):{},f.m?(f.u||(f.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,m)):(f.u="GET",f.g.ea(f.A,f.u,null,m)),ds(),xy(f.i,f.u,f.A,f.l,f.R,f.m)}ci.prototype.ca=function(f){f=f.target;const m=this.M;m&&jn(f)==3?m.j():this.Y(f)},ci.prototype.Y=function(f){try{if(f==this.g)e:{const kt=jn(this.g);var m=this.g.Ba();const vr=this.g.Z();if(!(3>kt)&&(kt!=3||this.g&&(this.h.h||this.g.oa()||ff(this.g)))){this.J||kt!=4||m==7||(m==8||0>=vr?ds(3):ds(2)),nc(this);var b=this.g.Z();this.X=b;t:if(Wd(this)){var N=ff(this.g);f="";var V=N.length,F=jn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Bi(this),gs(this);var ne="";break t}this.h.i=new a.TextDecoder}for(m=0;m<V;m++)this.h.h=!0,f+=this.h.i.decode(N[m],{stream:!(F&&m==V-1)});N.length=0,this.h.g+=f,this.C=0,ne=this.h.g}else ne=this.g.oa();if(this.o=b==200,Iy(this.i,this.u,this.A,this.l,this.R,kt,b),this.o){if(this.T&&!this.K){t:{if(this.g){var Qe,It=this.g;if((Qe=It.g?It.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(Qe)){var Be=Qe;break t}}Be=null}if(b=Be)mr(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ic(this,b);else{this.o=!1,this.s=3,$t(12),Bi(this),gs(this);break e}}if(this.P){b=!0;let dn;for(;!this.J&&this.C<ne.length;)if(dn=Cy(this,ne),dn==ec){kt==4&&(this.s=4,$t(14),b=!1),mr(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==jd){this.s=4,$t(15),mr(this.i,this.l,ne,"[Invalid Chunk]"),b=!1;break}else mr(this.i,this.l,dn,null),ic(this,dn);if(Wd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),kt!=4||ne.length!=0||this.h.h||(this.s=1,$t(16),b=!1),this.o=this.o&&b,!b)mr(this.i,this.l,ne,"[Invalid Chunked Response]"),Bi(this),gs(this);else if(0<ne.length&&!this.W){this.W=!0;var Tt=this.j;Tt.g==this&&Tt.ba&&!Tt.M&&(Tt.j.info("Great, no buffering proxy detected. Bytes received: "+ne.length),cc(Tt),Tt.M=!0,$t(11))}}else mr(this.i,this.l,ne,null),ic(this,ne);kt==4&&Bi(this),this.o&&!this.J&&(kt==4?bf(this.j,this):(this.o=!1,Ho(this)))}else jy(this.g),b==400&&0<ne.indexOf("Unknown SID")?(this.s=3,$t(12)):(this.s=0,$t(13)),Bi(this),gs(this)}}}catch{}finally{}};function Wd(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Cy(f,m){var b=f.C,N=m.indexOf(`
`,b);return N==-1?ec:(b=Number(m.substring(b,N)),isNaN(b)?jd:(N+=1,N+b>m.length?ec:(m=m.slice(N,N+b),f.C=N+b,m)))}ci.prototype.cancel=function(){this.J=!0,Bi(this)};function Ho(f){f.S=Date.now()+f.I,Gd(f,f.I)}function Gd(f,m){if(f.B!=null)throw Error("WatchDog timer not null");f.B=fs(d(f.ba,f),m)}function nc(f){f.B&&(a.clearTimeout(f.B),f.B=null)}ci.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(Sy(this.i,this.A),this.L!=2&&(ds(),$t(17)),Bi(this),this.s=2,gs(this)):Gd(this,this.S-f)};function gs(f){f.j.G==0||f.J||bf(f.j,f)}function Bi(f){nc(f);var m=f.M;m&&typeof m.ma=="function"&&m.ma(),f.M=null,Kt(f.U),f.g&&(m=f.g,f.g=null,m.abort(),m.ma())}function ic(f,m){try{var b=f.j;if(b.G!=0&&(b.g==f||rc(b.h,f))){if(!f.K&&rc(b.h,f)&&b.G==3){try{var N=b.Da.g.parse(m)}catch{N=null}if(Array.isArray(N)&&N.length==3){var V=N;if(V[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<f.F)Jo(b),Xo(b);else break e;lc(b),$t(18)}}else b.za=V[1],0<b.za-b.T&&37500>V[2]&&b.F&&b.v==0&&!b.C&&(b.C=fs(d(b.Za,b),6e3));if(1>=Xd(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else zi(b,11)}else if((f.K||b.g==f)&&Jo(b),!T(m))for(V=b.Da.g.parse(m),m=0;m<V.length;m++){let Be=V[m];if(b.T=Be[0],Be=Be[1],b.G==2)if(Be[0]=="c"){b.K=Be[1],b.ia=Be[2];const Tt=Be[3];Tt!=null&&(b.la=Tt,b.j.info("VER="+b.la));const kt=Be[4];kt!=null&&(b.Aa=kt,b.j.info("SVER="+b.Aa));const vr=Be[5];vr!=null&&typeof vr=="number"&&0<vr&&(N=1.5*vr,b.L=N,b.j.info("backChannelRequestTimeoutMs_="+N)),N=b;const dn=f.g;if(dn){const ea=dn.g?dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ea){var F=N.h;F.g||ea.indexOf("spdy")==-1&&ea.indexOf("quic")==-1&&ea.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(sc(F,F.h),F.h=null))}if(N.D){const uc=dn.g?dn.g.getResponseHeader("X-HTTP-Session-Id"):null;uc&&(N.ya=uc,tt(N.I,N.D,uc))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-f.F,b.j.info("Handshake RTT: "+b.R+"ms")),N=b;var ne=f;if(N.qa=xf(N,N.J?N.ia:null,N.W),ne.K){Qd(N.h,ne);var Qe=ne,It=N.L;It&&(Qe.I=It),Qe.B&&(nc(Qe),Ho(Qe)),N.g=ne}else yf(N);0<b.i.length&&Qo(b)}else Be[0]!="stop"&&Be[0]!="close"||zi(b,7);else b.G==3&&(Be[0]=="stop"||Be[0]=="close"?Be[0]=="stop"?zi(b,7):ac(b):Be[0]!="noop"&&b.l&&b.l.ta(Be),b.v=0)}}ds(4)}catch{}}var Ty=class{constructor(f,m){this.g=f,this.map=m}};function Kd(f){this.l=f||10,a.PerformanceNavigationTiming?(f=a.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Yd(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Xd(f){return f.h?1:f.g?f.g.size:0}function rc(f,m){return f.h?f.h==m:f.g?f.g.has(m):!1}function sc(f,m){f.g?f.g.add(m):f.h=m}function Qd(f,m){f.h&&f.h==m?f.h=null:f.g&&f.g.has(m)&&f.g.delete(m)}Kd.prototype.cancel=function(){if(this.i=Jd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Jd(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let m=f.i;for(const b of f.g.values())m=m.concat(b.D);return m}return _(f.i)}function ky(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var m=[],b=f.length,N=0;N<b;N++)m.push(f[N]);return m}m=[],b=0;for(N in f)m[b++]=f[N];return m}function Ry(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var m=[];f=f.length;for(var b=0;b<f;b++)m.push(b);return m}m=[],b=0;for(const N in f)m[b++]=N;return m}}}function Zd(f,m){if(f.forEach&&typeof f.forEach=="function")f.forEach(m,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,m,void 0);else for(var b=Ry(f),N=ky(f),V=N.length,F=0;F<V;F++)m.call(void 0,N[F],b&&b[F],f)}var ef=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ny(f,m){if(f){f=f.split("&");for(var b=0;b<f.length;b++){var N=f[b].indexOf("="),V=null;if(0<=N){var F=f[b].substring(0,N);V=f[b].substring(N+1)}else F=f[b];m(F,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function $i(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof $i){this.h=f.h,jo(this,f.j),this.o=f.o,this.g=f.g,qo(this,f.s),this.l=f.l;var m=f.i,b=new ys;b.i=m.i,m.g&&(b.g=new Map(m.g),b.h=m.h),tf(this,b),this.m=f.m}else f&&(m=String(f).match(ef))?(this.h=!1,jo(this,m[1]||"",!0),this.o=ms(m[2]||""),this.g=ms(m[3]||"",!0),qo(this,m[4]),this.l=ms(m[5]||"",!0),tf(this,m[6]||"",!0),this.m=ms(m[7]||"")):(this.h=!1,this.i=new ys(null,this.h))}$i.prototype.toString=function(){var f=[],m=this.j;m&&f.push(_s(m,nf,!0),":");var b=this.g;return(b||m=="file")&&(f.push("//"),(m=this.o)&&f.push(_s(m,nf,!0),"@"),f.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&f.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&f.push("/"),f.push(_s(b,b.charAt(0)=="/"?My:Ly,!0))),(b=this.i.toString())&&f.push("?",b),(b=this.m)&&f.push("#",_s(b,Dy)),f.join("")};function Hn(f){return new $i(f)}function jo(f,m,b){f.j=b?ms(m,!0):m,f.j&&(f.j=f.j.replace(/:$/,""))}function qo(f,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);f.s=m}else f.s=null}function tf(f,m,b){m instanceof ys?(f.i=m,Uy(f.i,f.h)):(b||(m=_s(m,Oy)),f.i=new ys(m,f.h))}function tt(f,m,b){f.i.set(m,b)}function Wo(f){return tt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function ms(f,m){return f?m?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function _s(f,m,b){return typeof f=="string"?(f=encodeURI(f).replace(m,Py),b&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Py(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var nf=/[#\/\?@]/g,Ly=/[#\?:]/g,My=/[#\?]/g,Oy=/[#\?@]/g,Dy=/#/g;function ys(f,m){this.h=this.g=null,this.i=f||null,this.j=!!m}function ui(f){f.g||(f.g=new Map,f.h=0,f.i&&Ny(f.i,function(m,b){f.add(decodeURIComponent(m.replace(/\+/g," ")),b)}))}i=ys.prototype,i.add=function(f,m){ui(this),this.i=null,f=_r(this,f);var b=this.g.get(f);return b||this.g.set(f,b=[]),b.push(m),this.h+=1,this};function rf(f,m){ui(f),m=_r(f,m),f.g.has(m)&&(f.i=null,f.h-=f.g.get(m).length,f.g.delete(m))}function sf(f,m){return ui(f),m=_r(f,m),f.g.has(m)}i.forEach=function(f,m){ui(this),this.g.forEach(function(b,N){b.forEach(function(V){f.call(m,V,N,this)},this)},this)},i.na=function(){ui(this);const f=Array.from(this.g.values()),m=Array.from(this.g.keys()),b=[];for(let N=0;N<m.length;N++){const V=f[N];for(let F=0;F<V.length;F++)b.push(m[N])}return b},i.V=function(f){ui(this);let m=[];if(typeof f=="string")sf(this,f)&&(m=m.concat(this.g.get(_r(this,f))));else{f=Array.from(this.g.values());for(let b=0;b<f.length;b++)m=m.concat(f[b])}return m},i.set=function(f,m){return ui(this),this.i=null,f=_r(this,f),sf(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[m]),this.h+=1,this},i.get=function(f,m){return f?(f=this.V(f),0<f.length?String(f[0]):m):m};function of(f,m,b){rf(f,m),0<b.length&&(f.i=null,f.g.set(_r(f,m),_(b)),f.h+=b.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],m=Array.from(this.g.keys());for(var b=0;b<m.length;b++){var N=m[b];const F=encodeURIComponent(String(N)),ne=this.V(N);for(N=0;N<ne.length;N++){var V=F;ne[N]!==""&&(V+="="+encodeURIComponent(String(ne[N]))),f.push(V)}}return this.i=f.join("&")};function _r(f,m){return m=String(m),f.j&&(m=m.toLowerCase()),m}function Uy(f,m){m&&!f.j&&(ui(f),f.i=null,f.g.forEach(function(b,N){var V=N.toLowerCase();N!=V&&(rf(this,N),of(this,V,b))},f)),f.j=m}function Vy(f,m){const b=new ps;if(a.Image){const N=new Image;N.onload=p(hi,b,"TestLoadImage: loaded",!0,m,N),N.onerror=p(hi,b,"TestLoadImage: error",!1,m,N),N.onabort=p(hi,b,"TestLoadImage: abort",!1,m,N),N.ontimeout=p(hi,b,"TestLoadImage: timeout",!1,m,N),a.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=f}else m(!1)}function Fy(f,m){const b=new ps,N=new AbortController,V=setTimeout(()=>{N.abort(),hi(b,"TestPingServer: timeout",!1,m)},1e4);fetch(f,{signal:N.signal}).then(F=>{clearTimeout(V),F.ok?hi(b,"TestPingServer: ok",!0,m):hi(b,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(V),hi(b,"TestPingServer: error",!1,m)})}function hi(f,m,b,N,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),N(b)}catch{}}function By(){this.g=new Jt}function $y(f,m,b){const N=b||"";try{Zd(f,function(V,F){let ne=V;c(V)&&(ne=et(V)),m.push(N+F+"="+encodeURIComponent(ne))})}catch(V){throw m.push(N+"type="+encodeURIComponent("_badmap")),V}}function Go(f){this.l=f.Ub||null,this.j=f.eb||!1}g(Go,hn),Go.prototype.g=function(){return new Ko(this.l,this.j)},Go.prototype.i=function(f){return function(){return f}}({});function Ko(f,m){me.call(this),this.D=f,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Ko,me),i=Ko.prototype,i.open=function(f,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=m,this.readyState=1,bs(this)},i.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(m.body=f),(this.D||a).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,vs(this)),this.readyState=0},i.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,bs(this)),this.g&&(this.readyState=3,bs(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;af(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function af(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}i.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var m=f.value?f.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!f.done}))&&(this.response=this.responseText+=m)}f.done?vs(this):bs(this),this.readyState==3&&af(this)}},i.Ra=function(f){this.g&&(this.response=this.responseText=f,vs(this))},i.Qa=function(f){this.g&&(this.response=f,vs(this))},i.ga=function(){this.g&&vs(this)};function vs(f){f.readyState=4,f.l=null,f.j=null,f.v=null,bs(f)}i.setRequestHeader=function(f,m){this.u.append(f,m)},i.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],m=this.h.entries();for(var b=m.next();!b.done;)b=b.value,f.push(b[0]+": "+b[1]),b=m.next();return f.join(`\r
`)};function bs(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ko.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function lf(f){let m="";return x(f,function(b,N){m+=N,m+=":",m+=b,m+=`\r
`}),m}function oc(f,m,b){e:{for(N in b){var N=!1;break e}N=!0}N||(b=lf(b),typeof f=="string"?b!=null&&encodeURIComponent(String(b)):tt(f,m,b))}function lt(f){me.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(lt,me);var zy=/^https?$/i,Hy=["POST","PUT"];i=lt.prototype,i.Ha=function(f){this.J=f},i.ea=function(f,m,b,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);m=m?m.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Zl.g(),this.v=this.o?Fo(this.o):Fo(Zl),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(m,String(f),!0),this.B=!1}catch(F){cf(this,F);return}if(f=b||"",b=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var V in N)b.set(V,N[V]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const F of N.keys())b.set(F,N.get(F));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(b.keys()).find(F=>F.toLowerCase()=="content-type"),V=a.FormData&&f instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Hy,m,void 0))||N||V||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,ne]of b)this.g.setRequestHeader(F,ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{df(this),this.u=!0,this.g.send(f),this.u=!1}catch(F){cf(this,F)}};function cf(f,m){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=m,f.m=5,uf(f),Yo(f)}function uf(f){f.A||(f.A=!0,we(f,"complete"),we(f,"error"))}i.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,we(this,"complete"),we(this,"abort"),Yo(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yo(this,!0)),lt.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?hf(this):this.bb())},i.bb=function(){hf(this)};function hf(f){if(f.h&&typeof o<"u"&&(!f.v[1]||jn(f)!=4||f.Z()!=2)){if(f.u&&jn(f)==4)Oe(f.Ea,0,f);else if(we(f,"readystatechange"),jn(f)==4){f.h=!1;try{const ne=f.Z();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var b;if(!(b=m)){var N;if(N=ne===0){var V=String(f.D).match(ef)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),N=!zy.test(V?V.toLowerCase():"")}b=N}if(b)we(f,"complete"),we(f,"success");else{f.m=6;try{var F=2<jn(f)?f.g.statusText:""}catch{F=""}f.l=F+" ["+f.Z()+"]",uf(f)}}finally{Yo(f)}}}}function Yo(f,m){if(f.g){df(f);const b=f.g,N=f.v[0]?()=>{}:null;f.g=null,f.v=null,m||we(f,"ready");try{b.onreadystatechange=N}catch{}}}function df(f){f.I&&(a.clearTimeout(f.I),f.I=null)}i.isActive=function(){return!!this.g};function jn(f){return f.g?f.g.readyState:0}i.Z=function(){try{return 2<jn(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(f){if(this.g){var m=this.g.responseText;return f&&m.indexOf(f)==0&&(m=m.substring(f.length)),gt(m)}};function ff(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function jy(f){const m={};f=(f.g&&2<=jn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<f.length;N++){if(T(f[N]))continue;var b=P(f[N]);const V=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const F=m[V]||[];m[V]=F,F.push(b)}w(m,function(N){return N.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ws(f,m,b){return b&&b.internalChannelParams&&b.internalChannelParams[f]||m}function pf(f){this.Aa=0,this.i=[],this.j=new ps,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ws("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ws("baseRetryDelayMs",5e3,f),this.cb=ws("retryDelaySeedMs",1e4,f),this.Wa=ws("forwardChannelMaxRetries",2,f),this.wa=ws("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Kd(f&&f.concurrentRequestLimit),this.Da=new By,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=pf.prototype,i.la=8,i.G=1,i.connect=function(f,m,b,N){$t(0),this.W=f,this.H=m||{},b&&N!==void 0&&(this.H.OSID=b,this.H.OAID=N),this.F=this.X,this.I=xf(this,null,this.W),Qo(this)};function ac(f){if(gf(f),f.G==3){var m=f.U++,b=Hn(f.I);if(tt(b,"SID",f.K),tt(b,"RID",m),tt(b,"TYPE","terminate"),Es(f,b),m=new ci(f,f.j,m),m.L=2,m.v=Wo(Hn(b)),b=!1,a.navigator&&a.navigator.sendBeacon)try{b=a.navigator.sendBeacon(m.v.toString(),"")}catch{}!b&&a.Image&&(new Image().src=m.v,b=!0),b||(m.g=If(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Ho(m)}Ef(f)}function Xo(f){f.g&&(cc(f),f.g.cancel(),f.g=null)}function gf(f){Xo(f),f.u&&(a.clearTimeout(f.u),f.u=null),Jo(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&a.clearTimeout(f.s),f.s=null)}function Qo(f){if(!Yd(f.h)&&!f.s){f.s=!0;var m=f.Ga;se||re(),Y||(se(),Y=!0),Q.add(m,f),f.B=0}}function qy(f,m){return Xd(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=m.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=fs(d(f.Ga,f,m),wf(f,f.B)),f.B++,!0)}i.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const V=new ci(this,this.j,f);let F=this.o;if(this.S&&(F?(F=S(F),k(F,this.S)):F=this.S),this.m!==null||this.O||(V.H=F,F=null),this.P)e:{for(var m=0,b=0;b<this.i.length;b++){t:{var N=this.i[b];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(m+=N,4096<m){m=b;break e}if(m===4096||b===this.i.length-1){m=b+1;break e}}m=1e3}else m=1e3;m=_f(this,V,m),b=Hn(this.I),tt(b,"RID",f),tt(b,"CVER",22),this.D&&tt(b,"X-HTTP-Session-Id",this.D),Es(this,b),F&&(this.O?m="headers="+encodeURIComponent(String(lf(F)))+"&"+m:this.m&&oc(b,this.m,F)),sc(this.h,V),this.Ua&&tt(b,"TYPE","init"),this.P?(tt(b,"$req",m),tt(b,"SID","null"),V.T=!0,tc(V,b,null)):tc(V,b,m),this.G=2}}else this.G==3&&(f?mf(this,f):this.i.length==0||Yd(this.h)||mf(this))};function mf(f,m){var b;m?b=m.l:b=f.U++;const N=Hn(f.I);tt(N,"SID",f.K),tt(N,"RID",b),tt(N,"AID",f.T),Es(f,N),f.m&&f.o&&oc(N,f.m,f.o),b=new ci(f,f.j,b,f.B+1),f.m===null&&(b.H=f.o),m&&(f.i=m.D.concat(f.i)),m=_f(f,b,1e3),b.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),sc(f.h,b),tc(b,N,m)}function Es(f,m){f.H&&x(f.H,function(b,N){tt(m,N,b)}),f.l&&Zd({},function(b,N){tt(m,N,b)})}function _f(f,m,b){b=Math.min(f.i.length,b);var N=f.l?d(f.l.Na,f.l,f):null;e:{var V=f.i;let F=-1;for(;;){const ne=["count="+b];F==-1?0<b?(F=V[0].g,ne.push("ofs="+F)):F=0:ne.push("ofs="+F);let Qe=!0;for(let It=0;It<b;It++){let Be=V[It].g;const Tt=V[It].map;if(Be-=F,0>Be)F=Math.max(0,V[It].g-100),Qe=!1;else try{$y(Tt,ne,"req"+Be+"_")}catch{N&&N(Tt)}}if(Qe){N=ne.join("&");break e}}}return f=f.i.splice(0,b),m.D=f,N}function yf(f){if(!f.g&&!f.u){f.Y=1;var m=f.Fa;se||re(),Y||(se(),Y=!0),Q.add(m,f),f.v=0}}function lc(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=fs(d(f.Fa,f),wf(f,f.v)),f.v++,!0)}i.Fa=function(){if(this.u=null,vf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=fs(d(this.ab,this),f)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,$t(10),Xo(this),vf(this))};function cc(f){f.A!=null&&(a.clearTimeout(f.A),f.A=null)}function vf(f){f.g=new ci(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var m=Hn(f.qa);tt(m,"RID","rpc"),tt(m,"SID",f.K),tt(m,"AID",f.T),tt(m,"CI",f.F?"0":"1"),!f.F&&f.ja&&tt(m,"TO",f.ja),tt(m,"TYPE","xmlhttp"),Es(f,m),f.m&&f.o&&oc(m,f.m,f.o),f.L&&(f.g.I=f.L);var b=f.g;f=f.ia,b.L=1,b.v=Wo(Hn(m)),b.m=null,b.P=!0,qd(b,f)}i.Za=function(){this.C!=null&&(this.C=null,Xo(this),lc(this),$t(19))};function Jo(f){f.C!=null&&(a.clearTimeout(f.C),f.C=null)}function bf(f,m){var b=null;if(f.g==m){Jo(f),cc(f),f.g=null;var N=2}else if(rc(f.h,m))b=m.D,Qd(f.h,m),N=1;else return;if(f.G!=0){if(m.o)if(N==1){b=m.m?m.m.length:0,m=Date.now()-m.F;var V=f.B;N=Bo(),we(N,new $d(N,b)),Qo(f)}else yf(f);else if(V=m.s,V==3||V==0&&0<m.X||!(N==1&&qy(f,m)||N==2&&lc(f)))switch(b&&0<b.length&&(m=f.h,m.i=m.i.concat(b)),V){case 1:zi(f,5);break;case 4:zi(f,10);break;case 3:zi(f,6);break;default:zi(f,2)}}}function wf(f,m){let b=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(b*=2),b*m}function zi(f,m){if(f.j.info("Error code "+m),m==2){var b=d(f.fb,f),N=f.Xa;const V=!N;N=new $i(N||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||jo(N,"https"),Wo(N),V?Vy(N.toString(),b):Fy(N.toString(),b)}else $t(2);f.G=0,f.l&&f.l.sa(m),Ef(f),gf(f)}i.fb=function(f){f?(this.j.info("Successfully pinged google.com"),$t(2)):(this.j.info("Failed to ping google.com"),$t(1))};function Ef(f){if(f.G=0,f.ka=[],f.l){const m=Jd(f.h);(m.length!=0||f.i.length!=0)&&(v(f.ka,m),v(f.ka,f.i),f.h.i.length=0,_(f.i),f.i.length=0),f.l.ra()}}function xf(f,m,b){var N=b instanceof $i?Hn(b):new $i(b);if(N.g!="")m&&(N.g=m+"."+N.g),qo(N,N.s);else{var V=a.location;N=V.protocol,m=m?m+"."+V.hostname:V.hostname,V=+V.port;var F=new $i(null);N&&jo(F,N),m&&(F.g=m),V&&qo(F,V),b&&(F.l=b),N=F}return b=f.D,m=f.ya,b&&m&&tt(N,b,m),tt(N,"VER",f.la),Es(f,N),N}function If(f,m,b){if(m&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=f.Ca&&!f.pa?new lt(new Go({eb:b})):new lt(f.pa),m.Ha(f.J),m}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sf(){}i=Sf.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function Zo(){}Zo.prototype.g=function(f,m){return new Zt(f,m)};function Zt(f,m){me.call(this),this.g=new pf(m),this.l=f,this.h=m&&m.messageUrlParams||null,f=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(f?f["X-WebChannel-Content-Type"]=m.messageContentType:f={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(f?f["X-WebChannel-Client-Profile"]=m.va:f={"X-WebChannel-Client-Profile":m.va}),this.g.S=f,(f=m&&m.Sb)&&!T(f)&&(this.g.m=f),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!T(m)&&(this.g.D=m,f=this.h,f!==null&&m in f&&(f=this.h,m in f&&delete f[m])),this.j=new yr(this)}g(Zt,me),Zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zt.prototype.close=function(){ac(this.g)},Zt.prototype.o=function(f){var m=this.g;if(typeof f=="string"){var b={};b.__data__=f,f=b}else this.u&&(b={},b.__data__=et(f),f=b);m.i.push(new Ty(m.Ya++,f)),m.G==3&&Qo(m)},Zt.prototype.N=function(){this.g.l=null,delete this.j,ac(this.g),delete this.g,Zt.aa.N.call(this)};function Af(f){mt.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var m=f.__sm__;if(m){e:{for(const b in m){f=b;break e}f=void 0}(this.i=f)&&(f=this.i,m=m!==null&&f in m?m[f]:void 0),this.data=m}else this.data=f}g(Af,mt);function Cf(){zn.call(this),this.status=1}g(Cf,zn);function yr(f){this.g=f}g(yr,Sf),yr.prototype.ua=function(){we(this.g,"a")},yr.prototype.ta=function(f){we(this.g,new Af(f))},yr.prototype.sa=function(f){we(this.g,new Cf)},yr.prototype.ra=function(){we(this.g,"b")},Zo.prototype.createWebChannel=Zo.prototype.g,Zt.prototype.send=Zt.prototype.o,Zt.prototype.open=Zt.prototype.m,Zt.prototype.close=Zt.prototype.close,a0=function(){return new Zo},o0=function(){return Bo()},s0=Fi,uu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$o.NO_ERROR=0,$o.TIMEOUT=8,$o.HTTP_ERROR=6,va=$o,zd.COMPLETE="complete",r0=zd,gr.EventType=li,li.OPEN="a",li.CLOSE="b",li.ERROR="c",li.MESSAGE="d",me.prototype.listen=me.prototype.K,Ls=gr,lt.prototype.listenOnce=lt.prototype.L,lt.prototype.getLastError=lt.prototype.Ka,lt.prototype.getLastErrorCode=lt.prototype.Ba,lt.prototype.getStatus=lt.prototype.Z,lt.prototype.getResponseJson=lt.prototype.Oa,lt.prototype.getResponseText=lt.prototype.oa,lt.prototype.send=lt.prototype.ea,lt.prototype.setWithCredentials=lt.prototype.Ha,i0=lt}).apply(typeof ra<"u"?ra:typeof self<"u"?self:typeof window<"u"?window:{});const pp="@firebase/firestore",gp="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pt.UNAUTHENTICATED=new Pt(null),Pt.GOOGLE_CREDENTIALS=new Pt("google-credentials-uid"),Pt.FIRST_PARTY=new Pt("first-party-uid"),Pt.MOCK_USER=new Pt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rs="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tr=new Ao("@firebase/firestore");function Sr(){return tr.logLevel}function ue(i,...e){if(tr.logLevel<=Ne.DEBUG){const t=e.map(Ih);tr.debug(`Firestore (${rs}): ${i}`,...t)}}function ni(i,...e){if(tr.logLevel<=Ne.ERROR){const t=e.map(Ih);tr.error(`Firestore (${rs}): ${i}`,...t)}}function jr(i,...e){if(tr.logLevel<=Ne.WARN){const t=e.map(Ih);tr.warn(`Firestore (${rs}): ${i}`,...t)}}function Ih(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ee(i="Unexpected state"){const e=`FIRESTORE (${rs}) INTERNAL ASSERTION FAILED: `+i;throw ni(e),new Error(e)}function Ke(i,e){i||Ee()}function Se(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends oi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class t4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Pt.UNAUTHENTICATED))}shutdown(){}}class n4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class i4{constructor(e){this.t=e,this.currentUser=Pt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ke(this.o===void 0);let n=this.i;const r=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve();let s=new Zn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Zn,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Zn)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ke(typeof n.accessToken=="string"),new l0(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ke(e===null||typeof e=="string"),new Pt(e)}}class r4{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Pt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class s4{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new r4(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Pt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mp{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class o4{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Qn(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Ke(this.o===void 0);const n=s=>{s.error!=null&&ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ue("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const r=s=>{ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new mp(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ke(typeof t.token=="string"),this.R=t.token,new mp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=a4(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%62))}return n}}function Re(i,e){return i<e?-1:i>e?1:0}function hu(i,e){let t=0;for(;t<i.length&&t<e.length;){const n=i.codePointAt(t),r=e.codePointAt(t);if(n!==r){if(n<128&&r<128)return Re(n,r);{const s=c0(),o=l4(s.encode(_p(i,t)),s.encode(_p(e,t)));return o!==0?o:Re(n,r)}}t+=n>65535?2:1}return Re(i.length,e.length)}function _p(i,e){return i.codePointAt(e)>65535?i.substring(e,e+2):i.substring(e,e+1)}function l4(i,e){for(let t=0;t<i.length&&t<e.length;++t)if(i[t]!==e[t])return Re(i[t],e[t]);return Re(i.length,e.length)}function qr(i,e,t){return i.length===e.length&&i.every((n,r)=>t(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp=-62135596800,vp=1e6;class ft{static now(){return ft.fromMillis(Date.now())}static fromDate(e){return ft.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*vp);return new ft(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<yp)throw new de(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vp}_compareTo(e){return this.seconds===e.seconds?Re(this.nanoseconds,e.nanoseconds):Re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-yp;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new ft(0,0))}static max(){return new Ie(new ft(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp="__name__";class kn{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ee(),n===void 0?n=e.length-t:n>e.length-t&&Ee(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return kn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof kn?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=kn.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Re(e.length,t.length)}static compareSegments(e,t){const n=kn.isNumericId(e),r=kn.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?kn.extractNumericId(e).compare(kn.extractNumericId(t)):hu(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ei.fromString(e.substring(4,e.length-2))}}class rt extends kn{construct(e,t,n){return new rt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new de(q.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new rt(t)}static emptyPath(){return new rt([])}}const c4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class At extends kn{construct(e,t,n){return new At(e,t,n)}static isValidIdentifier(e){return c4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),At.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bp}static keyField(){return new At([bp])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(n.length===0)throw new de(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new de(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new de(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(n+=a,r++):(s(),r++)}if(s(),o)throw new de(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new At(t)}static emptyPath(){return new At([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(rt.fromString(e))}static fromName(e){return new _e(rt.fromString(e).popFirst(5))}static empty(){return new _e(rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new rt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po=-1;function u4(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=Ie.fromTimestamp(n===1e9?new ft(t+1,0):new ft(t,n));return new Ci(r,_e.empty(),e)}function h4(i){return new Ci(i.readTime,i.key,po)}class Ci{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ci(Ie.min(),_e.empty(),po)}static max(){return new Ci(Ie.max(),_e.empty(),po)}}function d4(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=_e.comparator(i.documentKey,e.documentKey),t!==0?t:Re(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class p4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ss(i){if(i.code!==q.FAILED_PRECONDITION||i.message!==f4)throw i;ue("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new j((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof j?t:j.resolve(t)}catch(t){return j.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):j.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):j.reject(t)}static resolve(e){return new j((t,n)=>{t(e)})}static reject(e){return new j((t,n)=>{n(e)})}static waitFor(e){return new j((t,n)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},l=>n(l))}),o=!0,s===r&&t()})}static or(e){let t=j.resolve(!1);for(const n of e)t=t.next(r=>r?j.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,s)=>{n.push(t.call(this,r,s))}),this.waitFor(n)}static mapArray(e,t){return new j((n,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===s&&n(o)},u=>r(u))}})}static doWhile(e,t){return new j((n,r)=>{const s=()=>{e()===!0?t().next(()=>{s()},r):n()};s()})}}function g4(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function os(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Al.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh=-1;function Cl(i){return i==null}function Fa(i){return i===0&&1/i==-1/0}function m4(i){return typeof i=="number"&&Number.isInteger(i)&&!Fa(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0="";function _4(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=wp(e)),e=y4(i.get(t),e);return wp(e)}function y4(i,e){let t=e;const n=i.length;for(let r=0;r<n;r++){const s=i.charAt(r);switch(s){case"\0":t+="";break;case h0:t+="";break;default:t+=s}}return t}function wp(i){return i+h0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ep(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Ui(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function d0(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pt=class du{constructor(e,t){this.comparator=e,this.root=t||xi.EMPTY}insert(e,t){return new du(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,xi.BLACK,null,null))}remove(e){return new du(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sa(this.root,e,this.comparator,!1)}getReverseIterator(){return new sa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sa(this.root,e,this.comparator,!0)}},sa=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},xi=class Gn{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??Gn.RED,this.left=r??Gn.EMPTY,this.right=s??Gn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new Gn(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Gn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Gn.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ee();const e=this.left.check();if(e!==this.right.check())throw Ee();return e+(this.isRed()?0:1)}};xi.EMPTY=null,xi.RED=!0,xi.BLACK=!1;xi.EMPTY=new class{constructor(){this.size=0}get key(){throw Ee()}get value(){throw Ee()}get color(){throw Ee()}get left(){throw Ee()}get right(){throw Ee()}copy(e,t,n,r,s){return this}insert(e,t,n){return new xi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xp(this.data.getIterator())}getIteratorFrom(e){return new xp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new yt(this.comparator);return t.data=e,t}}class xp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.fields=e,e.sort(At.comparator)}static empty(){return new rn([])}unionWith(e){let t=new yt(At.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new rn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return qr(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new f0("Invalid base64 string: "+s):s}}(e);return new Ct(t)}static fromUint8Array(e){const t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new Ct(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ct.EMPTY_BYTE_STRING=new Ct("");const v4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ti(i){if(Ke(!!i),typeof i=="string"){let e=0;const t=v4.exec(i);if(Ke(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ut(i.seconds),nanos:ut(i.nanos)}}function ut(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function ki(i){return typeof i=="string"?Ct.fromBase64String(i):Ct.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0="server_timestamp",g0="__type__",m0="__previous_value__",_0="__local_write_time__";function Ah(i){var e,t;return((t=(((e=i==null?void 0:i.mapValue)===null||e===void 0?void 0:e.fields)||{})[g0])===null||t===void 0?void 0:t.stringValue)===p0}function Tl(i){const e=i.mapValue.fields[m0];return Ah(e)?Tl(e):e}function go(i){const e=Ti(i.mapValue.fields[_0].timestampValue);return new ft(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,t,n,r,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const Ba="(default)";class mo{constructor(e,t){this.projectId=e,this.database=t||Ba}static empty(){return new mo("","")}get isDefaultDatabase(){return this.database===Ba}isEqual(e){return e instanceof mo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0="__type__",w4="__max__",oa={mapValue:{}},v0="__vector__",$a="value";function Ri(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?Ah(i)?4:x4(i)?9007199254740991:E4(i)?10:11:Ee()}function Fn(i,e){if(i===e)return!0;const t=Ri(i);if(t!==Ri(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return go(i).isEqual(go(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Ti(r.timestampValue),a=Ti(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(r,s){return ki(r.bytesValue).isEqual(ki(s.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(r,s){return ut(r.geoPointValue.latitude)===ut(s.geoPointValue.latitude)&&ut(r.geoPointValue.longitude)===ut(s.geoPointValue.longitude)}(i,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ut(r.integerValue)===ut(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=ut(r.doubleValue),a=ut(s.doubleValue);return o===a?Fa(o)===Fa(a):isNaN(o)&&isNaN(a)}return!1}(i,e);case 9:return qr(i.arrayValue.values||[],e.arrayValue.values||[],Fn);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(Ep(o)!==Ep(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Fn(o[l],a[l])))return!1;return!0}(i,e);default:return Ee()}}function _o(i,e){return(i.values||[]).find(t=>Fn(t,e))!==void 0}function Wr(i,e){if(i===e)return 0;const t=Ri(i),n=Ri(e);if(t!==n)return Re(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Re(i.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ut(s.integerValue||s.doubleValue),l=ut(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(i,e);case 3:return Ip(i.timestampValue,e.timestampValue);case 4:return Ip(go(i),go(e));case 5:return hu(i.stringValue,e.stringValue);case 6:return function(s,o){const a=ki(s),l=ki(o);return a.compareTo(l)}(i.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Re(a[c],l[c]);if(u!==0)return u}return Re(a.length,l.length)}(i.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Re(ut(s.latitude),ut(o.latitude));return a!==0?a:Re(ut(s.longitude),ut(o.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return Sp(i.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,u;const h=s.fields||{},d=o.fields||{},p=(a=h[$a])===null||a===void 0?void 0:a.arrayValue,g=(l=d[$a])===null||l===void 0?void 0:l.arrayValue,_=Re(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return _!==0?_:Sp(p,g)}(i.mapValue,e.mapValue);case 11:return function(s,o){if(s===oa.mapValue&&o===oa.mapValue)return 0;if(s===oa.mapValue)return 1;if(o===oa.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const d=hu(l[h],u[h]);if(d!==0)return d;const p=Wr(a[l[h]],c[u[h]]);if(p!==0)return p}return Re(l.length,u.length)}(i.mapValue,e.mapValue);default:throw Ee()}}function Ip(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return Re(i,e);const t=Ti(i),n=Ti(e),r=Re(t.seconds,n.seconds);return r!==0?r:Re(t.nanos,n.nanos)}function Sp(i,e){const t=i.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const s=Wr(t[r],n[r]);if(s)return s}return Re(t.length,n.length)}function Gr(i){return fu(i)}function fu(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){const n=Ti(t);return`time(${n.seconds},${n.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return ki(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return _e.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let n="[",r=!0;for(const s of t.values||[])r?r=!1:n+=",",n+=fu(s);return n+"]"}(i.arrayValue):"mapValue"in i?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of n)s?s=!1:r+=",",r+=`${o}:${fu(t.fields[o])}`;return r+"}"}(i.mapValue):Ee()}function ba(i){switch(Ri(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Tl(i);return e?16+ba(e):16;case 5:return 2*i.stringValue.length;case 6:return ki(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((r,s)=>r+ba(s),0)}(i.arrayValue);case 10:case 11:return function(n){let r=0;return Ui(n.fields,(s,o)=>{r+=s.length+ba(o)}),r}(i.mapValue);default:throw Ee()}}function Ap(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function pu(i){return!!i&&"integerValue"in i}function Ch(i){return!!i&&"arrayValue"in i}function Cp(i){return!!i&&"nullValue"in i}function Tp(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function wa(i){return!!i&&"mapValue"in i}function E4(i){var e,t;return((t=(((e=i==null?void 0:i.mapValue)===null||e===void 0?void 0:e.fields)||{})[y0])===null||t===void 0?void 0:t.stringValue)===v0}function Ws(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return Ui(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ws(n)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ws(i.arrayValue.values[t]);return e}return Object.assign({},i)}function x4(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===w4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.value=e}static empty(){return new Xt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!wa(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ws(t)}setAll(e){let t=At.emptyPath(),n={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,n,r),n={},r=[],t=a.popLast()}o?n[a.lastSegment()]=Ws(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());wa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];wa(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ui(t,(r,s)=>e[r]=s);for(const r of n)delete e[r]}clone(){return new Xt(Ws(this.value))}}function b0(i){const e=[];return Ui(i.fields,(t,n)=>{const r=new At([t]);if(wa(n)){const s=b0(n.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new rn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,t,n,r,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Mt(e,0,Ie.min(),Ie.min(),Ie.min(),Xt.empty(),0)}static newFoundDocument(e,t,n,r){return new Mt(e,1,t,Ie.min(),n,r,0)}static newNoDocument(e,t){return new Mt(e,2,t,Ie.min(),Ie.min(),Xt.empty(),0)}static newUnknownDocument(e,t){return new Mt(e,3,t,Ie.min(),Ie.min(),Xt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,t){this.position=e,this.inclusive=t}}function kp(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){const s=e[r],o=i.position[r];if(s.field.isKeyField()?n=_e.comparator(_e.fromName(o.referenceValue),t.key):n=Wr(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Rp(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Fn(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,t="asc"){this.field=e,this.dir=t}}function I4(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{}class dt extends w0{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new A4(e,t,n):t==="array-contains"?new k4(e,n):t==="in"?new R4(e,n):t==="not-in"?new N4(e,n):t==="array-contains-any"?new P4(e,n):new dt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new C4(e,n):new T4(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Wr(t,this.value)):t!==null&&Ri(this.value)===Ri(t)&&this.matchesComparison(Wr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends w0{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new In(e,t)}matches(e){return E0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function E0(i){return i.op==="and"}function x0(i){return S4(i)&&E0(i)}function S4(i){for(const e of i.filters)if(e instanceof In)return!1;return!0}function gu(i){if(i instanceof dt)return i.field.canonicalString()+i.op.toString()+Gr(i.value);if(x0(i))return i.filters.map(e=>gu(e)).join(",");{const e=i.filters.map(t=>gu(t)).join(",");return`${i.op}(${e})`}}function I0(i,e){return i instanceof dt?function(n,r){return r instanceof dt&&n.op===r.op&&n.field.isEqual(r.field)&&Fn(n.value,r.value)}(i,e):i instanceof In?function(n,r){return r instanceof In&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,o,a)=>s&&I0(o,r.filters[a]),!0):!1}(i,e):void Ee()}function S0(i){return i instanceof dt?function(t){return`${t.field.canonicalString()} ${t.op} ${Gr(t.value)}`}(i):i instanceof In?function(t){return t.op.toString()+" {"+t.getFilters().map(S0).join(" ,")+"}"}(i):"Filter"}class A4 extends dt{constructor(e,t,n){super(e,t,n),this.key=_e.fromName(n.referenceValue)}matches(e){const t=_e.comparator(e.key,this.key);return this.matchesComparison(t)}}class C4 extends dt{constructor(e,t){super(e,"in",t),this.keys=A0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class T4 extends dt{constructor(e,t){super(e,"not-in",t),this.keys=A0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function A0(i,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>_e.fromName(n.referenceValue))}class k4 extends dt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ch(t)&&_o(t.arrayValue,this.value)}}class R4 extends dt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&_o(this.value.arrayValue,t)}}class N4 extends dt{constructor(e,t){super(e,"not-in",t)}matches(e){if(_o(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!_o(this.value.arrayValue,t)}}class P4 extends dt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ch(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>_o(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e,t=null,n=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.le=null}}function Np(i,e=null,t=[],n=[],r=null,s=null,o=null){return new L4(i,e,t,n,r,s,o)}function Th(i){const e=Se(i);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>gu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Cl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Gr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Gr(n)).join(",")),e.le=t}return e.le}function kh(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!I4(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!I0(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!Rp(i.startAt,e.startAt)&&Rp(i.endAt,e.endAt)}function mu(i){return _e.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,t=null,n=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function M4(i,e,t,n,r,s,o,a){return new Co(i,e,t,n,r,s,o,a)}function kl(i){return new Co(i)}function Pp(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function C0(i){return i.collectionGroup!==null}function Gs(i){const e=Se(i);if(e.he===null){e.he=[];const t=new Set;for(const s of e.explicitOrderBy)e.he.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new yt(At.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.he.push(new Ha(s,n))}),t.has(At.keyField().canonicalString())||e.he.push(new Ha(At.keyField(),n))}return e.he}function On(i){const e=Se(i);return e.Pe||(e.Pe=O4(e,Gs(i))),e.Pe}function O4(i,e){if(i.limitType==="F")return Np(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new Ha(r.field,s)});const t=i.endAt?new za(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new za(i.startAt.position,i.startAt.inclusive):null;return Np(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function _u(i,e){const t=i.filters.concat([e]);return new Co(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function yu(i,e,t){return new Co(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function Rl(i,e){return kh(On(i),On(e))&&i.limitType===e.limitType}function T0(i){return`${Th(On(i))}|lt:${i.limitType}`}function Ar(i){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>S0(r)).join(", ")}]`),Cl(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>Gr(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>Gr(r)).join(",")),`Target(${n})`}(On(i))}; limitType=${i.limitType})`}function Nl(i,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):_e.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(i,e)&&function(n,r){for(const s of Gs(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(i,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(i,e)&&function(n,r){return!(n.startAt&&!function(o,a,l){const c=kp(o,a,l);return o.inclusive?c<=0:c<0}(n.startAt,Gs(n),r)||n.endAt&&!function(o,a,l){const c=kp(o,a,l);return o.inclusive?c>=0:c>0}(n.endAt,Gs(n),r))}(i,e)}function D4(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function k0(i){return(e,t)=>{let n=!1;for(const r of Gs(i)){const s=U4(r,e,t);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function U4(i,e,t){const n=i.field.isKeyField()?_e.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?Wr(l,c):Ee()}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Ee()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ui(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return d0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4=new pt(_e.comparator);function ii(){return V4}const R0=new pt(_e.comparator);function Ms(...i){let e=R0;for(const t of i)e=e.insert(t.key,t);return e}function N0(i){let e=R0;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Ki(){return Ks()}function P0(){return Ks()}function Ks(){return new cr(i=>i.toString(),(i,e)=>i.isEqual(e))}const F4=new pt(_e.comparator),B4=new yt(_e.comparator);function Pe(...i){let e=B4;for(const t of i)e=e.add(t);return e}const $4=new yt(Re);function z4(){return $4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rh(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fa(e)?"-0":e}}function L0(i){return{integerValue:""+i}}function H4(i,e){return m4(e)?L0(e):Rh(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(){this._=void 0}}function j4(i,e,t){return i instanceof ja?function(r,s){const o={fields:{[g0]:{stringValue:p0},[_0]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Ah(s)&&(s=Tl(s)),s&&(o.fields[m0]=s),{mapValue:o}}(t,e):i instanceof yo?O0(i,e):i instanceof vo?D0(i,e):function(r,s){const o=M0(r,s),a=Lp(o)+Lp(r.Ie);return pu(o)&&pu(r.Ie)?L0(a):Rh(r.serializer,a)}(i,e)}function q4(i,e,t){return i instanceof yo?O0(i,e):i instanceof vo?D0(i,e):t}function M0(i,e){return i instanceof qa?function(n){return pu(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class ja extends Pl{}class yo extends Pl{constructor(e){super(),this.elements=e}}function O0(i,e){const t=U0(e);for(const n of i.elements)t.some(r=>Fn(r,n))||t.push(n);return{arrayValue:{values:t}}}class vo extends Pl{constructor(e){super(),this.elements=e}}function D0(i,e){let t=U0(e);for(const n of i.elements)t=t.filter(r=>!Fn(r,n));return{arrayValue:{values:t}}}class qa extends Pl{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Lp(i){return ut(i.integerValue||i.doubleValue)}function U0(i){return Ch(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function W4(i,e){return i.field.isEqual(e.field)&&function(n,r){return n instanceof yo&&r instanceof yo||n instanceof vo&&r instanceof vo?qr(n.elements,r.elements,Fn):n instanceof qa&&r instanceof qa?Fn(n.Ie,r.Ie):n instanceof ja&&r instanceof ja}(i.transform,e.transform)}class G4{constructor(e,t){this.version=e,this.transformResults=t}}class bn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new bn}static exists(e){return new bn(void 0,e)}static updateTime(e){return new bn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ea(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class Ll{}function V0(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new Nh(i.key,bn.none()):new To(i.key,i.data,bn.none());{const t=i.data,n=Xt.empty();let r=new yt(At.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),r=r.add(s)}return new Vi(i.key,n,new rn(r.toArray()),bn.none())}}function K4(i,e,t){i instanceof To?function(r,s,o){const a=r.value.clone(),l=Op(r.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(i,e,t):i instanceof Vi?function(r,s,o){if(!Ea(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Op(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(F0(r)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(i,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ys(i,e,t,n){return i instanceof To?function(s,o,a,l){if(!Ea(s.precondition,o))return a;const c=s.value.clone(),u=Dp(s.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(i,e,t,n):i instanceof Vi?function(s,o,a,l){if(!Ea(s.precondition,o))return a;const c=Dp(s.fieldTransforms,l,o),u=o.data;return u.setAll(F0(s)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(i,e,t,n):function(s,o,a){return Ea(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(i,e,t)}function Y4(i,e){let t=null;for(const n of i.fieldTransforms){const r=e.data.field(n.field),s=M0(n.transform,r||null);s!=null&&(t===null&&(t=Xt.empty()),t.set(n.field,s))}return t||null}function Mp(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&qr(n,r,(s,o)=>W4(s,o))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class To extends Ll{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Vi extends Ll{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function F0(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}}),e}function Op(i,e,t){const n=new Map;Ke(i.length===t.length);for(let r=0;r<t.length;r++){const s=i[r],o=s.transform,a=e.data.field(s.field);n.set(s.field,q4(o,a,t[r]))}return n}function Dp(i,e,t){const n=new Map;for(const r of i){const s=r.transform,o=t.data.field(r.field);n.set(r.field,j4(s,o,e))}return n}class Nh extends Ll{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class X4 extends Ll{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&K4(s,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ys(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ys(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=P0();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const l=V0(o,a);l!==null&&n.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(Ie.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Pe())}isEqual(e){return this.batchId===e.batchId&&qr(this.mutations,e.mutations,(t,n)=>Mp(t,n))&&qr(this.baseMutations,e.baseMutations,(t,n)=>Mp(t,n))}}class Ph{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ke(e.mutations.length===n.length);let r=function(){return F4}();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,n[o].version);return new Ph(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht,Ue;function e6(i){switch(i){case q.OK:return Ee();case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0;default:return Ee()}}function B0(i){if(i===void 0)return ni("GRPC error has no .code"),q.UNKNOWN;switch(i){case ht.OK:return q.OK;case ht.CANCELLED:return q.CANCELLED;case ht.UNKNOWN:return q.UNKNOWN;case ht.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case ht.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case ht.INTERNAL:return q.INTERNAL;case ht.UNAVAILABLE:return q.UNAVAILABLE;case ht.UNAUTHENTICATED:return q.UNAUTHENTICATED;case ht.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case ht.NOT_FOUND:return q.NOT_FOUND;case ht.ALREADY_EXISTS:return q.ALREADY_EXISTS;case ht.PERMISSION_DENIED:return q.PERMISSION_DENIED;case ht.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case ht.ABORTED:return q.ABORTED;case ht.OUT_OF_RANGE:return q.OUT_OF_RANGE;case ht.UNIMPLEMENTED:return q.UNIMPLEMENTED;case ht.DATA_LOSS:return q.DATA_LOSS;default:return Ee()}}(Ue=ht||(ht={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6=new Ei([4294967295,4294967295],0);function Up(i){const e=c0().encode(i),t=new n0;return t.update(e),new Uint8Array(t.digest())}function Vp(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ei([t,n],0),new Ei([r,s],0)]}class Lh{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Os(`Invalid padding: ${t}`);if(n<0)throw new Os(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Os(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Os(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=Ei.fromNumber(this.Ee)}Ae(e,t,n){let r=e.add(t.multiply(Ei.fromNumber(n)));return r.compare(t6)===1&&(r=new Ei([r.getBits(0),r.getBits(1)],0)),r.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=Up(e),[n,r]=Vp(t);for(let s=0;s<this.hashCount;s++){const o=this.Ae(n,r,s);if(!this.Re(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Lh(s,r,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.Ee===0)return;const t=Up(e),[n,r]=Vp(t);for(let s=0;s<this.hashCount;s++){const o=this.Ae(n,r,s);this.Ve(o)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Os extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ko.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Ml(Ie.min(),r,new pt(Re),ii(),Pe())}}class ko{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ko(n,t,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,t,n,r){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=r}}class $0{constructor(e,t){this.targetId=e,this.ge=t}}class z0{constructor(e,t,n=Ct.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Fp{constructor(){this.pe=0,this.ye=Bp(),this.we=Ct.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=Pe(),t=Pe(),n=Pe();return this.ye.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ee()}}),new ko(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=Bp()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Ke(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class n6{constructor(e){this.ke=e,this.qe=new Map,this.Qe=ii(),this.$e=aa(),this.Ue=aa(),this.Ke=new pt(Re)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:Ee()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,r)=>{this.Je(r)&&t(r)})}Ze(e){const t=e.targetId,n=e.ge.count,r=this.Xe(t);if(r){const s=r.target;if(mu(s))if(n===0){const o=new _e(s.path);this.ze(t,o,Mt.newNoDocument(o,Ie.min()))}else Ke(n===1);else{const o=this.et(t);if(o!==n){const a=this.tt(e),l=a?this.nt(a,e,o):1;if(l!==0){this.Ye(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,c)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=ki(n).toUint8Array()}catch(l){if(l instanceof f0)return jr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Lh(o,r,s)}catch(l){return jr(l instanceof Os?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let r=0;return n.forEach(s=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.ze(t,s,null),r++)}),r}ot(e){const t=new Map;this.qe.forEach((s,o)=>{const a=this.Xe(o);if(a){if(s.current&&mu(a.target)){const l=new _e(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,Mt.newNoDocument(l,e))}s.ve&&(t.set(o,s.Fe()),s.Me())}});let n=Pe();this.Ue.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(s))}),this.Qe.forEach((s,o)=>o.setReadTime(e));const r=new Ml(e,t,this.Ke,this.Qe,n);return this.Qe=ii(),this.$e=aa(),this.Ue=aa(),this.Ke=new pt(Re),r}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const r=this.He(e);this.ut(e,t)?r.xe(t,1):r.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Fp,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new yt(Re),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new yt(Re),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||ue("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Fp),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function aa(){return new pt(_e.comparator)}function Bp(){return new pt(_e.comparator)}const i6={asc:"ASCENDING",desc:"DESCENDING"},r6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},s6={and:"AND",or:"OR"};class o6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vu(i,e){return i.useProto3Json||Cl(e)?e:{value:e}}function Wa(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function H0(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function a6(i,e){return Wa(i,e.toTimestamp())}function Dn(i){return Ke(!!i),Ie.fromTimestamp(function(t){const n=Ti(t);return new ft(n.seconds,n.nanos)}(i))}function Mh(i,e){return bu(i,e).canonicalString()}function bu(i,e){const t=function(r){return new rt(["projects",r.projectId,"databases",r.database])}(i).child("documents");return e===void 0?t:t.child(e)}function j0(i){const e=rt.fromString(i);return Ke(Y0(e)),e}function wu(i,e){return Mh(i.databaseId,e.path)}function Tc(i,e){const t=j0(e);if(t.get(1)!==i.databaseId.projectId)throw new de(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new de(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new _e(W0(t))}function q0(i,e){return Mh(i.databaseId,e)}function l6(i){const e=j0(i);return e.length===4?rt.emptyPath():W0(e)}function Eu(i){return new rt(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function W0(i){return Ke(i.length>4&&i.get(4)==="documents"),i.popFirst(5)}function $p(i,e,t){return{name:wu(i,e),fields:t.value.mapValue.fields}}function c6(i,e){let t;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(Ke(u===void 0||typeof u=="string"),Ct.fromBase64String(u||"")):(Ke(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Ct.fromUint8Array(u||new Uint8Array))}(i,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?q.UNKNOWN:B0(c.code);return new de(u,c.message||"")}(o);t=new z0(n,r,s,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=Tc(i,n.document.name),s=Dn(n.document.updateTime),o=n.document.createTime?Dn(n.document.createTime):Ie.min(),a=new Xt({mapValue:{fields:n.document.fields}}),l=Mt.newFoundDocument(r,s,o,a),c=n.targetIds||[],u=n.removedTargetIds||[];t=new xa(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=Tc(i,n.document),s=n.readTime?Dn(n.readTime):Ie.min(),o=Mt.newNoDocument(r,s),a=n.removedTargetIds||[];t=new xa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=Tc(i,n.document),s=n.removedTargetIds||[];t=new xa([],s,r,null)}else{if(!("filter"in e))return Ee();{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:s}=n,o=new Z4(r,s),a=n.targetId;t=new $0(a,o)}}return t}function u6(i,e){let t;if(e instanceof To)t={update:$p(i,e.key,e.value)};else if(e instanceof Nh)t={delete:wu(i,e.key)};else if(e instanceof Vi)t={update:$p(i,e.key,e.data),updateMask:v6(e.fieldMask)};else{if(!(e instanceof X4))return Ee();t={verify:wu(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const a=o.transform;if(a instanceof ja)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof yo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof vo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof qa)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw Ee()}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:a6(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ee()}(i,e.precondition)),t}function h6(i,e){return i&&i.length>0?(Ke(e!==void 0),i.map(t=>function(r,s){let o=r.updateTime?Dn(r.updateTime):Dn(s);return o.isEqual(Ie.min())&&(o=Dn(s)),new G4(o,r.transformResults||[])}(t,e))):[]}function d6(i,e){return{documents:[q0(i,e.path)]}}function f6(i,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=q0(i,r);const s=function(c){if(c.length!==0)return K0(In.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:Cr(d.field),direction:m6(d.dir)}}(u))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=vu(i,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ht:t,parent:r}}function p6(i){let e=l6(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){Ke(n===1);const u=t.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=function(h){const d=G0(h);return d instanceof In&&x0(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(d=>function(g){return new Ha(Tr(g.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(t.orderBy));let a=null;t.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,Cl(d)?null:d}(t.limit));let l=null;t.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new za(p,d)}(t.startAt));let c=null;return t.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new za(p,d)}(t.endAt)),M4(e,r,o,s,a,"F",l,c)}function g6(i,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ee()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function G0(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Tr(t.unaryFilter.field);return dt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Tr(t.unaryFilter.field);return dt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Tr(t.unaryFilter.field);return dt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Tr(t.unaryFilter.field);return dt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ee()}}(i):i.fieldFilter!==void 0?function(t){return dt.create(Tr(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ee()}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return In.create(t.compositeFilter.filters.map(n=>G0(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ee()}}(t.compositeFilter.op))}(i):Ee()}function m6(i){return i6[i]}function _6(i){return r6[i]}function y6(i){return s6[i]}function Cr(i){return{fieldPath:i.canonicalString()}}function Tr(i){return At.fromServerFormat(i.fieldPath)}function K0(i){return i instanceof dt?function(t){if(t.op==="=="){if(Tp(t.value))return{unaryFilter:{field:Cr(t.field),op:"IS_NAN"}};if(Cp(t.value))return{unaryFilter:{field:Cr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Tp(t.value))return{unaryFilter:{field:Cr(t.field),op:"IS_NOT_NAN"}};if(Cp(t.value))return{unaryFilter:{field:Cr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cr(t.field),op:_6(t.op),value:t.value}}}(i):i instanceof In?function(t){const n=t.getFilters().map(r=>K0(r));return n.length===1?n[0]:{compositeFilter:{op:y6(t.op),filters:n}}}(i):Ee()}function v6(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Y0(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,n,r,s=Ie.min(),o=Ie.min(),a=Ct.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e){this.Tt=e}}function w6(i){const e=p6({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?yu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(){this.Tn=new x6}addToCollectionParentIndex(e,t){return this.Tn.add(t),j.resolve()}getCollectionParents(e,t){return j.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return j.resolve()}deleteFieldIndex(e,t){return j.resolve()}deleteAllFieldIndexes(e){return j.resolve()}createTargetIndexes(e,t){return j.resolve()}getDocumentsMatchingTarget(e,t){return j.resolve(null)}getIndexType(e,t){return j.resolve(0)}getFieldIndexes(e,t){return j.resolve([])}getNextCollectionGroupToUpdate(e){return j.resolve(null)}getMinOffset(e,t){return j.resolve(Ci.min())}getMinOffsetFromCollectionGroup(e,t){return j.resolve(Ci.min())}updateCollectionGroup(e,t,n){return j.resolve()}updateIndexEntries(e,t){return j.resolve()}}class x6{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new yt(rt.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new yt(rt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},X0=41943040;class Yt{static withCacheSize(e){return new Yt(e,Yt.DEFAULT_COLLECTION_PERCENTILE,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yt.DEFAULT_COLLECTION_PERCENTILE=10,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yt.DEFAULT=new Yt(X0,Yt.DEFAULT_COLLECTION_PERCENTILE,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yt.DISABLED=new Yt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new Kr(0)}static Kn(){return new Kr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp="LruGarbageCollector",I6=1048576;function jp([i,e],[t,n]){const r=Re(i,t);return r===0?Re(e,n):r}class S6{constructor(e){this.Hn=e,this.buffer=new yt(jp),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();jp(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class A6{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){ue(Hp,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){os(t)?ue(Hp,"Ignoring IndexedDB error during garbage collection: ",t):await ss(t)}await this.er(3e5)})}}class C6{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return j.resolve(Al.ae);const n=new S6(t);return this.tr.forEachTarget(e,r=>n.Zn(r.sequenceNumber)).next(()=>this.tr.rr(e,r=>n.Zn(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ue("LruGarbageCollector","Garbage collection skipped; disabled"),j.resolve(zp)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zp):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,r,s,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(n=h,a=Date.now(),this.removeTargets(e,n,t))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(c=Date.now(),Sr()<=Ne.DEBUG&&ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),j.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:h})))}}function T6(i,e){return new C6(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(){this.changes=new cr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?j.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Ys(n.mutation,r,rn.empty(),ft.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Pe()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Pe()){const r=Ki();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(s=>{let o=Ms();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Ki();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Pe()))}populateOverlays(e,t,n){const r=[];return n.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,r){let s=ii();const o=Ks(),a=function(){return Ks()}();return t.forEach((l,c)=>{const u=n.get(c.key);r.has(c.key)&&(u===void 0||u.mutation instanceof Vi)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Ys(u.mutation,c,u.mutation.getFieldMask(),ft.now())):o.set(c.key,rn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>{var h;return a.set(c,new R6(u,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){const n=Ks();let r=new pt((o,a)=>o-a),s=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=n.get(l)||rn.empty();u=a.applyToLocalView(c,u),n.set(l,u);const h=(r.get(a.batchId)||Pe()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=P0();u.forEach(d=>{if(!s.has(d)){const p=V0(t.get(d),n.get(d));p!==null&&h.set(d,p),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return j.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(o){return _e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):C0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):j.resolve(Ki());let a=po,l=s;return o.next(c=>j.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?j.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Pe())).next(u=>({batchId:a,changes:N0(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _e(t)).next(n=>{let r=Ms();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let o=Ms();return this.indexManager.getCollectionParents(e,s).next(a=>j.forEach(a,l=>{const c=function(h,d){return new Co(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,r).next(u=>{u.forEach((h,d)=>{o=o.insert(h,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(o=>{s.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Mt.newInvalidDocument(u)))});let a=Ms();return o.forEach((l,c)=>{const u=s.get(l);u!==void 0&&Ys(u.mutation,c,rn.empty(),ft.now()),Nl(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return j.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Dn(r.createTime)}}(t)),j.resolve()}getNamedQuery(e,t){return j.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(r){return{name:r.name,query:w6(r.bundledQuery),readTime:Dn(r.readTime)}}(t)),j.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(){this.overlays=new pt(_e.comparator),this.Rr=new Map}getOverlay(e,t){return j.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ki();return j.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,s)=>{this.Et(e,t,s)}),j.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Rr.get(n);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Rr.delete(n)),j.resolve()}getOverlaysForCollection(e,t,n){const r=Ki(),s=t.length+1,o=new _e(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&r.set(l.getKey(),l)}return j.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new pt((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>n){let u=s.get(c.largestBatchId);u===null&&(u=Ki(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=Ki(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=r)););return j.resolve(a)}Et(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.Rr.get(r.largestBatchId).delete(n.key);this.Rr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new J4(t,n));let s=this.Rr.get(t);s===void 0&&(s=Pe(),this.Rr.set(t,s)),this.Rr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(){this.sessionToken=Ct.EMPTY_BYTE_STRING}getSessionToken(e){return j.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,j.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(){this.Vr=new yt(bt.mr),this.gr=new yt(bt.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new bt(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new bt(e,t))}Sr(e,t){e.forEach(n=>this.removeReference(n,t))}br(e){const t=new _e(new rt([])),n=new bt(t,e),r=new bt(t,e+1),s=[];return this.gr.forEachInRange([n,r],o=>{this.wr(o),s.push(o.key)}),s}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new _e(new rt([])),n=new bt(t,e),r=new bt(t,e+1);let s=Pe();return this.gr.forEachInRange([n,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new bt(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class bt{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return _e.comparator(e.key,t.key)||Re(e.Cr,t.Cr)}static pr(e,t){return Re(e.Cr,t.Cr)||_e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new yt(bt.mr)}checkEmpty(e){return j.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const s=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Q4(s,t,n,r);this.mutationQueue.push(o);for(const a of r)this.Mr=this.Mr.add(new bt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return j.resolve(o)}lookupMutationBatch(e,t){return j.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Nr(n),s=r<0?0:r;return j.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return j.resolve(this.mutationQueue.length===0?Sh:this.Fr-1)}getAllMutationBatches(e){return j.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new bt(t,0),r=new bt(t,Number.POSITIVE_INFINITY),s=[];return this.Mr.forEachInRange([n,r],o=>{const a=this.Or(o.Cr);s.push(a)}),j.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new yt(Re);return t.forEach(r=>{const s=new bt(r,0),o=new bt(r,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([s,o],a=>{n=n.add(a.Cr)})}),j.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;_e.isDocumentKey(s)||(s=s.child(""));const o=new bt(new _e(s),0);let a=new yt(Re);return this.Mr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.Cr)),!0)},o),j.resolve(this.Br(a))}Br(e){const t=[];return e.forEach(n=>{const r=this.Or(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Ke(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return j.forEach(t.mutations,r=>{const s=new bt(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){const n=new bt(t,0),r=this.Mr.firstAfterOrEqual(n);return j.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,j.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{constructor(e){this.kr=e,this.docs=function(){return new pt(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,o=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return j.resolve(n?n.document.mutableCopy():Mt.newInvalidDocument(t))}getEntries(e,t){let n=ii();return t.forEach(r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():Mt.newInvalidDocument(r))}),j.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=ii();const o=t.path,a=new _e(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||d4(h4(u),n)<=0||(r.has(u.key)||Nl(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return j.resolve(s)}getAllFromCollectionGroup(e,t,n,r){Ee()}qr(e,t){return j.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new U6(this)}getSize(e){return j.resolve(this.size)}}class U6 extends k6{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Ir.addEntry(e,r)):this.Ir.removeEntry(n)}),j.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e){this.persistence=e,this.Qr=new cr(t=>Th(t),kh),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.$r=0,this.Ur=new Oh,this.targetCount=0,this.Kr=Kr.Un()}forEachTarget(e,t){return this.Qr.forEach((n,r)=>t(r)),j.resolve()}getLastRemoteSnapshotVersion(e){return j.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return j.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),j.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),j.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new Kr(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,j.resolve()}updateTargetData(e,t){return this.zn(t),j.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,j.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=t&&n.get(a.targetId)===null&&(this.Qr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),j.waitFor(s).next(()=>r)}getTargetCount(e){return j.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return j.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),j.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),j.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),j.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return j.resolve(n)}containsKey(e,t){return j.resolve(this.Ur.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Al(0),this.zr=!1,this.zr=!0,this.jr=new M6,this.referenceDelegate=e(this),this.Hr=new V6(this),this.indexManager=new E6,this.remoteDocumentCache=function(r){return new D6(r)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new b6(t),this.Yr=new P6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new L6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new O6(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){ue("MemoryPersistence","Starting transaction:",e);const r=new F6(this.Gr.next());return this.referenceDelegate.Zr(),n(r).next(s=>this.referenceDelegate.Xr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}ei(e,t){return j.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}}class F6 extends p4{constructor(e){super(),this.currentSequenceNumber=e}}class Dh{constructor(e){this.persistence=e,this.ti=new Oh,this.ni=null}static ri(e){return new Dh(e)}get ii(){if(this.ni)return this.ni;throw Ee()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),j.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),j.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),j.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(r=>this.ii.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.ii.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return j.forEach(this.ii,n=>{const r=_e.fromPath(n);return this.si(e,r).next(s=>{s||t.removeEntry(r,Ie.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return j.or([()=>j.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Ga{constructor(e,t){this.persistence=e,this.oi=new cr(n=>_4(n.path),(n,r)=>n.isEqual(r)),this.garbageCollector=T6(this,t)}static ri(e,t){return new Ga(e,t)}Zr(){}Xr(e){return j.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return j.forEach(this.oi,(n,r)=>this.ar(e,n,r).next(s=>s?j.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.qr(e,o=>this.ar(e,o,t).next(a=>{a||(n++,s.removeEntry(o,Ie.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),j.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),j.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),j.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),j.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ba(e.data.value)),t}ar(e,t,n){return j.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.oi.get(t);return j.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=r}static Yi(e,t){let n=Pe(),r=Pe();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Uh(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return L5()?8:g4(En())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.rs(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ss(e,t,r,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new B6;return this._s(e,t,o).next(a=>{if(s.result=a,this.Xi)return this.us(e,t,o,a.size)})}).next(()=>s.result)}us(e,t,n,r){return n.documentReadCount<this.es?(Sr()<=Ne.DEBUG&&ue("QueryEngine","SDK will not create cache indexes for query:",Ar(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),j.resolve()):(Sr()<=Ne.DEBUG&&ue("QueryEngine","Query:",Ar(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ts*r?(Sr()<=Ne.DEBUG&&ue("QueryEngine","The SDK decides to create cache indexes for query:",Ar(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,On(t))):j.resolve())}rs(e,t){if(Pp(t))return j.resolve(null);let n=On(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=yu(t,null,"F"),n=On(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Pe(...s);return this.ns.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.cs(t,a);return this.ls(t,c,o,l.readTime)?this.rs(e,yu(t,null,"F")):this.hs(e,c,t,l)}))})))}ss(e,t,n,r){return Pp(t)||r.isEqual(Ie.min())?j.resolve(null):this.ns.getDocuments(e,n).next(s=>{const o=this.cs(t,s);return this.ls(t,o,n,r)?j.resolve(null):(Sr()<=Ne.DEBUG&&ue("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ar(t)),this.hs(e,o,t,u4(r,po)).next(a=>a))})}cs(e,t){let n=new yt(k0(e));return t.forEach((r,s)=>{Nl(e,s)&&(n=n.add(s))}),n}ls(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}_s(e,t,n){return Sr()<=Ne.DEBUG&&ue("QueryEngine","Using full collection scan to execute query:",Ar(t)),this.ns.getDocumentsMatchingQuery(e,t,Ci.min(),n)}hs(e,t,n,r){return this.ns.getDocumentsMatchingQuery(e,n,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh="LocalStore",z6=3e8;class H6{constructor(e,t,n,r){this.persistence=e,this.Ps=t,this.serializer=r,this.Ts=new pt(Re),this.Is=new cr(s=>Th(s),kh),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new N6(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function j6(i,e,t,n){return new H6(i,e,t,n)}async function J0(i,e){const t=Se(i);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(s=>(r=s,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let l=Pe();for(const c of r){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(n,l).next(c=>({Rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function q6(i,e){const t=Se(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),s=t.ds.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const h=c.batch,d=h.keys();let p=j.resolve();return d.forEach(g=>{p=p.next(()=>u.getEntry(l,g)).next(_=>{const v=c.docVersions.get(g);Ke(v!==null),_.version.compareTo(v)<0&&(h.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),u.addEntry(_)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let l=Pe();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function Z0(i){const e=Se(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function W6(i,e){const t=Se(i),n=e.snapshotVersion;let r=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ds.newChangeBuffer({trackRemovals:!0});r=t.Ts;const a=[];e.targetChanges.forEach((u,h)=>{const d=r.get(h);if(!d)return;a.push(t.Hr.removeMatchingKeys(s,u.removedDocuments,h).next(()=>t.Hr.addMatchingKeys(s,u.addedDocuments,h)));let p=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Ct.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),r=r.insert(h,p),function(_,v,C){return _.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=z6?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(d,p,u)&&a.push(t.Hr.updateTargetData(s,p))});let l=ii(),c=Pe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(G6(s,o,e.documentUpdates).next(u=>{l=u.Vs,c=u.fs})),!n.isEqual(Ie.min())){const u=t.Hr.getLastRemoteSnapshotVersion(s).next(h=>t.Hr.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(u)}return j.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(t.Ts=r,s))}function G6(i,e,t){let n=Pe(),r=Pe();return t.forEach(s=>n=n.add(s)),e.getEntries(i,n).next(s=>{let o=ii();return t.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Ie.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ue(Vh,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Vs:o,fs:r}})}function K6(i,e){const t=Se(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Sh),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Y6(i,e){const t=Se(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Hr.getTargetData(n,e).next(s=>s?(r=s,j.resolve(r)):t.Hr.allocateTargetId(n).next(o=>(r=new yi(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.Ts.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}async function xu(i,e,t){const n=Se(i),r=n.Ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!os(o))throw o;ue(Vh,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ts=n.Ts.remove(e),n.Is.delete(r.target)}function qp(i,e,t){const n=Se(i);let r=Ie.min(),s=Pe();return n.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const h=Se(l),d=h.Is.get(u);return d!==void 0?j.resolve(h.Ts.get(d)):h.Hr.getTargetData(c,u)}(n,o,On(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>n.Ps.getDocumentsMatchingQuery(o,e,t?r:Ie.min(),t?s:Pe())).next(a=>(X6(n,D4(e),a),{documents:a,gs:s})))}function X6(i,e,t){let n=i.Es.get(e)||Ie.min();t.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),i.Es.set(e,n)}class Wp{constructor(){this.activeTargetIds=z4()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Q6{constructor(){this.ho=new Wp,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Wp,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="ConnectivityMonitor";class Kp{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){ue(Gp,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){ue(Gp,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let la=null;function Iu(){return la===null?la=function(){return 268435456+Math.round(2147483648*Math.random())}():la++,"0x"+la.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kc="RestConnection",Z6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class e7{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${r}`,this.wo=this.databaseId.database===Ba?`project_id=${n}`:`project_id=${n}&database_id=${r}`}So(e,t,n,r,s){const o=Iu(),a=this.bo(e,t.toUriEncodedString());ue(kc,`Sending RPC '${e}' ${o}:`,a,n);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,r,s),this.vo(e,a,l,n).then(c=>(ue(kc,`Received RPC '${e}' ${o}: `,c),c),c=>{throw jr(kc,`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",n),c})}Co(e,t,n,r,s,o){return this.So(e,t,n,r,s)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rs}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),n&&n.headers.forEach((r,s)=>e[s]=r)}bo(e,t){const n=Z6[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rt="WebChannelConnection";class n7 extends e7{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,r){const s=Iu();return new Promise((o,a)=>{const l=new i0;l.setWithCredentials(!0),l.listenOnce(r0.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case va.NO_ERROR:const u=l.getResponseJson();ue(Rt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case va.TIMEOUT:ue(Rt,`RPC '${e}' ${s} timed out`),a(new de(q.DEADLINE_EXCEEDED,"Request time out"));break;case va.HTTP_ERROR:const h=l.getStatus();if(ue(Rt,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const g=function(v){const C=v.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(C)>=0?C:q.UNKNOWN}(p.status);a(new de(g,p.message))}else a(new de(q.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new de(q.UNAVAILABLE,"Connection failed."));break;default:Ee()}}finally{ue(Rt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(r);ue(Rt,`RPC '${e}' ${s} sending request:`,r),l.send(t,"POST",c,n,15)})}Wo(e,t,n){const r=Iu(),s=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=a0(),a=o0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const u=s.join("");ue(Rt,`Creating RPC '${e}' stream ${r}: ${u}`,l);const h=o.createWebChannel(u,l);let d=!1,p=!1;const g=new t7({Fo:v=>{p?ue(Rt,`Not sending because RPC '${e}' stream ${r} is closed:`,v):(d||(ue(Rt,`Opening RPC '${e}' stream ${r} transport.`),h.open(),d=!0),ue(Rt,`RPC '${e}' stream ${r} sending:`,v),h.send(v))},Mo:()=>h.close()}),_=(v,C,T)=>{v.listen(C,y=>{try{T(y)}catch(A){setTimeout(()=>{throw A},0)}})};return _(h,Ls.EventType.OPEN,()=>{p||(ue(Rt,`RPC '${e}' stream ${r} transport opened.`),g.Qo())}),_(h,Ls.EventType.CLOSE,()=>{p||(p=!0,ue(Rt,`RPC '${e}' stream ${r} transport closed`),g.Uo())}),_(h,Ls.EventType.ERROR,v=>{p||(p=!0,jr(Rt,`RPC '${e}' stream ${r} transport errored:`,v),g.Uo(new de(q.UNAVAILABLE,"The operation could not be completed")))}),_(h,Ls.EventType.MESSAGE,v=>{var C;if(!p){const T=v.data[0];Ke(!!T);const y=T,A=(y==null?void 0:y.error)||((C=y[0])===null||C===void 0?void 0:C.error);if(A){ue(Rt,`RPC '${e}' stream ${r} received error:`,A);const E=A.status;let x=function(I){const k=ht[I];if(k!==void 0)return B0(k)}(E),w=A.message;x===void 0&&(x=q.INTERNAL,w="Unknown error status: "+E+" with message "+A.message),p=!0,g.Uo(new de(x,w)),h.close()}else ue(Rt,`RPC '${e}' stream ${r} received:`,T),g.Ko(T)}}),_(a,s0.STAT_EVENT,v=>{v.stat===uu.PROXY?ue(Rt,`RPC '${e}' stream ${r} detected buffering proxy`):v.stat===uu.NOPROXY&&ue(Rt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{g.$o()},0),g}}function Rc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ol(i){return new o6(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e,t,n=1e3,r=1.5,s=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=r,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),r=Math.max(0,t-n);r>0&&ue("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="PersistentStream";class t_{constructor(e,t,n,r,s,o,a,l){this.Ti=e,this.n_=n,this.r_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new e_(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===q.RESOURCE_EXHAUSTED?(ni(t.toString()),ni("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.i_===t&&this.V_(n,r)},n=>{e(()=>{const r=new de(q.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(r)})})}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(r=>{n(()=>this.m_(r))}),this.stream.onMessage(r=>{n(()=>++this.__==1?this.g_(r):this.onNext(r))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return ue(Yp,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(ue(Yp,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class i7 extends t_{constructor(e,t,n,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=c6(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ie.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ie.min():o.readTime?Dn(o.readTime):Ie.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Eu(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=mu(l)?{documents:d6(s,l)}:{query:f6(s,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=H0(s,o.resumeToken);const c=vu(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Ie.min())>0){a.readTime=Wa(s,o.snapshotVersion.toTimestamp());const c=vu(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const n=g6(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Eu(this.serializer),t.removeTarget=e,this.I_(t)}}class r7 extends t_{constructor(e,t,n,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return Ke(!!e.streamToken),this.lastStreamToken=e.streamToken,Ke(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){Ke(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=h6(e.writeResults,e.commitTime),n=Dn(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Eu(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>u6(this.serializer,n))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s7{}class o7 extends s7{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.F_=!1}M_(){if(this.F_)throw new de(q.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,bu(t,n),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new de(q.UNKNOWN,s.toString())})}Co(e,t,n,r,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(e,bu(t,n),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new de(q.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class a7{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(ni(t),this.N_=!1):ue("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr="RemoteStore";class l7{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=s,this.z_.To(o=>{n.enqueueAndForget(async()=>{ur(this)&&(ue(nr,"Restarting streams for network reachability change."),await async function(l){const c=Se(l);c.W_.add(4),await Ro(c),c.j_.set("Unknown"),c.W_.delete(4),await Dl(c)}(this))})}),this.j_=new a7(n,r)}}async function Dl(i){if(ur(i))for(const e of i.G_)await e(!0)}async function Ro(i){for(const e of i.G_)await e(!1)}function n_(i,e){const t=Se(i);t.K_.has(e.targetId)||(t.K_.set(e.targetId,e),zh(t)?$h(t):as(t).c_()&&Bh(t,e))}function Fh(i,e){const t=Se(i),n=as(t);t.K_.delete(e),n.c_()&&i_(t,e),t.K_.size===0&&(n.c_()?n.P_():ur(t)&&t.j_.set("Unknown"))}function Bh(i,e){if(i.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}as(i).y_(e)}function i_(i,e){i.H_.Ne(e),as(i).w_(e)}function $h(i){i.H_=new n6({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>i.K_.get(e)||null,it:()=>i.datastore.serializer.databaseId}),as(i).start(),i.j_.B_()}function zh(i){return ur(i)&&!as(i).u_()&&i.K_.size>0}function ur(i){return Se(i).W_.size===0}function r_(i){i.H_=void 0}async function c7(i){i.j_.set("Online")}async function u7(i){i.K_.forEach((e,t)=>{Bh(i,e)})}async function h7(i,e){r_(i),zh(i)?(i.j_.q_(e),$h(i)):i.j_.set("Unknown")}async function d7(i,e,t){if(i.j_.set("Online"),e instanceof z0&&e.state===2&&e.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.K_.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.K_.delete(a),r.H_.removeTarget(a))}(i,e)}catch(n){ue(nr,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ka(i,n)}else if(e instanceof xa?i.H_.We(e):e instanceof $0?i.H_.Ze(e):i.H_.je(e),!t.isEqual(Ie.min()))try{const n=await Z0(i.localStore);t.compareTo(n)>=0&&await function(s,o){const a=s.H_.ot(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.K_.get(c);u&&s.K_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=s.K_.get(l);if(!u)return;s.K_.set(l,u.withResumeToken(Ct.EMPTY_BYTE_STRING,u.snapshotVersion)),i_(s,l);const h=new yi(u.target,l,c,u.sequenceNumber);Bh(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(i,t)}catch(n){ue(nr,"Failed to raise snapshot:",n),await Ka(i,n)}}async function Ka(i,e,t){if(!os(e))throw e;i.W_.add(1),await Ro(i),i.j_.set("Offline"),t||(t=()=>Z0(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{ue(nr,"Retrying IndexedDB access"),await t(),i.W_.delete(1),await Dl(i)})}function s_(i,e){return e().catch(t=>Ka(i,t,e))}async function Ul(i){const e=Se(i),t=Ni(e);let n=e.U_.length>0?e.U_[e.U_.length-1].batchId:Sh;for(;f7(e);)try{const r=await K6(e.localStore,n);if(r===null){e.U_.length===0&&t.P_();break}n=r.batchId,p7(e,r)}catch(r){await Ka(e,r)}o_(e)&&a_(e)}function f7(i){return ur(i)&&i.U_.length<10}function p7(i,e){i.U_.push(e);const t=Ni(i);t.c_()&&t.S_&&t.b_(e.mutations)}function o_(i){return ur(i)&&!Ni(i).u_()&&i.U_.length>0}function a_(i){Ni(i).start()}async function g7(i){Ni(i).C_()}async function m7(i){const e=Ni(i);for(const t of i.U_)e.b_(t.mutations)}async function _7(i,e,t){const n=i.U_.shift(),r=Ph.from(n,e,t);await s_(i,()=>i.remoteSyncer.applySuccessfulWrite(r)),await Ul(i)}async function y7(i,e){e&&Ni(i).S_&&await async function(n,r){if(function(o){return e6(o)&&o!==q.ABORTED}(r.code)){const s=n.U_.shift();Ni(n).h_(),await s_(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Ul(n)}}(i,e),o_(i)&&a_(i)}async function Xp(i,e){const t=Se(i);t.asyncQueue.verifyOperationInProgress(),ue(nr,"RemoteStore received new credentials");const n=ur(t);t.W_.add(3),await Ro(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await Dl(t)}async function v7(i,e){const t=Se(i);e?(t.W_.delete(2),await Dl(t)):e||(t.W_.add(2),await Ro(t),t.j_.set("Unknown"))}function as(i){return i.J_||(i.J_=function(t,n,r){const s=Se(t);return s.M_(),new i7(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{xo:c7.bind(null,i),No:u7.bind(null,i),Lo:h7.bind(null,i),p_:d7.bind(null,i)}),i.G_.push(async e=>{e?(i.J_.h_(),zh(i)?$h(i):i.j_.set("Unknown")):(await i.J_.stop(),r_(i))})),i.J_}function Ni(i){return i.Y_||(i.Y_=function(t,n,r){const s=Se(t);return s.M_(),new r7(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{xo:()=>Promise.resolve(),No:g7.bind(null,i),Lo:y7.bind(null,i),D_:m7.bind(null,i),v_:_7.bind(null,i)}),i.G_.push(async e=>{e?(i.Y_.h_(),await Ul(i)):(await i.Y_.stop(),i.U_.length>0&&(ue(nr,`Stopping write stream with ${i.U_.length} pending writes`),i.U_=[]))})),i.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new Zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const o=Date.now()+n,a=new Hh(e,t,o,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jh(i,e){if(ni("AsyncQueue",`${e}: ${i}`),os(i))return new de(q.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{static emptySet(e){return new Dr(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||_e.comparator(t.key,n.key):(t,n)=>_e.comparator(t.key,n.key),this.keyedMap=Ms(),this.sortedSet=new pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Dr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Dr;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(){this.Z_=new pt(_e.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):Ee():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}}class Yr{constructor(e,t,n,r,s,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Yr(e,t,Dr.emptySet(t),o,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Rl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class w7{constructor(){this.queries=Jp(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){const r=Se(t),s=r.queries;r.queries=Jp(),s.forEach((o,a)=>{for(const l of a.ta)l.onError(n)})})(this,new de(q.ABORTED,"Firestore shutting down"))}}function Jp(){return new cr(i=>T0(i),Rl)}async function qh(i,e){const t=Se(i);let n=3;const r=e.query;let s=t.queries.get(r);s?!s.na()&&e.ra()&&(n=2):(s=new b7,n=e.ra()?0:1);try{switch(n){case 0:s.ea=await t.onListen(r,!0);break;case 1:s.ea=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=jh(o,`Initialization of query '${Ar(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.ta.push(e),e.sa(t.onlineState),s.ea&&e.oa(s.ea)&&Gh(t)}async function Wh(i,e){const t=Se(i),n=e.query;let r=3;const s=t.queries.get(n);if(s){const o=s.ta.indexOf(e);o>=0&&(s.ta.splice(o,1),s.ta.length===0?r=e.ra()?0:1:!s.na()&&e.ra()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function E7(i,e){const t=Se(i);let n=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.ta)a.oa(r)&&(n=!0);o.ea=r}}n&&Gh(t)}function x7(i,e,t){const n=Se(i),r=n.queries.get(e);if(r)for(const s of r.ta)s.onError(t);n.queries.delete(e)}function Gh(i){i.ia.forEach(e=>{e.next()})}var Su,Zp;(Zp=Su||(Su={}))._a="default",Zp.Cache="cache";class Kh{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new Yr(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=Yr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Su.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e){this.key=e}}class c_{constructor(e){this.key=e}}class I7{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Pe(),this.mutatedKeys=Pe(),this.ya=k0(e),this.wa=new Dr(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new Qp,r=t?t.wa:this.wa;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const d=r.get(u),p=Nl(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),_=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let v=!1;d&&p?d.data.isEqual(p.data)?g!==_&&(n.track({type:3,doc:p}),v=!0):this.va(d,p)||(n.track({type:2,doc:p}),v=!0,(l&&this.ya(p,l)>0||c&&this.ya(p,c)<0)&&(a=!0)):!d&&p?(n.track({type:0,doc:p}),v=!0):d&&!p&&(n.track({type:1,doc:d}),v=!0,(l||c)&&(a=!0)),v&&(p?(o=o.add(p),s=_?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{wa:o,Da:n,ls:a,mutatedKeys:s}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort((u,h)=>function(p,g){const _=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ee()}};return _(p)-_(g)}(u.type,h.type)||this.ya(u.doc,h.doc)),this.Ca(n),r=r!=null&&r;const a=t&&!r?this.Fa():[],l=this.pa.size===0&&this.current&&!r?1:0,c=l!==this.ga;return this.ga=l,o.length!==0||c?{snapshot:new Yr(this.query,e.wa,s,o,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new Qp,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Pe(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});const t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new c_(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new l_(n))}),t}Oa(e){this.fa=e.gs,this.pa=Pe();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return Yr.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const Yh="SyncEngine";class S7{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class A7{constructor(e){this.key=e,this.Ba=!1}}class C7{constructor(e,t,n,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new cr(a=>T0(a),Rl),this.qa=new Map,this.Qa=new Set,this.$a=new pt(_e.comparator),this.Ua=new Map,this.Ka=new Oh,this.Wa={},this.Ga=new Map,this.za=Kr.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function T7(i,e,t=!0){const n=g_(i);let r;const s=n.ka.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Na()):r=await u_(n,e,t,!0),r}async function k7(i,e){const t=g_(i);await u_(t,e,!0,!1)}async function u_(i,e,t,n){const r=await Y6(i.localStore,On(e)),s=r.targetId,o=i.sharedClientState.addLocalQueryTarget(s,t);let a;return n&&(a=await R7(i,e,s,o==="current",r.resumeToken)),i.isPrimaryClient&&t&&n_(i.remoteStore,r),a}async function R7(i,e,t,n,r){i.Ha=(h,d,p)=>async function(_,v,C,T){let y=v.view.ba(C);y.ls&&(y=await qp(_.localStore,v.query,!1).then(({documents:w})=>v.view.ba(w,y)));const A=T&&T.targetChanges.get(v.targetId),E=T&&T.targetMismatches.get(v.targetId)!=null,x=v.view.applyChanges(y,_.isPrimaryClient,A,E);return tg(_,v.targetId,x.Ma),x.snapshot}(i,h,d,p);const s=await qp(i.localStore,e,!0),o=new I7(e,s.gs),a=o.ba(s.documents),l=ko.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",r),c=o.applyChanges(a,i.isPrimaryClient,l);tg(i,t,c.Ma);const u=new S7(e,t,o);return i.ka.set(e,u),i.qa.has(t)?i.qa.get(t).push(e):i.qa.set(t,[e]),c.snapshot}async function N7(i,e,t){const n=Se(i),r=n.ka.get(e),s=n.qa.get(r.targetId);if(s.length>1)return n.qa.set(r.targetId,s.filter(o=>!Rl(o,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await xu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),t&&Fh(n.remoteStore,r.targetId),Au(n,r.targetId)}).catch(ss)):(Au(n,r.targetId),await xu(n.localStore,r.targetId,!0))}async function P7(i,e){const t=Se(i),n=t.ka.get(e),r=t.qa.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Fh(t.remoteStore,n.targetId))}async function L7(i,e,t){const n=B7(i);try{const r=await function(o,a){const l=Se(o),c=ft.now(),u=a.reduce((p,g)=>p.add(g.key),Pe());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=ii(),_=Pe();return l.ds.getEntries(p,u).next(v=>{g=v,g.forEach((C,T)=>{T.isValidDocument()||(_=_.add(C))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(v=>{h=v;const C=[];for(const T of a){const y=Y4(T,h.get(T.key).overlayedDocument);y!=null&&C.push(new Vi(T.key,y,b0(y.value.mapValue),bn.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,C,a)}).next(v=>{d=v;const C=v.applyToLocalDocumentSet(h,_);return l.documentOverlayCache.saveOverlays(p,v.batchId,C)})}).then(()=>({batchId:d.batchId,changes:N0(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(o,a,l){let c=o.Wa[o.currentUser.toKey()];c||(c=new pt(Re)),c=c.insert(a,l),o.Wa[o.currentUser.toKey()]=c}(n,r.batchId,t),await No(n,r.changes),await Ul(n.remoteStore)}catch(r){const s=jh(r,"Failed to persist write");t.reject(s)}}async function h_(i,e){const t=Se(i);try{const n=await W6(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.Ua.get(s);o&&(Ke(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Ba=!0:r.modifiedDocuments.size>0?Ke(o.Ba):r.removedDocuments.size>0&&(Ke(o.Ba),o.Ba=!1))}),await No(t,n,e)}catch(n){await ss(n)}}function eg(i,e,t){const n=Se(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.ka.forEach((s,o)=>{const a=o.view.sa(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const l=Se(o);l.onlineState=a;let c=!1;l.queries.forEach((u,h)=>{for(const d of h.ta)d.sa(a)&&(c=!0)}),c&&Gh(l)}(n.eventManager,e),r.length&&n.La.p_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function M7(i,e,t){const n=Se(i);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Ua.get(e),s=r&&r.key;if(s){let o=new pt(_e.comparator);o=o.insert(s,Mt.newNoDocument(s,Ie.min()));const a=Pe().add(s),l=new Ml(Ie.min(),new Map,new pt(Re),o,a);await h_(n,l),n.$a=n.$a.remove(s),n.Ua.delete(e),Xh(n)}else await xu(n.localStore,e,!1).then(()=>Au(n,e,t)).catch(ss)}async function O7(i,e){const t=Se(i),n=e.batch.batchId;try{const r=await q6(t.localStore,e);f_(t,n,null),d_(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await No(t,r)}catch(r){await ss(r)}}async function D7(i,e,t){const n=Se(i);try{const r=await function(o,a){const l=Se(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(Ke(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);f_(n,e,t),d_(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await No(n,r)}catch(r){await ss(r)}}function d_(i,e){(i.Ga.get(e)||[]).forEach(t=>{t.resolve()}),i.Ga.delete(e)}function f_(i,e,t){const n=Se(i);let r=n.Wa[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.Wa[n.currentUser.toKey()]=r}}function Au(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.qa.get(e))i.ka.delete(n),t&&i.La.Ja(n,t);i.qa.delete(e),i.isPrimaryClient&&i.Ka.br(e).forEach(n=>{i.Ka.containsKey(n)||p_(i,n)})}function p_(i,e){i.Qa.delete(e.path.canonicalString());const t=i.$a.get(e);t!==null&&(Fh(i.remoteStore,t),i.$a=i.$a.remove(e),i.Ua.delete(t),Xh(i))}function tg(i,e,t){for(const n of t)n instanceof l_?(i.Ka.addReference(n.key,e),U7(i,n)):n instanceof c_?(ue(Yh,"Document no longer in limbo: "+n.key),i.Ka.removeReference(n.key,e),i.Ka.containsKey(n.key)||p_(i,n.key)):Ee()}function U7(i,e){const t=e.key,n=t.path.canonicalString();i.$a.get(t)||i.Qa.has(n)||(ue(Yh,"New document in limbo: "+t),i.Qa.add(n),Xh(i))}function Xh(i){for(;i.Qa.size>0&&i.$a.size<i.maxConcurrentLimboResolutions;){const e=i.Qa.values().next().value;i.Qa.delete(e);const t=new _e(rt.fromString(e)),n=i.za.next();i.Ua.set(n,new A7(t)),i.$a=i.$a.insert(t,n),n_(i.remoteStore,new yi(On(kl(t.path)),n,"TargetPurposeLimboResolution",Al.ae))}}async function No(i,e,t){const n=Se(i),r=[],s=[],o=[];n.ka.isEmpty()||(n.ka.forEach((a,l)=>{o.push(n.Ha(l,e,t).then(c=>{var u;if((c||t)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){r.push(c);const h=Uh.Yi(l.targetId,c);s.push(h)}}))}),await Promise.all(o),n.La.p_(r),await async function(l,c){const u=Se(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>j.forEach(c,d=>j.forEach(d.Hi,p=>u.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>j.forEach(d.Ji,p=>u.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!os(h))throw h;ue(Vh,"Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=u.Ts.get(d),g=p.snapshotVersion,_=p.withLastLimboFreeSnapshotVersion(g);u.Ts=u.Ts.insert(d,_)}}}(n.localStore,s))}async function V7(i,e){const t=Se(i);if(!t.currentUser.isEqual(e)){ue(Yh,"User change. New user:",e.toKey());const n=await J0(t.localStore,e);t.currentUser=e,function(s,o){s.Ga.forEach(a=>{a.forEach(l=>{l.reject(new de(q.CANCELLED,o))})}),s.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await No(t,n.Rs)}}function F7(i,e){const t=Se(i),n=t.Ua.get(e);if(n&&n.Ba)return Pe().add(n.key);{let r=Pe();const s=t.qa.get(e);if(!s)return r;for(const o of s){const a=t.ka.get(o);r=r.unionWith(a.view.Sa)}return r}}function g_(i){const e=Se(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=h_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=F7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=M7.bind(null,e),e.La.p_=E7.bind(null,e.eventManager),e.La.Ja=x7.bind(null,e.eventManager),e}function B7(i){const e=Se(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=O7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=D7.bind(null,e),e}class Ya{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ol(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return j6(this.persistence,new $6,e.initialUser,this.serializer)}Xa(e){return new Q0(Dh.ri,this.serializer)}Za(e){return new Q6}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ya.provider={build:()=>new Ya};class $7 extends Ya{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){Ke(this.persistence.referenceDelegate instanceof Ga);const n=this.persistence.referenceDelegate.garbageCollector;return new A6(n,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?Yt.withCacheSize(this.cacheSizeBytes):Yt.DEFAULT;return new Q0(n=>Ga.ri(n,t),this.serializer)}}class Cu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>eg(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=V7.bind(null,this.syncEngine),await v7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new w7}()}createDatastore(e){const t=Ol(e.databaseInfo.databaseId),n=function(s){return new n7(s)}(e.databaseInfo);return function(s,o,a,l){return new o7(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,r,s,o,a){return new l7(n,r,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>eg(this.syncEngine,t,0),function(){return Kp.D()?new Kp:new J6}())}createSyncEngine(e,t){return function(r,s,o,a,l,c,u){const h=new C7(r,s,o,a,l,c);return u&&(h.ja=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const s=Se(r);ue(nr,"RemoteStore shutting down."),s.W_.add(5),await Ro(s),s.z_.shutdown(),s.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Cu.provider={build:()=>new Cu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):ni("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi="FirestoreClient";class z7{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Pt.UNAUTHENTICATED,this.clientId=u0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{ue(Pi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(ue(Pi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=jh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Nc(i,e){i.asyncQueue.verifyOperationInProgress(),ue(Pi,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(async r=>{n.isEqual(r)||(await J0(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=e}async function ng(i,e){i.asyncQueue.verifyOperationInProgress();const t=await H7(i);ue(Pi,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener(n=>Xp(e.remoteStore,n)),i.setAppCheckTokenChangeListener((n,r)=>Xp(e.remoteStore,r)),i._onlineComponents=e}async function H7(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){ue(Pi,"Using user provided OfflineComponentProvider");try{await Nc(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===q.FAILED_PRECONDITION||r.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;jr("Error using user provided cache. Falling back to memory cache: "+t),await Nc(i,new Ya)}}else ue(Pi,"Using default OfflineComponentProvider"),await Nc(i,new $7(void 0));return i._offlineComponents}async function m_(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(ue(Pi,"Using user provided OnlineComponentProvider"),await ng(i,i._uninitializedComponentsProvider._online)):(ue(Pi,"Using default OnlineComponentProvider"),await ng(i,new Cu))),i._onlineComponents}function j7(i){return m_(i).then(e=>e.syncEngine)}async function Xa(i){const e=await m_(i),t=e.eventManager;return t.onListen=T7.bind(null,e.syncEngine),t.onUnlisten=N7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=k7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=P7.bind(null,e.syncEngine),t}function q7(i,e,t={}){const n=new Zn;return i.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const u=new Qh({next:d=>{u.su(),o.enqueueAndForget(()=>Wh(s,h));const p=d.docs.has(a);!p&&d.fromCache?c.reject(new de(q.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new de(q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Kh(kl(a.path),u,{includeMetadataChanges:!0,Ta:!0});return qh(s,h)}(await Xa(i),i.asyncQueue,e,t,n)),n.promise}function W7(i,e,t={}){const n=new Zn;return i.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const u=new Qh({next:d=>{u.su(),o.enqueueAndForget(()=>Wh(s,h)),d.fromCache&&l.source==="server"?c.reject(new de(q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Kh(a,u,{includeMetadataChanges:!0,Ta:!0});return qh(s,h)}(await Xa(i),i.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y_(i,e,t){if(!t)throw new de(q.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function G7(i,e,t,n){if(e===!0&&n===!0)throw new de(q.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function rg(i){if(!_e.isDocumentKey(i))throw new de(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function sg(i){if(_e.isDocumentKey(i))throw new de(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function Vl(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Ee()}function on(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new de(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Vl(i);throw new de(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="firestore.googleapis.com",og=!0;class ag{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new de(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=v_,this.ssl=og}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:og;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=X0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<I6)throw new de(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}G7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new de(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new de(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new de(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fl{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ag({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ag(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new t4;switch(n.type){case"firstParty":return new s4(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new de(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=ig.get(t);n&&(ue("ComponentProvider","Removing Datastore"),ig.delete(t),n.terminate())}(this),Promise.resolve()}}function K7(i,e,t,n={}){var r;const s=(i=on(i,Fl))._getSettings(),o=Object.assign(Object.assign({},s),{emulatorOptions:i._getEmulatorOptions()}),a=`${e}:${t}`;s.host!==v_&&s.host!==a&&jr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},s),{host:a,ssl:!1,emulatorOptions:n});if(!Ua(l,o)&&(i._setSettings(l),n.mockUserToken)){let c,u;if(typeof n.mockUserToken=="string")c=n.mockUserToken,u=Pt.MOCK_USER;else{c=T5(n.mockUserToken,(r=i._app)===null||r===void 0?void 0:r.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new de(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Pt(h)}i._authCredentials=new n4(new l0(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new hr(this.firestore,e,this._query)}}class Ft{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ii(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}}class Ii extends hr{constructor(e,t,n){super(e,t,kl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new _e(e))}withConverter(e){return new Ii(this.firestore,e,this._path)}}function ca(i,e,...t){if(i=Gt(i),y_("collection","path",e),i instanceof Fl){const n=rt.fromString(e,...t);return sg(n),new Ii(i,null,n)}{if(!(i instanceof Ft||i instanceof Ii))throw new de(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(rt.fromString(e,...t));return sg(n),new Ii(i.firestore,null,n)}}function Pc(i,e,...t){if(i=Gt(i),arguments.length===1&&(e=u0.newId()),y_("doc","path",e),i instanceof Fl){const n=rt.fromString(e,...t);return rg(n),new Ft(i,null,new _e(n))}{if(!(i instanceof Ft||i instanceof Ii))throw new de(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(rt.fromString(e,...t));return rg(n),new Ft(i.firestore,i instanceof Ii?i.converter:null,new _e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg="AsyncQueue";class cg{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new e_(this,"async_queue_retry"),this.Su=()=>{const n=Rc();n&&ue(lg,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.bu=e;const t=Rc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=Rc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new Zn;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!os(e))throw e;ue(lg,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.bu.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(n);throw ni("INTERNAL UNHANDLED ERROR: ",r),n}).then(n=>(this.pu=!1,n))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const r=Hh.createAndSchedule(this,e,t,n,s=>this.Fu(s));return this.fu.push(r),r}Du(){this.gu&&Ee()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function ug(i){return function(t,n){if(typeof t!="object"||t===null)return!1;const r=t;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(i,["next","error","complete"])}class Li extends Fl{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new cg,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new cg(e),this._firestoreClient=void 0,await e}}}function Y7(i,e){const t=typeof i=="object"?i:Zm(),n=typeof i=="string"?i:Ba,r=zb(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const s=A5("firestore");s&&K7(r,...s)}return r}function Bl(i){if(i._terminated)throw new de(q.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||X7(i),i._firestoreClient}function X7(i){var e,t,n;const r=i._freezeSettings(),s=function(a,l,c,u){return new b4(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,__(u.experimentalLongPollingOptions),u.useFetchStreams)}(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,r);i._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=r.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(i._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),i._firestoreClient=new z7(i._authCredentials,i._appCheckCredentials,i._queue,s,i._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xr(Ct.fromBase64String(e))}catch(t){throw new de(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Xr(Ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new At(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Re(this._lat,e._lat)||Re(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,r){if(n.length!==r.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==r[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q7=/^__.*__$/;class J7{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms):new To(e,this.data,t,this.fieldTransforms)}}class b_{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function w_(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ee()}}class ed{constructor(e,t,n,r,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.Bu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new ed(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.$u(e),r}Uu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.ku({path:n,Qu:!1});return r.Bu(),r}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return Qa(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(w_(this.Lu)&&Q7.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class Z7{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Ol(e)}ju(e,t,n,r=!1){return new ed({Lu:e,methodName:t,zu:n,path:At.emptyPath(),Qu:!1,Gu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function td(i){const e=i._freezeSettings(),t=Ol(i._databaseId);return new Z7(i._databaseId,!!e.ignoreUndefinedProperties,t)}function e9(i,e,t,n,r,s={}){const o=i.ju(s.merge||s.mergeFields?2:0,e,t,r);nd("Data must be an object, but it was:",o,n);const a=E_(n,o);let l,c;if(s.merge)l=new rn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=Tu(e,h,t);if(!o.contains(d))throw new de(q.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);I_(u,d)||u.push(d)}l=new rn(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new J7(new Xt(a),l,c)}class Hl extends Jh{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hl}}function t9(i,e,t,n){const r=i.ju(1,e,t);nd("Data must be an object, but it was:",r,n);const s=[],o=Xt.empty();Ui(n,(l,c)=>{const u=id(e,l,t);c=Gt(c);const h=r.Uu(u);if(c instanceof Hl)s.push(u);else{const d=Po(c,h);d!=null&&(s.push(u),o.set(u,d))}});const a=new rn(s);return new b_(o,a,r.fieldTransforms)}function n9(i,e,t,n,r,s){const o=i.ju(1,e,t),a=[Tu(e,n,t)],l=[r];if(s.length%2!=0)throw new de(q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Tu(e,s[d])),l.push(s[d+1]);const c=[],u=Xt.empty();for(let d=a.length-1;d>=0;--d)if(!I_(c,a[d])){const p=a[d];let g=l[d];g=Gt(g);const _=o.Uu(p);if(g instanceof Hl)c.push(p);else{const v=Po(g,_);v!=null&&(c.push(p),u.set(p,v))}}const h=new rn(c);return new b_(u,h,o.fieldTransforms)}function i9(i,e,t,n=!1){return Po(t,i.ju(n?4:3,e))}function Po(i,e){if(x_(i=Gt(i)))return nd("Unsupported field value:",e,i),E_(i,e);if(i instanceof Jh)return function(n,r){if(!w_(r.Lu))throw r.Wu(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Wu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(n,r){const s=[];let o=0;for(const a of n){let l=Po(a,r.Ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(i,e)}return function(n,r){if((n=Gt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return H4(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=ft.fromDate(n);return{timestampValue:Wa(r.serializer,s)}}if(n instanceof ft){const s=new ft(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Wa(r.serializer,s)}}if(n instanceof zl)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Xr)return{bytesValue:H0(r.serializer,n._byteString)};if(n instanceof Ft){const s=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw r.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Mh(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof Zh)return function(o,a){return{mapValue:{fields:{[y0]:{stringValue:v0},[$a]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Wu("VectorValues must only contain numeric values.");return Rh(a.serializer,c)})}}}}}}(n,r);throw r.Wu(`Unsupported field value: ${Vl(n)}`)}(i,e)}function E_(i,e){const t={};return d0(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ui(i,(n,r)=>{const s=Po(r,e.qu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function x_(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof ft||i instanceof zl||i instanceof Xr||i instanceof Ft||i instanceof Jh||i instanceof Zh)}function nd(i,e,t){if(!x_(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const n=Vl(t);throw n==="an object"?e.Wu(i+" a custom object"):e.Wu(i+" "+n)}}function Tu(i,e,t){if((e=Gt(e))instanceof $l)return e._internalPath;if(typeof e=="string")return id(i,e);throw Qa("Field path arguments must be of type string or ",i,!1,void 0,t)}const r9=new RegExp("[~\\*/\\[\\]]");function id(i,e,t){if(e.search(r9)>=0)throw Qa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new $l(...e.split("."))._internalPath}catch{throw Qa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function Qa(i,e,t,n,r){const s=n&&!n.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${r}`),l+=")"),new de(q.INVALID_ARGUMENT,a+i+l)}function I_(i,e){return i.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new s9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class s9 extends S_{data(){return super.data()}}function rd(i,e){return typeof e=="string"?id(i,e):e instanceof $l?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new de(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sd{}class o9 extends sd{}function hg(i,e,...t){let n=[];e instanceof sd&&n.push(e),n=n.concat(t),function(s){const o=s.filter(l=>l instanceof od).length,a=s.filter(l=>l instanceof jl).length;if(o>1||o>0&&a>0)throw new de(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)i=r._apply(i);return i}class jl extends o9{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new jl(e,t,n)}_apply(e){const t=this._parse(e);return C_(e._query,t),new hr(e.firestore,e.converter,_u(e._query,t))}_parse(e){const t=td(e.firestore);return function(s,o,a,l,c,u,h){let d;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new de(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){pg(h,u);const g=[];for(const _ of h)g.push(fg(l,s,_));d={arrayValue:{values:g}}}else d=fg(l,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||pg(h,u),d=i9(a,o,h,u==="in"||u==="not-in");return dt.create(c,u,d)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function dg(i,e,t){const n=e,r=rd("where",i);return jl._create(r,n,t)}class od extends sd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new od(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:In.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const l of a)C_(o,l),o=_u(o,l)}(e._query,t),new hr(e.firestore,e.converter,_u(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function fg(i,e,t){if(typeof(t=Gt(t))=="string"){if(t==="")throw new de(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!C0(e)&&t.indexOf("/")!==-1)throw new de(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(rt.fromString(t));if(!_e.isDocumentKey(n))throw new de(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Ap(i,new _e(n))}if(t instanceof Ft)return Ap(i,t._key);throw new de(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vl(t)}.`)}function pg(i,e){if(!Array.isArray(i)||i.length===0)throw new de(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function C_(i,e){const t=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(i.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new de(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class a9{convertValue(e,t="none"){switch(Ri(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ki(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ee()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Ui(e,(r,s)=>{n[r]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,r;const s=(r=(n=(t=e.fields)===null||t===void 0?void 0:t[$a].arrayValue)===null||n===void 0?void 0:n.values)===null||r===void 0?void 0:r.map(o=>ut(o.doubleValue));return new Zh(s)}convertGeoPoint(e){return new zl(ut(e.latitude),ut(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Tl(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(go(e));default:return null}}convertTimestamp(e){const t=Ti(e);return new ft(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=rt.fromString(e);Ke(Y0(n));const r=new mo(n.get(1),n.get(3)),s=new _e(n.popFirst(5));return r.isEqual(t)||ni(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l9(i,e,t){let n;return n=i?i.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class T_ extends S_{constructor(e,t,n,r,s,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ia(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(rd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Ia extends T_{data(e={}){return super.data(e)}}class k_{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ds(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Ia(this._firestore,this._userDataWriter,n.key,n,new Ds(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const l=new Ia(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Ds(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Ia(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Ds(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:c9(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function c9(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ee()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(i){i=on(i,Ft);const e=on(i.firestore,Li);return q7(Bl(e),i._key).then(t=>N_(e,i,t))}class ad extends a9{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,t)}}function ku(i){i=on(i,hr);const e=on(i.firestore,Li),t=Bl(e),n=new ad(e);return A_(i._query),W7(t,i._query).then(r=>new k_(e,n,i,r))}function u9(i,e,t){i=on(i,Ft);const n=on(i.firestore,Li),r=l9(i.converter,e);return ld(n,[e9(td(n),"setDoc",i._key,r,i.converter!==null,t).toMutation(i._key,bn.none())])}function h9(i,e,t,...n){i=on(i,Ft);const r=on(i.firestore,Li),s=td(r);let o;return o=typeof(e=Gt(e))=="string"||e instanceof $l?n9(s,"updateDoc",i._key,e,t,n):t9(s,"updateDoc",i._key,e),ld(r,[o.toMutation(i._key,bn.exists(!0))])}function d9(i){return ld(on(i.firestore,Li),[new Nh(i._key,bn.none())])}function ql(i,...e){var t,n,r;i=Gt(i);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ug(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ug(e[o])){const h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let l,c,u;if(i instanceof Ft)c=on(i.firestore,Li),u=kl(i._key.path),l={next:h=>{e[o]&&e[o](N_(c,i,h))},error:e[o+1],complete:e[o+2]};else{const h=on(i,hr);c=on(h.firestore,Li),u=h._query;const d=new ad(c);l={next:p=>{e[o]&&e[o](new k_(c,d,h,p))},error:e[o+1],complete:e[o+2]},A_(i._query)}return function(d,p,g,_){const v=new Qh(_),C=new Kh(p,v,g);return d.asyncQueue.enqueueAndForget(async()=>qh(await Xa(d),C)),()=>{v.su(),d.asyncQueue.enqueueAndForget(async()=>Wh(await Xa(d),C))}}(Bl(c),u,a,l)}function ld(i,e){return function(n,r){const s=new Zn;return n.asyncQueue.enqueueAndForget(async()=>L7(await j7(n),r,s)),s.promise}(Bl(i),e)}function N_(i,e,t){const n=t.docs.get(e._key),r=new ad(i);return new T_(i,r,e._key,n,new Ds(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){rs=r})(is),Vn(new xn("firestore",(n,{instanceIdentifier:r,options:s})=>{const o=n.getProvider("app").getImmediate(),a=new Li(new i4(n.getProvider("auth-internal")),new o4(o,n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new de(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new mo(c.options.projectId,u)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),sn(pp,gp,e),sn(pp,gp,"esm2017")})();const wr="families",f9={__name:"FamilyTree",setup(i){const e=Hv("tree"),t=Ji([]);let n,r;gm(()=>{const u=ca(xr,wr);r=ql(u,h=>{t.value=h.docs.map(d=>d.data()),s(e.value,t.value),r&&r()}),s(e.value,t.value)}),mh(()=>{r&&r()});function s(u,h){console.log(ke.templates.john),console.log(ke.templates.john_male);const d='<text data-width="230" style="font-size: 16px;font-weight:bold;" fill="#aeaeae" x="60" y="145" text-anchor="middle">{val}</text>',p='<text data-width="150" style="font-size: 13px;" fill="#aeaeae" x="60" y="160" text-anchor="middle">{val}</text>';ke.templates.john.field_0=d,ke.templates.john_male.field_0=d,ke.templates.john_female.field_0=d,ke.templates.john.field_1=p,ke.templates.john_male.field_1=p,ke.templates.john_female.field_1=p,ke.templates.sriniz=Object.assign({},ke.templates.base);const g=380,_=95;ke.templates.sriniz.size=[g,_],ke.templates.sriniz.node=`<rect x="0" y="0" height="${_}" width="${g}" stroke-width="1" rx="15" ry="15"></rect>`,ke.templates.sriniz.nodeMenuButton='<use data-ctrl-n-menu-id="{id}" x="350" y="70" xlink:href="#base_node_menu" fill="#ffffff"/>',ke.templates.sriniz.defs=`
        <g transform="matrix(0.05,0,0,0.05,-13 ,-12)" id="heart">
          <path d="M448,256c0-106-86-192-192-192S64,150,64,256s86,192,192,192S448,362,448,256Z" style="fill:#fff;stroke:red;stroke-miterlimit:10;stroke-width:24px" fill="red"></path><path d="M256,360a16,16,0,0,1-9-2.78c-39.3-26.68-56.32-45-65.7-56.41-20-24.37-29.58-49.4-29.3-76.5.31-31.06,25.22-56.33,55.53-56.33,20.4,0,35,10.63,44.1,20.41a6,6,0,0,0,8.72,0c9.11-9.78,23.7-20.41,44.1-20.41,30.31,0,55.22,25.27,55.53,56.33.28,27.1-9.31,52.13-29.3,76.5-9.38,11.44-26.4,29.73-65.7,56.41A16,16,0,0,1,256,360Z" fill="red"></path>
        </g>
        <g id="sriniz_male_up">
          <circle cx="15" cy="15" r="10" fill="#fff" stroke="#fff" stroke-width="1"></circle>
          ${ke.icon.ft(15,15,"#0070a6",7.5,7.5)}
        </g>

        <g id="sriniz_female_up">
          <circle cx="15" cy="15" r="10" fill="#fff" stroke="#fff" stroke-width="1"></circle>
          ${ke.icon.ft(15,15,"#bd00ad",7.5,7.5)}
        </g>`;const v='<text data-width="180" style="font-size: 12px; font-weight: normal;" fill="#ffffff" x="130" y="70">Alamat: {val}</text>';ke.templates.sriniz_male=Object.assign({},ke.templates.sriniz),ke.templates.sriniz_male.node='<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" fill="#0070a6" stroke="#aeaeae" rx="15" ry="15"></rect>',ke.templates.sriniz_male.field_0=d,ke.templates.sriniz_male.field_1=p,ke.templates.sriniz_male.field_2=v,ke.templates.sriniz_female=Object.assign({},ke.templates.sriniz),ke.templates.sriniz_female.node='<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" fill="#bd00ad" stroke="#aeaeae" rx="15" ry="15"></rect>',ke.templates.sriniz_female.field_0=d,ke.templates.sriniz_female.field_1=p,ke.templates.sriniz_female.field_2=v;const C='<circle cx="97" cy="-16" r="10" fill="#0070a6" stroke="#fff" stroke-width="1"><title>Expand</title></circle><line x1="90" y1="-16" x2="104" y2="-16" stroke-width="1" stroke="#fff"></line><line x1="97" y1="-23" x2="97" y2="-9" stroke-width="1" stroke="#fff"></line>',T='<circle cx="97" cy="-16" r="10" fill="#bd00ad" stroke="#fff" stroke-width="1"></circle><line x1="90" y1="-16" x2="104" y2="-16" stroke-width="1" stroke="#fff"></line><line x1="97" y1="-23" x2="97" y2="-9" stroke-width="1" stroke="#fff"></line>';ke.templates.sriniz_male.plus=C,ke.templates.sriniz_female.plus=T;const y='<clipPath id="ulaImg"><rect  height="75" width="75" x="45" y="10" stroke-width="1" fill="#bd00ad" stroke="#aeaeae" rx="15" ry="15"></rect></clipPath><image x="45" y="10" preserveAspectRatio="xMidYMid slice" clip-path="url(#ulaImg)" xlink:href="{val}" width="75" height="75"></image>';ke.templates.sriniz_male.img_0=y,ke.templates.sriniz_female.img_0=y,ke.templates.sriniz_male.up='<use x="350" y="0" xlink:href="#sriniz_male_up"></use>',ke.templates.sriniz_female.up='<use x="350" y="0" xlink:href="#sriniz_female_up"></use>',ke.templates.sriniz.pointer='<g data-pointer="pointer" transform="matrix(0,0,0,0,80,80)">><g transform="matrix(0.3,0,0,0.3,-17,-17)"><polygon fill="#0070a6" points="53.004,173.004 53.004,66.996 0,120" /><polygon fill="#0070a6" points="186.996,66.996 186.996,173.004 240,120" /><polygon fill="#bd00ad" points="66.996,53.004 173.004,53.004 120,0" /><polygon fill="#bd00ad" points="120,240 173.004,186.996 66.996,186.996" /><circle fill="red" cx="120" cy="120" r="30" /></g></g>',ke.miniMap.draggable=!1,n=new ke(u,{nodes:h,sticky:!1,mouseScrool:ke.none,scaleInitial:o().scaleInitial,mode:"dark",template:"john",roots:["_ui8p"],nodeMenu:{edit:{text:"Ubah"},details:{text:"Lihat Selengkapnya"}},levelSeparation:100,siblingSeparation:80,minPartnerSeparation:50,orderBy:"anak",miniMap:!0,toolbar:{fullScreen:!0,zoom:!0,fit:!0,expandAll:!0},scaleMax:1.5,nodeTreeMenu:!1,nodeBinding:{field_0:"name",field_1:"born",field_2:"city",field_3:"anak",img_0:"photo"},editForm:{generateElementsFromFields:!1,titleBinding:"name",photoBinding:"photo",addMoreBtn:"",addMore:"",addMoreFieldName:"",saveAndCloseBtn:"Simpan",cancelBtn:"Tutup",elements:[{type:"textbox",label:"Anak Ke-",binding:"anak"},{type:"textbox",label:"Nama Lengkap",binding:"name"},{type:"select",options:[{value:"male",text:"Pria"},{value:"female",text:"Wanita"}],label:"Jenis Kelamin",binding:"gender"},[{type:"date",label:"Tanggal Lahir",binding:"born"},{type:"date",label:"Meninggal (opsional)",binding:"die"}],[{type:"textbox",label:"Instagram",binding:"email"},{type:"textbox",label:"WA",binding:"phone"}],{type:"textbox",label:"Alamat",binding:"city"},{type:"textbox",label:"Foto",binding:"photo",btn:"Upload"}]}}),n.on("render-link",function(A,E){E.cnode.ppid!=null&&(E.html+='<use data-ctrl-ec-id="'+E.node.id+'" xlink:href="#heart" x="'+E.p.xa+'" y="'+E.p.ya+'"/>'),E.cnode.isPartner&&E.node.partnerSeparation==50&&(E.html+='<use data-ctrl-ec-id="'+E.node.id+'" xlink:href="#heart" x="'+E.p.xb+'" y="'+E.p.yb+'"/>')}),n.on("field",function(A,E){if(E.name=="born"){if(E.value==""||E.value==null){E.value="-";return}try{let x=new Date(E.value);E.value=x.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch{E.value="-"}}if(E.name=="die"){let x=new Date(E.value);E.value=x.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}}),n.on("expcollclick",function(A,E,x){var w=n.getNode(x);return E?n.expandCollapse(x,[],w.ftChildrenIds):n.expandCollapse(x,w.ftChildrenIds,[]),!1}),n.onUpdateNode(async A=>{console.log(A),A.addNodesData.forEach(async E=>{await a(E)}),A.updateNodesData.forEach(async E=>{await l(E.id,E)}),A.removeNodeId!=null&&await c(A.removeNodeId)})}function o(){var h=new URLSearchParams(window.location.search).get("fit"),d=!0,p=1;return h=="yes"&&(d=!1,p=ke.match.boundary),{enableSearch:d,scaleInitial:p}}async function a(u){const h=Pc(ca(xr,wr)),d=h.id,p={doc_id:d,...u};return await u9(h,p),console.log("Document created with ID and stored in data:",d),d}async function l(u,h){const d=hg(ca(xr,wr),dg("id","==",u)),g=(await ku(d)).docs.map(_=>h9(Pc(xr,wr,_.id),{...h}));await Promise.all(g),console.log("Document(s) updated based on field match")}async function c(u){const h=hg(ca(xr,wr),dg("id","==",u));try{const p=(await ku(h)).docs.map(g=>d9(Pc(xr,wr,g.id)));await Promise.all(p),console.log("Matching documents deleted")}catch(d){console.error("Error deleting documents:",d)}}return(u,h)=>(cn(),si("div",{id:"tree",ref_key:"tree",ref:e},null,512))}},p9={__name:"App",setup(i){return(e,t)=>(cn(),nu(f9))}},g9="modulepreload",m9=function(i){return"/"+i},gg={},_9=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(l=>{if(l=m9(l),l in gg)return;gg[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":g9,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((d,p)=>{h.addEventListener("load",d),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const kr=typeof document<"u";function P_(i){return typeof i=="object"||"displayName"in i||"props"in i||"__vccOpts"in i}function y9(i){return i.__esModule||i[Symbol.toStringTag]==="Module"||i.default&&P_(i.default)}const qe=Object.assign;function Lc(i,e){const t={};for(const n in e){const r=e[n];t[n]=Sn(r)?r.map(i):i(r)}return t}const Xs=()=>{},Sn=Array.isArray,L_=/#/g,v9=/&/g,b9=/\//g,w9=/=/g,E9=/\?/g,M_=/\+/g,x9=/%5B/g,I9=/%5D/g,O_=/%5E/g,S9=/%60/g,D_=/%7B/g,A9=/%7C/g,U_=/%7D/g,C9=/%20/g;function cd(i){return encodeURI(""+i).replace(A9,"|").replace(x9,"[").replace(I9,"]")}function T9(i){return cd(i).replace(D_,"{").replace(U_,"}").replace(O_,"^")}function Ru(i){return cd(i).replace(M_,"%2B").replace(C9,"+").replace(L_,"%23").replace(v9,"%26").replace(S9,"`").replace(D_,"{").replace(U_,"}").replace(O_,"^")}function k9(i){return Ru(i).replace(w9,"%3D")}function R9(i){return cd(i).replace(L_,"%23").replace(E9,"%3F")}function N9(i){return i==null?"":R9(i).replace(b9,"%2F")}function bo(i){try{return decodeURIComponent(""+i)}catch{}return""+i}const P9=/\/$/,L9=i=>i.replace(P9,"");function Mc(i,e,t="/"){let n,r={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(n=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),r=i(s)),a>-1&&(n=n||e.slice(0,a),o=e.slice(a,e.length)),n=U9(n??e,t),{fullPath:n+(s&&"?")+s+o,path:n,query:r,hash:bo(o)}}function M9(i,e){const t=e.query?i(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function mg(i,e){return!e||!i.toLowerCase().startsWith(e.toLowerCase())?i:i.slice(e.length)||"/"}function O9(i,e,t){const n=e.matched.length-1,r=t.matched.length-1;return n>-1&&n===r&&Qr(e.matched[n],t.matched[r])&&V_(e.params,t.params)&&i(e.query)===i(t.query)&&e.hash===t.hash}function Qr(i,e){return(i.aliasOf||i)===(e.aliasOf||e)}function V_(i,e){if(Object.keys(i).length!==Object.keys(e).length)return!1;for(const t in i)if(!D9(i[t],e[t]))return!1;return!0}function D9(i,e){return Sn(i)?_g(i,e):Sn(e)?_g(e,i):i===e}function _g(i,e){return Sn(e)?i.length===e.length&&i.every((t,n)=>t===e[n]):i.length===1&&i[0]===e}function U9(i,e){if(i.startsWith("/"))return i;if(!i)return e;const t=e.split("/"),n=i.split("/"),r=n[n.length-1];(r===".."||r===".")&&n.push("");let s=t.length-1,o,a;for(o=0;o<n.length;o++)if(a=n[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+n.slice(o).join("/")}const di={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var wo;(function(i){i.pop="pop",i.push="push"})(wo||(wo={}));var Qs;(function(i){i.back="back",i.forward="forward",i.unknown=""})(Qs||(Qs={}));function V9(i){if(!i)if(kr){const e=document.querySelector("base");i=e&&e.getAttribute("href")||"/",i=i.replace(/^\w+:\/\/[^\/]+/,"")}else i="/";return i[0]!=="/"&&i[0]!=="#"&&(i="/"+i),L9(i)}const F9=/^[^#]+#/;function B9(i,e){return i.replace(F9,"#")+e}function $9(i,e){const t=document.documentElement.getBoundingClientRect(),n=i.getBoundingClientRect();return{behavior:e.behavior,left:n.left-t.left-(e.left||0),top:n.top-t.top-(e.top||0)}}const Wl=()=>({left:window.scrollX,top:window.scrollY});function z9(i){let e;if("el"in i){const t=i.el,n=typeof t=="string"&&t.startsWith("#"),r=typeof t=="string"?n?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!r)return;e=$9(r,i)}else e=i;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function yg(i,e){return(history.state?history.state.position-e:-1)+i}const Nu=new Map;function H9(i,e){Nu.set(i,e)}function j9(i){const e=Nu.get(i);return Nu.delete(i),e}let q9=()=>location.protocol+"//"+location.host;function F_(i,e){const{pathname:t,search:n,hash:r}=e,s=i.indexOf("#");if(s>-1){let a=r.includes(i.slice(s))?i.slice(s).length:1,l=r.slice(a);return l[0]!=="/"&&(l="/"+l),mg(l,"")}return mg(t,i)+n+r}function W9(i,e,t,n){let r=[],s=[],o=null;const a=({state:d})=>{const p=F_(i,location),g=t.value,_=e.value;let v=0;if(d){if(t.value=p,e.value=d,o&&o===g){o=null;return}v=_?d.position-_.position:0}else n(p);r.forEach(C=>{C(t.value,g,{delta:v,type:wo.pop,direction:v?v>0?Qs.forward:Qs.back:Qs.unknown})})};function l(){o=t.value}function c(d){r.push(d);const p=()=>{const g=r.indexOf(d);g>-1&&r.splice(g,1)};return s.push(p),p}function u(){const{history:d}=window;d.state&&d.replaceState(qe({},d.state,{scroll:Wl()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:h}}function vg(i,e,t,n=!1,r=!1){return{back:i,current:e,forward:t,replaced:n,position:window.history.length,scroll:r?Wl():null}}function G9(i){const{history:e,location:t}=window,n={value:F_(i,t)},r={value:e.state};r.value||s(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const h=i.indexOf("#"),d=h>-1?(t.host&&document.querySelector("base")?i:i.slice(h))+l:q9()+i+l;try{e[u?"replaceState":"pushState"](c,"",d),r.value=c}catch(p){console.error(p),t[u?"replace":"assign"](d)}}function o(l,c){const u=qe({},e.state,vg(r.value.back,l,r.value.forward,!0),c,{position:r.value.position});s(l,u,!0),n.value=l}function a(l,c){const u=qe({},r.value,e.state,{forward:l,scroll:Wl()});s(u.current,u,!0);const h=qe({},vg(n.value,l,null),{position:u.position+1},c);s(l,h,!1),n.value=l}return{location:n,state:r,push:a,replace:o}}function K9(i){i=V9(i);const e=G9(i),t=W9(i,e.state,e.location,e.replace);function n(s,o=!0){o||t.pauseListeners(),history.go(s)}const r=qe({location:"",base:i,go:n,createHref:B9.bind(null,i)},e,t);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function Y9(i){return typeof i=="string"||i&&typeof i=="object"}function B_(i){return typeof i=="string"||typeof i=="symbol"}const $_=Symbol("");var bg;(function(i){i[i.aborted=4]="aborted",i[i.cancelled=8]="cancelled",i[i.duplicated=16]="duplicated"})(bg||(bg={}));function Jr(i,e){return qe(new Error,{type:i,[$_]:!0},e)}function Wn(i,e){return i instanceof Error&&$_ in i&&(e==null||!!(i.type&e))}const wg="[^/]+?",X9={sensitive:!1,strict:!1,start:!0,end:!0},Q9=/[.+*?^${}()[\]/\\]/g;function J9(i,e){const t=qe({},X9,e),n=[];let r=t.start?"^":"";const s=[];for(const c of i){const u=c.length?[]:[90];t.strict&&!c.length&&(r+="/");for(let h=0;h<c.length;h++){const d=c[h];let p=40+(t.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(Q9,"\\$&"),p+=40;else if(d.type===1){const{value:g,repeatable:_,optional:v,regexp:C}=d;s.push({name:g,repeatable:_,optional:v});const T=C||wg;if(T!==wg){p+=10;try{new RegExp(`(${T})`)}catch(A){throw new Error(`Invalid custom RegExp for param "${g}" (${T}): `+A.message)}}let y=_?`((?:${T})(?:/(?:${T}))*)`:`(${T})`;h||(y=v&&c.length<2?`(?:/${y})`:"/"+y),v&&(y+="?"),r+=y,p+=20,v&&(p+=-8),_&&(p+=-20),T===".*"&&(p+=-50)}u.push(p)}n.push(u)}if(t.strict&&t.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}t.strict||(r+="/?"),t.end?r+="$":t.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,t.sensitive?"":"i");function a(c){const u=c.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const p=u[d]||"",g=s[d-1];h[g.name]=p&&g.repeatable?p.split("/"):p}return h}function l(c){let u="",h=!1;for(const d of i){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const p of d)if(p.type===0)u+=p.value;else if(p.type===1){const{value:g,repeatable:_,optional:v}=p,C=g in c?c[g]:"";if(Sn(C)&&!_)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const T=Sn(C)?C.join("/"):C;if(!T)if(v)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${g}"`);u+=T}}return u||"/"}return{re:o,score:n,keys:s,parse:a,stringify:l}}function Z9(i,e){let t=0;for(;t<i.length&&t<e.length;){const n=e[t]-i[t];if(n)return n;t++}return i.length<e.length?i.length===1&&i[0]===80?-1:1:i.length>e.length?e.length===1&&e[0]===80?1:-1:0}function z_(i,e){let t=0;const n=i.score,r=e.score;for(;t<n.length&&t<r.length;){const s=Z9(n[t],r[t]);if(s)return s;t++}if(Math.abs(r.length-n.length)===1){if(Eg(n))return 1;if(Eg(r))return-1}return r.length-n.length}function Eg(i){const e=i[i.length-1];return i.length>0&&e[e.length-1]<0}const e8={type:0,value:""},t8=/[a-zA-Z0-9_]/;function n8(i){if(!i)return[[]];if(i==="/")return[[e8]];if(!i.startsWith("/"))throw new Error(`Invalid path "${i}"`);function e(p){throw new Error(`ERR (${t})/"${c}": ${p}`)}let t=0,n=t;const r=[];let s;function o(){s&&r.push(s),s=[]}let a=0,l,c="",u="";function h(){c&&(t===0?s.push({type:0,value:c}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;a<i.length;){if(l=i[a++],l==="\\"&&t!==2){n=t,t=4;continue}switch(t){case 0:l==="/"?(c&&h(),o()):l===":"?(h(),t=1):d();break;case 4:d(),t=n;break;case 1:l==="("?t=2:t8.test(l)?d():(h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),h(),o(),r}function i8(i,e,t){const n=J9(n8(i.path),t),r=qe(n,{record:i,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function r8(i,e){const t=[],n=new Map;e=Ag({strict:!1,end:!0,sensitive:!1},e);function r(h){return n.get(h)}function s(h,d,p){const g=!p,_=Ig(h);_.aliasOf=p&&p.record;const v=Ag(e,h),C=[_];if("alias"in h){const A=typeof h.alias=="string"?[h.alias]:h.alias;for(const E of A)C.push(Ig(qe({},_,{components:p?p.record.components:_.components,path:E,aliasOf:p?p.record:_})))}let T,y;for(const A of C){const{path:E}=A;if(d&&E[0]!=="/"){const x=d.record.path,w=x[x.length-1]==="/"?"":"/";A.path=d.record.path+(E&&w+E)}if(T=i8(A,d,v),p?p.alias.push(T):(y=y||T,y!==T&&y.alias.push(T),g&&h.name&&!Sg(T)&&o(h.name)),H_(T)&&l(T),_.children){const x=_.children;for(let w=0;w<x.length;w++)s(x[w],T,p&&p.children[w])}p=p||T}return y?()=>{o(y)}:Xs}function o(h){if(B_(h)){const d=n.get(h);d&&(n.delete(h),t.splice(t.indexOf(d),1),d.children.forEach(o),d.alias.forEach(o))}else{const d=t.indexOf(h);d>-1&&(t.splice(d,1),h.record.name&&n.delete(h.record.name),h.children.forEach(o),h.alias.forEach(o))}}function a(){return t}function l(h){const d=a8(h,t);t.splice(d,0,h),h.record.name&&!Sg(h)&&n.set(h.record.name,h)}function c(h,d){let p,g={},_,v;if("name"in h&&h.name){if(p=n.get(h.name),!p)throw Jr(1,{location:h});v=p.record.name,g=qe(xg(d.params,p.keys.filter(y=>!y.optional).concat(p.parent?p.parent.keys.filter(y=>y.optional):[]).map(y=>y.name)),h.params&&xg(h.params,p.keys.map(y=>y.name))),_=p.stringify(g)}else if(h.path!=null)_=h.path,p=t.find(y=>y.re.test(_)),p&&(g=p.parse(_),v=p.record.name);else{if(p=d.name?n.get(d.name):t.find(y=>y.re.test(d.path)),!p)throw Jr(1,{location:h,currentLocation:d});v=p.record.name,g=qe({},d.params,h.params),_=p.stringify(g)}const C=[];let T=p;for(;T;)C.unshift(T.record),T=T.parent;return{name:v,path:_,params:g,matched:C,meta:o8(C)}}i.forEach(h=>s(h));function u(){t.length=0,n.clear()}return{addRoute:s,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:r}}function xg(i,e){const t={};for(const n of e)n in i&&(t[n]=i[n]);return t}function Ig(i){const e={path:i.path,redirect:i.redirect,name:i.name,meta:i.meta||{},aliasOf:i.aliasOf,beforeEnter:i.beforeEnter,props:s8(i),children:i.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in i?i.components||null:i.component&&{default:i.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function s8(i){const e={},t=i.props||!1;if("component"in i)e.default=t;else for(const n in i.components)e[n]=typeof t=="object"?t[n]:t;return e}function Sg(i){for(;i;){if(i.record.aliasOf)return!0;i=i.parent}return!1}function o8(i){return i.reduce((e,t)=>qe(e,t.meta),{})}function Ag(i,e){const t={};for(const n in i)t[n]=n in e?e[n]:i[n];return t}function a8(i,e){let t=0,n=e.length;for(;t!==n;){const s=t+n>>1;z_(i,e[s])<0?n=s:t=s+1}const r=l8(i);return r&&(n=e.lastIndexOf(r,n-1)),n}function l8(i){let e=i;for(;e=e.parent;)if(H_(e)&&z_(i,e)===0)return e}function H_({record:i}){return!!(i.name||i.components&&Object.keys(i.components).length||i.redirect)}function c8(i){const e={};if(i===""||i==="?")return e;const n=(i[0]==="?"?i.slice(1):i).split("&");for(let r=0;r<n.length;++r){const s=n[r].replace(M_," "),o=s.indexOf("="),a=bo(o<0?s:s.slice(0,o)),l=o<0?null:bo(s.slice(o+1));if(a in e){let c=e[a];Sn(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function Cg(i){let e="";for(let t in i){const n=i[t];if(t=k9(t),n==null){n!==void 0&&(e+=(e.length?"&":"")+t);continue}(Sn(n)?n.map(s=>s&&Ru(s)):[n&&Ru(n)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function u8(i){const e={};for(const t in i){const n=i[t];n!==void 0&&(e[t]=Sn(n)?n.map(r=>r==null?null:""+r):n==null?n:""+n)}return e}const h8=Symbol(""),Tg=Symbol(""),ud=Symbol(""),j_=Symbol(""),Pu=Symbol("");function Ss(){let i=[];function e(n){return i.push(n),()=>{const r=i.indexOf(n);r>-1&&i.splice(r,1)}}function t(){i=[]}return{add:e,list:()=>i.slice(),reset:t}}function mi(i,e,t,n,r,s=o=>o()){const o=n&&(n.enterCallbacks[r]=n.enterCallbacks[r]||[]);return()=>new Promise((a,l)=>{const c=d=>{d===!1?l(Jr(4,{from:t,to:e})):d instanceof Error?l(d):Y9(d)?l(Jr(2,{from:e,to:d})):(o&&n.enterCallbacks[r]===o&&typeof d=="function"&&o.push(d),a())},u=s(()=>i.call(n&&n.instances[r],e,t,c));let h=Promise.resolve(u);i.length<3&&(h=h.then(c)),h.catch(d=>l(d))})}function Oc(i,e,t,n,r=s=>s()){const s=[];for(const o of i)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(P_(l)){const u=(l.__vccOpts||l)[e];u&&s.push(mi(u,t,n,o,a,r))}else{let c=l();s.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const h=y9(u)?u.default:u;o.mods[a]=u,o.components[a]=h;const p=(h.__vccOpts||h)[e];return p&&mi(p,t,n,o,a,r)()}))}}return s}function kg(i){const e=vn(ud),t=vn(j_),n=fn(()=>{const l=Zi(i.to);return e.resolve(l)}),r=fn(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],h=t.matched;if(!u||!h.length)return-1;const d=h.findIndex(Qr.bind(null,u));if(d>-1)return d;const p=Rg(l[c-2]);return c>1&&Rg(u)===p&&h[h.length-1].path!==p?h.findIndex(Qr.bind(null,l[c-2])):d}),s=fn(()=>r.value>-1&&m8(t.params,n.value.params)),o=fn(()=>r.value>-1&&r.value===t.matched.length-1&&V_(t.params,n.value.params));function a(l={}){if(g8(l)){const c=e[Zi(i.replace)?"replace":"push"](Zi(i.to)).catch(Xs);return i.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:fn(()=>n.value.href),isActive:s,isExactActive:o,navigate:a}}function d8(i){return i.length===1?i[0]:i}const f8=hm({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:kg,setup(i,{slots:e}){const t=yl(kg(i)),{options:n}=vn(ud),r=fn(()=>({[Ng(i.activeClass,n.linkActiveClass,"router-link-active")]:t.isActive,[Ng(i.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&d8(e.default(t));return i.custom?s:Bm("a",{"aria-current":t.isExactActive?i.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:r.value},s)}}}),p8=f8;function g8(i){if(!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)&&!i.defaultPrevented&&!(i.button!==void 0&&i.button!==0)){if(i.currentTarget&&i.currentTarget.getAttribute){const e=i.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return i.preventDefault&&i.preventDefault(),!0}}function m8(i,e){for(const t in e){const n=e[t],r=i[t];if(typeof n=="string"){if(n!==r)return!1}else if(!Sn(r)||r.length!==n.length||n.some((s,o)=>s!==r[o]))return!1}return!0}function Rg(i){return i?i.aliasOf?i.aliasOf.path:i.path:""}const Ng=(i,e,t)=>i??e??t,_8=hm({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(i,{attrs:e,slots:t}){const n=vn(Pu),r=fn(()=>i.route||n.value),s=vn(Tg,0),o=fn(()=>{let c=Zi(s);const{matched:u}=r.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),a=fn(()=>r.value.matched[o.value]);ma(Tg,fn(()=>o.value+1)),ma(h8,a),ma(Pu,r);const l=Ji();return js(()=>[l.value,a.value,i.name],([c,u,h],[d,p,g])=>{u&&(u.instances[h]=c,p&&p!==u&&c&&c===d&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!Qr(u,p)||!d)&&(u.enterCallbacks[h]||[]).forEach(_=>_(c))},{flush:"post"}),()=>{const c=r.value,u=i.name,h=a.value,d=h&&h.components[u];if(!d)return Pg(t.default,{Component:d,route:c});const p=h.props[u],g=p?p===!0?c.params:typeof p=="function"?p(c):p:null,v=Bm(d,qe({},g,e,{onVnodeUnmounted:C=>{C.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return Pg(t.default,{Component:v,route:c})||v}}});function Pg(i,e){if(!i)return null;const t=i(e);return t.length===1?t[0]:t}const y8=_8;function v8(i){const e=r8(i.routes,i),t=i.parseQuery||c8,n=i.stringifyQuery||Cg,r=i.history,s=Ss(),o=Ss(),a=Ss(),l=fh(di);let c=di;kr&&i.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Lc.bind(null,U=>""+U),h=Lc.bind(null,N9),d=Lc.bind(null,bo);function p(U,Z){let J,le;return B_(U)?(J=e.getRecordMatcher(U),le=Z):le=U,e.addRoute(le,J)}function g(U){const Z=e.getRecordMatcher(U);Z&&e.removeRoute(Z)}function _(){return e.getRoutes().map(U=>U.record)}function v(U){return!!e.getRecordMatcher(U)}function C(U,Z){if(Z=qe({},Z||l.value),typeof U=="string"){const D=Mc(t,U,Z.path),B=e.resolve({path:D.path},Z),H=r.createHref(D.fullPath);return qe(D,B,{params:d(B.params),hash:bo(D.hash),redirectedFrom:void 0,href:H})}let J;if(U.path!=null)J=qe({},U,{path:Mc(t,U.path,Z.path).path});else{const D=qe({},U.params);for(const B in D)D[B]==null&&delete D[B];J=qe({},U,{params:h(D)}),Z.params=h(Z.params)}const le=e.resolve(J,Z),Ae=U.hash||"";le.params=u(d(le.params));const L=M9(n,qe({},U,{hash:T9(Ae),path:le.path})),M=r.createHref(L);return qe({fullPath:L,hash:Ae,query:n===Cg?u8(U.query):U.query||{}},le,{redirectedFrom:void 0,href:M})}function T(U){return typeof U=="string"?Mc(t,U,l.value.path):qe({},U)}function y(U,Z){if(c!==U)return Jr(8,{from:Z,to:U})}function A(U){return w(U)}function E(U){return A(qe(T(U),{replace:!0}))}function x(U){const Z=U.matched[U.matched.length-1];if(Z&&Z.redirect){const{redirect:J}=Z;let le=typeof J=="function"?J(U):J;return typeof le=="string"&&(le=le.includes("?")||le.includes("#")?le=T(le):{path:le},le.params={}),qe({query:U.query,hash:U.hash,params:le.path!=null?{}:U.params},le)}}function w(U,Z){const J=c=C(U),le=l.value,Ae=U.state,L=U.force,M=U.replace===!0,D=x(J);if(D)return w(qe(T(D),{state:typeof D=="object"?qe({},Ae,D.state):Ae,force:L,replace:M}),Z||J);const B=J;B.redirectedFrom=Z;let H;return!L&&O9(n,le,J)&&(H=Jr(16,{to:B,from:le}),ve(le,le,!0,!1)),(H?Promise.resolve(H):k(B,le)).catch(z=>Wn(z)?Wn(z,2)?z:re(z):Y(z,B,le)).then(z=>{if(z){if(Wn(z,2))return w(qe({replace:M},T(z.to),{state:typeof z.to=="object"?qe({},Ae,z.to.state):Ae,force:L}),Z||B)}else z=O(B,le,!0,M,Ae);return P(B,le,z),z})}function S(U,Z){const J=y(U,Z);return J?Promise.reject(J):Promise.resolve()}function I(U){const Z=Me.values().next().value;return Z&&typeof Z.runWithContext=="function"?Z.runWithContext(U):U()}function k(U,Z){let J;const[le,Ae,L]=b8(U,Z);J=Oc(le.reverse(),"beforeRouteLeave",U,Z);for(const D of le)D.leaveGuards.forEach(B=>{J.push(mi(B,U,Z))});const M=S.bind(null,U,Z);return J.push(M),be(J).then(()=>{J=[];for(const D of s.list())J.push(mi(D,U,Z));return J.push(M),be(J)}).then(()=>{J=Oc(Ae,"beforeRouteUpdate",U,Z);for(const D of Ae)D.updateGuards.forEach(B=>{J.push(mi(B,U,Z))});return J.push(M),be(J)}).then(()=>{J=[];for(const D of L)if(D.beforeEnter)if(Sn(D.beforeEnter))for(const B of D.beforeEnter)J.push(mi(B,U,Z));else J.push(mi(D.beforeEnter,U,Z));return J.push(M),be(J)}).then(()=>(U.matched.forEach(D=>D.enterCallbacks={}),J=Oc(L,"beforeRouteEnter",U,Z,I),J.push(M),be(J))).then(()=>{J=[];for(const D of o.list())J.push(mi(D,U,Z));return J.push(M),be(J)}).catch(D=>Wn(D,8)?D:Promise.reject(D))}function P(U,Z,J){a.list().forEach(le=>I(()=>le(U,Z,J)))}function O(U,Z,J,le,Ae){const L=y(U,Z);if(L)return L;const M=Z===di,D=kr?history.state:{};J&&(le||M?r.replace(U.fullPath,qe({scroll:M&&D&&D.scroll},Ae)):r.push(U.fullPath,Ae)),l.value=U,ve(U,Z,J,M),re()}let R;function K(){R||(R=r.listen((U,Z,J)=>{if(!W.listening)return;const le=C(U),Ae=x(le);if(Ae){w(qe(Ae,{replace:!0,force:!0}),le).catch(Xs);return}c=le;const L=l.value;kr&&H9(yg(L.fullPath,J.delta),Wl()),k(le,L).catch(M=>Wn(M,12)?M:Wn(M,2)?(w(qe(T(M.to),{force:!0}),le).then(D=>{Wn(D,20)&&!J.delta&&J.type===wo.pop&&r.go(-1,!1)}).catch(Xs),Promise.reject()):(J.delta&&r.go(-J.delta,!1),Y(M,le,L))).then(M=>{M=M||O(le,L,!1),M&&(J.delta&&!Wn(M,8)?r.go(-J.delta,!1):J.type===wo.pop&&Wn(M,20)&&r.go(-1,!1)),P(le,L,M)}).catch(Xs)}))}let ie=Ss(),pe=Ss(),se;function Y(U,Z,J){re(U);const le=pe.list();return le.length?le.forEach(Ae=>Ae(U,Z,J)):console.error(U),Promise.reject(U)}function Q(){return se&&l.value!==di?Promise.resolve():new Promise((U,Z)=>{ie.add([U,Z])})}function re(U){return se||(se=!U,K(),ie.list().forEach(([Z,J])=>U?J(U):Z()),ie.reset()),U}function ve(U,Z,J,le){const{scrollBehavior:Ae}=i;if(!kr||!Ae)return Promise.resolve();const L=!J&&j9(yg(U.fullPath,0))||(le||!J)&&history.state&&history.state.scroll||null;return om().then(()=>Ae(U,Z,L)).then(M=>M&&z9(M)).catch(M=>Y(M,U,Z))}const ae=U=>r.go(U);let fe;const Me=new Set,W={currentRoute:l,listening:!0,addRoute:p,removeRoute:g,clearRoutes:e.clearRoutes,hasRoute:v,getRoutes:_,resolve:C,options:i,push:A,replace:E,go:ae,back:()=>ae(-1),forward:()=>ae(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:pe.add,isReady:Q,install(U){const Z=this;U.component("RouterLink",p8),U.component("RouterView",y8),U.config.globalProperties.$router=Z,Object.defineProperty(U.config.globalProperties,"$route",{enumerable:!0,get:()=>Zi(l)}),kr&&!fe&&l.value===di&&(fe=!0,A(r.location).catch(Ae=>{}));const J={};for(const Ae in di)Object.defineProperty(J,Ae,{get:()=>l.value[Ae],enumerable:!0});U.provide(ud,Z),U.provide(j_,tm(J)),U.provide(Pu,l);const le=U.unmount;Me.add(U),U.unmount=function(){Me.delete(U),Me.size<1&&(c=di,R&&R(),R=null,l.value=di,fe=!1,se=!1),le()}}};function be(U){return U.reduce((Z,J)=>Z.then(()=>I(J)),Promise.resolve())}return W}function b8(i,e){const t=[],n=[],r=[],s=Math.max(e.matched.length,i.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(i.matched.find(c=>Qr(c,a))?n.push(a):t.push(a));const l=i.matched[o];l&&(e.matched.find(c=>Qr(c,l))||r.push(l))}return[t,n,r]}const ls=(i,e)=>{const t=i.__vccOpts||i;for(const[n,r]of e)t[n]=r;return t},w8={},E8={class:"item"},x8={class:"details"};function I8(i,e){return cn(),si("div",E8,[je("i",null,[mc(i.$slots,"icon",{},void 0)]),je("div",x8,[je("h3",null,[mc(i.$slots,"heading",{},void 0)]),mc(i.$slots,"default",{},void 0)])])}const As=ls(w8,[["render",I8],["__scopeId","data-v-40a5c0e5"]]),S8={},A8={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"17",fill:"currentColor"};function C8(i,e){return cn(),si("svg",A8,e[0]||(e[0]=[je("path",{d:"M11 2.253a1 1 0 1 0-2 0h2zm-2 13a1 1 0 1 0 2 0H9zm.447-12.167a1 1 0 1 0 1.107-1.666L9.447 3.086zM1 2.253L.447 1.42A1 1 0 0 0 0 2.253h1zm0 13H0a1 1 0 0 0 1.553.833L1 15.253zm8.447.833a1 1 0 1 0 1.107-1.666l-1.107 1.666zm0-14.666a1 1 0 1 0 1.107 1.666L9.447 1.42zM19 2.253h1a1 1 0 0 0-.447-.833L19 2.253zm0 13l-.553.833A1 1 0 0 0 20 15.253h-1zm-9.553-.833a1 1 0 1 0 1.107 1.666L9.447 14.42zM9 2.253v13h2v-13H9zm1.553-.833C9.203.523 7.42 0 5.5 0v2c1.572 0 2.961.431 3.947 1.086l1.107-1.666zM5.5 0C3.58 0 1.797.523.447 1.42l1.107 1.666C2.539 2.431 3.928 2 5.5 2V0zM0 2.253v13h2v-13H0zm1.553 13.833C2.539 15.431 3.928 15 5.5 15v-2c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM5.5 15c1.572 0 2.961.431 3.947 1.086l1.107-1.666C9.203 13.523 7.42 13 5.5 13v2zm5.053-11.914C11.539 2.431 12.928 2 14.5 2V0c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM14.5 2c1.573 0 2.961.431 3.947 1.086l1.107-1.666C18.203.523 16.421 0 14.5 0v2zm3.5.253v13h2v-13h-2zm1.553 12.167C18.203 13.523 16.421 13 14.5 13v2c1.573 0 2.961.431 3.947 1.086l1.107-1.666zM14.5 13c-1.92 0-3.703.523-5.053 1.42l1.107 1.666C11.539 15.431 12.928 15 14.5 15v-2z"},null,-1)]))}const T8=ls(S8,[["render",C8]]),k8={},R8={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"iconify iconify--mdi",width:"24",height:"24",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"};function N8(i,e){return cn(),si("svg",R8,e[0]||(e[0]=[je("path",{d:"M20 18v-4h-3v1h-2v-1H9v1H7v-1H4v4h16M6.33 8l-1.74 4H7v-1h2v1h6v-1h2v1h2.41l-1.74-4H6.33M9 5v1h6V5H9m12.84 7.61c.1.22.16.48.16.8V18c0 .53-.21 1-.6 1.41c-.4.4-.85.59-1.4.59H4c-.55 0-1-.19-1.4-.59C2.21 19 2 18.53 2 18v-4.59c0-.32.06-.58.16-.8L4.5 7.22C4.84 6.41 5.45 6 6.33 6H7V5c0-.55.18-1 .57-1.41C7.96 3.2 8.44 3 9 3h6c.56 0 1.04.2 1.43.59c.39.41.57.86.57 1.41v1h.67c.88 0 1.49.41 1.83 1.22l2.34 5.39z",fill:"currentColor"},null,-1)]))}const P8=ls(k8,[["render",N8]]),L8={},M8={xmlns:"http://www.w3.org/2000/svg",width:"18",height:"20",fill:"currentColor"};function O8(i,e){return cn(),si("svg",M8,e[0]||(e[0]=[je("path",{d:"M11.447 8.894a1 1 0 1 0-.894-1.789l.894 1.789zm-2.894-.789a1 1 0 1 0 .894 1.789l-.894-1.789zm0 1.789a1 1 0 1 0 .894-1.789l-.894 1.789zM7.447 7.106a1 1 0 1 0-.894 1.789l.894-1.789zM10 9a1 1 0 1 0-2 0h2zm-2 2.5a1 1 0 1 0 2 0H8zm9.447-5.606a1 1 0 1 0-.894-1.789l.894 1.789zm-2.894-.789a1 1 0 1 0 .894 1.789l-.894-1.789zm2 .789a1 1 0 1 0 .894-1.789l-.894 1.789zm-1.106-2.789a1 1 0 1 0-.894 1.789l.894-1.789zM18 5a1 1 0 1 0-2 0h2zm-2 2.5a1 1 0 1 0 2 0h-2zm-5.447-4.606a1 1 0 1 0 .894-1.789l-.894 1.789zM9 1l.447-.894a1 1 0 0 0-.894 0L9 1zm-2.447.106a1 1 0 1 0 .894 1.789l-.894-1.789zm-6 3a1 1 0 1 0 .894 1.789L.553 4.106zm2.894.789a1 1 0 1 0-.894-1.789l.894 1.789zm-2-.789a1 1 0 1 0-.894 1.789l.894-1.789zm1.106 2.789a1 1 0 1 0 .894-1.789l-.894 1.789zM2 5a1 1 0 1 0-2 0h2zM0 7.5a1 1 0 1 0 2 0H0zm8.553 12.394a1 1 0 1 0 .894-1.789l-.894 1.789zm-1.106-2.789a1 1 0 1 0-.894 1.789l.894-1.789zm1.106 1a1 1 0 1 0 .894 1.789l-.894-1.789zm2.894.789a1 1 0 1 0-.894-1.789l.894 1.789zM8 19a1 1 0 1 0 2 0H8zm2-2.5a1 1 0 1 0-2 0h2zm-7.447.394a1 1 0 1 0 .894-1.789l-.894 1.789zM1 15H0a1 1 0 0 0 .553.894L1 15zm1-2.5a1 1 0 1 0-2 0h2zm12.553 2.606a1 1 0 1 0 .894 1.789l-.894-1.789zM17 15l.447.894A1 1 0 0 0 18 15h-1zm1-2.5a1 1 0 1 0-2 0h2zm-7.447-5.394l-2 1 .894 1.789 2-1-.894-1.789zm-1.106 1l-2-1-.894 1.789 2 1 .894-1.789zM8 9v2.5h2V9H8zm8.553-4.894l-2 1 .894 1.789 2-1-.894-1.789zm.894 0l-2-1-.894 1.789 2 1 .894-1.789zM16 5v2.5h2V5h-2zm-4.553-3.894l-2-1-.894 1.789 2 1 .894-1.789zm-2.894-1l-2 1 .894 1.789 2-1L8.553.106zM1.447 5.894l2-1-.894-1.789-2 1 .894 1.789zm-.894 0l2 1 .894-1.789-2-1-.894 1.789zM0 5v2.5h2V5H0zm9.447 13.106l-2-1-.894 1.789 2 1 .894-1.789zm0 1.789l2-1-.894-1.789-2 1 .894 1.789zM10 19v-2.5H8V19h2zm-6.553-3.894l-2-1-.894 1.789 2 1 .894-1.789zM2 15v-2.5H0V15h2zm13.447 1.894l2-1-.894-1.789-2 1 .894 1.789zM18 15v-2.5h-2V15h2z"},null,-1)]))}const D8=ls(L8,[["render",O8]]),U8={},V8={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor"};function F8(i,e){return cn(),si("svg",V8,e[0]||(e[0]=[je("path",{d:"M15 4a1 1 0 1 0 0 2V4zm0 11v-1a1 1 0 0 0-1 1h1zm0 4l-.707.707A1 1 0 0 0 16 19h-1zm-4-4l.707-.707A1 1 0 0 0 11 14v1zm-4.707-1.293a1 1 0 0 0-1.414 1.414l1.414-1.414zm-.707.707l-.707-.707.707.707zM9 11v-1a1 1 0 0 0-.707.293L9 11zm-4 0h1a1 1 0 0 0-1-1v1zm0 4H4a1 1 0 0 0 1.707.707L5 15zm10-9h2V4h-2v2zm2 0a1 1 0 0 1 1 1h2a3 3 0 0 0-3-3v2zm1 1v6h2V7h-2zm0 6a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2zm-1 1h-2v2h2v-2zm-3 1v4h2v-4h-2zm1.707 3.293l-4-4-1.414 1.414 4 4 1.414-1.414zM11 14H7v2h4v-2zm-4 0c-.276 0-.525-.111-.707-.293l-1.414 1.414C5.42 15.663 6.172 16 7 16v-2zm-.707 1.121l3.414-3.414-1.414-1.414-3.414 3.414 1.414 1.414zM9 12h4v-2H9v2zm4 0a3 3 0 0 0 3-3h-2a1 1 0 0 1-1 1v2zm3-3V3h-2v6h2zm0-6a3 3 0 0 0-3-3v2a1 1 0 0 1 1 1h2zm-3-3H3v2h10V0zM3 0a3 3 0 0 0-3 3h2a1 1 0 0 1 1-1V0zM0 3v6h2V3H0zm0 6a3 3 0 0 0 3 3v-2a1 1 0 0 1-1-1H0zm3 3h2v-2H3v2zm1-1v4h2v-4H4zm1.707 4.707l.586-.586-1.414-1.414-.586.586 1.414 1.414z"},null,-1)]))}const B8=ls(U8,[["render",F8]]),$8={},z8={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor"};function H8(i,e){return cn(),si("svg",z8,e[0]||(e[0]=[je("path",{d:"M10 3.22l-.61-.6a5.5 5.5 0 0 0-7.666.105 5.5 5.5 0 0 0-.114 7.665L10 18.78l8.39-8.4a5.5 5.5 0 0 0-.114-7.665 5.5 5.5 0 0 0-7.666-.105l-.61.61z"},null,-1)]))}const j8=ls($8,[["render",H8]]),q8={__name:"TheWelcome",setup(i){const e=()=>fetch("/__open-in-editor?file=README.md");return(t,n)=>(cn(),si(tn,null,[at(As,null,{icon:Nt(()=>[at(T8)]),heading:Nt(()=>n[0]||(n[0]=[He("Documentation")])),default:Nt(()=>[n[1]||(n[1]=He(" Vue’s ")),n[2]||(n[2]=je("a",{href:"https://vuejs.org/",target:"_blank",rel:"noopener"},"official documentation",-1)),n[3]||(n[3]=He(" provides you with all information you need to get started. "))]),_:1}),at(As,null,{icon:Nt(()=>[at(P8)]),heading:Nt(()=>n[4]||(n[4]=[He("Tooling")])),default:Nt(()=>[n[6]||(n[6]=He(" This project is served and bundled with ")),n[7]||(n[7]=je("a",{href:"https://vite.dev/guide/features.html",target:"_blank",rel:"noopener"},"Vite",-1)),n[8]||(n[8]=He(". The recommended IDE setup is ")),n[9]||(n[9]=je("a",{href:"https://code.visualstudio.com/",target:"_blank",rel:"noopener"},"VSCode",-1)),n[10]||(n[10]=He(" + ")),n[11]||(n[11]=je("a",{href:"https://github.com/vuejs/language-tools",target:"_blank",rel:"noopener"},"Vue - Official",-1)),n[12]||(n[12]=He(". If you need to test your components and web pages, check out ")),n[13]||(n[13]=je("a",{href:"https://vitest.dev/",target:"_blank",rel:"noopener"},"Vitest",-1)),n[14]||(n[14]=He(" and ")),n[15]||(n[15]=je("a",{href:"https://www.cypress.io/",target:"_blank",rel:"noopener"},"Cypress",-1)),n[16]||(n[16]=He(" / ")),n[17]||(n[17]=je("a",{href:"https://playwright.dev/",target:"_blank",rel:"noopener"},"Playwright",-1)),n[18]||(n[18]=He(". ")),n[19]||(n[19]=je("br",null,null,-1)),n[20]||(n[20]=He(" More instructions are available in ")),je("a",{href:"javascript:void(0)",onClick:e},n[5]||(n[5]=[je("code",null,"README.md",-1)])),n[21]||(n[21]=He(". "))]),_:1}),at(As,null,{icon:Nt(()=>[at(D8)]),heading:Nt(()=>n[22]||(n[22]=[He("Ecosystem")])),default:Nt(()=>[n[23]||(n[23]=He(" Get official tools and libraries for your project: ")),n[24]||(n[24]=je("a",{href:"https://pinia.vuejs.org/",target:"_blank",rel:"noopener"},"Pinia",-1)),n[25]||(n[25]=He(", ")),n[26]||(n[26]=je("a",{href:"https://router.vuejs.org/",target:"_blank",rel:"noopener"},"Vue Router",-1)),n[27]||(n[27]=He(", ")),n[28]||(n[28]=je("a",{href:"https://test-utils.vuejs.org/",target:"_blank",rel:"noopener"},"Vue Test Utils",-1)),n[29]||(n[29]=He(", and ")),n[30]||(n[30]=je("a",{href:"https://github.com/vuejs/devtools",target:"_blank",rel:"noopener"},"Vue Dev Tools",-1)),n[31]||(n[31]=He(". If you need more resources, we suggest paying ")),n[32]||(n[32]=je("a",{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"},"Awesome Vue",-1)),n[33]||(n[33]=He(" a visit. "))]),_:1}),at(As,null,{icon:Nt(()=>[at(B8)]),heading:Nt(()=>n[34]||(n[34]=[He("Community")])),default:Nt(()=>[n[35]||(n[35]=He(" Got stuck? Ask your question on ")),n[36]||(n[36]=je("a",{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"},"Vue Land",-1)),n[37]||(n[37]=He(" (our official Discord server), or ")),n[38]||(n[38]=je("a",{href:"https://stackoverflow.com/questions/tagged/vue.js",target:"_blank",rel:"noopener"},"StackOverflow",-1)),n[39]||(n[39]=He(". You should also follow the official ")),n[40]||(n[40]=je("a",{href:"https://bsky.app/profile/vuejs.org",target:"_blank",rel:"noopener"},"@vuejs.org",-1)),n[41]||(n[41]=He(" Bluesky account or the ")),n[42]||(n[42]=je("a",{href:"https://x.com/vuejs",target:"_blank",rel:"noopener"},"@vuejs",-1)),n[43]||(n[43]=He(" X account for latest news in the Vue world. "))]),_:1}),at(As,null,{icon:Nt(()=>[at(j8)]),heading:Nt(()=>n[44]||(n[44]=[He("Support Vue")])),default:Nt(()=>[n[45]||(n[45]=He(" As an independent project, Vue relies on community backing for its sustainability. You can help us by ")),n[46]||(n[46]=je("a",{href:"https://vuejs.org/sponsor/",target:"_blank",rel:"noopener"},"becoming a sponsor",-1)),n[47]||(n[47]=He(". "))]),_:1})],64))}},W8={__name:"HomeView",setup(i){return(e,t)=>(cn(),si("main",null,[at(q8)]))}},G8=v8({history:K9("/"),routes:[{path:"/",name:"home",component:W8},{path:"/about",name:"about",component:()=>_9(()=>import("./AboutView-BIAqk6Xq.js"),__vite__mapDeps([0,1]))}]});function q_(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(i);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(i,n[r])&&(t[n[r]]=i[n[r]]);return t}function W_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const K8=W_,G_=new ns("auth","Firebase",W_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja=new Ao("@firebase/auth");function Y8(i,...e){Ja.logLevel<=Ne.WARN&&Ja.warn(`Auth (${is}): ${i}`,...e)}function Sa(i,...e){Ja.logLevel<=Ne.ERROR&&Ja.error(`Auth (${is}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(i,...e){throw hd(i,...e)}function K_(i,...e){return hd(i,...e)}function Y_(i,e,t){const n=Object.assign(Object.assign({},K8()),{[e]:t});return new ns("auth","Firebase",n).create(e,{appName:i.name})}function Aa(i){return Y_(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hd(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return G_.create(i,...e)}function ze(i,e,...t){if(!i)throw hd(e,...t)}function Js(i){const e="INTERNAL ASSERTION FAILED: "+i;throw Sa(e),new Error(e)}function Za(i,e){i||Js(e)}function X8(){return Mg()==="http:"||Mg()==="https:"}function Mg(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(X8()||N5()||"connection"in navigator)?navigator.onLine:!0}function J8(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,t){this.shortDelay=e,this.longDelay=t,Za(t>e,"Short delay should be less than long delay!"),this.isMobile=wh()||Gm()}get(){return Q8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z8(i,e){Za(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Js("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Js("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Js("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nw=new Lo(3e4,6e4);function Q_(i,e){return i.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:i.tenantId}):e}async function Gl(i,e,t,n,r={}){return J_(i,r,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const a=Eh(Object.assign({key:i.config.apiKey},o)).slice(1),l=await i._getAdditionalHeaders();l["Content-Type"]="application/json",i.languageCode&&(l["X-Firebase-Locale"]=i.languageCode);const c=Object.assign({method:e,headers:l},s);return R5()||(c.referrerPolicy="no-referrer"),X_.fetch()(await Z_(i,i.config.apiHost,t,a),c)})}async function J_(i,e,t){i._canInitEmulator=!1;const n=Object.assign(Object.assign({},ew),e);try{const r=new iw(i),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw ua(i,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ua(i,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw ua(i,"email-already-in-use",o);if(l==="USER_DISABLED")throw ua(i,"user-disabled",o);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Y_(i,u,c);Lg(i,u)}}catch(r){if(r instanceof oi)throw r;Lg(i,"network-request-failed",{message:String(r)})}}async function Z_(i,e,t,n){const r=`${e}${t}?${n}`,s=i,o=s.config.emulator?Z8(i.config,r):`${i.config.apiScheme}://${r}`;return tw.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class iw{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(K_(this.auth,"network-request-failed")),nw.get())})}}function ua(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const r=K_(i,e,n);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rw(i,e){return Gl(i,"POST","/v1/accounts:delete",e)}async function el(i,e){return Gl(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zs(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sw(i,e=!1){const t=Gt(i),n=await t.getIdToken(e),r=e2(n);ze(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:n,authTime:Zs(Dc(r.auth_time)),issuedAtTime:Zs(Dc(r.iat)),expirationTime:Zs(Dc(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Dc(i){return Number(i)*1e3}function e2(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return Sa("JWT malformed, contained fewer than 3 sections"),null;try{const r=Oa(t);return r?JSON.parse(r):(Sa("Failed to decode base64 JWT payload"),null)}catch(r){return Sa("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Og(i){const e=e2(i);return ze(e,"internal-error"),ze(typeof e.exp<"u","internal-error"),ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lu(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof oi&&ow(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function ow({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zs(this.lastLoginAt),this.creationTime=Zs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tl(i){var e;const t=i.auth,n=await i.getIdToken(),r=await Lu(i,el(t,{idToken:n}));ze(r==null?void 0:r.users.length,t,"internal-error");const s=r.users[0];i._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?t2(s.providerUserInfo):[],a=cw(i.providerData,o),l=i.isAnonymous,c=!(i.email&&s.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Mu(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(i,h)}async function lw(i){const e=Gt(i);await tl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function cw(i,e){return[...i.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function t2(i){return i.map(e=>{var{providerId:t}=e,n=q_(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uw(i,e){const t=await J_(i,{},async()=>{const n=Eh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=i.config,o=await Z_(i,r,"/v1/token",`key=${s}`),a=await i._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",X_.fetch()(o,{method:"POST",headers:a,body:n})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function hw(i,e){return Gl(i,"POST","/v2/accounts:revokeToken",Q_(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ze(e.idToken,"internal-error"),ze(typeof e.idToken<"u","internal-error"),ze(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Og(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ze(e.length!==0,"internal-error");const t=Og(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await uw(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,o=new Ur;return n&&(ze(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),r&&(ze(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(ze(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ur,this.toJSON())}_performRefresh(){return Js("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(i,e){ze(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Nn{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=q_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new aw(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Mu(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Lu(this,this.stsTokenManager.getToken(this.auth,e));return ze(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return sw(this,e)}reload(){return lw(this)}_assign(e){this!==e&&(ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Nn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await tl(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qn(this.auth.app))return Promise.reject(Aa(this.auth));const e=await this.getIdToken();return await Lu(this,rw(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,o,a,l,c,u;const h=(n=t.displayName)!==null&&n!==void 0?n:void 0,d=(r=t.email)!==null&&r!==void 0?r:void 0,p=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,g=(o=t.photoURL)!==null&&o!==void 0?o:void 0,_=(a=t.tenantId)!==null&&a!==void 0?a:void 0,v=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,C=(c=t.createdAt)!==null&&c!==void 0?c:void 0,T=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:y,emailVerified:A,isAnonymous:E,providerData:x,stsTokenManager:w}=t;ze(y&&w,e,"internal-error");const S=Ur.fromJSON(this.name,w);ze(typeof y=="string",e,"internal-error"),fi(h,e.name),fi(d,e.name),ze(typeof A=="boolean",e,"internal-error"),ze(typeof E=="boolean",e,"internal-error"),fi(p,e.name),fi(g,e.name),fi(_,e.name),fi(v,e.name),fi(C,e.name),fi(T,e.name);const I=new Nn({uid:y,auth:e,email:d,emailVerified:A,displayName:h,isAnonymous:E,photoURL:g,phoneNumber:p,tenantId:_,stsTokenManager:S,createdAt:C,lastLoginAt:T});return x&&Array.isArray(x)&&(I.providerData=x.map(k=>Object.assign({},k))),v&&(I._redirectEventId=v),I}static async _fromIdTokenResponse(e,t,n=!1){const r=new Ur;r.updateFromServerResponse(t);const s=new Nn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await tl(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];ze(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?t2(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new Ur;a.updateFromIdToken(n);const l=new Nn({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Mu(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dg=new Map;function Yi(i){Za(i instanceof Function,"Expected a class definition");let e=Dg.get(i);return e?(Za(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,Dg.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}n2.type="NONE";const Ug=n2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(i,e,t){return`firebase:${i}:${e}:${t}`}class Vr{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=Uc(this.userKey,r.apiKey,s),this.fullPersistenceKey=Uc("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await el(this.auth,{idToken:e}).catch(()=>{});return t?Nn._fromGetAccountInfoResponse(this.auth,t,e):null}return Nn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Vr(Yi(Ug),e,n);const r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=r[0]||Yi(Ug);const o=Uc(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const d=await el(e,{idToken:u}).catch(()=>{});if(!d)break;h=await Nn._fromGetAccountInfoResponse(e,d,u)}else h=Nn._fromJSON(e,u);c!==s&&(a=h),s=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Vr(s,e,n):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Vr(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_w(e))return"Blackberry";if(yw(e))return"Webos";if(fw(e))return"Safari";if((e.includes("chrome/")||pw(e))&&!e.includes("edge/"))return"Chrome";if(mw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function dw(i=En()){return/firefox\//i.test(i)}function fw(i=En()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pw(i=En()){return/crios\//i.test(i)}function gw(i=En()){return/iemobile/i.test(i)}function mw(i=En()){return/android/i.test(i)}function _w(i=En()){return/blackberry/i.test(i)}function yw(i=En()){return/webos/i.test(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i2(i,e=[]){let t;switch(i){case"Browser":t=Vg(En());break;case"Worker":t=`${Vg(En())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${is}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bw(i,e={}){return Gl(i,"GET","/v2/passwordPolicy",Q_(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww=6;class Ew{constructor(e){var t,n,r,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:ww,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Fg(this),this.idTokenSubscription=new Fg(this),this.beforeStateQueue=new vw(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=G_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yi(t)),this._initializationPromise=this.queue(async()=>{var n,r,s;if(!this._deleted&&(this.persistenceManager=await Vr.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await el(this,{idToken:e}),n=await Nn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Qn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=J8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qn(this.app))return Promise.reject(Aa(this));const t=e?Gt(e):null;return t&&ze(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qn(this.app)?Promise.reject(Aa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qn(this.app)?Promise.reject(Aa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Yi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bw(this),t=new Ew(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ns("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await hw(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Yi(e)||this._popupRedirectResolver;ze(t,this,"argument-error"),this.redirectPersistenceManager=await Vr.create(this,[Yi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ze(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,n,r);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=i2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(Qn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&Y8(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Iw(i){return Gt(i)}class Fg{constructor(e){this.auth=e,this.observer=null,this.addObserver=$5(t=>this.observer=t)}get next(){return ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Sw(i,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Yi);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}new Lo(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Lo(2e3,1e4);/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Lo(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Lo(5e3,15e3);var Bg="@firebase/auth",$g="1.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Tw(i){Vn(new xn("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;ze(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:o,authDomain:a,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:i2(i)},c=new xw(n,r,s,l);return Sw(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Vn(new xn("auth-internal",e=>{const t=Iw(e.getProvider("auth").getImmediate());return(n=>new Aw(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),sn(Bg,$g,Cw(i)),sn(Bg,$g,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw=5*60;C5("authIdTokenMaxAge");Tw("Browser");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw=new Map,Nw={activated:!1,tokenObservers:[]};function An(i){return Rw.get(i)||Object.assign({},Nw)}const zg={RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e,t,n,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new uo,this.pending.promise.catch(t=>{}),await Lw(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new uo,this.pending.promise.catch(t=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}function Lw(i){return new Promise(e=>{setTimeout(e,i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},nl=new ns("appCheck","AppCheck",Mw);function r2(i){if(!An(i).activated)throw nl.create("use-before-activation",{appName:i.name})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow="firebase-app-check-database",Dw=1,Ou="firebase-app-check-store";let ha=null;function Uw(){return ha||(ha=new Promise((i,e)=>{try{const t=indexedDB.open(Ow,Dw);t.onsuccess=n=>{i(n.target.result)},t.onerror=n=>{var r;e(nl.create("storage-open",{originalErrorMessage:(r=n.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=n=>{const r=n.target.result;switch(n.oldVersion){case 0:r.createObjectStore(Ou,{keyPath:"compositeKey"})}}}catch(t){e(nl.create("storage-open",{originalErrorMessage:t==null?void 0:t.message}))}}),ha)}function Vw(i,e){return Fw(Bw(i),e)}async function Fw(i,e){const n=(await Uw()).transaction(Ou,"readwrite"),s=n.objectStore(Ou).put({compositeKey:i,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},n.onerror=l=>{var c;a(nl.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})}function Bw(i){return`${i.options.appId}-${i.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Du=new Ao("@firebase/app-check");function Hg(i,e){return Km()?Vw(i,e).catch(t=>{Du.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w={error:"UNKNOWN_ERROR"};function zw(i){return xl.encodeString(JSON.stringify(i),!1)}async function Uu(i,e=!1,t=!1){const n=i.app;r2(n);const r=An(n);let s=r.token,o;if(s&&!Us(s)&&(r.token=void 0,s=void 0),!s){const c=await r.cachedTokenPromise;c&&(Us(c)?s=c:await Hg(n,void 0))}if(!e&&s&&Us(s))return{token:s.token};let a=!1;try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),a=!0),s=await An(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"||c.code==="appCheck/initial-throttle"?Du.warn(c.message):t&&Du.error(c),o=c}let l;return s?o?Us(s)?l={token:s.token,internalError:o}:l=qg(o):(l={token:s.token},r.token=s,await Hg(n,s)):l=qg(o),a&&Ww(n,l),l}async function Hw(i){const e=i.app;r2(e);const{provider:t}=An(e);{const{token:n}=await t.getToken();return{token:n}}}function jw(i,e,t,n){const{app:r}=i,s=An(r),o={next:t,error:n,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Us(s.token)){const a=s.token;Promise.resolve().then(()=>{t({token:a.token}),jg(i)}).catch(()=>{})}s.cachedTokenPromise.then(()=>jg(i))}function s2(i,e){const t=An(i),n=t.tokenObservers.filter(r=>r.next!==e);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function jg(i){const{app:e}=i,t=An(e);let n=t.tokenRefresher;n||(n=qw(i),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function qw(i){const{app:e}=i;return new Pw(async()=>{const t=An(e);let n;if(t.token?n=await Uu(i,!0):n=await Uu(i),n.error)throw n.error;if(n.internalError)throw n.internalError},()=>!0,()=>{const t=An(e);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5;const r=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,r),Math.max(0,n-Date.now())}else return 0},zg.RETRIAL_MIN_WAIT,zg.RETRIAL_MAX_WAIT)}function Ww(i,e){const t=An(i).tokenObservers;for(const n of t)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function Us(i){return i.expireTimeMillis-Date.now()>0}function qg(i){return{token:zw($w),error:i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=An(this.app);for(const t of e)s2(this.app,t.next);return Promise.resolve()}}function Kw(i,e){return new Gw(i,e)}function Yw(i){return{getToken:e=>Uu(i,e),getLimitedUseToken:()=>Hw(i),addTokenListener:e=>jw(i,"INTERNAL",e),removeTokenListener:e=>s2(i.app,e)}}const Xw="@firebase/app-check",Qw="0.8.13",Jw="app-check",Wg="app-check-internal";function Zw(){Vn(new xn(Jw,i=>{const e=i.getProvider("app").getImmediate(),t=i.getProvider("heartbeat");return Kw(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,e,t)=>{i.getProvider(Wg).initialize()})),Vn(new xn(Wg,i=>{const e=i.getProvider("app-check").getImmediate();return Yw(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),sn(Xw,Qw)}Zw();var eE="firebase",tE="11.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn(eE,tE,"app");const o2=Symbol("firebaseApp");function dd(i){return vh()&&vn(o2,null)||Zm(i)}const Pn=()=>{};function fd(i,e){return e.split(".").reduce((t,n)=>t&&t[n],i)}function nE(i,e,t){const n=(""+e).split("."),r=n.pop(),s=n.reduce((o,a)=>o&&o[a],i);if(s!=null)return Array.isArray(s)?s.splice(Number(r),1,t):s[r]=t}function dr(i){return!!i&&typeof i=="object"}const iE=Object.prototype;function rE(i){return dr(i)&&Object.getPrototypeOf(i)===iE}function pd(i){return dr(i)&&i.type==="document"}function sE(i){return dr(i)&&i.type==="collection"}function oE(i){return pd(i)||sE(i)}function aE(i){return dr(i)&&i.type==="query"}function lE(i){return dr(i)&&"ref"in i}function cE(i){return dr(i)&&typeof i.bucket=="string"}function uE(i,e){let t;return()=>{if(!t)return t=!0,i(e())}}const hE=Symbol.for("v-scx");function dE(){return!!vn(hE,0)}const da=new WeakMap;function fE(i,e){if(!da.has(i)){const t=F1(!0);da.set(i,t);const{unmount:n}=e;e.unmount=()=>{n.call(e),t.stop(),da.delete(i)}}return da.get(i)}var Gg={};const Kg="@firebase/database",Yg="1.0.14";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a2="";function pE(i){a2=i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),St(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:ho(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ai(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=function(i){try{if(typeof window<"u"&&typeof window[i]<"u"){const e=window[i];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new gE(e)}}catch{}return new mE},Xi=l2("localStorage"),_E=l2("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr=new Ao("@firebase/database"),yE=function(){let i=1;return function(){return i++}}(),c2=function(i){const e=q5(i),t=new B5;t.update(e);const n=t.digest();return xl.encodeByteArray(n)},Mo=function(...i){let e="";for(let t=0;t<i.length;t++){const n=i[t];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?e+=Mo.apply(null,n):typeof n=="object"?e+=St(n):e+=n,e+=" "}return e};let eo=null,Xg=!0;const vE=function(i,e){oe(!0,"Can't turn on custom loggers persistently."),Fr.logLevel=Ne.VERBOSE,eo=Fr.log.bind(Fr)},Ot=function(...i){if(Xg===!0&&(Xg=!1,eo===null&&_E.get("logging_enabled")===!0&&vE()),eo){const e=Mo.apply(null,i);eo(e)}},Oo=function(i){return function(...e){Ot(i,...e)}},Vu=function(...i){const e="FIREBASE INTERNAL ERROR: "+Mo(...i);Fr.error(e)},ir=function(...i){const e=`FIREBASE FATAL ERROR: ${Mo(...i)}`;throw Fr.error(e),new Error(e)},an=function(...i){const e="FIREBASE WARNING: "+Mo(...i);Fr.warn(e)},bE=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&an("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},u2=function(i){return typeof i=="number"&&(i!==i||i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY)},wE=function(i){if(document.readyState==="complete")i();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,i())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Zr="[MIN_NAME]",rr="[MAX_NAME]",cs=function(i,e){if(i===e)return 0;if(i===Zr||e===rr)return-1;if(e===Zr||i===rr)return 1;{const t=Qg(i),n=Qg(e);return t!==null?n!==null?t-n===0?i.length-e.length:t-n:-1:n!==null?1:i<e?-1:1}},EE=function(i,e){return i===e?0:i<e?-1:1},Cs=function(i,e){if(e&&i in e)return e[i];throw new Error("Missing required key ("+i+") in object: "+St(e))},gd=function(i){if(typeof i!="object"||i===null)return St(i);const e=[];for(const n in i)e.push(n);e.sort();let t="{";for(let n=0;n<e.length;n++)n!==0&&(t+=","),t+=St(e[n]),t+=":",t+=gd(i[e[n]]);return t+="}",t},h2=function(i,e){const t=i.length;if(t<=e)return[i];const n=[];for(let r=0;r<t;r+=e)r+e>t?n.push(i.substring(r,t)):n.push(i.substring(r,r+e));return n};function un(i,e){for(const t in i)i.hasOwnProperty(t)&&e(t,i[t])}const d2=function(i){oe(!u2(i),"Invalid JSON number");const e=11,t=52,n=(1<<e-1)-1;let r,s,o,a,l;i===0?(s=0,o=0,r=1/i===-1/0?1:0):(r=i<0,i=Math.abs(i),i>=Math.pow(2,1-n)?(a=Math.min(Math.floor(Math.log(i)/Math.LN2),n),s=a+n,o=Math.round(i*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(i/Math.pow(2,1-n-t))));const c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();const u=c.join("");let h="";for(l=0;l<64;l+=8){let d=parseInt(u.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},xE=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},IE=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},SE=new RegExp("^-?(0*)\\d{1,10}$"),AE=-2147483648,CE=2147483647,Qg=function(i){if(SE.test(i)){const e=Number(i);if(e>=AE&&e<=CE)return e}return null},Do=function(i){try{i()}catch(e){setTimeout(()=>{const t=e.stack||"";throw an("Exception was thrown by user callback.",t),e},Math.floor(0))}},TE=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},to=function(i,e){const t=setTimeout(i,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Qn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(n=>this.appCheck=n)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){an(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Ot("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',an(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md="5",f2="v",p2="s",g2="r",m2="f",_2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,y2="ls",v2="p",Fu="ac",b2="websocket",w2="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e,t,n,r,s=!1,o="",a=!1,l=!1,c=null){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Xi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Xi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function PE(i){return i.host!==i.internalHost||i.isCustomHost()||i.includeNamespaceInQueryParams}function E2(i,e,t){oe(typeof e=="string","typeof type must == string"),oe(typeof t=="object","typeof params must == object");let n;if(e===b2)n=(i.secure?"wss://":"ws://")+i.internalHost+"/.ws?";else if(e===w2)n=(i.secure?"https://":"http://")+i.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);PE(i)&&(t.ns=i.namespace);const r=[];return un(t,(s,o)=>{r.push(s+"="+o)}),n+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(){this.counters_={}}incrementCounter(e,t=1){ai(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return v5(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc={},Fc={};function _d(i){const e=i.toString();return Vc[e]||(Vc[e]=new LE),Vc[e]}function ME(i,e){const t=i.toString();return Fc[t]||(Fc[t]=e()),Fc[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<n.length;++r)n[r]&&Do(()=>{this.onMessage_(n[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg="start",DE="close",UE="pLPCommand",VE="pRTLPCB",x2="id",I2="pw",S2="ser",FE="cb",BE="seg",$E="ts",zE="d",HE="dframe",A2=1870,C2=30,jE=A2-C2,qE=25e3,WE=3e4;class Rr{constructor(e,t,n,r,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Oo(e),this.stats_=_d(t),this.urlFn=l=>(this.appCheckToken&&(l[Fu]=this.appCheckToken),E2(t,w2,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new OE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(WE)),wE(()=>{if(this.isClosed_)return;this.scriptTagHolder=new yd((...s)=>{const[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Jg)this.id=a,this.password=l;else if(o===DE)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const n={};n[Jg]="t",n[S2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[FE]=this.scriptTagHolder.uniqueCallbackIdentifier),n[f2]=md,this.transportSessionId&&(n[p2]=this.transportSessionId),this.lastSessionId&&(n[y2]=this.lastSessionId),this.applicationId&&(n[v2]=this.applicationId),this.appCheckToken&&(n[Fu]=this.appCheckToken),typeof location<"u"&&location.hostname&&_2.test(location.hostname)&&(n[g2]=m2);const r=this.urlFn(n);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Rr.forceAllow_=!0}static forceDisallow(){Rr.forceDisallow_=!0}static isAvailable(){return Rr.forceAllow_?!0:!Rr.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!xE()&&!IE()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=St(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=jm(t),r=h2(n,jE);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={};n[HE]="t",n[x2]=e,n[I2]=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=St(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class yd{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=yE(),window[UE+this.uniqueCallbackIdentifier]=e,window[VE+this.uniqueCallbackIdentifier]=t,this.myIFrame=yd.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ot("frame writing exception"),a.stack&&Ot(a.stack),Ot(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ot("No IE domain setting required")}catch{const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[x2]=this.myID,e[I2]=this.myPW,e[S2]=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+C2+n.length<=A2;){const o=this.pendingSegs.shift();n=n+"&"+BE+r+"="+o.seg+"&"+$E+r+"="+o.ts+"&"+zE+r+"="+o.d,r++}return t=t+n,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(qE)),s=()=>{clearTimeout(r),n()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const r=n.readyState;(!r||r==="loaded"||r==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Ot("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE=16384,KE=45e3;let il=null;typeof MozWebSocket<"u"?il=MozWebSocket:typeof WebSocket<"u"&&(il=WebSocket);class pn{constructor(e,t,n,r,s,o,a){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Oo(this.connId),this.stats_=_d(t),this.connURL=pn.connectionURL_(t,o,a,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,s){const o={};return o[f2]=md,typeof location<"u"&&location.hostname&&_2.test(location.hostname)&&(o[g2]=m2),t&&(o[p2]=t),n&&(o[y2]=n),r&&(o[Fu]=r),s&&(o[v2]=s),E2(e,b2,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Xi.set("previous_websocket_failure",!0);try{let n;P5(),this.mySock=new il(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const r=n.message||n.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const r=n.message||n.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){pn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&il!==null&&!pn.forceDisallow_}static previouslyFailed(){return Xi.isInMemoryStorage||Xi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Xi.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const n=ho(t);this.onMessage(n)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(oe(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const n=this.extractFrameCount_(t);n!==null&&this.appendFrame_(n)}}send(e){this.resetKeepAlive();const t=St(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=h2(t,GE);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(KE))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}pn.responsesRequiredToBeHealthy=2;pn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{static get ALL_TRANSPORTS(){return[Rr,pn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=pn&&pn.isAvailable();let n=t&&!pn.previouslyFailed();if(e.webSocketOnly&&(t||an("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[pn];else{const r=this.transports_=[];for(const s of Eo.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s);Eo.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Eo.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=6e4,XE=5e3,QE=10*1024,JE=100*1024,Bc="t",Zg="d",ZE="s",e1="r",ex="e",t1="o",n1="a",i1="n",r1="p",tx="h";class nx{constructor(e,t,n,r,s,o,a,l,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Oo("c:"+this.id+":"),this.transportManager_=new Eo(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=to(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>JE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>QE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Bc in e){const t=e[Bc];t===n1?this.upgradeIfSecondaryHealthy_():t===e1?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===t1&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Cs("t",e),n=Cs("d",e);if(t==="c")this.onSecondaryControl_(n);else if(t==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:r1,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:n1,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:i1,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Cs("t",e),n=Cs("d",e);t==="c"?this.onControl_(n):t==="d"&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Cs(Bc,e);if(Zg in e){const n=e[Zg];if(t===tx){const r=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===i1){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===ZE?this.onConnectionShutdown_(n):t===e1?this.onReset_(n):t===ex?Vu("Server Error: "+n):t===t1?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Vu("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),md!==n&&an("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),to(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(YE))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):to(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(XE))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:r1,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Xi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e){this.allowedEvents_=e,this.listeners_={},oe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let r=0;r<n.length;r++)n[r].callback.apply(n[r].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!n||n===r[s].context)){r.splice(s,1);return}}validateEventType_(e){oe(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl extends k2{static getInstance(){return new rl}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!wh()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return oe(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=32,o1=768;class st{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let n=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Xe(){return new st("")}function Ve(i){return i.pieceNum_>=i.pieces_.length?null:i.pieces_[i.pieceNum_]}function Mi(i){return i.pieces_.length-i.pieceNum_}function it(i){let e=i.pieceNum_;return e<i.pieces_.length&&e++,new st(i.pieces_,e)}function R2(i){return i.pieceNum_<i.pieces_.length?i.pieces_[i.pieces_.length-1]:null}function ix(i){let e="";for(let t=i.pieceNum_;t<i.pieces_.length;t++)i.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(i.pieces_[t])));return e||"/"}function N2(i,e=0){return i.pieces_.slice(i.pieceNum_+e)}function P2(i){if(i.pieceNum_>=i.pieces_.length)return null;const e=[];for(let t=i.pieceNum_;t<i.pieces_.length-1;t++)e.push(i.pieces_[t]);return new st(e,0)}function Et(i,e){const t=[];for(let n=i.pieceNum_;n<i.pieces_.length;n++)t.push(i.pieces_[n]);if(e instanceof st)for(let n=e.pieceNum_;n<e.pieces_.length;n++)t.push(e.pieces_[n]);else{const n=e.split("/");for(let r=0;r<n.length;r++)n[r].length>0&&t.push(n[r])}return new st(t,0)}function Le(i){return i.pieceNum_>=i.pieces_.length}function ln(i,e){const t=Ve(i),n=Ve(e);if(t===null)return e;if(t===n)return ln(it(i),it(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+i+")")}function L2(i,e){if(Mi(i)!==Mi(e))return!1;for(let t=i.pieceNum_,n=e.pieceNum_;t<=i.pieces_.length;t++,n++)if(i.pieces_[t]!==e.pieces_[n])return!1;return!0}function gn(i,e){let t=i.pieceNum_,n=e.pieceNum_;if(Mi(i)>Mi(e))return!1;for(;t<i.pieces_.length;){if(i.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0}class rx{constructor(e,t){this.errorPrefix_=t,this.parts_=N2(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=Sl(this.parts_[n]);M2(this)}}function sx(i,e){i.parts_.length>0&&(i.byteLength_+=1),i.parts_.push(e),i.byteLength_+=Sl(e),M2(i)}function ox(i){const e=i.parts_.pop();i.byteLength_-=Sl(e),i.parts_.length>0&&(i.byteLength_-=1)}function M2(i){if(i.byteLength_>o1)throw new Error(i.errorPrefix_+"has a key path longer than "+o1+" bytes ("+i.byteLength_+").");if(i.parts_.length>s1)throw new Error(i.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+s1+") or object contains a cycle "+Gi(i))}function Gi(i){return i.parts_.length===0?"":"in property '"+i.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd extends k2{static getInstance(){return new vd}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const n=!document[e];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}getInitialEvent(e){return oe(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=1e3,ax=60*5*1e3,a1=30*1e3,lx=1.3,cx=3e4,ux="server_kill",l1=3;class ei extends T2{constructor(e,t,n,r,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=ei.nextPersistentConnectionId_++,this.log_=Oo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ts,this.maxReconnectDelay_=ax,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");vd.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&rl.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,s={r,a:e,b:t};this.log_(St(s)),oe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new uo,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,n,r){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),oe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),oe(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const s={p:n},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,c=a.s;ei.warnOnListenWarnings_(l,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(n,r),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&ai(e,"w")){const n=Hr(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();an(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||F5(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=a1)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=V5(e)?"auth":"gauth",n={cred:e};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(t,n,r=>{const s=r.s,o=r.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),oe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";r&&(s.q=n,s.t=r),this.sendRequest(o,s)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const s={p:t,d:n};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,s){this.initConnection_();const o={p:t,d:n};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,n=>{if(n.s!=="ok"){const s=n.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+St(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Vu("Unrecognized action received from server: "+St(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){oe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ts,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ts,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>cx&&(this.reconnectDelay_=Ts),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*lx)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+ei.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,n())},c=function(h){oe(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Ot("getToken() completed but was canceled"):(Ot("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new nx(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,p=>{an(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(ux)},s))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&an(h),l())}}}interrupt(e){Ot("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ot("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ip(this.interruptReasons_)&&(this.reconnectDelay_=Ts,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;t?n=t.map(s=>gd(s)).join("$"):n="default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new st(e).toString();let r;if(this.listens.has(n)){const s=this.listens.get(n);r=s.get(t),s.delete(t),s.size===0&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Ot("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=l1&&(this.reconnectDelay_=a1,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Ot("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=l1&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+a2.replace(/\./g,"-")]=1,wh()?e["framework.cordova"]=1:Gm()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=rl.getInstance().currentlyOnline();return ip(this.interruptReasons_)&&e}}ei.nextPersistentConnectionId_=0;ei.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Fe(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Fe(Zr,e),r=new Fe(Zr,t);return this.compare(n,r)!==0}minPost(){return Fe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fa;class O2 extends Kl{static get __EMPTY_NODE(){return fa}static set __EMPTY_NODE(e){fa=e}compare(e,t){return cs(e.name,t.name)}isDefinedOn(e){throw ts("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Fe.MIN}maxPost(){return new Fe(rr,fa)}makePost(e,t){return oe(typeof e=="string","KeyIndex indexValue must always be a string."),new Fe(e,fa)}toString(){return".key"}}const Br=new O2;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,t,n,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class wt{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??wt.RED,this.left=r??Qt.EMPTY_NODE,this.right=s??Qt.EMPTY_NODE}copy(e,t,n,r,s){return new wt(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(e,t,n),null):s===0?r=r.copy(null,t,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Qt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),t(e,n.key)===0){if(n.right.isEmpty())return Qt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}wt.RED=!0;wt.BLACK=!1;class hx{copy(e,t,n,r,s){return this}insert(e,t,n){return new wt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Qt{constructor(e,t=Qt.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Qt(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,wt.BLACK,null,null))}remove(e){return new Qt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,wt.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),t===0)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();)if(t=this.comparator_(e,n.key),t===0){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else t<0?n=n.left:t>0&&(r=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new pa(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new pa(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new pa(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new pa(this.root_,null,this.comparator_,!0,e)}}Qt.EMPTY_NODE=new hx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(i,e){return cs(i.name,e.name)}function bd(i,e){return cs(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bu;function fx(i){Bu=i}const D2=function(i){return typeof i=="number"?"number:"+d2(i):"string:"+i},U2=function(i){if(i.isLeafNode()){const e=i.val();oe(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ai(e,".sv"),"Priority must be a string or number.")}else oe(i===Bu||i.isEmpty(),"priority of unexpected type.");oe(i===Bu||i.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c1;class vt{static set __childrenNodeConstructor(e){c1=e}static get __childrenNodeConstructor(){return c1}constructor(e,t=vt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,oe(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),U2(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new vt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:vt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Le(e)?this:Ve(e)===".priority"?this.priorityNode_:vt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:vt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Ve(e);return n===null?t:t.isEmpty()&&n!==".priority"?this:(oe(n!==".priority"||Mi(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,vt.__childrenNodeConstructor.EMPTY_NODE.updateChild(it(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+D2(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=d2(this.value_):e+=this.value_,this.lazyHash_=c2(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===vt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof vt.__childrenNodeConstructor?-1:(oe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=vt.VALUE_TYPE_ORDER.indexOf(t),s=vt.VALUE_TYPE_ORDER.indexOf(n);return oe(r>=0,"Unknown leaf type: "+t),oe(s>=0,"Unknown leaf type: "+n),r===s?n==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}vt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V2,F2;function px(i){V2=i}function gx(i){F2=i}class mx extends Kl{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),s=n.compareTo(r);return s===0?cs(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Fe.MIN}maxPost(){return new Fe(rr,new vt("[PRIORITY-POST]",F2))}makePost(e,t){const n=V2(e);return new Fe(t,new vt("[PRIORITY-POST]",n))}toString(){return".priority"}}const Vt=new mx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x=Math.log(2);class yx{constructor(e){const t=s=>parseInt(Math.log(s)/_x,10),n=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const r=n(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const sl=function(i,e,t,n){i.sort(e);const r=function(l,c){const u=c-l;let h,d;if(u===0)return null;if(u===1)return h=i[l],d=t?t(h):h,new wt(d,h.node,wt.BLACK,null,null);{const p=parseInt(u/2,10)+l,g=r(l,p),_=r(p+1,c);return h=i[p],d=t?t(h):h,new wt(d,h.node,wt.BLACK,g,_)}},s=function(l){let c=null,u=null,h=i.length;const d=function(g,_){const v=h-g,C=h;h-=g;const T=r(v+1,C),y=i[v],A=t?t(y):y;p(new wt(A,y.node,_,null,T))},p=function(g){c?(c.left=g,c=g):(u=g,c=g)};for(let g=0;g<l.count;++g){const _=l.nextBitIsOne(),v=Math.pow(2,l.count-(g+1));_?d(v,wt.BLACK):(d(v,wt.BLACK),d(v,wt.RED))}return u},o=new yx(i.length),a=s(o);return new Qt(n||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $c;const Er={};class Jn{static get Default(){return oe(Er&&Vt,"ChildrenNode.ts has not been loaded"),$c=$c||new Jn({".priority":Er},{".priority":Vt}),$c}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=Hr(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Qt?t:null}hasIndex(e){return ai(this.indexSet_,e.toString())}addIndex(e,t){oe(e!==Br,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const s=t.getIterator(Fe.Wrap);let o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=s.getNext();let a;r?a=sl(n,e.getCompare()):a=Er;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new Jn(u,c)}addToIndexes(e,t){const n=Da(this.indexes_,(r,s)=>{const o=Hr(this.indexSet_,s);if(oe(o,"Missing index implementation for "+s),r===Er)if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(Fe.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),sl(a,o.getCompare())}else return Er;else{const a=t.get(e.name);let l=r;return a&&(l=l.remove(new Fe(e.name,a))),l.insert(e,e.node)}});return new Jn(n,this.indexSet_)}removeFromIndexes(e,t){const n=Da(this.indexes_,r=>{if(r===Er)return r;{const s=t.get(e.name);return s?r.remove(new Fe(e.name,s)):r}});return new Jn(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ks;class Ge{static get EMPTY_NODE(){return ks||(ks=new Ge(new Qt(bd),null,Jn.Default))}constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&U2(this.priorityNode_),this.children_.isEmpty()&&oe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ks}updatePriority(e){return this.children_.isEmpty()?this:new Ge(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?ks:t}}getChild(e){const t=Ve(e);return t===null?this:this.getImmediateChild(t).getChild(it(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(oe(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const n=new Fe(e,t);let r,s;t.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(n,this.children_));const o=r.isEmpty()?ks:this.priorityNode_;return new Ge(r,o,s)}}updateChild(e,t){const n=Ve(e);if(n===null)return t;{oe(Ve(e)!==".priority"||Mi(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(it(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,s=!0;if(this.forEachChild(Vt,(o,a)=>{t[o]=a.val(e),n++,s&&Ge.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!e&&s&&r<2*n){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+D2(this.getPriority().val())+":"),this.forEachChild(Vt,(t,n)=>{const r=n.hash();r!==""&&(e+=":"+t+":"+r)}),this.lazyHash_=e===""?"":c2(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const s=r.getPredecessorKey(new Fe(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const n=t.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Fe(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const n=t.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Fe(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(r=>t(r.name,r.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,Fe.Wrap);let s=r.peek();for(;s!=null&&t.compare(s,e)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,Fe.Wrap);let s=r.peek();for(;s!=null&&t.compare(s,e)>0;)r.getNext(),s=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Uo?-1:0}withIndex(e){if(e===Br||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ge(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Br||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const n=this.getIterator(Vt),r=t.getIterator(Vt);let s=n.getNext(),o=r.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=n.getNext(),o=r.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Br?null:this.indexMap_.get(e.toString())}}Ge.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class vx extends Ge{constructor(){super(new Qt(bd),Ge.EMPTY_NODE,Jn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ge.EMPTY_NODE}isEmpty(){return!1}}const Uo=new vx;Object.defineProperties(Fe,{MIN:{value:new Fe(Zr,Ge.EMPTY_NODE)},MAX:{value:new Fe(rr,Uo)}});O2.__EMPTY_NODE=Ge.EMPTY_NODE;vt.__childrenNodeConstructor=Ge;fx(Uo);gx(Uo);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=!0;function Dt(i,e=null){if(i===null)return Ge.EMPTY_NODE;if(typeof i=="object"&&".priority"in i&&(e=i[".priority"]),oe(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof i=="object"&&".value"in i&&i[".value"]!==null&&(i=i[".value"]),typeof i!="object"||".sv"in i){const t=i;return new vt(t,Dt(e))}if(!(i instanceof Array)&&bx){const t=[];let n=!1;if(un(i,(o,a)=>{if(o.substring(0,1)!=="."){const l=Dt(a);l.isEmpty()||(n=n||!l.getPriority().isEmpty(),t.push(new Fe(o,l)))}}),t.length===0)return Ge.EMPTY_NODE;const s=sl(t,dx,o=>o.name,bd);if(n){const o=sl(t,Vt.getCompare());return new Ge(s,Dt(e),new Jn({".priority":o},{".priority":Vt}))}else return new Ge(s,Dt(e),Jn.Default)}else{let t=Ge.EMPTY_NODE;return un(i,(n,r)=>{if(ai(i,n)&&n.substring(0,1)!=="."){const s=Dt(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(n,s))}}),t.updatePriority(Dt(e))}}px(Dt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx extends Kl{constructor(e){super(),this.indexPath_=e,oe(!Le(e)&&Ve(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),s=n.compareTo(r);return s===0?cs(e.name,t.name):s}makePost(e,t){const n=Dt(e),r=Ge.EMPTY_NODE.updateChild(this.indexPath_,n);return new Fe(t,r)}maxPost(){const e=Ge.EMPTY_NODE.updateChild(this.indexPath_,Uo);return new Fe(rr,e)}toString(){return N2(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex extends Kl{compare(e,t){const n=e.node.compareTo(t.node);return n===0?cs(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Fe.MIN}maxPost(){return Fe.MAX}makePost(e,t){const n=Dt(e);return new Fe(t,n)}toString(){return".value"}}const xx=new Ex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ix(i){return{type:"value",snapshotNode:i}}function Sx(i,e){return{type:"child_added",snapshotNode:e,childName:i}}function Ax(i,e){return{type:"child_removed",snapshotNode:e,childName:i}}function u1(i,e,t){return{type:"child_changed",snapshotNode:e,childName:i,oldSnap:t}}function Cx(i,e){return{type:"child_moved",snapshotNode:e,childName:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Vt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return oe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return oe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Zr}hasEnd(){return this.endSet_}getIndexEndValue(){return oe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return oe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:rr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return oe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Vt}copy(){const e=new wd;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function h1(i){const e={};if(i.isDefault())return e;let t;if(i.index_===Vt?t="$priority":i.index_===xx?t="$value":i.index_===Br?t="$key":(oe(i.index_ instanceof wx,"Unrecognized index type!"),t=i.index_.toString()),e.orderBy=St(t),i.startSet_){const n=i.startAfterSet_?"startAfter":"startAt";e[n]=St(i.indexStartValue_),i.startNameSet_&&(e[n]+=","+St(i.indexStartName_))}if(i.endSet_){const n=i.endBeforeSet_?"endBefore":"endAt";e[n]=St(i.indexEndValue_),i.endNameSet_&&(e[n]+=","+St(i.indexEndName_))}return i.limitSet_&&(i.isViewFromLeft()?e.limitToFirst=i.limit_:e.limitToLast=i.limit_),e}function d1(i){const e={};if(i.startSet_&&(e.sp=i.indexStartValue_,i.startNameSet_&&(e.sn=i.indexStartName_),e.sin=!i.startAfterSet_),i.endSet_&&(e.ep=i.indexEndValue_,i.endNameSet_&&(e.en=i.indexEndName_),e.ein=!i.endBeforeSet_),i.limitSet_){e.l=i.limit_;let t=i.viewFrom_;t===""&&(i.isViewFromLeft()?t="l":t="r"),e.vf=t}return i.index_!==Vt&&(e.i=i.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol extends T2{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(oe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Oo("p:rest:"),this.listens_={}}listen(e,t,n,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=ol.getListenId_(e,n),a={};this.listens_[o]=a;const l=h1(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(s,h,!1,n),Hr(this.listens_,o)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",r(d,null)}})}unlisten(e,t){const n=ol.getListenId_(e,t);delete this.listens_[n]}get(e){const t=h1(e._queryParams),n=e._path.toString(),r=new uo;return this.restRequest_(n+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(n,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Eh(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=ho(a.responseText)}catch{an("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,l)}else a.status!==401&&a.status!==404&&an("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(){this.rootNode_=Ge.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(){return{value:null,children:new Map}}function B2(i,e,t){if(Le(e))i.value=t,i.children.clear();else if(i.value!==null)i.value=i.value.updateChild(e,t);else{const n=Ve(e);i.children.has(n)||i.children.set(n,al());const r=i.children.get(n);e=it(e),B2(r,e,t)}}function $u(i,e,t){i.value!==null?t(e,i.value):kx(i,(n,r)=>{const s=new st(e.toString()+"/"+n);$u(r,s,t)})}function kx(i,e){i.children.forEach((t,n)=>{e(n,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&un(this.last_,(n,r)=>{t[n]=t[n]-r}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1=10*1e3,Nx=30*1e3,Px=5*60*1e3;class Lx{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Rx(e);const n=f1+(Nx-f1)*Math.random();to(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;un(e,(r,s)=>{s>0&&ai(this.statsToReport_,r)&&(t[r]=s,n=!0)}),n&&this.server_.reportStats(t),to(this.reportStats_.bind(this),Math.floor(Math.random()*2*Px))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ln;(function(i){i[i.OVERWRITE=0]="OVERWRITE",i[i.MERGE=1]="MERGE",i[i.ACK_USER_WRITE=2]="ACK_USER_WRITE",i[i.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ln||(Ln={}));function $2(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function z2(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function H2(i){return{fromUser:!1,fromServer:!0,queryId:i,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Ln.ACK_USER_WRITE,this.source=$2()}operationForChild(e){if(Le(this.path)){if(this.affectedTree.value!=null)return oe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new st(e));return new ll(Xe(),t,this.revert)}}else return oe(Ve(this.path)===e,"operationForChild called for unrelated child."),new ll(it(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Ln.OVERWRITE}operationForChild(e){return Le(this.path)?new sr(this.source,Xe(),this.snap.getImmediateChild(e)):new sr(this.source,it(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Ln.MERGE}operationForChild(e){if(Le(this.path)){const t=this.children.subtree(new st(e));return t.isEmpty()?null:t.value?new sr(this.source,Xe(),t.value):new xo(this.source,Xe(),t)}else return oe(Ve(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new xo(this.source,it(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Le(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ve(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function Mx(i,e,t,n){const r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&i.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Cx(o.childName,o.snapshotNode))}),Rs(i,r,"child_removed",e,n,t),Rs(i,r,"child_added",e,n,t),Rs(i,r,"child_moved",s,n,t),Rs(i,r,"child_changed",e,n,t),Rs(i,r,"value",e,n,t),r}function Rs(i,e,t,n,r,s){const o=n.filter(a=>a.type===t);o.sort((a,l)=>Dx(i,a,l)),o.forEach(a=>{const l=Ox(i,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,i.query_))})})}function Ox(i,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,i.index_)),e}function Dx(i,e,t){if(e.childName==null||t.childName==null)throw ts("Should only compare child_ events.");const n=new Fe(e.childName,e.snapshotNode),r=new Fe(t.childName,t.snapshotNode);return i.index_.compare(n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j2(i,e){return{eventCache:i,serverCache:e}}function no(i,e,t,n){return j2(new Ed(e,t,n),i.serverCache)}function q2(i,e,t,n){return j2(i.eventCache,new Ed(e,t,n))}function zu(i){return i.eventCache.isFullyInitialized()?i.eventCache.getNode():null}function or(i){return i.serverCache.isFullyInitialized()?i.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zc;const Ux=()=>(zc||(zc=new Qt(EE)),zc);class nt{static fromObject(e){let t=new nt(null);return un(e,(n,r)=>{t=t.set(new st(n),r)}),t}constructor(e,t=Ux()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Xe(),value:this.value};if(Le(e))return null;{const n=Ve(e),r=this.children.get(n);if(r!==null){const s=r.findRootMostMatchingPathAndValue(it(e),t);return s!=null?{path:Et(new st(n),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Le(e))return this;{const t=Ve(e),n=this.children.get(t);return n!==null?n.subtree(it(e)):new nt(null)}}set(e,t){if(Le(e))return new nt(t,this.children);{const n=Ve(e),s=(this.children.get(n)||new nt(null)).set(it(e),t),o=this.children.insert(n,s);return new nt(this.value,o)}}remove(e){if(Le(e))return this.children.isEmpty()?new nt(null):new nt(null,this.children);{const t=Ve(e),n=this.children.get(t);if(n){const r=n.remove(it(e));let s;return r.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,r),this.value===null&&s.isEmpty()?new nt(null):new nt(this.value,s)}else return this}}get(e){if(Le(e))return this.value;{const t=Ve(e),n=this.children.get(t);return n?n.get(it(e)):null}}setTree(e,t){if(Le(e))return t;{const n=Ve(e),s=(this.children.get(n)||new nt(null)).setTree(it(e),t);let o;return s.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,s),new nt(this.value,o)}}fold(e){return this.fold_(Xe(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((r,s)=>{n[r]=s.fold_(Et(e,r),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Xe(),t)}findOnPath_(e,t,n){const r=this.value?n(t,this.value):!1;if(r)return r;if(Le(e))return null;{const s=Ve(e),o=this.children.get(s);return o?o.findOnPath_(it(e),Et(t,s),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Xe(),t)}foreachOnPath_(e,t,n){if(Le(e))return this;{this.value&&n(t,this.value);const r=Ve(e),s=this.children.get(r);return s?s.foreachOnPath_(it(e),Et(t,r),n):new nt(null)}}foreach(e){this.foreach_(Xe(),e)}foreach_(e,t){this.children.inorderTraversal((n,r)=>{r.foreach_(Et(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.writeTree_=e}static empty(){return new wn(new nt(null))}}function io(i,e,t){if(Le(e))return new wn(new nt(t));{const n=i.writeTree_.findRootMostValueAndPath(e);if(n!=null){const r=n.path;let s=n.value;const o=ln(r,e);return s=s.updateChild(o,t),new wn(i.writeTree_.set(r,s))}else{const r=new nt(t),s=i.writeTree_.setTree(e,r);return new wn(s)}}}function p1(i,e,t){let n=i;return un(t,(r,s)=>{n=io(n,Et(e,r),s)}),n}function g1(i,e){if(Le(e))return wn.empty();{const t=i.writeTree_.setTree(e,new nt(null));return new wn(t)}}function Hu(i,e){return fr(i,e)!=null}function fr(i,e){const t=i.writeTree_.findRootMostValueAndPath(e);return t!=null?i.writeTree_.get(t.path).getChild(ln(t.path,e)):null}function m1(i){const e=[],t=i.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Vt,(n,r)=>{e.push(new Fe(n,r))}):i.writeTree_.children.inorderTraversal((n,r)=>{r.value!=null&&e.push(new Fe(n,r.value))}),e}function Si(i,e){if(Le(e))return i;{const t=fr(i,e);return t!=null?new wn(new nt(t)):new wn(i.writeTree_.subtree(e))}}function ju(i){return i.writeTree_.isEmpty()}function es(i,e){return W2(Xe(),i.writeTree_,e)}function W2(i,e,t){if(e.value!=null)return t.updateChild(i,e.value);{let n=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(oe(s.value!==null,"Priority writes must always be leaf nodes"),n=s.value):t=W2(Et(i,r),s,t)}),!t.getChild(i).isEmpty()&&n!==null&&(t=t.updateChild(Et(i,".priority"),n)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G2(i,e){return J2(e,i)}function Vx(i,e,t,n,r){oe(n>i.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),i.allWrites.push({path:e,snap:t,writeId:n,visible:r}),r&&(i.visibleWrites=io(i.visibleWrites,e,t)),i.lastWriteId=n}function Fx(i,e){for(let t=0;t<i.allWrites.length;t++){const n=i.allWrites[t];if(n.writeId===e)return n}return null}function Bx(i,e){const t=i.allWrites.findIndex(a=>a.writeId===e);oe(t>=0,"removeWrite called with nonexistent writeId.");const n=i.allWrites[t];i.allWrites.splice(t,1);let r=n.visible,s=!1,o=i.allWrites.length-1;for(;r&&o>=0;){const a=i.allWrites[o];a.visible&&(o>=t&&$x(a,n.path)?r=!1:gn(n.path,a.path)&&(s=!0)),o--}if(r){if(s)return zx(i),!0;if(n.snap)i.visibleWrites=g1(i.visibleWrites,n.path);else{const a=n.children;un(a,l=>{i.visibleWrites=g1(i.visibleWrites,Et(n.path,l))})}return!0}else return!1}function $x(i,e){if(i.snap)return gn(i.path,e);for(const t in i.children)if(i.children.hasOwnProperty(t)&&gn(Et(i.path,t),e))return!0;return!1}function zx(i){i.visibleWrites=K2(i.allWrites,Hx,Xe()),i.allWrites.length>0?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1}function Hx(i){return i.visible}function K2(i,e,t){let n=wn.empty();for(let r=0;r<i.length;++r){const s=i[r];if(e(s)){const o=s.path;let a;if(s.snap)gn(t,o)?(a=ln(t,o),n=io(n,a,s.snap)):gn(o,t)&&(a=ln(o,t),n=io(n,Xe(),s.snap.getChild(a)));else if(s.children){if(gn(t,o))a=ln(t,o),n=p1(n,a,s.children);else if(gn(o,t))if(a=ln(o,t),Le(a))n=p1(n,Xe(),s.children);else{const l=Hr(s.children,Ve(a));if(l){const c=l.getChild(it(a));n=io(n,Xe(),c)}}}else throw ts("WriteRecord should have .snap or .children")}}return n}function Y2(i,e,t,n,r){if(!n&&!r){const s=fr(i.visibleWrites,e);if(s!=null)return s;{const o=Si(i.visibleWrites,e);if(ju(o))return t;if(t==null&&!Hu(o,Xe()))return null;{const a=t||Ge.EMPTY_NODE;return es(o,a)}}}else{const s=Si(i.visibleWrites,e);if(!r&&ju(s))return t;if(!r&&t==null&&!Hu(s,Xe()))return null;{const o=function(c){return(c.visible||r)&&(!n||!~n.indexOf(c.writeId))&&(gn(c.path,e)||gn(e,c.path))},a=K2(i.allWrites,o,e),l=t||Ge.EMPTY_NODE;return es(a,l)}}}function jx(i,e,t){let n=Ge.EMPTY_NODE;const r=fr(i.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Vt,(s,o)=>{n=n.updateImmediateChild(s,o)}),n;if(t){const s=Si(i.visibleWrites,e);return t.forEachChild(Vt,(o,a)=>{const l=es(Si(s,new st(o)),a);n=n.updateImmediateChild(o,l)}),m1(s).forEach(o=>{n=n.updateImmediateChild(o.name,o.node)}),n}else{const s=Si(i.visibleWrites,e);return m1(s).forEach(o=>{n=n.updateImmediateChild(o.name,o.node)}),n}}function qx(i,e,t,n,r){oe(n||r,"Either existingEventSnap or existingServerSnap must exist");const s=Et(e,t);if(Hu(i.visibleWrites,s))return null;{const o=Si(i.visibleWrites,s);return ju(o)?r.getChild(t):es(o,r.getChild(t))}}function Wx(i,e,t,n){const r=Et(e,t),s=fr(i.visibleWrites,r);if(s!=null)return s;if(n.isCompleteForChild(t)){const o=Si(i.visibleWrites,r);return es(o,n.getNode().getImmediateChild(t))}else return null}function Gx(i,e){return fr(i.visibleWrites,e)}function Kx(i,e,t,n,r,s,o){let a;const l=Si(i.visibleWrites,e),c=fr(l,Xe());if(c!=null)a=c;else if(t!=null)a=es(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o);let p=d.getNext();for(;p&&u.length<r;)h(p,n)!==0&&u.push(p),p=d.getNext();return u}else return[]}function Yx(){return{visibleWrites:wn.empty(),allWrites:[],lastWriteId:-1}}function qu(i,e,t,n){return Y2(i.writeTree,i.treePath,e,t,n)}function X2(i,e){return jx(i.writeTree,i.treePath,e)}function _1(i,e,t,n){return qx(i.writeTree,i.treePath,e,t,n)}function cl(i,e){return Gx(i.writeTree,Et(i.treePath,e))}function Xx(i,e,t,n,r,s){return Kx(i.writeTree,i.treePath,e,t,n,r,s)}function xd(i,e,t){return Wx(i.writeTree,i.treePath,e,t)}function Q2(i,e){return J2(Et(i.treePath,e),i.writeTree)}function J2(i,e){return{treePath:i,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;oe(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),oe(n!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const s=r.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(n,u1(n,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(n);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(n,Ax(n,r.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(n,Sx(n,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(n,u1(n,e.snapshotNode,r.oldSnap));else throw ts("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}}const Z2=new Jx;class Id{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const n=this.optCompleteServerCache_!=null?new Ed(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return xd(this.writes_,e,n)}}getChildAfterChild(e,t,n){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:or(this.viewCache_),s=Xx(this.writes_,r,t,1,n,e);return s.length===0?null:s[0]}}function Zx(i,e){oe(e.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),oe(e.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed")}function eI(i,e,t,n,r){const s=new Qx;let o,a;if(t.type===Ln.OVERWRITE){const c=t;c.source.fromUser?o=Wu(i,e,c.path,c.snap,n,r,s):(oe(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!Le(c.path),o=ul(i,e,c.path,c.snap,n,r,a,s))}else if(t.type===Ln.MERGE){const c=t;c.source.fromUser?o=nI(i,e,c.path,c.children,n,r,s):(oe(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=Gu(i,e,c.path,c.children,n,r,a,s))}else if(t.type===Ln.ACK_USER_WRITE){const c=t;c.revert?o=sI(i,e,c.path,n,r,s):o=iI(i,e,c.path,c.affectedTree,n,r,s)}else if(t.type===Ln.LISTEN_COMPLETE)o=rI(i,e,t.path,n,s);else throw ts("Unknown operation type: "+t.type);const l=s.getChanges();return tI(e,o,l),{viewCache:o,changes:l}}function tI(i,e,t){const n=e.eventCache;if(n.isFullyInitialized()){const r=n.getNode().isLeafNode()||n.getNode().isEmpty(),s=zu(i);(t.length>0||!i.eventCache.isFullyInitialized()||r&&!n.getNode().equals(s)||!n.getNode().getPriority().equals(s.getPriority()))&&t.push(Ix(zu(e)))}}function ey(i,e,t,n,r,s){const o=e.eventCache;if(cl(n,t)!=null)return e;{let a,l;if(Le(t))if(oe(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=or(e),u=c instanceof Ge?c:Ge.EMPTY_NODE,h=X2(n,u);a=i.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const c=qu(n,or(e));a=i.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{const c=Ve(t);if(c===".priority"){oe(Mi(t)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const h=_1(n,t,u,l);h!=null?a=i.filter.updatePriority(u,h):a=o.getNode()}else{const u=it(t);let h;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const d=_1(n,t,o.getNode(),l);d!=null?h=o.getNode().getImmediateChild(c).updateChild(u,d):h=o.getNode().getImmediateChild(c)}else h=xd(n,c,e.serverCache);h!=null?a=i.filter.updateChild(o.getNode(),c,h,u,r,s):a=o.getNode()}}return no(e,a,o.isFullyInitialized()||Le(t),i.filter.filtersNodes())}}function ul(i,e,t,n,r,s,o,a){const l=e.serverCache;let c;const u=o?i.filter:i.filter.getIndexedFilter();if(Le(t))c=u.updateFullNode(l.getNode(),n,null);else if(u.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(t,n);c=u.updateFullNode(l.getNode(),p,null)}else{const p=Ve(t);if(!l.isCompleteForPath(t)&&Mi(t)>1)return e;const g=it(t),v=l.getNode().getImmediateChild(p).updateChild(g,n);p===".priority"?c=u.updatePriority(l.getNode(),v):c=u.updateChild(l.getNode(),p,v,g,Z2,null)}const h=q2(e,c,l.isFullyInitialized()||Le(t),u.filtersNodes()),d=new Id(r,h,s);return ey(i,h,t,r,d,a)}function Wu(i,e,t,n,r,s,o){const a=e.eventCache;let l,c;const u=new Id(r,e,s);if(Le(t))c=i.filter.updateFullNode(e.eventCache.getNode(),n,o),l=no(e,c,!0,i.filter.filtersNodes());else{const h=Ve(t);if(h===".priority")c=i.filter.updatePriority(e.eventCache.getNode(),n),l=no(e,c,a.isFullyInitialized(),a.isFiltered());else{const d=it(t),p=a.getNode().getImmediateChild(h);let g;if(Le(d))g=n;else{const _=u.getCompleteChild(h);_!=null?R2(d)===".priority"&&_.getChild(P2(d)).isEmpty()?g=_:g=_.updateChild(d,n):g=Ge.EMPTY_NODE}if(p.equals(g))l=e;else{const _=i.filter.updateChild(a.getNode(),h,g,d,u,o);l=no(e,_,a.isFullyInitialized(),i.filter.filtersNodes())}}}return l}function y1(i,e){return i.eventCache.isCompleteForChild(e)}function nI(i,e,t,n,r,s,o){let a=e;return n.foreach((l,c)=>{const u=Et(t,l);y1(e,Ve(u))&&(a=Wu(i,a,u,c,r,s,o))}),n.foreach((l,c)=>{const u=Et(t,l);y1(e,Ve(u))||(a=Wu(i,a,u,c,r,s,o))}),a}function v1(i,e,t){return t.foreach((n,r)=>{e=e.updateChild(n,r)}),e}function Gu(i,e,t,n,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;Le(t)?c=n:c=new nt(null).setTree(t,n);const u=e.serverCache.getNode();return c.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const p=e.serverCache.getNode().getImmediateChild(h),g=v1(i,p,d);l=ul(i,l,new st(h),g,r,s,o,a)}}),c.children.inorderTraversal((h,d)=>{const p=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!u.hasChild(h)&&!p){const g=e.serverCache.getNode().getImmediateChild(h),_=v1(i,g,d);l=ul(i,l,new st(h),_,r,s,o,a)}}),l}function iI(i,e,t,n,r,s,o){if(cl(r,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(n.value!=null){if(Le(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return ul(i,e,t,l.getNode().getChild(t),r,s,a,o);if(Le(t)){let c=new nt(null);return l.getNode().forEachChild(Br,(u,h)=>{c=c.set(new st(u),h)}),Gu(i,e,t,c,r,s,a,o)}else return e}else{let c=new nt(null);return n.foreach((u,h)=>{const d=Et(t,u);l.isCompleteForPath(d)&&(c=c.set(u,l.getNode().getChild(d)))}),Gu(i,e,t,c,r,s,a,o)}}function rI(i,e,t,n,r){const s=e.serverCache,o=q2(e,s.getNode(),s.isFullyInitialized()||Le(t),s.isFiltered());return ey(i,o,t,n,Z2,r)}function sI(i,e,t,n,r,s){let o;if(cl(n,t)!=null)return e;{const a=new Id(n,e,r),l=e.eventCache.getNode();let c;if(Le(t)||Ve(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=qu(n,or(e));else{const h=e.serverCache.getNode();oe(h instanceof Ge,"serverChildren would be complete if leaf node"),u=X2(n,h)}u=u,c=i.filter.updateFullNode(l,u,s)}else{const u=Ve(t);let h=xd(n,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=l.getImmediateChild(u)),h!=null?c=i.filter.updateChild(l,u,h,it(t),a,s):e.eventCache.getNode().hasChild(u)?c=i.filter.updateChild(l,u,Ge.EMPTY_NODE,it(t),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=qu(n,or(e)),o.isLeafNode()&&(c=i.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||cl(n,Xe())!=null,no(e,c,o,i.filter.filtersNodes())}}function oI(i,e){const t=or(i.viewCache_);return t&&(i.query._queryParams.loadsAllData()||!Le(e)&&!t.getImmediateChild(Ve(e)).isEmpty())?t.getChild(e):null}function b1(i,e,t,n){e.type===Ln.MERGE&&e.source.queryId!==null&&(oe(or(i.viewCache_),"We should always have a full cache before handling merges"),oe(zu(i.viewCache_),"Missing event cache, even though we have a server cache"));const r=i.viewCache_,s=eI(i.processor_,r,e,t,n);return Zx(i.processor_,s.viewCache),oe(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),i.viewCache_=s.viewCache,aI(i,s.changes,s.viewCache.eventCache.getNode())}function aI(i,e,t,n){const r=i.eventRegistrations_;return Mx(i.eventGenerator_,e,t,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let w1;function lI(i){oe(!w1,"__referenceConstructor has already been defined"),w1=i}function Sd(i,e,t,n){const r=e.source.queryId;if(r!==null){const s=i.views.get(r);return oe(s!=null,"SyncTree gave us an op for an invalid query."),b1(s,e,t,n)}else{let s=[];for(const o of i.views.values())s=s.concat(b1(o,e,t,n));return s}}function Ad(i,e){let t=null;for(const n of i.views.values())t=t||oI(n,e);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E1;function cI(i){oe(!E1,"__referenceConstructor has already been defined"),E1=i}class x1{constructor(e){this.listenProvider_=e,this.syncPointTree_=new nt(null),this.pendingWriteTree_=Yx(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function uI(i,e,t,n,r){return Vx(i.pendingWriteTree_,e,t,n,r),r?Xl(i,new sr($2(),e,t)):[]}function Nr(i,e,t=!1){const n=Fx(i.pendingWriteTree_,e);if(Bx(i.pendingWriteTree_,e)){let s=new nt(null);return n.snap!=null?s=s.set(Xe(),!0):un(n.children,o=>{s=s.set(new st(o),!0)}),Xl(i,new ll(n.path,s,t))}else return[]}function Yl(i,e,t){return Xl(i,new sr(z2(),e,t))}function hI(i,e,t){const n=nt.fromObject(t);return Xl(i,new xo(z2(),e,n))}function dI(i,e,t,n){const r=ry(i,n);if(r!=null){const s=sy(r),o=s.path,a=s.queryId,l=ln(o,e),c=new sr(H2(a),l,t);return oy(i,o,c)}else return[]}function fI(i,e,t,n){const r=ry(i,n);if(r){const s=sy(r),o=s.path,a=s.queryId,l=ln(o,e),c=nt.fromObject(t),u=new xo(H2(a),l,c);return oy(i,o,u)}else return[]}function ty(i,e,t){const r=i.pendingWriteTree_,s=i.syncPointTree_.findOnPath(e,(o,a)=>{const l=ln(o,e),c=Ad(a,l);if(c)return c});return Y2(r,e,s,t,!0)}function Xl(i,e){return ny(e,i.syncPointTree_,null,G2(i.pendingWriteTree_,Xe()))}function ny(i,e,t,n){if(Le(i.path))return iy(i,e,t,n);{const r=e.get(Xe());t==null&&r!=null&&(t=Ad(r,Xe()));let s=[];const o=Ve(i.path),a=i.operationForChild(o),l=e.children.get(o);if(l&&a){const c=t?t.getImmediateChild(o):null,u=Q2(n,o);s=s.concat(ny(a,l,c,u))}return r&&(s=s.concat(Sd(r,i,n,t))),s}}function iy(i,e,t,n){const r=e.get(Xe());t==null&&r!=null&&(t=Ad(r,Xe()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,c=Q2(n,o),u=i.operationForChild(o);u&&(s=s.concat(iy(u,a,l,c)))}),r&&(s=s.concat(Sd(r,i,n,t))),s}function ry(i,e){return i.tagToQueryMap.get(e)}function sy(i){const e=i.indexOf("$");return oe(e!==-1&&e<i.length-1,"Bad queryKey."),{queryId:i.substr(e+1),path:new st(i.substr(0,e))}}function oy(i,e,t){const n=i.syncPointTree_.get(e);oe(n,"Missing sync point for query tag that we're tracking");const r=G2(i.pendingWriteTree_,e);return Sd(n,t,r,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Cd(t)}node(){return this.node_}}class Td{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Et(this.path_,e);return new Td(this.syncTree_,t)}node(){return ty(this.syncTree_,this.path_)}}const pI=function(i){return i=i||{},i.timestamp=i.timestamp||new Date().getTime(),i},I1=function(i,e,t){if(!i||typeof i!="object")return i;if(oe(".sv"in i,"Unexpected leaf node or priority contents"),typeof i[".sv"]=="string")return gI(i[".sv"],e,t);if(typeof i[".sv"]=="object")return mI(i[".sv"],e);oe(!1,"Unexpected server value: "+JSON.stringify(i,null,2))},gI=function(i,e,t){switch(i){case"timestamp":return t.timestamp;default:oe(!1,"Unexpected server value: "+i)}},mI=function(i,e,t){i.hasOwnProperty("increment")||oe(!1,"Unexpected server value: "+JSON.stringify(i,null,2));const n=i.increment;typeof n!="number"&&oe(!1,"Unexpected increment value: "+n);const r=e.node();if(oe(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return n;const o=r.getValue();return typeof o!="number"?n:o+n},_I=function(i,e,t,n){return kd(e,new Td(t,i),n)},yI=function(i,e,t){return kd(i,new Cd(e),t)};function kd(i,e,t){const n=i.getPriority().val(),r=I1(n,e.getImmediateChild(".priority"),t);let s;if(i.isLeafNode()){const o=i,a=I1(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new vt(a,Dt(r)):i}else{const o=i;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new vt(r))),o.forEachChild(Vt,(a,l)=>{const c=kd(l,e.getImmediateChild(a),t);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Nd(i,e){let t=e instanceof st?e:new st(e),n=i,r=Ve(t);for(;r!==null;){const s=Hr(n.node.children,r)||{children:{},childCount:0};n=new Rd(r,n,s),t=it(t),r=Ve(t)}return n}function us(i){return i.node.value}function ay(i,e){i.node.value=e,Ku(i)}function ly(i){return i.node.childCount>0}function vI(i){return us(i)===void 0&&!ly(i)}function Ql(i,e){un(i.node.children,(t,n)=>{e(new Rd(t,i,n))})}function cy(i,e,t,n){t&&e(i),Ql(i,r=>{cy(r,e,!0)})}function bI(i,e,t){let n=i.parent;for(;n!==null;){if(e(n))return!0;n=n.parent}return!1}function Vo(i){return new st(i.parent===null?i.name:Vo(i.parent)+"/"+i.name)}function Ku(i){i.parent!==null&&wI(i.parent,i.name,i)}function wI(i,e,t){const n=vI(t),r=ai(i.node.children,e);n&&r?(delete i.node.children[e],i.node.childCount--,Ku(i)):!n&&!r&&(i.node.children[e]=t.node,i.node.childCount++,Ku(i))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=/[\[\].#$\/\u0000-\u001F\u007F]/,xI=/[\[\].#$\u0000-\u001F\u007F]/,Hc=10*1024*1024,uy=function(i){return typeof i=="string"&&i.length!==0&&!EI.test(i)},II=function(i){return typeof i=="string"&&i.length!==0&&!xI.test(i)},SI=function(i){return i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),II(i)},hy=function(i,e,t){const n=t instanceof st?new rx(t,i):t;if(e===void 0)throw new Error(i+"contains undefined "+Gi(n));if(typeof e=="function")throw new Error(i+"contains a function "+Gi(n)+" with contents = "+e.toString());if(u2(e))throw new Error(i+"contains "+e.toString()+" "+Gi(n));if(typeof e=="string"&&e.length>Hc/3&&Sl(e)>Hc)throw new Error(i+"contains a string greater than "+Hc+" utf8 bytes "+Gi(n)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(un(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!uy(o)))throw new Error(i+" contains an invalid key ("+o+") "+Gi(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);sx(n,o),hy(i,a,n),ox(n)}),r&&s)throw new Error(i+' contains ".value" child '+Gi(n)+" in addition to actual children.")}},AI=function(i,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!uy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!SI(t))throw new Error(j5(i,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function TI(i,e){let t=null;for(let n=0;n<e.length;n++){const r=e[n],s=r.getPath();t!==null&&!L2(s,t.path)&&(i.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(r)}t&&i.eventLists_.push(t)}function pr(i,e,t){TI(i,t),kI(i,n=>gn(n,e)||gn(e,n))}function kI(i,e){i.recursionDepth_++;let t=!0;for(let n=0;n<i.eventLists_.length;n++){const r=i.eventLists_[n];if(r){const s=r.path;e(s)?(RI(i.eventLists_[n]),i.eventLists_[n]=null):t=!1}}t&&(i.eventLists_=[]),i.recursionDepth_--}function RI(i){for(let e=0;e<i.events.length;e++){const t=i.events[e];if(t!==null){i.events[e]=null;const n=t.getEventRunner();eo&&Ot("event: "+t.toString()),Do(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI="repo_interrupt",PI=25;class LI{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new CI,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=al(),this.transactionQueueTree_=new Rd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function MI(i,e,t){if(i.stats_=_d(i.repoInfo_),i.forceRestClient_||TE())i.server_=new ol(i.repoInfo_,(n,r,s,o)=>{S1(i,n,r,s,o)},i.authTokenProvider_,i.appCheckProvider_),setTimeout(()=>A1(i,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{St(t)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}i.persistentConnection_=new ei(i.repoInfo_,e,(n,r,s,o)=>{S1(i,n,r,s,o)},n=>{A1(i,n)},n=>{DI(i,n)},i.authTokenProvider_,i.appCheckProvider_,t),i.server_=i.persistentConnection_}i.authTokenProvider_.addTokenChangeListener(n=>{i.server_.refreshAuthToken(n)}),i.appCheckProvider_.addTokenChangeListener(n=>{i.server_.refreshAppCheckToken(n.token)}),i.statsReporter_=ME(i.repoInfo_,()=>new Lx(i.stats_,i.server_)),i.infoData_=new Tx,i.infoSyncTree_=new x1({startListening:(n,r,s,o)=>{let a=[];const l=i.infoData_.getNode(n._path);return l.isEmpty()||(a=Yl(i.infoSyncTree_,n._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Pd(i,"connected",!1),i.serverSyncTree_=new x1({startListening:(n,r,s,o)=>(i.server_.listen(n,s,r,(a,l)=>{const c=o(a,l);pr(i.eventQueue_,n._path,c)}),[]),stopListening:(n,r)=>{i.server_.unlisten(n,r)}})}function OI(i){const t=i.infoData_.getNode(new st(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function dy(i){return pI({timestamp:OI(i)})}function S1(i,e,t,n,r){i.dataUpdateCount++;const s=new st(e);t=i.interceptServerDataCallback_?i.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(n){const l=Da(t,c=>Dt(c));o=fI(i.serverSyncTree_,s,l,r)}else{const l=Dt(t);o=dI(i.serverSyncTree_,s,l,r)}else if(n){const l=Da(t,c=>Dt(c));o=hI(i.serverSyncTree_,s,l)}else{const l=Dt(t);o=Yl(i.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Md(i,s)),pr(i.eventQueue_,a,o)}function A1(i,e){Pd(i,"connected",e),e===!1&&VI(i)}function DI(i,e){un(e,(t,n)=>{Pd(i,t,n)})}function Pd(i,e,t){const n=new st("/.info/"+e),r=Dt(t);i.infoData_.updateSnapshot(n,r);const s=Yl(i.infoSyncTree_,n,r);pr(i.eventQueue_,n,s)}function UI(i){return i.nextWriteId_++}function VI(i){fy(i,"onDisconnectEvents");const e=dy(i),t=al();$u(i.onDisconnect_,Xe(),(r,s)=>{const o=_I(r,s,i.serverSyncTree_,e);B2(t,r,o)});let n=[];$u(t,Xe(),(r,s)=>{n=n.concat(Yl(i.serverSyncTree_,r,s));const o=zI(i,r);Md(i,o)}),i.onDisconnect_=al(),pr(i.eventQueue_,Xe(),n)}function FI(i){i.persistentConnection_&&i.persistentConnection_.interrupt(NI)}function fy(i,...e){let t="";i.persistentConnection_&&(t=i.persistentConnection_.id+":"),Ot(t,...e)}function py(i,e,t){return ty(i.serverSyncTree_,e,t)||Ge.EMPTY_NODE}function Ld(i,e=i.transactionQueueTree_){if(e||Jl(i,e),us(e)){const t=my(i,e);oe(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&BI(i,Vo(e),t)}else ly(e)&&Ql(e,t=>{Ld(i,t)})}function BI(i,e,t){const n=t.map(c=>c.currentWriteId),r=py(i,e,n);let s=r;const o=r.hash();for(let c=0;c<t.length;c++){const u=t[c];oe(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=ln(e,u.path);s=s.updateChild(h,u.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;i.server_.put(l.toString(),a,c=>{fy(i,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const h=[];for(let d=0;d<t.length;d++)t[d].status=2,u=u.concat(Nr(i.serverSyncTree_,t[d].currentWriteId)),t[d].onComplete&&h.push(()=>t[d].onComplete(null,!0,t[d].currentOutputSnapshotResolved)),t[d].unwatcher();Jl(i,Nd(i.transactionQueueTree_,e)),Ld(i,i.transactionQueueTree_),pr(i.eventQueue_,e,u);for(let d=0;d<h.length;d++)Do(h[d])}else{if(c==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{an("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=c}Md(i,e)}},o)}function Md(i,e){const t=gy(i,e),n=Vo(t),r=my(i,t);return $I(i,r,n),n}function $I(i,e,t){if(e.length===0)return;const n=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=ln(t,l.path);let u=!1,h;if(oe(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,h=l.abortReason,r=r.concat(Nr(i.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=PI)u=!0,h="maxretry",r=r.concat(Nr(i.serverSyncTree_,l.currentWriteId,!0));else{const d=py(i,l.path,o);l.currentInputSnapshot=d;const p=e[a].update(d.val());if(p!==void 0){hy("transaction failed: Data returned ",p,l.path);let g=Dt(p);typeof p=="object"&&p!=null&&ai(p,".priority")||(g=g.updatePriority(d.getPriority()));const v=l.currentWriteId,C=dy(i),T=yI(g,d,C);l.currentOutputSnapshotRaw=g,l.currentOutputSnapshotResolved=T,l.currentWriteId=UI(i),o.splice(o.indexOf(v),1),r=r.concat(uI(i.serverSyncTree_,l.path,T,l.currentWriteId,l.applyLocally)),r=r.concat(Nr(i.serverSyncTree_,v,!0))}else u=!0,h="nodata",r=r.concat(Nr(i.serverSyncTree_,l.currentWriteId,!0))}pr(i.eventQueue_,t,r),r=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?n.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):n.push(()=>e[a].onComplete(new Error(h),!1,null))))}Jl(i,i.transactionQueueTree_);for(let a=0;a<n.length;a++)Do(n[a]);Ld(i,i.transactionQueueTree_)}function gy(i,e){let t,n=i.transactionQueueTree_;for(t=Ve(e);t!==null&&us(n)===void 0;)n=Nd(n,t),e=it(e),t=Ve(e);return n}function my(i,e){const t=[];return _y(i,e,t),t.sort((n,r)=>n.order-r.order),t}function _y(i,e,t){const n=us(e);if(n)for(let r=0;r<n.length;r++)t.push(n[r]);Ql(e,r=>{_y(i,r,t)})}function Jl(i,e){const t=us(e);if(t){let n=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[n]=t[r],n++);t.length=n,ay(e,t.length>0?t:void 0)}Ql(e,n=>{Jl(i,n)})}function zI(i,e){const t=Vo(gy(i,e)),n=Nd(i.transactionQueueTree_,e);return bI(n,r=>{jc(i,r)}),jc(i,n),cy(n,r=>{jc(i,r)}),t}function jc(i,e){const t=us(e);if(t){const n=[];let r=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(oe(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(oe(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(Nr(i.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&n.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?ay(e,void 0):t.length=s+1,pr(i.eventQueue_,Vo(e),r);for(let o=0;o<n.length;o++)Do(n[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HI(i){let e="";const t=i.split("/");for(let n=0;n<t.length;n++)if(t[n].length>0){let r=t[n];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function jI(i){const e={};i.charAt(0)==="?"&&(i=i.substring(1));for(const t of i.split("&")){if(t.length===0)continue;const n=t.split("=");n.length===2?e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):an(`Invalid query segment '${t}' in query '${i}'`)}return e}const C1=function(i,e){const t=qI(i),n=t.namespace;t.domain==="firebase.com"&&ir(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&t.domain!=="localhost"&&ir("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||bE();const r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new NE(t.host,t.secure,n,r,e,"",n!==t.subdomain),path:new st(t.pathString)}},qI=function(i){let e="",t="",n="",r="",s="",o=!0,a="https",l=443;if(typeof i=="string"){let c=i.indexOf("//");c>=0&&(a=i.substring(0,c-1),i=i.substring(c+2));let u=i.indexOf("/");u===-1&&(u=i.length);let h=i.indexOf("?");h===-1&&(h=i.length),e=i.substring(0,Math.min(u,h)),u<h&&(r=HI(i.substring(u,h)));const d=jI(i.substring(Math.min(i.length,h)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")t="localhost";else if(p.split(".").length<=2)t=p;else{const g=e.indexOf(".");n=e.substring(0,g).toLowerCase(),t=e.substring(g+1),s=n}"ns"in d&&(s=d.ns)}return{host:e,port:l,domain:t,subdomain:n,secure:o,scheme:a,pathString:r,namespace:s}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Le(this._path)?null:R2(this._path)}get ref(){return new hs(this._repo,this._path)}get _queryIdentifier(){const e=d1(this._queryParams),t=gd(e);return t==="{}"?"default":t}get _queryObject(){return d1(this._queryParams)}isEqual(e){if(e=Gt(e),!(e instanceof Od))return!1;const t=this._repo===e._repo,n=L2(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+ix(this._path)}}class hs extends Od{constructor(e,t){super(e,t,new wd,!1)}get parent(){const e=P2(this._path);return e===null?null:new hs(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}lI(hs);cI(hs);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI="FIREBASE_DATABASE_EMULATOR_HOST",Yu={};let GI=!1;function KI(i,e,t,n,r){let s=n||i.options.databaseURL;s===void 0&&(i.options.projectId||ir("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ot("Using default host for project ",i.options.projectId),s=`${i.options.projectId}-default-rtdb.firebaseio.com`);let o=C1(s,r),a=o.repoInfo,l;typeof process<"u"&&Gg&&(l=Gg[WI]),l?(s=`http://${l}?ns=${a.namespace}`,o=C1(s,r),a=o.repoInfo):o.repoInfo.secure;const c=new RE(i.name,i.options,e);AI("Invalid Firebase Database URL",o),Le(o.path)||ir("Database URL must point to the root of a Firebase Database (not including a child path).");const u=XI(a,i,c,new kE(i,t));return new QI(u,i)}function YI(i,e){const t=Yu[e];(!t||t[i.key]!==i)&&ir(`Database ${e}(${i.repoInfo_}) has already been deleted.`),FI(i),delete t[i.key]}function XI(i,e,t,n){let r=Yu[e.name];r||(r={},Yu[e.name]=r);let s=r[i.toURLString()];return s&&ir("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new LI(i,GI,t,n),r[i.toURLString()]=s,s}class QI{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(MI(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new hs(this._repo,Xe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(YI(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ir("Cannot call "+e+" on a deleted database.")}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(i){pE(is),Vn(new xn("database",(e,{instanceIdentifier:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return KI(n,r,s,t)},"PUBLIC").setMultipleInstances(!0)),sn(Kg,Yg,i),sn(Kg,Yg,"esm2017")}ei.prototype.simpleListen=function(i,e){this.sendRequest("q",{p:i},e)};ei.prototype.echo=function(i,e){this.sendRequest("echo",{d:i},e)};JI();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yy="firebasestorage.googleapis.com",ZI="storageBucket",eS=2*60*1e3,tS=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n extends oi{constructor(e,t,n=0){super(qc(e),`Firebase Storage: ${t} (${qc(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,$n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Bn;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Bn||(Bn={}));function qc(i){return"storage/"+i}function nS(){const i="An unknown error occurred, please check the error payload for server response.";return new $n(Bn.UNKNOWN,i)}function iS(){return new $n(Bn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function rS(){return new $n(Bn.CANCELED,"User canceled the upload/download.")}function sS(i){return new $n(Bn.INVALID_URL,"Invalid URL '"+i+"'.")}function oS(i){return new $n(Bn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function T1(i){return new $n(Bn.INVALID_ARGUMENT,i)}function vy(){return new $n(Bn.APP_DELETED,"The Firebase app was deleted.")}function aS(i){return new $n(Bn.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=mn.makeFromUrl(e,t)}catch{return new mn(e,"")}if(n.path==="")return n;throw oS(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";function s(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(A){A.path_=decodeURIComponent(A.path)}const u="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),g={bucket:1,path:3},_=t===yy?"(?:storage.googleapis.com|storage.cloud.google.com)":t,v="([^?#]*)",C=new RegExp(`^https?://${_}/${r}/${v}`,"i"),y=[{regex:a,indices:l,postModify:s},{regex:p,indices:g,postModify:c},{regex:C,indices:{bucket:1,path:2},postModify:c}];for(let A=0;A<y.length;A++){const E=y[A],x=E.regex.exec(e);if(x){const w=x[E.indices.bucket];let S=x[E.indices.path];S||(S=""),n=new mn(w,S),E.postModify(n);break}}if(n==null)throw sS(e);return n}}class lS{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(i,e,t){let n=1,r=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...v){c||(c=!0,e.apply(null,v))}function h(v){r=setTimeout(()=>{r=null,i(p,l())},v)}function d(){s&&clearTimeout(s)}function p(v,...C){if(c){d();return}if(v){d(),u.call(null,v,...C);return}if(l()||o){d(),u.call(null,v,...C);return}n<64&&(n*=2);let y;a===1?(a=2,y=0):y=(n+Math.random())*1e3,h(y)}let g=!1;function _(v){g||(g=!0,d(),!c&&(r!==null?(v||(a=2),clearTimeout(r),h(0)):v||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,_(!0)},t),_}function uS(i){i(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(i){return i!==void 0}function k1(i,e,t,n){if(n<e)throw T1(`Invalid value for '${i}'. Expected ${e} or greater.`);if(n>t)throw T1(`Invalid value for '${i}'. Expected ${t} or less.`)}function dS(i){const e=encodeURIComponent;let t="?";for(const n in i)if(i.hasOwnProperty(n)){const r=e(n)+"="+e(i[n]);t=t+r+"&"}return t=t.slice(0,-1),t}var hl;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(hl||(hl={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(i,e){const t=i>=500&&i<600,r=[408,429].indexOf(i)!==-1,s=e.indexOf(i)!==-1;return t||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,t,n,r,s,o,a,l,c,u,h,d=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new ga(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===hl.NO_ERROR,l=s.getStatus();if(!a||fS(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===hl.ABORT;n(!1,new ga(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new ga(c,s))})},t=(n,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());hS(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=nS();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?vy():rS();o(l)}else{const l=iS();o(l)}};this.canceled_?t(!1,new ga(!1,null,!0)):this.backoffId_=cS(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&uS(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ga{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function gS(i,e){e!==null&&e.length>0&&(i.Authorization="Firebase "+e)}function mS(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _S(i,e){e&&(i["X-Firebase-GMPID"]=e)}function yS(i,e){e!==null&&(i["X-Firebase-AppCheck"]=e)}function vS(i,e,t,n,r,s,o=!0){const a=dS(i.urlParams),l=i.url+a,c=Object.assign({},i.headers);return _S(c,e),gS(c,t),mS(c,s),yS(c,n),new pS(l,i.method,c,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bS(i){if(i.length===0)return null;const e=i.lastIndexOf("/");return e===-1?"":i.slice(0,e)}function wS(i){const e=i.lastIndexOf("/",i.length-2);return e===-1?i:i.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,t){this._service=e,t instanceof mn?this._location=t:this._location=mn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new dl(e,t)}get root(){const e=new mn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return wS(this._location.path)}get storage(){return this._service}get parent(){const e=bS(this._location.path);if(e===null)return null;const t=new mn(this._location.bucket,e);return new dl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw aS(e)}}function R1(i,e){const t=e==null?void 0:e[ZI];return t==null?null:mn.makeFromBucketSpec(t,i)}class ES{constructor(e,t,n,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=yy,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=eS,this._maxUploadRetryTime=tS,this._requests=new Set,r!=null?this._bucket=mn.makeFromBucketSpec(r,this._host):this._bucket=R1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=mn.makeFromBucketSpec(this._url,e):this._bucket=R1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){k1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){k1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Qn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new dl(this,e)}_makeRequest(e,t,n,r,s=!0){if(this._deleted)return new lS(vy());{const o=vS(e,this._appId,n,r,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const N1="@firebase/storage",P1="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS="storage";function IS(i,{instanceIdentifier:e}){const t=i.getProvider("app").getImmediate(),n=i.getProvider("auth-internal"),r=i.getProvider("app-check-internal");return new ES(t,n,r,e,is)}function SS(){Vn(new xn(xS,IS,"PUBLIC").setMultipleInstances(!0)),sn(N1,P1,""),sn(N1,P1,"esm2017")}SS();const Wc=new WeakMap;function by(i,e){return Wc.has(e)||Wc.set(e,{f:{},r:{},s:{},u:{}}),Wc.get(e)}function AS(i,e,t,n){if(!i)return t;const[r,s]=wy(i);if(!r)return t;const o=by(void 0,n)[r]||{},a=e||s;return a&&a in o?o[a]:t}function CS(i,e,t,n){if(!i)return;const[r,s]=wy(i);if(!r)return;const o=by(void 0,n)[r],a=e||s;if(a)return t.then(l=>{o[a]=l}).catch(Pn),a}function wy(i){return oE(i)||aE(i)?["f",i.path]:lE(i)?["r",i.toString()]:cE(i)?["s",i.toString()]:[]}const Gc=new WeakMap;function TS(i,e,t){const n=dd();Gc.has(n)||Gc.set(n,new Map);const r=Gc.get(n),s=CS(e,t,i,n);return s&&r.set(s,i),s?()=>r.delete(s):Pn}const kS={toFirestore(i){return i},fromFirestore(i,e){return i.exists()?Object.defineProperties(i.data(e),{id:{value:i.id}}):null}};function Xu(i,e,t,n){if(!rE(i))return[i,{}];const r=[{},{}],s=Object.keys(t).reduce((a,l)=>{const c=t[l];return a[c.path]=c.data(),a},{});function o(a,l,c,u){l=l||{};const[h,d]=u;Object.getOwnPropertyNames(a).forEach(p=>{const g=Object.getOwnPropertyDescriptor(a,p);g&&!g.enumerable&&Object.defineProperty(h,p,g)});for(const p in a){const g=a[p];if(g==null||g instanceof Date||g instanceof ft||g instanceof zl)h[p]=g;else if(pd(g)){const _=c+p;h[p]=_ in t?l[p]:g.path,d[_]=g.converter?g:g.withConverter(n.converter)}else if(Array.isArray(g)){h[p]=Array(g.length);for(let _=0;_<g.length;_++){const v=g[_];v&&v.path in s&&(h[p][_]=s[v.path])}o(g,l[p]||h[p],c+p+".",[h[p],d])}else dr(g)?(h[p]={},o(g,l[p],c+p+".",[h[p],d])):h[p]=g}}return o(i,e,"",r),r}const Dd={reset:!1,wait:!0,maxRefDepth:2,converter:kS,snapshotOptions:{serverTimestamps:"estimate"}};function fl(i){for(const e in i)i[e].unsub()}function Qu(i,e,t,n,r,s,o,a,l){const[c,u]=Xu(n.data(i.snapshotOptions),fd(e,t),r,i);s.set(e,t,c),Ju(i,e,t,r,u,s,o,a,l)}function RS({ref:i,target:e,path:t,depth:n,resolve:r,reject:s,ops:o},a){const l=Object.create(null);let c=Pn;return a.once?R_(i).then(u=>{u.exists()?Qu(a,e,t,u,l,o,n,r,s):(o.set(e,t,null),r())}).catch(s):c=ql(i,u=>{u.exists()?Qu(a,e,t,u,l,o,n,r,s):(o.set(e,t,null),r())},s),()=>{c(),fl(l)}}function Ju(i,e,t,n,r,s,o,a,l){const c=Object.keys(r);if(Object.keys(n).filter(_=>c.indexOf(_)<0).forEach(_=>{n[_].unsub(),delete n[_]}),!c.length||++o>i.maxRefDepth)return a(t);let h=0;const d=c.length,p=Object.create(null);function g(_){_ in p&&++h>=d&&a(t)}c.forEach(_=>{const v=n[_],C=r[_],T=`${t}.${_}`;if(p[T]=!0,v)if(v.path!==C.path)v.unsub();else return;n[_]={data:()=>fd(e,T),unsub:RS({ref:C,target:e,path:T,depth:o,ops:s,resolve:g.bind(null,T),reject:l},i),path:C.path}})}function NS(i,e,t,n,r,s){const o=Object.assign({},Dd,s),{snapshotListenOptions:a,snapshotOptions:l,wait:c,once:u}=o,h="value";let d=Ji(c?[]:i.value);c||t.set(i,h,[]);const p=n;let g,_=Pn;const v=[],C={added:({newIndex:y,doc:A})=>{v.splice(y,0,Object.create(null));const E=v[y],[x,w]=Xu(A.data(l),void 0,E,o);t.add(Kn(d),y,x),Ju(o,d,`${h}.${y}`,E,w,t,0,n.bind(null,A),r)},modified:({oldIndex:y,newIndex:A,doc:E})=>{const x=Kn(d),w=v[y],S=x[y],[I,k]=Xu(E.data(l),S,w,o);v.splice(A,0,w),t.remove(x,y),t.add(x,A,I),Ju(o,d,`${h}.${A}`,w,k,t,0,n,r)},removed:({oldIndex:y})=>{const A=Kn(d);t.remove(A,y),fl(v.splice(y,1)[0])}};function T(y){const A=y.docChanges(a);if(!g&&A.length){g=!0;let E=0;const x=A.length,w=Object.create(null);for(let S=0;S<x;S++)w[A[S].doc.id]=!0;n=S=>{S&&S.id in w&&++E>=x&&(c&&(t.set(i,h,Kn(d)),d=i),p(Kn(d)),n=Pn)}}A.forEach(E=>{C[E.type](E)}),A.length||(c&&(t.set(i,h,Kn(d)),d=i),n(Kn(d)))}return u?ku(e).then(T).catch(r):_=ql(e,T,r),y=>{if(_(),y){const A=typeof y=="function"?y():[];t.set(i,h,A)}v.forEach(fl)}}function PS(i,e,t,n,r,s){const o=Object.assign({},Dd,s),a="value",l=Object.create(null);n=uE(n,()=>fd(i,a));let c=Pn;function u(h){h.exists()?Qu(o,i,a,h,l,t,0,n,r):(t.set(i,a,null),n(null))}return o.once?R_(e).then(u).catch(r):c=ql(e,u,r),h=>{if(c(),h){const d=typeof h=="function"?h():null;t.set(i,a,d)}fl(l)}}const L1=Symbol();function LS(i,e){let t=Pn;const n=Object.assign({},Dd,e),r=Kn(i),s=n.target||Ji();dE()&&(n.once=!0);const o=AS(r,n.ssrKey,L1,dd()),a=o!==L1;a&&(s.value=o);let l=!a;const c=Ji(!1),u=Ji(),h=fh(),d=B1();let p=Pn;function g(){let C=Kn(i);const T=new Promise((y,A)=>{if(t(n.reset),!C)return t=Pn,y(null);c.value=l,l=!0,C.converter||(C=C.withConverter(n.converter)),t=(pd(C)?PS:NS)(s,C,MS,y,A,n)}).catch(y=>(h.value===T&&(u.value=y),Promise.reject(y))).finally(()=>{h.value===T&&(c.value=!1)});h.value=T}let _=Pn;(_t(i)||typeof i=="function")&&(_=js(i,g)),g(),r&&(p=TS(h.value,r,n.ssrKey)),vh()&&mm(()=>h.value),d&&av(v);function v(C=n.reset){_(),p(),t(C)}return Object.defineProperties(s,{error:{get:()=>u},data:{get:()=>s},pending:{get:()=>c},promise:{get:()=>h},stop:{get:()=>v}})}const MS={set:(i,e,t)=>nE(i,e,t),add:(i,e,t)=>i.splice(e,0,t),remove:(i,e)=>i.splice(e,1)},Ns=new WeakMap;function OS(i,e,t){e&&e[i]&&(e[i](t),delete e[i])}const DS={bindName:"$firestoreBind",unbindName:"$firestoreUnbind"},US=function(e,t,n){const r=Object.assign({},DS,t),{bindName:s,unbindName:o}=r,a=e.config.globalProperties;a[o]=function(c,u){OS(c,Ns.get(this),u),delete this.$firestoreRefs[c]},a[s]=function(c,u,h){const d=Object.assign({},r,h),p=Pv(this.$data,c);Ns.has(this)||Ns.set(this,{});const g=Ns.get(this);g[c]&&g[c](d.reset);const _=fE(n||dd(),e).run(()=>F1()),{promise:v,stop:C}=e.runWithContext(()=>_.run(()=>LS(u,{target:p,...d}))),T=y=>{C(y),_.stop()};return g[c]=T,this.$firestoreRefs[c]=u,v.value},e.mixin({beforeCreate(){this.$firestoreRefs=Object.create(null)},created(){const{firestore:l}=this.$options,c=typeof l=="function"?l.call(this):l;if(c)for(const u in c)this[s](u,c[u],r)},beforeUnmount(){const l=Ns.get(this);if(l)for(const c in l)l[c]();this.$firestoreRefs=null}})};function VS(i){return(e,t)=>US(t,i,e)}function FS(i,{firebaseApp:e,modules:t=[]}){i.provide(o2,e);for(const n of t)n(e,i)}const BS={apiKey:"AIzaSyC96yRx9ISiCgYPgVzq9cwlN226gxmDuCY",authDomain:"ibn-silsilah.firebaseapp.com",projectId:"ibn-silsilah",storageBucket:"ibn-silsilah.firebasestorage.app",messagingSenderId:"875917133519",appId:"1:875917133519:web:44e3380532420659eb59ba",measurementId:"G-1YNFY1JHPN"},Ey=Jm(BS),xr=Y7(Ey),Ud=u5(p9);Ud.use(G8);Ud.use(FS,{firebaseApp:Ey,modules:[VS()]});Ud.mount("#app");export{ls as _,je as a,si as c,cn as o};
